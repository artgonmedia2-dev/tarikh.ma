var Oh=u=>{throw TypeError(u)};var Jo=(u,e,t)=>e.has(u)||Oh("Cannot "+t);var as=(u,e,t)=>(Jo(u,e,"read from private field"),t?t.call(u):e.get(u)),Zn=(u,e,t)=>e.has(u)?Oh("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(u):e.set(u,t),er=(u,e,t,i)=>(Jo(u,e,"write to private field"),i?i.call(u,t):e.set(u,t),t),Ta=(u,e,t)=>(Jo(u,e,"access private method"),t);var zh=(u,e,t,i)=>({set _(r){er(u,e,r,t)},get _(){return as(u,e,i)}});function Ag(u,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in u)){const l=Object.getOwnPropertyDescriptor(i,r);l&&Object.defineProperty(u,r,l.get?l:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(r){if(r.ep)return;r.ep=!0;const l=t(r);fetch(r.href,l)}})();function Rc(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var Zo={exports:{}},tr={},ec={exports:{}},Ce={};var Bh;function _g(){if(Bh)return Ce;Bh=1;var u=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.iterator;function b(V){return V===null||typeof V!="object"?null:(V=x&&V[x]||V["@@iterator"],typeof V=="function"?V:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,N={};function _(V,z,ce){this.props=V,this.context=z,this.refs=N,this.updater=ce||w}_.prototype.isReactComponent={},_.prototype.setState=function(V,z){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,z,"setState")},_.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function j(){}j.prototype=_.prototype;function S(V,z,ce){this.props=V,this.context=z,this.refs=N,this.updater=ce||w}var P=S.prototype=new j;P.constructor=S,y(P,_.prototype),P.isPureReactComponent=!0;var k=Array.isArray,L=Object.prototype.hasOwnProperty,T={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function $(V,z,ce){var ve,U={},B=null,ee=null;if(z!=null)for(ve in z.ref!==void 0&&(ee=z.ref),z.key!==void 0&&(B=""+z.key),z)L.call(z,ve)&&!I.hasOwnProperty(ve)&&(U[ve]=z[ve]);var K=arguments.length-2;if(K===1)U.children=ce;else if(1<K){for(var fe=Array(K),Ve=0;Ve<K;Ve++)fe[Ve]=arguments[Ve+2];U.children=fe}if(V&&V.defaultProps)for(ve in K=V.defaultProps,K)U[ve]===void 0&&(U[ve]=K[ve]);return{$$typeof:u,type:V,key:B,ref:ee,props:U,_owner:T.current}}function te(V,z){return{$$typeof:u,type:V.type,key:z,ref:V.ref,props:V.props,_owner:V._owner}}function oe(V){return typeof V=="object"&&V!==null&&V.$$typeof===u}function ae(V){var z={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(ce){return z[ce]})}var ne=/\/+/g;function se(V,z){return typeof V=="object"&&V!==null&&V.key!=null?ae(""+V.key):z.toString(36)}function xe(V,z,ce,ve,U){var B=typeof V;(B==="undefined"||B==="boolean")&&(V=null);var ee=!1;if(V===null)ee=!0;else switch(B){case"string":case"number":ee=!0;break;case"object":switch(V.$$typeof){case u:case e:ee=!0}}if(ee)return ee=V,U=U(ee),V=ve===""?"."+se(ee,0):ve,k(U)?(ce="",V!=null&&(ce=V.replace(ne,"$&/")+"/"),xe(U,z,ce,"",function(Ve){return Ve})):U!=null&&(oe(U)&&(U=te(U,ce+(!U.key||ee&&ee.key===U.key?"":(""+U.key).replace(ne,"$&/")+"/")+V)),z.push(U)),1;if(ee=0,ve=ve===""?".":ve+":",k(V))for(var K=0;K<V.length;K++){B=V[K];var fe=ve+se(B,K);ee+=xe(B,z,ce,fe,U)}else if(fe=b(V),typeof fe=="function")for(V=fe.call(V),K=0;!(B=V.next()).done;)B=B.value,fe=ve+se(B,K++),ee+=xe(B,z,ce,fe,U);else if(B==="object")throw z=String(V),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.");return ee}function Se(V,z,ce){if(V==null)return V;var ve=[],U=0;return xe(V,ve,"","",function(B){return z.call(ce,B,U++)}),ve}function X(V){if(V._status===-1){var z=V._result;z=z(),z.then(function(ce){(V._status===0||V._status===-1)&&(V._status=1,V._result=ce)},function(ce){(V._status===0||V._status===-1)&&(V._status=2,V._result=ce)}),V._status===-1&&(V._status=0,V._result=z)}if(V._status===1)return V._result.default;throw V._result}var Z={current:null},q={transition:null},re={ReactCurrentDispatcher:Z,ReactCurrentBatchConfig:q,ReactCurrentOwner:T};function Q(){throw Error("act(...) is not supported in production builds of React.")}return Ce.Children={map:Se,forEach:function(V,z,ce){Se(V,function(){z.apply(this,arguments)},ce)},count:function(V){var z=0;return Se(V,function(){z++}),z},toArray:function(V){return Se(V,function(z){return z})||[]},only:function(V){if(!oe(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},Ce.Component=_,Ce.Fragment=t,Ce.Profiler=r,Ce.PureComponent=S,Ce.StrictMode=i,Ce.Suspense=f,Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=re,Ce.act=Q,Ce.cloneElement=function(V,z,ce){if(V==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+V+".");var ve=y({},V.props),U=V.key,B=V.ref,ee=V._owner;if(z!=null){if(z.ref!==void 0&&(B=z.ref,ee=T.current),z.key!==void 0&&(U=""+z.key),V.type&&V.type.defaultProps)var K=V.type.defaultProps;for(fe in z)L.call(z,fe)&&!I.hasOwnProperty(fe)&&(ve[fe]=z[fe]===void 0&&K!==void 0?K[fe]:z[fe])}var fe=arguments.length-2;if(fe===1)ve.children=ce;else if(1<fe){K=Array(fe);for(var Ve=0;Ve<fe;Ve++)K[Ve]=arguments[Ve+2];ve.children=K}return{$$typeof:u,type:V.type,key:U,ref:B,props:ve,_owner:ee}},Ce.createContext=function(V){return V={$$typeof:c,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},V.Provider={$$typeof:l,_context:V},V.Consumer=V},Ce.createElement=$,Ce.createFactory=function(V){var z=$.bind(null,V);return z.type=V,z},Ce.createRef=function(){return{current:null}},Ce.forwardRef=function(V){return{$$typeof:d,render:V}},Ce.isValidElement=oe,Ce.lazy=function(V){return{$$typeof:m,_payload:{_status:-1,_result:V},_init:X}},Ce.memo=function(V,z){return{$$typeof:p,type:V,compare:z===void 0?null:z}},Ce.startTransition=function(V){var z=q.transition;q.transition={};try{V()}finally{q.transition=z}},Ce.unstable_act=Q,Ce.useCallback=function(V,z){return Z.current.useCallback(V,z)},Ce.useContext=function(V){return Z.current.useContext(V)},Ce.useDebugValue=function(){},Ce.useDeferredValue=function(V){return Z.current.useDeferredValue(V)},Ce.useEffect=function(V,z){return Z.current.useEffect(V,z)},Ce.useId=function(){return Z.current.useId()},Ce.useImperativeHandle=function(V,z,ce){return Z.current.useImperativeHandle(V,z,ce)},Ce.useInsertionEffect=function(V,z){return Z.current.useInsertionEffect(V,z)},Ce.useLayoutEffect=function(V,z){return Z.current.useLayoutEffect(V,z)},Ce.useMemo=function(V,z){return Z.current.useMemo(V,z)},Ce.useReducer=function(V,z,ce){return Z.current.useReducer(V,z,ce)},Ce.useRef=function(V){return Z.current.useRef(V)},Ce.useState=function(V){return Z.current.useState(V)},Ce.useSyncExternalStore=function(V,z,ce){return Z.current.useSyncExternalStore(V,z,ce)},Ce.useTransition=function(){return Z.current.useTransition()},Ce.version="18.3.1",Ce}var $h;function xr(){return $h||($h=1,ec.exports=_g()),ec.exports}var Uh;function Sg(){if(Uh)return tr;Uh=1;var u=xr(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(d,f,p){var m,x={},b=null,w=null;p!==void 0&&(b=""+p),f.key!==void 0&&(b=""+f.key),f.ref!==void 0&&(w=f.ref);for(m in f)i.call(f,m)&&!l.hasOwnProperty(m)&&(x[m]=f[m]);if(d&&d.defaultProps)for(m in f=d.defaultProps,f)x[m]===void 0&&(x[m]=f[m]);return{$$typeof:e,type:d,key:b,ref:w,props:x,_owner:r.current}}return tr.Fragment=t,tr.jsx=c,tr.jsxs=c,tr}var Hh;function jg(){return Hh||(Hh=1,Zo.exports=Sg()),Zo.exports}var a=jg(),E=xr();const Lc=Rc(E),kg=Ag({__proto__:null,default:Lc},[E]);var Ra={},tc={exports:{}},Lt={},sc={exports:{}},nc={};var Wh;function Eg(){return Wh||(Wh=1,(function(u){function e(q,re){var Q=q.length;q.push(re);e:for(;0<Q;){var V=Q-1>>>1,z=q[V];if(0<r(z,re))q[V]=re,q[Q]=z,Q=V;else break e}}function t(q){return q.length===0?null:q[0]}function i(q){if(q.length===0)return null;var re=q[0],Q=q.pop();if(Q!==re){q[0]=Q;e:for(var V=0,z=q.length,ce=z>>>1;V<ce;){var ve=2*(V+1)-1,U=q[ve],B=ve+1,ee=q[B];if(0>r(U,Q))B<z&&0>r(ee,U)?(q[V]=ee,q[B]=Q,V=B):(q[V]=U,q[ve]=Q,V=ve);else if(B<z&&0>r(ee,Q))q[V]=ee,q[B]=Q,V=B;else break e}}return re}function r(q,re){var Q=q.sortIndex-re.sortIndex;return Q!==0?Q:q.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;u.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();u.unstable_now=function(){return c.now()-d}}var f=[],p=[],m=1,x=null,b=3,w=!1,y=!1,N=!1,_=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(q){for(var re=t(p);re!==null;){if(re.callback===null)i(p);else if(re.startTime<=q)i(p),re.sortIndex=re.expirationTime,e(f,re);else break;re=t(p)}}function k(q){if(N=!1,P(q),!y)if(t(f)!==null)y=!0,X(L);else{var re=t(p);re!==null&&Z(k,re.startTime-q)}}function L(q,re){y=!1,N&&(N=!1,j($),$=-1),w=!0;var Q=b;try{for(P(re),x=t(f);x!==null&&(!(x.expirationTime>re)||q&&!ae());){var V=x.callback;if(typeof V=="function"){x.callback=null,b=x.priorityLevel;var z=V(x.expirationTime<=re);re=u.unstable_now(),typeof z=="function"?x.callback=z:x===t(f)&&i(f),P(re)}else i(f);x=t(f)}if(x!==null)var ce=!0;else{var ve=t(p);ve!==null&&Z(k,ve.startTime-re),ce=!1}return ce}finally{x=null,b=Q,w=!1}}var T=!1,I=null,$=-1,te=5,oe=-1;function ae(){return!(u.unstable_now()-oe<te)}function ne(){if(I!==null){var q=u.unstable_now();oe=q;var re=!0;try{re=I(!0,q)}finally{re?se():(T=!1,I=null)}}else T=!1}var se;if(typeof S=="function")se=function(){S(ne)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,Se=xe.port2;xe.port1.onmessage=ne,se=function(){Se.postMessage(null)}}else se=function(){_(ne,0)};function X(q){I=q,T||(T=!0,se())}function Z(q,re){$=_(function(){q(u.unstable_now())},re)}u.unstable_IdlePriority=5,u.unstable_ImmediatePriority=1,u.unstable_LowPriority=4,u.unstable_NormalPriority=3,u.unstable_Profiling=null,u.unstable_UserBlockingPriority=2,u.unstable_cancelCallback=function(q){q.callback=null},u.unstable_continueExecution=function(){y||w||(y=!0,X(L))},u.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):te=0<q?Math.floor(1e3/q):5},u.unstable_getCurrentPriorityLevel=function(){return b},u.unstable_getFirstCallbackNode=function(){return t(f)},u.unstable_next=function(q){switch(b){case 1:case 2:case 3:var re=3;break;default:re=b}var Q=b;b=re;try{return q()}finally{b=Q}},u.unstable_pauseExecution=function(){},u.unstable_requestPaint=function(){},u.unstable_runWithPriority=function(q,re){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var Q=b;b=q;try{return re()}finally{b=Q}},u.unstable_scheduleCallback=function(q,re,Q){var V=u.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?V+Q:V):Q=V,q){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=Q+z,q={id:m++,callback:re,priorityLevel:q,startTime:Q,expirationTime:z,sortIndex:-1},Q>V?(q.sortIndex=Q,e(p,q),t(f)===null&&q===t(p)&&(N?(j($),$=-1):N=!0,Z(k,Q-V))):(q.sortIndex=z,e(f,q),y||w||(y=!0,X(L))),q},u.unstable_shouldYield=ae,u.unstable_wrapCallback=function(q){var re=b;return function(){var Q=b;b=re;try{return q.apply(this,arguments)}finally{b=Q}}}})(nc)),nc}var Gh;function Cg(){return Gh||(Gh=1,sc.exports=Eg()),sc.exports}var qh;function Pg(){if(qh)return Lt;qh=1;var u=xr(),e=Cg();function t(s){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+s,o=1;o<arguments.length;o++)n+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+s+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function l(s,n){c(s,n),c(s+"Capture",n)}function c(s,n){for(r[s]=n,s=0;s<n.length;s++)i.add(n[s])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},x={};function b(s){return f.call(x,s)?!0:f.call(m,s)?!1:p.test(s)?x[s]=!0:(m[s]=!0,!1)}function w(s,n,o,h){if(o!==null&&o.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return h?!1:o!==null?!o.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function y(s,n,o,h){if(n===null||typeof n>"u"||w(s,n,o,h))return!0;if(h)return!1;if(o!==null)switch(o.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function N(s,n,o,h,g,v,A){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=h,this.attributeNamespace=g,this.mustUseProperty=o,this.propertyName=s,this.type=n,this.sanitizeURL=v,this.removeEmptyString=A}var _={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){_[s]=new N(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var n=s[0];_[n]=new N(n,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){_[s]=new N(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){_[s]=new N(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){_[s]=new N(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){_[s]=new N(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){_[s]=new N(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){_[s]=new N(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){_[s]=new N(s,5,!1,s.toLowerCase(),null,!1,!1)});var j=/[\-:]([a-z])/g;function S(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var n=s.replace(j,S);_[n]=new N(n,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var n=s.replace(j,S);_[n]=new N(n,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var n=s.replace(j,S);_[n]=new N(n,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){_[s]=new N(s,1,!1,s.toLowerCase(),null,!1,!1)}),_.xlinkHref=new N("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){_[s]=new N(s,1,!1,s.toLowerCase(),null,!0,!0)});function P(s,n,o,h){var g=_.hasOwnProperty(n)?_[n]:null;(g!==null?g.type!==0:h||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(y(n,o,g,h)&&(o=null),h||g===null?b(n)&&(o===null?s.removeAttribute(n):s.setAttribute(n,""+o)):g.mustUseProperty?s[g.propertyName]=o===null?g.type===3?!1:"":o:(n=g.attributeName,h=g.attributeNamespace,o===null?s.removeAttribute(n):(g=g.type,o=g===3||g===4&&o===!0?"":""+o,h?s.setAttributeNS(h,n,o):s.setAttribute(n,o))))}var k=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,L=Symbol.for("react.element"),T=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),$=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),oe=Symbol.for("react.provider"),ae=Symbol.for("react.context"),ne=Symbol.for("react.forward_ref"),se=Symbol.for("react.suspense"),xe=Symbol.for("react.suspense_list"),Se=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),Z=Symbol.for("react.offscreen"),q=Symbol.iterator;function re(s){return s===null||typeof s!="object"?null:(s=q&&s[q]||s["@@iterator"],typeof s=="function"?s:null)}var Q=Object.assign,V;function z(s){if(V===void 0)try{throw Error()}catch(o){var n=o.stack.trim().match(/\n( *(at )?)/);V=n&&n[1]||""}return`
`+V+s}var ce=!1;function ve(s,n){if(!s||ce)return"";ce=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(O){var h=O}Reflect.construct(s,[],n)}else{try{n.call()}catch(O){h=O}s.call(n.prototype)}else{try{throw Error()}catch(O){h=O}s()}}catch(O){if(O&&h&&typeof O.stack=="string"){for(var g=O.stack.split(`
`),v=h.stack.split(`
`),A=g.length-1,C=v.length-1;1<=A&&0<=C&&g[A]!==v[C];)C--;for(;1<=A&&0<=C;A--,C--)if(g[A]!==v[C]){if(A!==1||C!==1)do if(A--,C--,0>C||g[A]!==v[C]){var R=`
`+g[A].replace(" at new "," at ");return s.displayName&&R.includes("<anonymous>")&&(R=R.replace("<anonymous>",s.displayName)),R}while(1<=A&&0<=C);break}}}finally{ce=!1,Error.prepareStackTrace=o}return(s=s?s.displayName||s.name:"")?z(s):""}function U(s){switch(s.tag){case 5:return z(s.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return s=ve(s.type,!1),s;case 11:return s=ve(s.type.render,!1),s;case 1:return s=ve(s.type,!0),s;default:return""}}function B(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case I:return"Fragment";case T:return"Portal";case te:return"Profiler";case $:return"StrictMode";case se:return"Suspense";case xe:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case ae:return(s.displayName||"Context")+".Consumer";case oe:return(s._context.displayName||"Context")+".Provider";case ne:var n=s.render;return s=s.displayName,s||(s=n.displayName||n.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case Se:return n=s.displayName||null,n!==null?n:B(s.type)||"Memo";case X:n=s._payload,s=s._init;try{return B(s(n))}catch{}}return null}function ee(s){var n=s.type;switch(s.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=n.render,s=s.displayName||s.name||"",n.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(n);case 8:return n===$?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function K(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function fe(s){var n=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function Ve(s){var n=fe(s)?"checked":"value",o=Object.getOwnPropertyDescriptor(s.constructor.prototype,n),h=""+s[n];if(!s.hasOwnProperty(n)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var g=o.get,v=o.set;return Object.defineProperty(s,n,{configurable:!0,get:function(){return g.call(this)},set:function(A){h=""+A,v.call(this,A)}}),Object.defineProperty(s,n,{enumerable:o.enumerable}),{getValue:function(){return h},setValue:function(A){h=""+A},stopTracking:function(){s._valueTracker=null,delete s[n]}}}}function wt(s){s._valueTracker||(s._valueTracker=Ve(s))}function dt(s){if(!s)return!1;var n=s._valueTracker;if(!n)return!0;var o=n.getValue(),h="";return s&&(h=fe(s)?s.checked?"true":"false":s.value),s=h,s!==o?(n.setValue(s),!0):!1}function Nt(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Ht(s,n){var o=n.checked;return Q({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??s._wrapperState.initialChecked})}function an(s,n){var o=n.defaultValue==null?"":n.defaultValue,h=n.checked!=null?n.checked:n.defaultChecked;o=K(n.value!=null?n.value:o),s._wrapperState={initialChecked:h,initialValue:o,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function ui(s,n){n=n.checked,n!=null&&P(s,"checked",n,!1)}function hi(s,n){ui(s,n);var o=K(n.value),h=n.type;if(o!=null)h==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+o):s.value!==""+o&&(s.value=""+o);else if(h==="submit"||h==="reset"){s.removeAttribute("value");return}n.hasOwnProperty("value")?pi(s,n.type,o):n.hasOwnProperty("defaultValue")&&pi(s,n.type,K(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(s.defaultChecked=!!n.defaultChecked)}function fi(s,n,o){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var h=n.type;if(!(h!=="submit"&&h!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+s._wrapperState.initialValue,o||n===s.value||(s.value=n),s.defaultValue=n}o=s.name,o!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,o!==""&&(s.name=o)}function pi(s,n,o){(n!=="number"||Nt(s.ownerDocument)!==s)&&(o==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+o&&(s.defaultValue=""+o))}var ln=Array.isArray;function Ts(s,n,o,h){if(s=s.options,n){n={};for(var g=0;g<o.length;g++)n["$"+o[g]]=!0;for(o=0;o<s.length;o++)g=n.hasOwnProperty("$"+s[o].value),s[o].selected!==g&&(s[o].selected=g),g&&h&&(s[o].defaultSelected=!0)}else{for(o=""+K(o),n=null,g=0;g<s.length;g++){if(s[g].value===o){s[g].selected=!0,h&&(s[g].defaultSelected=!0);return}n!==null||s[g].disabled||(n=s[g])}n!==null&&(n.selected=!0)}}function mi(s,n){if(n.dangerouslySetInnerHTML!=null)throw Error(t(91));return Q({},n,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function J(s,n){var o=n.value;if(o==null){if(o=n.children,n=n.defaultValue,o!=null){if(n!=null)throw Error(t(92));if(ln(o)){if(1<o.length)throw Error(t(93));o=o[0]}n=o}n==null&&(n=""),o=n}s._wrapperState={initialValue:K(o)}}function Le(s,n){var o=K(n.value),h=K(n.defaultValue);o!=null&&(o=""+o,o!==s.value&&(s.value=o),n.defaultValue==null&&s.defaultValue!==o&&(s.defaultValue=o)),h!=null&&(s.defaultValue=""+h)}function En(s){var n=s.textContent;n===s._wrapperState.initialValue&&n!==""&&n!==null&&(s.value=n)}function Nr(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ol(s,n){return s==null||s==="http://www.w3.org/1999/xhtml"?Nr(n):s==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Ar,Zc=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,o,h,g){MSApp.execUnsafeLocalFunction(function(){return s(n,o,h,g)})}:s})(function(s,n){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=n;else{for(Ar=Ar||document.createElement("div"),Ar.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=Ar.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;n.firstChild;)s.appendChild(n.firstChild)}});function gi(s,n){if(n){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=n;return}}s.textContent=n}var xi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kp=["Webkit","ms","Moz","O"];Object.keys(xi).forEach(function(s){kp.forEach(function(n){n=n+s.charAt(0).toUpperCase()+s.substring(1),xi[n]=xi[s]})});function ed(s,n,o){return n==null||typeof n=="boolean"||n===""?"":o||typeof n!="number"||n===0||xi.hasOwnProperty(s)&&xi[s]?(""+n).trim():n+"px"}function td(s,n){s=s.style;for(var o in n)if(n.hasOwnProperty(o)){var h=o.indexOf("--")===0,g=ed(o,n[o],h);o==="float"&&(o="cssFloat"),h?s.setProperty(o,g):s[o]=g}}var Ep=Q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cl(s,n){if(n){if(Ep[s]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(t(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(t(61))}if(n.style!=null&&typeof n.style!="object")throw Error(t(62))}}function dl(s,n){if(s.indexOf("-")===-1)return typeof n.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ul=null;function hl(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var fl=null,Cn=null,Pn=null;function sd(s){if(s=Oi(s)){if(typeof fl!="function")throw Error(t(280));var n=s.stateNode;n&&(n=Gr(n),fl(s.stateNode,s.type,n))}}function nd(s){Cn?Pn?Pn.push(s):Pn=[s]:Cn=s}function id(){if(Cn){var s=Cn,n=Pn;if(Pn=Cn=null,sd(s),n)for(s=0;s<n.length;s++)sd(n[s])}}function rd(s,n){return s(n)}function ad(){}var pl=!1;function ld(s,n,o){if(pl)return s(n,o);pl=!0;try{return rd(s,n,o)}finally{pl=!1,(Cn!==null||Pn!==null)&&(ad(),id())}}function vi(s,n){var o=s.stateNode;if(o===null)return null;var h=Gr(o);if(h===null)return null;o=h[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(t(231,n,typeof o));return o}var ml=!1;if(d)try{var bi={};Object.defineProperty(bi,"passive",{get:function(){ml=!0}}),window.addEventListener("test",bi,bi),window.removeEventListener("test",bi,bi)}catch{ml=!1}function Cp(s,n,o,h,g,v,A,C,R){var O=Array.prototype.slice.call(arguments,3);try{n.apply(o,O)}catch(W){this.onError(W)}}var yi=!1,_r=null,Sr=!1,gl=null,Pp={onError:function(s){yi=!0,_r=s}};function Tp(s,n,o,h,g,v,A,C,R){yi=!1,_r=null,Cp.apply(Pp,arguments)}function Rp(s,n,o,h,g,v,A,C,R){if(Tp.apply(this,arguments),yi){if(yi){var O=_r;yi=!1,_r=null}else throw Error(t(198));Sr||(Sr=!0,gl=O)}}function on(s){var n=s,o=s;if(s.alternate)for(;n.return;)n=n.return;else{s=n;do n=s,(n.flags&4098)!==0&&(o=n.return),s=n.return;while(s)}return n.tag===3?o:null}function od(s){if(s.tag===13){var n=s.memoizedState;if(n===null&&(s=s.alternate,s!==null&&(n=s.memoizedState)),n!==null)return n.dehydrated}return null}function cd(s){if(on(s)!==s)throw Error(t(188))}function Lp(s){var n=s.alternate;if(!n){if(n=on(s),n===null)throw Error(t(188));return n!==s?null:s}for(var o=s,h=n;;){var g=o.return;if(g===null)break;var v=g.alternate;if(v===null){if(h=g.return,h!==null){o=h;continue}break}if(g.child===v.child){for(v=g.child;v;){if(v===o)return cd(g),s;if(v===h)return cd(g),n;v=v.sibling}throw Error(t(188))}if(o.return!==h.return)o=g,h=v;else{for(var A=!1,C=g.child;C;){if(C===o){A=!0,o=g,h=v;break}if(C===h){A=!0,h=g,o=v;break}C=C.sibling}if(!A){for(C=v.child;C;){if(C===o){A=!0,o=v,h=g;break}if(C===h){A=!0,h=v,o=g;break}C=C.sibling}if(!A)throw Error(t(189))}}if(o.alternate!==h)throw Error(t(190))}if(o.tag!==3)throw Error(t(188));return o.stateNode.current===o?s:n}function dd(s){return s=Lp(s),s!==null?ud(s):null}function ud(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var n=ud(s);if(n!==null)return n;s=s.sibling}return null}var hd=e.unstable_scheduleCallback,fd=e.unstable_cancelCallback,Mp=e.unstable_shouldYield,Vp=e.unstable_requestPaint,Ye=e.unstable_now,Ip=e.unstable_getCurrentPriorityLevel,xl=e.unstable_ImmediatePriority,pd=e.unstable_UserBlockingPriority,jr=e.unstable_NormalPriority,Dp=e.unstable_LowPriority,md=e.unstable_IdlePriority,kr=null,ds=null;function Fp(s){if(ds&&typeof ds.onCommitFiberRoot=="function")try{ds.onCommitFiberRoot(kr,s,void 0,(s.current.flags&128)===128)}catch{}}var Zt=Math.clz32?Math.clz32:Bp,Op=Math.log,zp=Math.LN2;function Bp(s){return s>>>=0,s===0?32:31-(Op(s)/zp|0)|0}var Er=64,Cr=4194304;function wi(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Pr(s,n){var o=s.pendingLanes;if(o===0)return 0;var h=0,g=s.suspendedLanes,v=s.pingedLanes,A=o&268435455;if(A!==0){var C=A&~g;C!==0?h=wi(C):(v&=A,v!==0&&(h=wi(v)))}else A=o&~g,A!==0?h=wi(A):v!==0&&(h=wi(v));if(h===0)return 0;if(n!==0&&n!==h&&(n&g)===0&&(g=h&-h,v=n&-n,g>=v||g===16&&(v&4194240)!==0))return n;if((h&4)!==0&&(h|=o&16),n=s.entangledLanes,n!==0)for(s=s.entanglements,n&=h;0<n;)o=31-Zt(n),g=1<<o,h|=s[o],n&=~g;return h}function $p(s,n){switch(s){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Up(s,n){for(var o=s.suspendedLanes,h=s.pingedLanes,g=s.expirationTimes,v=s.pendingLanes;0<v;){var A=31-Zt(v),C=1<<A,R=g[A];R===-1?((C&o)===0||(C&h)!==0)&&(g[A]=$p(C,n)):R<=n&&(s.expiredLanes|=C),v&=~C}}function vl(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function gd(){var s=Er;return Er<<=1,(Er&4194240)===0&&(Er=64),s}function bl(s){for(var n=[],o=0;31>o;o++)n.push(s);return n}function Ni(s,n,o){s.pendingLanes|=n,n!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,n=31-Zt(n),s[n]=o}function Hp(s,n){var o=s.pendingLanes&~n;s.pendingLanes=n,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=n,s.mutableReadLanes&=n,s.entangledLanes&=n,n=s.entanglements;var h=s.eventTimes;for(s=s.expirationTimes;0<o;){var g=31-Zt(o),v=1<<g;n[g]=0,h[g]=-1,s[g]=-1,o&=~v}}function yl(s,n){var o=s.entangledLanes|=n;for(s=s.entanglements;o;){var h=31-Zt(o),g=1<<h;g&n|s[h]&n&&(s[h]|=n),o&=~g}}var Ie=0;function xd(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var vd,wl,bd,yd,wd,Nl=!1,Tr=[],Rs=null,Ls=null,Ms=null,Ai=new Map,_i=new Map,Vs=[],Wp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nd(s,n){switch(s){case"focusin":case"focusout":Rs=null;break;case"dragenter":case"dragleave":Ls=null;break;case"mouseover":case"mouseout":Ms=null;break;case"pointerover":case"pointerout":Ai.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":_i.delete(n.pointerId)}}function Si(s,n,o,h,g,v){return s===null||s.nativeEvent!==v?(s={blockedOn:n,domEventName:o,eventSystemFlags:h,nativeEvent:v,targetContainers:[g]},n!==null&&(n=Oi(n),n!==null&&wl(n)),s):(s.eventSystemFlags|=h,n=s.targetContainers,g!==null&&n.indexOf(g)===-1&&n.push(g),s)}function Gp(s,n,o,h,g){switch(n){case"focusin":return Rs=Si(Rs,s,n,o,h,g),!0;case"dragenter":return Ls=Si(Ls,s,n,o,h,g),!0;case"mouseover":return Ms=Si(Ms,s,n,o,h,g),!0;case"pointerover":var v=g.pointerId;return Ai.set(v,Si(Ai.get(v)||null,s,n,o,h,g)),!0;case"gotpointercapture":return v=g.pointerId,_i.set(v,Si(_i.get(v)||null,s,n,o,h,g)),!0}return!1}function Ad(s){var n=cn(s.target);if(n!==null){var o=on(n);if(o!==null){if(n=o.tag,n===13){if(n=od(o),n!==null){s.blockedOn=n,wd(s.priority,function(){bd(o)});return}}else if(n===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Rr(s){if(s.blockedOn!==null)return!1;for(var n=s.targetContainers;0<n.length;){var o=_l(s.domEventName,s.eventSystemFlags,n[0],s.nativeEvent);if(o===null){o=s.nativeEvent;var h=new o.constructor(o.type,o);ul=h,o.target.dispatchEvent(h),ul=null}else return n=Oi(o),n!==null&&wl(n),s.blockedOn=o,!1;n.shift()}return!0}function _d(s,n,o){Rr(s)&&o.delete(n)}function qp(){Nl=!1,Rs!==null&&Rr(Rs)&&(Rs=null),Ls!==null&&Rr(Ls)&&(Ls=null),Ms!==null&&Rr(Ms)&&(Ms=null),Ai.forEach(_d),_i.forEach(_d)}function ji(s,n){s.blockedOn===n&&(s.blockedOn=null,Nl||(Nl=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,qp)))}function ki(s){function n(g){return ji(g,s)}if(0<Tr.length){ji(Tr[0],s);for(var o=1;o<Tr.length;o++){var h=Tr[o];h.blockedOn===s&&(h.blockedOn=null)}}for(Rs!==null&&ji(Rs,s),Ls!==null&&ji(Ls,s),Ms!==null&&ji(Ms,s),Ai.forEach(n),_i.forEach(n),o=0;o<Vs.length;o++)h=Vs[o],h.blockedOn===s&&(h.blockedOn=null);for(;0<Vs.length&&(o=Vs[0],o.blockedOn===null);)Ad(o),o.blockedOn===null&&Vs.shift()}var Tn=k.ReactCurrentBatchConfig,Lr=!0;function Xp(s,n,o,h){var g=Ie,v=Tn.transition;Tn.transition=null;try{Ie=1,Al(s,n,o,h)}finally{Ie=g,Tn.transition=v}}function Yp(s,n,o,h){var g=Ie,v=Tn.transition;Tn.transition=null;try{Ie=4,Al(s,n,o,h)}finally{Ie=g,Tn.transition=v}}function Al(s,n,o,h){if(Lr){var g=_l(s,n,o,h);if(g===null)Bl(s,n,h,Mr,o),Nd(s,h);else if(Gp(g,s,n,o,h))h.stopPropagation();else if(Nd(s,h),n&4&&-1<Wp.indexOf(s)){for(;g!==null;){var v=Oi(g);if(v!==null&&vd(v),v=_l(s,n,o,h),v===null&&Bl(s,n,h,Mr,o),v===g)break;g=v}g!==null&&h.stopPropagation()}else Bl(s,n,h,null,o)}}var Mr=null;function _l(s,n,o,h){if(Mr=null,s=hl(h),s=cn(s),s!==null)if(n=on(s),n===null)s=null;else if(o=n.tag,o===13){if(s=od(n),s!==null)return s;s=null}else if(o===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;s=null}else n!==s&&(s=null);return Mr=s,null}function Sd(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ip()){case xl:return 1;case pd:return 4;case jr:case Dp:return 16;case md:return 536870912;default:return 16}default:return 16}}var Is=null,Sl=null,Vr=null;function jd(){if(Vr)return Vr;var s,n=Sl,o=n.length,h,g="value"in Is?Is.value:Is.textContent,v=g.length;for(s=0;s<o&&n[s]===g[s];s++);var A=o-s;for(h=1;h<=A&&n[o-h]===g[v-h];h++);return Vr=g.slice(s,1<h?1-h:void 0)}function Ir(s){var n=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&n===13&&(s=13)):s=n,s===10&&(s=13),32<=s||s===13?s:0}function Dr(){return!0}function kd(){return!1}function Dt(s){function n(o,h,g,v,A){this._reactName=o,this._targetInst=g,this.type=h,this.nativeEvent=v,this.target=A,this.currentTarget=null;for(var C in s)s.hasOwnProperty(C)&&(o=s[C],this[C]=o?o(v):v[C]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Dr:kd,this.isPropagationStopped=kd,this}return Q(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Dr)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Dr)},persist:function(){},isPersistent:Dr}),n}var Rn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jl=Dt(Rn),Ei=Q({},Rn,{view:0,detail:0}),Kp=Dt(Ei),kl,El,Ci,Fr=Q({},Ei,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pl,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ci&&(Ci&&s.type==="mousemove"?(kl=s.screenX-Ci.screenX,El=s.screenY-Ci.screenY):El=kl=0,Ci=s),kl)},movementY:function(s){return"movementY"in s?s.movementY:El}}),Ed=Dt(Fr),Qp=Q({},Fr,{dataTransfer:0}),Jp=Dt(Qp),Zp=Q({},Ei,{relatedTarget:0}),Cl=Dt(Zp),em=Q({},Rn,{animationName:0,elapsedTime:0,pseudoElement:0}),tm=Dt(em),sm=Q({},Rn,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),nm=Dt(sm),im=Q({},Rn,{data:0}),Cd=Dt(im),rm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},am={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function om(s){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(s):(s=lm[s])?!!n[s]:!1}function Pl(){return om}var cm=Q({},Ei,{key:function(s){if(s.key){var n=rm[s.key]||s.key;if(n!=="Unidentified")return n}return s.type==="keypress"?(s=Ir(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?am[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pl,charCode:function(s){return s.type==="keypress"?Ir(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ir(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),dm=Dt(cm),um=Q({},Fr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pd=Dt(um),hm=Q({},Ei,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pl}),fm=Dt(hm),pm=Q({},Rn,{propertyName:0,elapsedTime:0,pseudoElement:0}),mm=Dt(pm),gm=Q({},Fr,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),xm=Dt(gm),vm=[9,13,27,32],Tl=d&&"CompositionEvent"in window,Pi=null;d&&"documentMode"in document&&(Pi=document.documentMode);var bm=d&&"TextEvent"in window&&!Pi,Td=d&&(!Tl||Pi&&8<Pi&&11>=Pi),Rd=" ",Ld=!1;function Md(s,n){switch(s){case"keyup":return vm.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vd(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ln=!1;function ym(s,n){switch(s){case"compositionend":return Vd(n);case"keypress":return n.which!==32?null:(Ld=!0,Rd);case"textInput":return s=n.data,s===Rd&&Ld?null:s;default:return null}}function wm(s,n){if(Ln)return s==="compositionend"||!Tl&&Md(s,n)?(s=jd(),Vr=Sl=Is=null,Ln=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Td&&n.locale!=="ko"?null:n.data;default:return null}}var Nm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Id(s){var n=s&&s.nodeName&&s.nodeName.toLowerCase();return n==="input"?!!Nm[s.type]:n==="textarea"}function Dd(s,n,o,h){nd(h),n=Ur(n,"onChange"),0<n.length&&(o=new jl("onChange","change",null,o,h),s.push({event:o,listeners:n}))}var Ti=null,Ri=null;function Am(s){tu(s,0)}function Or(s){var n=Fn(s);if(dt(n))return s}function _m(s,n){if(s==="change")return n}var Fd=!1;if(d){var Rl;if(d){var Ll="oninput"in document;if(!Ll){var Od=document.createElement("div");Od.setAttribute("oninput","return;"),Ll=typeof Od.oninput=="function"}Rl=Ll}else Rl=!1;Fd=Rl&&(!document.documentMode||9<document.documentMode)}function zd(){Ti&&(Ti.detachEvent("onpropertychange",Bd),Ri=Ti=null)}function Bd(s){if(s.propertyName==="value"&&Or(Ri)){var n=[];Dd(n,Ri,s,hl(s)),ld(Am,n)}}function Sm(s,n,o){s==="focusin"?(zd(),Ti=n,Ri=o,Ti.attachEvent("onpropertychange",Bd)):s==="focusout"&&zd()}function jm(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Or(Ri)}function km(s,n){if(s==="click")return Or(n)}function Em(s,n){if(s==="input"||s==="change")return Or(n)}function Cm(s,n){return s===n&&(s!==0||1/s===1/n)||s!==s&&n!==n}var es=typeof Object.is=="function"?Object.is:Cm;function Li(s,n){if(es(s,n))return!0;if(typeof s!="object"||s===null||typeof n!="object"||n===null)return!1;var o=Object.keys(s),h=Object.keys(n);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var g=o[h];if(!f.call(n,g)||!es(s[g],n[g]))return!1}return!0}function $d(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Ud(s,n){var o=$d(s);s=0;for(var h;o;){if(o.nodeType===3){if(h=s+o.textContent.length,s<=n&&h>=n)return{node:o,offset:n-s};s=h}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=$d(o)}}function Hd(s,n){return s&&n?s===n?!0:s&&s.nodeType===3?!1:n&&n.nodeType===3?Hd(s,n.parentNode):"contains"in s?s.contains(n):s.compareDocumentPosition?!!(s.compareDocumentPosition(n)&16):!1:!1}function Wd(){for(var s=window,n=Nt();n instanceof s.HTMLIFrameElement;){try{var o=typeof n.contentWindow.location.href=="string"}catch{o=!1}if(o)s=n.contentWindow;else break;n=Nt(s.document)}return n}function Ml(s){var n=s&&s.nodeName&&s.nodeName.toLowerCase();return n&&(n==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||n==="textarea"||s.contentEditable==="true")}function Pm(s){var n=Wd(),o=s.focusedElem,h=s.selectionRange;if(n!==o&&o&&o.ownerDocument&&Hd(o.ownerDocument.documentElement,o)){if(h!==null&&Ml(o)){if(n=h.start,s=h.end,s===void 0&&(s=n),"selectionStart"in o)o.selectionStart=n,o.selectionEnd=Math.min(s,o.value.length);else if(s=(n=o.ownerDocument||document)&&n.defaultView||window,s.getSelection){s=s.getSelection();var g=o.textContent.length,v=Math.min(h.start,g);h=h.end===void 0?v:Math.min(h.end,g),!s.extend&&v>h&&(g=h,h=v,v=g),g=Ud(o,v);var A=Ud(o,h);g&&A&&(s.rangeCount!==1||s.anchorNode!==g.node||s.anchorOffset!==g.offset||s.focusNode!==A.node||s.focusOffset!==A.offset)&&(n=n.createRange(),n.setStart(g.node,g.offset),s.removeAllRanges(),v>h?(s.addRange(n),s.extend(A.node,A.offset)):(n.setEnd(A.node,A.offset),s.addRange(n)))}}for(n=[],s=o;s=s.parentNode;)s.nodeType===1&&n.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<n.length;o++)s=n[o],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var Tm=d&&"documentMode"in document&&11>=document.documentMode,Mn=null,Vl=null,Mi=null,Il=!1;function Gd(s,n,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Il||Mn==null||Mn!==Nt(h)||(h=Mn,"selectionStart"in h&&Ml(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Mi&&Li(Mi,h)||(Mi=h,h=Ur(Vl,"onSelect"),0<h.length&&(n=new jl("onSelect","select",null,n,o),s.push({event:n,listeners:h}),n.target=Mn)))}function zr(s,n){var o={};return o[s.toLowerCase()]=n.toLowerCase(),o["Webkit"+s]="webkit"+n,o["Moz"+s]="moz"+n,o}var Vn={animationend:zr("Animation","AnimationEnd"),animationiteration:zr("Animation","AnimationIteration"),animationstart:zr("Animation","AnimationStart"),transitionend:zr("Transition","TransitionEnd")},Dl={},qd={};d&&(qd=document.createElement("div").style,"AnimationEvent"in window||(delete Vn.animationend.animation,delete Vn.animationiteration.animation,delete Vn.animationstart.animation),"TransitionEvent"in window||delete Vn.transitionend.transition);function Br(s){if(Dl[s])return Dl[s];if(!Vn[s])return s;var n=Vn[s],o;for(o in n)if(n.hasOwnProperty(o)&&o in qd)return Dl[s]=n[o];return s}var Xd=Br("animationend"),Yd=Br("animationiteration"),Kd=Br("animationstart"),Qd=Br("transitionend"),Jd=new Map,Zd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ds(s,n){Jd.set(s,n),l(n,[s])}for(var Fl=0;Fl<Zd.length;Fl++){var Ol=Zd[Fl],Rm=Ol.toLowerCase(),Lm=Ol[0].toUpperCase()+Ol.slice(1);Ds(Rm,"on"+Lm)}Ds(Xd,"onAnimationEnd"),Ds(Yd,"onAnimationIteration"),Ds(Kd,"onAnimationStart"),Ds("dblclick","onDoubleClick"),Ds("focusin","onFocus"),Ds("focusout","onBlur"),Ds(Qd,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mm=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vi));function eu(s,n,o){var h=s.type||"unknown-event";s.currentTarget=o,Rp(h,n,void 0,s),s.currentTarget=null}function tu(s,n){n=(n&4)!==0;for(var o=0;o<s.length;o++){var h=s[o],g=h.event;h=h.listeners;e:{var v=void 0;if(n)for(var A=h.length-1;0<=A;A--){var C=h[A],R=C.instance,O=C.currentTarget;if(C=C.listener,R!==v&&g.isPropagationStopped())break e;eu(g,C,O),v=R}else for(A=0;A<h.length;A++){if(C=h[A],R=C.instance,O=C.currentTarget,C=C.listener,R!==v&&g.isPropagationStopped())break e;eu(g,C,O),v=R}}}if(Sr)throw s=gl,Sr=!1,gl=null,s}function ze(s,n){var o=n[ql];o===void 0&&(o=n[ql]=new Set);var h=s+"__bubble";o.has(h)||(su(n,s,2,!1),o.add(h))}function zl(s,n,o){var h=0;n&&(h|=4),su(o,s,h,n)}var $r="_reactListening"+Math.random().toString(36).slice(2);function Ii(s){if(!s[$r]){s[$r]=!0,i.forEach(function(o){o!=="selectionchange"&&(Mm.has(o)||zl(o,!1,s),zl(o,!0,s))});var n=s.nodeType===9?s:s.ownerDocument;n===null||n[$r]||(n[$r]=!0,zl("selectionchange",!1,n))}}function su(s,n,o,h){switch(Sd(n)){case 1:var g=Xp;break;case 4:g=Yp;break;default:g=Al}o=g.bind(null,n,o,s),g=void 0,!ml||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(g=!0),h?g!==void 0?s.addEventListener(n,o,{capture:!0,passive:g}):s.addEventListener(n,o,!0):g!==void 0?s.addEventListener(n,o,{passive:g}):s.addEventListener(n,o,!1)}function Bl(s,n,o,h,g){var v=h;if((n&1)===0&&(n&2)===0&&h!==null)e:for(;;){if(h===null)return;var A=h.tag;if(A===3||A===4){var C=h.stateNode.containerInfo;if(C===g||C.nodeType===8&&C.parentNode===g)break;if(A===4)for(A=h.return;A!==null;){var R=A.tag;if((R===3||R===4)&&(R=A.stateNode.containerInfo,R===g||R.nodeType===8&&R.parentNode===g))return;A=A.return}for(;C!==null;){if(A=cn(C),A===null)return;if(R=A.tag,R===5||R===6){h=v=A;continue e}C=C.parentNode}}h=h.return}ld(function(){var O=v,W=hl(o),G=[];e:{var H=Jd.get(s);if(H!==void 0){var le=jl,he=s;switch(s){case"keypress":if(Ir(o)===0)break e;case"keydown":case"keyup":le=dm;break;case"focusin":he="focus",le=Cl;break;case"focusout":he="blur",le=Cl;break;case"beforeblur":case"afterblur":le=Cl;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":le=Ed;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":le=Jp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":le=fm;break;case Xd:case Yd:case Kd:le=tm;break;case Qd:le=mm;break;case"scroll":le=Kp;break;case"wheel":le=xm;break;case"copy":case"cut":case"paste":le=nm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":le=Pd}var pe=(n&4)!==0,Ke=!pe&&s==="scroll",D=pe?H!==null?H+"Capture":null:H;pe=[];for(var M=O,F;M!==null;){F=M;var Y=F.stateNode;if(F.tag===5&&Y!==null&&(F=Y,D!==null&&(Y=vi(M,D),Y!=null&&pe.push(Di(M,Y,F)))),Ke)break;M=M.return}0<pe.length&&(H=new le(H,he,null,o,W),G.push({event:H,listeners:pe}))}}if((n&7)===0){e:{if(H=s==="mouseover"||s==="pointerover",le=s==="mouseout"||s==="pointerout",H&&o!==ul&&(he=o.relatedTarget||o.fromElement)&&(cn(he)||he[bs]))break e;if((le||H)&&(H=W.window===W?W:(H=W.ownerDocument)?H.defaultView||H.parentWindow:window,le?(he=o.relatedTarget||o.toElement,le=O,he=he?cn(he):null,he!==null&&(Ke=on(he),he!==Ke||he.tag!==5&&he.tag!==6)&&(he=null)):(le=null,he=O),le!==he)){if(pe=Ed,Y="onMouseLeave",D="onMouseEnter",M="mouse",(s==="pointerout"||s==="pointerover")&&(pe=Pd,Y="onPointerLeave",D="onPointerEnter",M="pointer"),Ke=le==null?H:Fn(le),F=he==null?H:Fn(he),H=new pe(Y,M+"leave",le,o,W),H.target=Ke,H.relatedTarget=F,Y=null,cn(W)===O&&(pe=new pe(D,M+"enter",he,o,W),pe.target=F,pe.relatedTarget=Ke,Y=pe),Ke=Y,le&&he)t:{for(pe=le,D=he,M=0,F=pe;F;F=In(F))M++;for(F=0,Y=D;Y;Y=In(Y))F++;for(;0<M-F;)pe=In(pe),M--;for(;0<F-M;)D=In(D),F--;for(;M--;){if(pe===D||D!==null&&pe===D.alternate)break t;pe=In(pe),D=In(D)}pe=null}else pe=null;le!==null&&nu(G,H,le,pe,!1),he!==null&&Ke!==null&&nu(G,Ke,he,pe,!0)}}e:{if(H=O?Fn(O):window,le=H.nodeName&&H.nodeName.toLowerCase(),le==="select"||le==="input"&&H.type==="file")var me=_m;else if(Id(H))if(Fd)me=Em;else{me=jm;var be=Sm}else(le=H.nodeName)&&le.toLowerCase()==="input"&&(H.type==="checkbox"||H.type==="radio")&&(me=km);if(me&&(me=me(s,O))){Dd(G,me,o,W);break e}be&&be(s,H,O),s==="focusout"&&(be=H._wrapperState)&&be.controlled&&H.type==="number"&&pi(H,"number",H.value)}switch(be=O?Fn(O):window,s){case"focusin":(Id(be)||be.contentEditable==="true")&&(Mn=be,Vl=O,Mi=null);break;case"focusout":Mi=Vl=Mn=null;break;case"mousedown":Il=!0;break;case"contextmenu":case"mouseup":case"dragend":Il=!1,Gd(G,o,W);break;case"selectionchange":if(Tm)break;case"keydown":case"keyup":Gd(G,o,W)}var ye;if(Tl)e:{switch(s){case"compositionstart":var Ae="onCompositionStart";break e;case"compositionend":Ae="onCompositionEnd";break e;case"compositionupdate":Ae="onCompositionUpdate";break e}Ae=void 0}else Ln?Md(s,o)&&(Ae="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(Ae="onCompositionStart");Ae&&(Td&&o.locale!=="ko"&&(Ln||Ae!=="onCompositionStart"?Ae==="onCompositionEnd"&&Ln&&(ye=jd()):(Is=W,Sl="value"in Is?Is.value:Is.textContent,Ln=!0)),be=Ur(O,Ae),0<be.length&&(Ae=new Cd(Ae,s,null,o,W),G.push({event:Ae,listeners:be}),ye?Ae.data=ye:(ye=Vd(o),ye!==null&&(Ae.data=ye)))),(ye=bm?ym(s,o):wm(s,o))&&(O=Ur(O,"onBeforeInput"),0<O.length&&(W=new Cd("onBeforeInput","beforeinput",null,o,W),G.push({event:W,listeners:O}),W.data=ye))}tu(G,n)})}function Di(s,n,o){return{instance:s,listener:n,currentTarget:o}}function Ur(s,n){for(var o=n+"Capture",h=[];s!==null;){var g=s,v=g.stateNode;g.tag===5&&v!==null&&(g=v,v=vi(s,o),v!=null&&h.unshift(Di(s,v,g)),v=vi(s,n),v!=null&&h.push(Di(s,v,g))),s=s.return}return h}function In(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function nu(s,n,o,h,g){for(var v=n._reactName,A=[];o!==null&&o!==h;){var C=o,R=C.alternate,O=C.stateNode;if(R!==null&&R===h)break;C.tag===5&&O!==null&&(C=O,g?(R=vi(o,v),R!=null&&A.unshift(Di(o,R,C))):g||(R=vi(o,v),R!=null&&A.push(Di(o,R,C)))),o=o.return}A.length!==0&&s.push({event:n,listeners:A})}var Vm=/\r\n?/g,Im=/\u0000|\uFFFD/g;function iu(s){return(typeof s=="string"?s:""+s).replace(Vm,`
`).replace(Im,"")}function Hr(s,n,o){if(n=iu(n),iu(s)!==n&&o)throw Error(t(425))}function Wr(){}var $l=null,Ul=null;function Hl(s,n){return s==="textarea"||s==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Wl=typeof setTimeout=="function"?setTimeout:void 0,Dm=typeof clearTimeout=="function"?clearTimeout:void 0,ru=typeof Promise=="function"?Promise:void 0,Fm=typeof queueMicrotask=="function"?queueMicrotask:typeof ru<"u"?function(s){return ru.resolve(null).then(s).catch(Om)}:Wl;function Om(s){setTimeout(function(){throw s})}function Gl(s,n){var o=n,h=0;do{var g=o.nextSibling;if(s.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"){if(h===0){s.removeChild(g),ki(n);return}h--}else o!=="$"&&o!=="$?"&&o!=="$!"||h++;o=g}while(o);ki(n)}function Fs(s){for(;s!=null;s=s.nextSibling){var n=s.nodeType;if(n===1||n===3)break;if(n===8){if(n=s.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return s}function au(s){s=s.previousSibling;for(var n=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"){if(n===0)return s;n--}else o==="/$"&&n++}s=s.previousSibling}return null}var Dn=Math.random().toString(36).slice(2),us="__reactFiber$"+Dn,Fi="__reactProps$"+Dn,bs="__reactContainer$"+Dn,ql="__reactEvents$"+Dn,zm="__reactListeners$"+Dn,Bm="__reactHandles$"+Dn;function cn(s){var n=s[us];if(n)return n;for(var o=s.parentNode;o;){if(n=o[bs]||o[us]){if(o=n.alternate,n.child!==null||o!==null&&o.child!==null)for(s=au(s);s!==null;){if(o=s[us])return o;s=au(s)}return n}s=o,o=s.parentNode}return null}function Oi(s){return s=s[us]||s[bs],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function Fn(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function Gr(s){return s[Fi]||null}var Xl=[],On=-1;function Os(s){return{current:s}}function Be(s){0>On||(s.current=Xl[On],Xl[On]=null,On--)}function Oe(s,n){On++,Xl[On]=s.current,s.current=n}var zs={},pt=Os(zs),Et=Os(!1),dn=zs;function zn(s,n){var o=s.type.contextTypes;if(!o)return zs;var h=s.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===n)return h.__reactInternalMemoizedMaskedChildContext;var g={},v;for(v in o)g[v]=n[v];return h&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=n,s.__reactInternalMemoizedMaskedChildContext=g),g}function Ct(s){return s=s.childContextTypes,s!=null}function qr(){Be(Et),Be(pt)}function lu(s,n,o){if(pt.current!==zs)throw Error(t(168));Oe(pt,n),Oe(Et,o)}function ou(s,n,o){var h=s.stateNode;if(n=n.childContextTypes,typeof h.getChildContext!="function")return o;h=h.getChildContext();for(var g in h)if(!(g in n))throw Error(t(108,ee(s)||"Unknown",g));return Q({},o,h)}function Xr(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||zs,dn=pt.current,Oe(pt,s),Oe(Et,Et.current),!0}function cu(s,n,o){var h=s.stateNode;if(!h)throw Error(t(169));o?(s=ou(s,n,dn),h.__reactInternalMemoizedMergedChildContext=s,Be(Et),Be(pt),Oe(pt,s)):Be(Et),Oe(Et,o)}var ys=null,Yr=!1,Yl=!1;function du(s){ys===null?ys=[s]:ys.push(s)}function $m(s){Yr=!0,du(s)}function Bs(){if(!Yl&&ys!==null){Yl=!0;var s=0,n=Ie;try{var o=ys;for(Ie=1;s<o.length;s++){var h=o[s];do h=h(!0);while(h!==null)}ys=null,Yr=!1}catch(g){throw ys!==null&&(ys=ys.slice(s+1)),hd(xl,Bs),g}finally{Ie=n,Yl=!1}}return null}var Bn=[],$n=0,Kr=null,Qr=0,Wt=[],Gt=0,un=null,ws=1,Ns="";function hn(s,n){Bn[$n++]=Qr,Bn[$n++]=Kr,Kr=s,Qr=n}function uu(s,n,o){Wt[Gt++]=ws,Wt[Gt++]=Ns,Wt[Gt++]=un,un=s;var h=ws;s=Ns;var g=32-Zt(h)-1;h&=~(1<<g),o+=1;var v=32-Zt(n)+g;if(30<v){var A=g-g%5;v=(h&(1<<A)-1).toString(32),h>>=A,g-=A,ws=1<<32-Zt(n)+g|o<<g|h,Ns=v+s}else ws=1<<v|o<<g|h,Ns=s}function Kl(s){s.return!==null&&(hn(s,1),uu(s,1,0))}function Ql(s){for(;s===Kr;)Kr=Bn[--$n],Bn[$n]=null,Qr=Bn[--$n],Bn[$n]=null;for(;s===un;)un=Wt[--Gt],Wt[Gt]=null,Ns=Wt[--Gt],Wt[Gt]=null,ws=Wt[--Gt],Wt[Gt]=null}var Ft=null,Ot=null,$e=!1,ts=null;function hu(s,n){var o=Kt(5,null,null,0);o.elementType="DELETED",o.stateNode=n,o.return=s,n=s.deletions,n===null?(s.deletions=[o],s.flags|=16):n.push(o)}function fu(s,n){switch(s.tag){case 5:var o=s.type;return n=n.nodeType!==1||o.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(s.stateNode=n,Ft=s,Ot=Fs(n.firstChild),!0):!1;case 6:return n=s.pendingProps===""||n.nodeType!==3?null:n,n!==null?(s.stateNode=n,Ft=s,Ot=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(o=un!==null?{id:ws,overflow:Ns}:null,s.memoizedState={dehydrated:n,treeContext:o,retryLane:1073741824},o=Kt(18,null,null,0),o.stateNode=n,o.return=s,s.child=o,Ft=s,Ot=null,!0):!1;default:return!1}}function Jl(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Zl(s){if($e){var n=Ot;if(n){var o=n;if(!fu(s,n)){if(Jl(s))throw Error(t(418));n=Fs(o.nextSibling);var h=Ft;n&&fu(s,n)?hu(h,o):(s.flags=s.flags&-4097|2,$e=!1,Ft=s)}}else{if(Jl(s))throw Error(t(418));s.flags=s.flags&-4097|2,$e=!1,Ft=s}}}function pu(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Ft=s}function Jr(s){if(s!==Ft)return!1;if(!$e)return pu(s),$e=!0,!1;var n;if((n=s.tag!==3)&&!(n=s.tag!==5)&&(n=s.type,n=n!=="head"&&n!=="body"&&!Hl(s.type,s.memoizedProps)),n&&(n=Ot)){if(Jl(s))throw mu(),Error(t(418));for(;n;)hu(s,n),n=Fs(n.nextSibling)}if(pu(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,n=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"){if(n===0){Ot=Fs(s.nextSibling);break e}n--}else o!=="$"&&o!=="$!"&&o!=="$?"||n++}s=s.nextSibling}Ot=null}}else Ot=Ft?Fs(s.stateNode.nextSibling):null;return!0}function mu(){for(var s=Ot;s;)s=Fs(s.nextSibling)}function Un(){Ot=Ft=null,$e=!1}function eo(s){ts===null?ts=[s]:ts.push(s)}var Um=k.ReactCurrentBatchConfig;function zi(s,n,o){if(s=o.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(t(309));var h=o.stateNode}if(!h)throw Error(t(147,s));var g=h,v=""+s;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===v?n.ref:(n=function(A){var C=g.refs;A===null?delete C[v]:C[v]=A},n._stringRef=v,n)}if(typeof s!="string")throw Error(t(284));if(!o._owner)throw Error(t(290,s))}return s}function Zr(s,n){throw s=Object.prototype.toString.call(n),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":s))}function gu(s){var n=s._init;return n(s._payload)}function xu(s){function n(D,M){if(s){var F=D.deletions;F===null?(D.deletions=[M],D.flags|=16):F.push(M)}}function o(D,M){if(!s)return null;for(;M!==null;)n(D,M),M=M.sibling;return null}function h(D,M){for(D=new Map;M!==null;)M.key!==null?D.set(M.key,M):D.set(M.index,M),M=M.sibling;return D}function g(D,M){return D=Ys(D,M),D.index=0,D.sibling=null,D}function v(D,M,F){return D.index=F,s?(F=D.alternate,F!==null?(F=F.index,F<M?(D.flags|=2,M):F):(D.flags|=2,M)):(D.flags|=1048576,M)}function A(D){return s&&D.alternate===null&&(D.flags|=2),D}function C(D,M,F,Y){return M===null||M.tag!==6?(M=Go(F,D.mode,Y),M.return=D,M):(M=g(M,F),M.return=D,M)}function R(D,M,F,Y){var me=F.type;return me===I?W(D,M,F.props.children,Y,F.key):M!==null&&(M.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===X&&gu(me)===M.type)?(Y=g(M,F.props),Y.ref=zi(D,M,F),Y.return=D,Y):(Y=Aa(F.type,F.key,F.props,null,D.mode,Y),Y.ref=zi(D,M,F),Y.return=D,Y)}function O(D,M,F,Y){return M===null||M.tag!==4||M.stateNode.containerInfo!==F.containerInfo||M.stateNode.implementation!==F.implementation?(M=qo(F,D.mode,Y),M.return=D,M):(M=g(M,F.children||[]),M.return=D,M)}function W(D,M,F,Y,me){return M===null||M.tag!==7?(M=yn(F,D.mode,Y,me),M.return=D,M):(M=g(M,F),M.return=D,M)}function G(D,M,F){if(typeof M=="string"&&M!==""||typeof M=="number")return M=Go(""+M,D.mode,F),M.return=D,M;if(typeof M=="object"&&M!==null){switch(M.$$typeof){case L:return F=Aa(M.type,M.key,M.props,null,D.mode,F),F.ref=zi(D,null,M),F.return=D,F;case T:return M=qo(M,D.mode,F),M.return=D,M;case X:var Y=M._init;return G(D,Y(M._payload),F)}if(ln(M)||re(M))return M=yn(M,D.mode,F,null),M.return=D,M;Zr(D,M)}return null}function H(D,M,F,Y){var me=M!==null?M.key:null;if(typeof F=="string"&&F!==""||typeof F=="number")return me!==null?null:C(D,M,""+F,Y);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case L:return F.key===me?R(D,M,F,Y):null;case T:return F.key===me?O(D,M,F,Y):null;case X:return me=F._init,H(D,M,me(F._payload),Y)}if(ln(F)||re(F))return me!==null?null:W(D,M,F,Y,null);Zr(D,F)}return null}function le(D,M,F,Y,me){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return D=D.get(F)||null,C(M,D,""+Y,me);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case L:return D=D.get(Y.key===null?F:Y.key)||null,R(M,D,Y,me);case T:return D=D.get(Y.key===null?F:Y.key)||null,O(M,D,Y,me);case X:var be=Y._init;return le(D,M,F,be(Y._payload),me)}if(ln(Y)||re(Y))return D=D.get(F)||null,W(M,D,Y,me,null);Zr(M,Y)}return null}function he(D,M,F,Y){for(var me=null,be=null,ye=M,Ae=M=0,ot=null;ye!==null&&Ae<F.length;Ae++){ye.index>Ae?(ot=ye,ye=null):ot=ye.sibling;var Me=H(D,ye,F[Ae],Y);if(Me===null){ye===null&&(ye=ot);break}s&&ye&&Me.alternate===null&&n(D,ye),M=v(Me,M,Ae),be===null?me=Me:be.sibling=Me,be=Me,ye=ot}if(Ae===F.length)return o(D,ye),$e&&hn(D,Ae),me;if(ye===null){for(;Ae<F.length;Ae++)ye=G(D,F[Ae],Y),ye!==null&&(M=v(ye,M,Ae),be===null?me=ye:be.sibling=ye,be=ye);return $e&&hn(D,Ae),me}for(ye=h(D,ye);Ae<F.length;Ae++)ot=le(ye,D,Ae,F[Ae],Y),ot!==null&&(s&&ot.alternate!==null&&ye.delete(ot.key===null?Ae:ot.key),M=v(ot,M,Ae),be===null?me=ot:be.sibling=ot,be=ot);return s&&ye.forEach(function(Ks){return n(D,Ks)}),$e&&hn(D,Ae),me}function pe(D,M,F,Y){var me=re(F);if(typeof me!="function")throw Error(t(150));if(F=me.call(F),F==null)throw Error(t(151));for(var be=me=null,ye=M,Ae=M=0,ot=null,Me=F.next();ye!==null&&!Me.done;Ae++,Me=F.next()){ye.index>Ae?(ot=ye,ye=null):ot=ye.sibling;var Ks=H(D,ye,Me.value,Y);if(Ks===null){ye===null&&(ye=ot);break}s&&ye&&Ks.alternate===null&&n(D,ye),M=v(Ks,M,Ae),be===null?me=Ks:be.sibling=Ks,be=Ks,ye=ot}if(Me.done)return o(D,ye),$e&&hn(D,Ae),me;if(ye===null){for(;!Me.done;Ae++,Me=F.next())Me=G(D,Me.value,Y),Me!==null&&(M=v(Me,M,Ae),be===null?me=Me:be.sibling=Me,be=Me);return $e&&hn(D,Ae),me}for(ye=h(D,ye);!Me.done;Ae++,Me=F.next())Me=le(ye,D,Ae,Me.value,Y),Me!==null&&(s&&Me.alternate!==null&&ye.delete(Me.key===null?Ae:Me.key),M=v(Me,M,Ae),be===null?me=Me:be.sibling=Me,be=Me);return s&&ye.forEach(function(Ng){return n(D,Ng)}),$e&&hn(D,Ae),me}function Ke(D,M,F,Y){if(typeof F=="object"&&F!==null&&F.type===I&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case L:e:{for(var me=F.key,be=M;be!==null;){if(be.key===me){if(me=F.type,me===I){if(be.tag===7){o(D,be.sibling),M=g(be,F.props.children),M.return=D,D=M;break e}}else if(be.elementType===me||typeof me=="object"&&me!==null&&me.$$typeof===X&&gu(me)===be.type){o(D,be.sibling),M=g(be,F.props),M.ref=zi(D,be,F),M.return=D,D=M;break e}o(D,be);break}else n(D,be);be=be.sibling}F.type===I?(M=yn(F.props.children,D.mode,Y,F.key),M.return=D,D=M):(Y=Aa(F.type,F.key,F.props,null,D.mode,Y),Y.ref=zi(D,M,F),Y.return=D,D=Y)}return A(D);case T:e:{for(be=F.key;M!==null;){if(M.key===be)if(M.tag===4&&M.stateNode.containerInfo===F.containerInfo&&M.stateNode.implementation===F.implementation){o(D,M.sibling),M=g(M,F.children||[]),M.return=D,D=M;break e}else{o(D,M);break}else n(D,M);M=M.sibling}M=qo(F,D.mode,Y),M.return=D,D=M}return A(D);case X:return be=F._init,Ke(D,M,be(F._payload),Y)}if(ln(F))return he(D,M,F,Y);if(re(F))return pe(D,M,F,Y);Zr(D,F)}return typeof F=="string"&&F!==""||typeof F=="number"?(F=""+F,M!==null&&M.tag===6?(o(D,M.sibling),M=g(M,F),M.return=D,D=M):(o(D,M),M=Go(F,D.mode,Y),M.return=D,D=M),A(D)):o(D,M)}return Ke}var Hn=xu(!0),vu=xu(!1),ea=Os(null),ta=null,Wn=null,to=null;function so(){to=Wn=ta=null}function no(s){var n=ea.current;Be(ea),s._currentValue=n}function io(s,n,o){for(;s!==null;){var h=s.alternate;if((s.childLanes&n)!==n?(s.childLanes|=n,h!==null&&(h.childLanes|=n)):h!==null&&(h.childLanes&n)!==n&&(h.childLanes|=n),s===o)break;s=s.return}}function Gn(s,n){ta=s,to=Wn=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&n)!==0&&(Pt=!0),s.firstContext=null)}function qt(s){var n=s._currentValue;if(to!==s)if(s={context:s,memoizedValue:n,next:null},Wn===null){if(ta===null)throw Error(t(308));Wn=s,ta.dependencies={lanes:0,firstContext:s}}else Wn=Wn.next=s;return n}var fn=null;function ro(s){fn===null?fn=[s]:fn.push(s)}function bu(s,n,o,h){var g=n.interleaved;return g===null?(o.next=o,ro(n)):(o.next=g.next,g.next=o),n.interleaved=o,As(s,h)}function As(s,n){s.lanes|=n;var o=s.alternate;for(o!==null&&(o.lanes|=n),o=s,s=s.return;s!==null;)s.childLanes|=n,o=s.alternate,o!==null&&(o.childLanes|=n),o=s,s=s.return;return o.tag===3?o.stateNode:null}var $s=!1;function ao(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yu(s,n){s=s.updateQueue,n.updateQueue===s&&(n.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function _s(s,n){return{eventTime:s,lane:n,tag:0,payload:null,callback:null,next:null}}function Us(s,n,o){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(Re&2)!==0){var g=h.pending;return g===null?n.next=n:(n.next=g.next,g.next=n),h.pending=n,As(s,o)}return g=h.interleaved,g===null?(n.next=n,ro(h)):(n.next=g.next,g.next=n),h.interleaved=n,As(s,o)}function sa(s,n,o){if(n=n.updateQueue,n!==null&&(n=n.shared,(o&4194240)!==0)){var h=n.lanes;h&=s.pendingLanes,o|=h,n.lanes=o,yl(s,o)}}function wu(s,n){var o=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var g=null,v=null;if(o=o.firstBaseUpdate,o!==null){do{var A={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};v===null?g=v=A:v=v.next=A,o=o.next}while(o!==null);v===null?g=v=n:v=v.next=n}else g=v=n;o={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:v,shared:h.shared,effects:h.effects},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=n:s.next=n,o.lastBaseUpdate=n}function na(s,n,o,h){var g=s.updateQueue;$s=!1;var v=g.firstBaseUpdate,A=g.lastBaseUpdate,C=g.shared.pending;if(C!==null){g.shared.pending=null;var R=C,O=R.next;R.next=null,A===null?v=O:A.next=O,A=R;var W=s.alternate;W!==null&&(W=W.updateQueue,C=W.lastBaseUpdate,C!==A&&(C===null?W.firstBaseUpdate=O:C.next=O,W.lastBaseUpdate=R))}if(v!==null){var G=g.baseState;A=0,W=O=R=null,C=v;do{var H=C.lane,le=C.eventTime;if((h&H)===H){W!==null&&(W=W.next={eventTime:le,lane:0,tag:C.tag,payload:C.payload,callback:C.callback,next:null});e:{var he=s,pe=C;switch(H=n,le=o,pe.tag){case 1:if(he=pe.payload,typeof he=="function"){G=he.call(le,G,H);break e}G=he;break e;case 3:he.flags=he.flags&-65537|128;case 0:if(he=pe.payload,H=typeof he=="function"?he.call(le,G,H):he,H==null)break e;G=Q({},G,H);break e;case 2:$s=!0}}C.callback!==null&&C.lane!==0&&(s.flags|=64,H=g.effects,H===null?g.effects=[C]:H.push(C))}else le={eventTime:le,lane:H,tag:C.tag,payload:C.payload,callback:C.callback,next:null},W===null?(O=W=le,R=G):W=W.next=le,A|=H;if(C=C.next,C===null){if(C=g.shared.pending,C===null)break;H=C,C=H.next,H.next=null,g.lastBaseUpdate=H,g.shared.pending=null}}while(!0);if(W===null&&(R=G),g.baseState=R,g.firstBaseUpdate=O,g.lastBaseUpdate=W,n=g.shared.interleaved,n!==null){g=n;do A|=g.lane,g=g.next;while(g!==n)}else v===null&&(g.shared.lanes=0);gn|=A,s.lanes=A,s.memoizedState=G}}function Nu(s,n,o){if(s=n.effects,n.effects=null,s!==null)for(n=0;n<s.length;n++){var h=s[n],g=h.callback;if(g!==null){if(h.callback=null,h=o,typeof g!="function")throw Error(t(191,g));g.call(h)}}}var Bi={},hs=Os(Bi),$i=Os(Bi),Ui=Os(Bi);function pn(s){if(s===Bi)throw Error(t(174));return s}function lo(s,n){switch(Oe(Ui,n),Oe($i,s),Oe(hs,Bi),s=n.nodeType,s){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:ol(null,"");break;default:s=s===8?n.parentNode:n,n=s.namespaceURI||null,s=s.tagName,n=ol(n,s)}Be(hs),Oe(hs,n)}function qn(){Be(hs),Be($i),Be(Ui)}function Au(s){pn(Ui.current);var n=pn(hs.current),o=ol(n,s.type);n!==o&&(Oe($i,s),Oe(hs,o))}function oo(s){$i.current===s&&(Be(hs),Be($i))}var We=Os(0);function ia(s){for(var n=s;n!==null;){if(n.tag===13){var o=n.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break;for(;n.sibling===null;){if(n.return===null||n.return===s)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var co=[];function uo(){for(var s=0;s<co.length;s++)co[s]._workInProgressVersionPrimary=null;co.length=0}var ra=k.ReactCurrentDispatcher,ho=k.ReactCurrentBatchConfig,mn=0,Ge=null,st=null,at=null,aa=!1,Hi=!1,Wi=0,Hm=0;function mt(){throw Error(t(321))}function fo(s,n){if(n===null)return!1;for(var o=0;o<n.length&&o<s.length;o++)if(!es(s[o],n[o]))return!1;return!0}function po(s,n,o,h,g,v){if(mn=v,Ge=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,ra.current=s===null||s.memoizedState===null?Xm:Ym,s=o(h,g),Hi){v=0;do{if(Hi=!1,Wi=0,25<=v)throw Error(t(301));v+=1,at=st=null,n.updateQueue=null,ra.current=Km,s=o(h,g)}while(Hi)}if(ra.current=ca,n=st!==null&&st.next!==null,mn=0,at=st=Ge=null,aa=!1,n)throw Error(t(300));return s}function mo(){var s=Wi!==0;return Wi=0,s}function fs(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return at===null?Ge.memoizedState=at=s:at=at.next=s,at}function Xt(){if(st===null){var s=Ge.alternate;s=s!==null?s.memoizedState:null}else s=st.next;var n=at===null?Ge.memoizedState:at.next;if(n!==null)at=n,st=s;else{if(s===null)throw Error(t(310));st=s,s={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},at===null?Ge.memoizedState=at=s:at=at.next=s}return at}function Gi(s,n){return typeof n=="function"?n(s):n}function go(s){var n=Xt(),o=n.queue;if(o===null)throw Error(t(311));o.lastRenderedReducer=s;var h=st,g=h.baseQueue,v=o.pending;if(v!==null){if(g!==null){var A=g.next;g.next=v.next,v.next=A}h.baseQueue=g=v,o.pending=null}if(g!==null){v=g.next,h=h.baseState;var C=A=null,R=null,O=v;do{var W=O.lane;if((mn&W)===W)R!==null&&(R=R.next={lane:0,action:O.action,hasEagerState:O.hasEagerState,eagerState:O.eagerState,next:null}),h=O.hasEagerState?O.eagerState:s(h,O.action);else{var G={lane:W,action:O.action,hasEagerState:O.hasEagerState,eagerState:O.eagerState,next:null};R===null?(C=R=G,A=h):R=R.next=G,Ge.lanes|=W,gn|=W}O=O.next}while(O!==null&&O!==v);R===null?A=h:R.next=C,es(h,n.memoizedState)||(Pt=!0),n.memoizedState=h,n.baseState=A,n.baseQueue=R,o.lastRenderedState=h}if(s=o.interleaved,s!==null){g=s;do v=g.lane,Ge.lanes|=v,gn|=v,g=g.next;while(g!==s)}else g===null&&(o.lanes=0);return[n.memoizedState,o.dispatch]}function xo(s){var n=Xt(),o=n.queue;if(o===null)throw Error(t(311));o.lastRenderedReducer=s;var h=o.dispatch,g=o.pending,v=n.memoizedState;if(g!==null){o.pending=null;var A=g=g.next;do v=s(v,A.action),A=A.next;while(A!==g);es(v,n.memoizedState)||(Pt=!0),n.memoizedState=v,n.baseQueue===null&&(n.baseState=v),o.lastRenderedState=v}return[v,h]}function _u(){}function Su(s,n){var o=Ge,h=Xt(),g=n(),v=!es(h.memoizedState,g);if(v&&(h.memoizedState=g,Pt=!0),h=h.queue,vo(Eu.bind(null,o,h,s),[s]),h.getSnapshot!==n||v||at!==null&&at.memoizedState.tag&1){if(o.flags|=2048,qi(9,ku.bind(null,o,h,g,n),void 0,null),lt===null)throw Error(t(349));(mn&30)!==0||ju(o,n,g)}return g}function ju(s,n,o){s.flags|=16384,s={getSnapshot:n,value:o},n=Ge.updateQueue,n===null?(n={lastEffect:null,stores:null},Ge.updateQueue=n,n.stores=[s]):(o=n.stores,o===null?n.stores=[s]:o.push(s))}function ku(s,n,o,h){n.value=o,n.getSnapshot=h,Cu(n)&&Pu(s)}function Eu(s,n,o){return o(function(){Cu(n)&&Pu(s)})}function Cu(s){var n=s.getSnapshot;s=s.value;try{var o=n();return!es(s,o)}catch{return!0}}function Pu(s){var n=As(s,1);n!==null&&rs(n,s,1,-1)}function Tu(s){var n=fs();return typeof s=="function"&&(s=s()),n.memoizedState=n.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gi,lastRenderedState:s},n.queue=s,s=s.dispatch=qm.bind(null,Ge,s),[n.memoizedState,s]}function qi(s,n,o,h){return s={tag:s,create:n,destroy:o,deps:h,next:null},n=Ge.updateQueue,n===null?(n={lastEffect:null,stores:null},Ge.updateQueue=n,n.lastEffect=s.next=s):(o=n.lastEffect,o===null?n.lastEffect=s.next=s:(h=o.next,o.next=s,s.next=h,n.lastEffect=s)),s}function Ru(){return Xt().memoizedState}function la(s,n,o,h){var g=fs();Ge.flags|=s,g.memoizedState=qi(1|n,o,void 0,h===void 0?null:h)}function oa(s,n,o,h){var g=Xt();h=h===void 0?null:h;var v=void 0;if(st!==null){var A=st.memoizedState;if(v=A.destroy,h!==null&&fo(h,A.deps)){g.memoizedState=qi(n,o,v,h);return}}Ge.flags|=s,g.memoizedState=qi(1|n,o,v,h)}function Lu(s,n){return la(8390656,8,s,n)}function vo(s,n){return oa(2048,8,s,n)}function Mu(s,n){return oa(4,2,s,n)}function Vu(s,n){return oa(4,4,s,n)}function Iu(s,n){if(typeof n=="function")return s=s(),n(s),function(){n(null)};if(n!=null)return s=s(),n.current=s,function(){n.current=null}}function Du(s,n,o){return o=o!=null?o.concat([s]):null,oa(4,4,Iu.bind(null,n,s),o)}function bo(){}function Fu(s,n){var o=Xt();n=n===void 0?null:n;var h=o.memoizedState;return h!==null&&n!==null&&fo(n,h[1])?h[0]:(o.memoizedState=[s,n],s)}function Ou(s,n){var o=Xt();n=n===void 0?null:n;var h=o.memoizedState;return h!==null&&n!==null&&fo(n,h[1])?h[0]:(s=s(),o.memoizedState=[s,n],s)}function zu(s,n,o){return(mn&21)===0?(s.baseState&&(s.baseState=!1,Pt=!0),s.memoizedState=o):(es(o,n)||(o=gd(),Ge.lanes|=o,gn|=o,s.baseState=!0),n)}function Wm(s,n){var o=Ie;Ie=o!==0&&4>o?o:4,s(!0);var h=ho.transition;ho.transition={};try{s(!1),n()}finally{Ie=o,ho.transition=h}}function Bu(){return Xt().memoizedState}function Gm(s,n,o){var h=qs(s);if(o={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null},$u(s))Uu(n,o);else if(o=bu(s,n,o,h),o!==null){var g=_t();rs(o,s,h,g),Hu(o,n,h)}}function qm(s,n,o){var h=qs(s),g={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null};if($u(s))Uu(n,g);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=n.lastRenderedReducer,v!==null))try{var A=n.lastRenderedState,C=v(A,o);if(g.hasEagerState=!0,g.eagerState=C,es(C,A)){var R=n.interleaved;R===null?(g.next=g,ro(n)):(g.next=R.next,R.next=g),n.interleaved=g;return}}catch{}o=bu(s,n,g,h),o!==null&&(g=_t(),rs(o,s,h,g),Hu(o,n,h))}}function $u(s){var n=s.alternate;return s===Ge||n!==null&&n===Ge}function Uu(s,n){Hi=aa=!0;var o=s.pending;o===null?n.next=n:(n.next=o.next,o.next=n),s.pending=n}function Hu(s,n,o){if((o&4194240)!==0){var h=n.lanes;h&=s.pendingLanes,o|=h,n.lanes=o,yl(s,o)}}var ca={readContext:qt,useCallback:mt,useContext:mt,useEffect:mt,useImperativeHandle:mt,useInsertionEffect:mt,useLayoutEffect:mt,useMemo:mt,useReducer:mt,useRef:mt,useState:mt,useDebugValue:mt,useDeferredValue:mt,useTransition:mt,useMutableSource:mt,useSyncExternalStore:mt,useId:mt,unstable_isNewReconciler:!1},Xm={readContext:qt,useCallback:function(s,n){return fs().memoizedState=[s,n===void 0?null:n],s},useContext:qt,useEffect:Lu,useImperativeHandle:function(s,n,o){return o=o!=null?o.concat([s]):null,la(4194308,4,Iu.bind(null,n,s),o)},useLayoutEffect:function(s,n){return la(4194308,4,s,n)},useInsertionEffect:function(s,n){return la(4,2,s,n)},useMemo:function(s,n){var o=fs();return n=n===void 0?null:n,s=s(),o.memoizedState=[s,n],s},useReducer:function(s,n,o){var h=fs();return n=o!==void 0?o(n):n,h.memoizedState=h.baseState=n,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:n},h.queue=s,s=s.dispatch=Gm.bind(null,Ge,s),[h.memoizedState,s]},useRef:function(s){var n=fs();return s={current:s},n.memoizedState=s},useState:Tu,useDebugValue:bo,useDeferredValue:function(s){return fs().memoizedState=s},useTransition:function(){var s=Tu(!1),n=s[0];return s=Wm.bind(null,s[1]),fs().memoizedState=s,[n,s]},useMutableSource:function(){},useSyncExternalStore:function(s,n,o){var h=Ge,g=fs();if($e){if(o===void 0)throw Error(t(407));o=o()}else{if(o=n(),lt===null)throw Error(t(349));(mn&30)!==0||ju(h,n,o)}g.memoizedState=o;var v={value:o,getSnapshot:n};return g.queue=v,Lu(Eu.bind(null,h,v,s),[s]),h.flags|=2048,qi(9,ku.bind(null,h,v,o,n),void 0,null),o},useId:function(){var s=fs(),n=lt.identifierPrefix;if($e){var o=Ns,h=ws;o=(h&~(1<<32-Zt(h)-1)).toString(32)+o,n=":"+n+"R"+o,o=Wi++,0<o&&(n+="H"+o.toString(32)),n+=":"}else o=Hm++,n=":"+n+"r"+o.toString(32)+":";return s.memoizedState=n},unstable_isNewReconciler:!1},Ym={readContext:qt,useCallback:Fu,useContext:qt,useEffect:vo,useImperativeHandle:Du,useInsertionEffect:Mu,useLayoutEffect:Vu,useMemo:Ou,useReducer:go,useRef:Ru,useState:function(){return go(Gi)},useDebugValue:bo,useDeferredValue:function(s){var n=Xt();return zu(n,st.memoizedState,s)},useTransition:function(){var s=go(Gi)[0],n=Xt().memoizedState;return[s,n]},useMutableSource:_u,useSyncExternalStore:Su,useId:Bu,unstable_isNewReconciler:!1},Km={readContext:qt,useCallback:Fu,useContext:qt,useEffect:vo,useImperativeHandle:Du,useInsertionEffect:Mu,useLayoutEffect:Vu,useMemo:Ou,useReducer:xo,useRef:Ru,useState:function(){return xo(Gi)},useDebugValue:bo,useDeferredValue:function(s){var n=Xt();return st===null?n.memoizedState=s:zu(n,st.memoizedState,s)},useTransition:function(){var s=xo(Gi)[0],n=Xt().memoizedState;return[s,n]},useMutableSource:_u,useSyncExternalStore:Su,useId:Bu,unstable_isNewReconciler:!1};function ss(s,n){if(s&&s.defaultProps){n=Q({},n),s=s.defaultProps;for(var o in s)n[o]===void 0&&(n[o]=s[o]);return n}return n}function yo(s,n,o,h){n=s.memoizedState,o=o(h,n),o=o==null?n:Q({},n,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var da={isMounted:function(s){return(s=s._reactInternals)?on(s)===s:!1},enqueueSetState:function(s,n,o){s=s._reactInternals;var h=_t(),g=qs(s),v=_s(h,g);v.payload=n,o!=null&&(v.callback=o),n=Us(s,v,g),n!==null&&(rs(n,s,g,h),sa(n,s,g))},enqueueReplaceState:function(s,n,o){s=s._reactInternals;var h=_t(),g=qs(s),v=_s(h,g);v.tag=1,v.payload=n,o!=null&&(v.callback=o),n=Us(s,v,g),n!==null&&(rs(n,s,g,h),sa(n,s,g))},enqueueForceUpdate:function(s,n){s=s._reactInternals;var o=_t(),h=qs(s),g=_s(o,h);g.tag=2,n!=null&&(g.callback=n),n=Us(s,g,h),n!==null&&(rs(n,s,h,o),sa(n,s,h))}};function Wu(s,n,o,h,g,v,A){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,v,A):n.prototype&&n.prototype.isPureReactComponent?!Li(o,h)||!Li(g,v):!0}function Gu(s,n,o){var h=!1,g=zs,v=n.contextType;return typeof v=="object"&&v!==null?v=qt(v):(g=Ct(n)?dn:pt.current,h=n.contextTypes,v=(h=h!=null)?zn(s,g):zs),n=new n(o,v),s.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=da,s.stateNode=n,n._reactInternals=s,h&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=g,s.__reactInternalMemoizedMaskedChildContext=v),n}function qu(s,n,o,h){s=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(o,h),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(o,h),n.state!==s&&da.enqueueReplaceState(n,n.state,null)}function wo(s,n,o,h){var g=s.stateNode;g.props=o,g.state=s.memoizedState,g.refs={},ao(s);var v=n.contextType;typeof v=="object"&&v!==null?g.context=qt(v):(v=Ct(n)?dn:pt.current,g.context=zn(s,v)),g.state=s.memoizedState,v=n.getDerivedStateFromProps,typeof v=="function"&&(yo(s,n,v,o),g.state=s.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(n=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),n!==g.state&&da.enqueueReplaceState(g,g.state,null),na(s,o,g,h),g.state=s.memoizedState),typeof g.componentDidMount=="function"&&(s.flags|=4194308)}function Xn(s,n){try{var o="",h=n;do o+=U(h),h=h.return;while(h);var g=o}catch(v){g=`
Error generating stack: `+v.message+`
`+v.stack}return{value:s,source:n,stack:g,digest:null}}function No(s,n,o){return{value:s,source:null,stack:o??null,digest:n??null}}function Ao(s,n){try{console.error(n.value)}catch(o){setTimeout(function(){throw o})}}var Qm=typeof WeakMap=="function"?WeakMap:Map;function Xu(s,n,o){o=_s(-1,o),o.tag=3,o.payload={element:null};var h=n.value;return o.callback=function(){xa||(xa=!0,Fo=h),Ao(s,n)},o}function Yu(s,n,o){o=_s(-1,o),o.tag=3;var h=s.type.getDerivedStateFromError;if(typeof h=="function"){var g=n.value;o.payload=function(){return h(g)},o.callback=function(){Ao(s,n)}}var v=s.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(o.callback=function(){Ao(s,n),typeof h!="function"&&(Ws===null?Ws=new Set([this]):Ws.add(this));var A=n.stack;this.componentDidCatch(n.value,{componentStack:A!==null?A:""})}),o}function Ku(s,n,o){var h=s.pingCache;if(h===null){h=s.pingCache=new Qm;var g=new Set;h.set(n,g)}else g=h.get(n),g===void 0&&(g=new Set,h.set(n,g));g.has(o)||(g.add(o),s=ug.bind(null,s,n,o),n.then(s,s))}function Qu(s){do{var n;if((n=s.tag===13)&&(n=s.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return s;s=s.return}while(s!==null);return null}function Ju(s,n,o,h,g){return(s.mode&1)===0?(s===n?s.flags|=65536:(s.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(n=_s(-1,1),n.tag=2,Us(o,n,1))),o.lanes|=1),s):(s.flags|=65536,s.lanes=g,s)}var Jm=k.ReactCurrentOwner,Pt=!1;function At(s,n,o,h){n.child=s===null?vu(n,null,o,h):Hn(n,s.child,o,h)}function Zu(s,n,o,h,g){o=o.render;var v=n.ref;return Gn(n,g),h=po(s,n,o,h,v,g),o=mo(),s!==null&&!Pt?(n.updateQueue=s.updateQueue,n.flags&=-2053,s.lanes&=~g,Ss(s,n,g)):($e&&o&&Kl(n),n.flags|=1,At(s,n,h,g),n.child)}function eh(s,n,o,h,g){if(s===null){var v=o.type;return typeof v=="function"&&!Wo(v)&&v.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(n.tag=15,n.type=v,th(s,n,v,h,g)):(s=Aa(o.type,null,h,n,n.mode,g),s.ref=n.ref,s.return=n,n.child=s)}if(v=s.child,(s.lanes&g)===0){var A=v.memoizedProps;if(o=o.compare,o=o!==null?o:Li,o(A,h)&&s.ref===n.ref)return Ss(s,n,g)}return n.flags|=1,s=Ys(v,h),s.ref=n.ref,s.return=n,n.child=s}function th(s,n,o,h,g){if(s!==null){var v=s.memoizedProps;if(Li(v,h)&&s.ref===n.ref)if(Pt=!1,n.pendingProps=h=v,(s.lanes&g)!==0)(s.flags&131072)!==0&&(Pt=!0);else return n.lanes=s.lanes,Ss(s,n,g)}return _o(s,n,o,h,g)}function sh(s,n,o){var h=n.pendingProps,g=h.children,v=s!==null?s.memoizedState:null;if(h.mode==="hidden")if((n.mode&1)===0)n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Oe(Kn,zt),zt|=o;else{if((o&1073741824)===0)return s=v!==null?v.baseLanes|o:o,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:s,cachePool:null,transitions:null},n.updateQueue=null,Oe(Kn,zt),zt|=s,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=v!==null?v.baseLanes:o,Oe(Kn,zt),zt|=h}else v!==null?(h=v.baseLanes|o,n.memoizedState=null):h=o,Oe(Kn,zt),zt|=h;return At(s,n,g,o),n.child}function nh(s,n){var o=n.ref;(s===null&&o!==null||s!==null&&s.ref!==o)&&(n.flags|=512,n.flags|=2097152)}function _o(s,n,o,h,g){var v=Ct(o)?dn:pt.current;return v=zn(n,v),Gn(n,g),o=po(s,n,o,h,v,g),h=mo(),s!==null&&!Pt?(n.updateQueue=s.updateQueue,n.flags&=-2053,s.lanes&=~g,Ss(s,n,g)):($e&&h&&Kl(n),n.flags|=1,At(s,n,o,g),n.child)}function ih(s,n,o,h,g){if(Ct(o)){var v=!0;Xr(n)}else v=!1;if(Gn(n,g),n.stateNode===null)ha(s,n),Gu(n,o,h),wo(n,o,h,g),h=!0;else if(s===null){var A=n.stateNode,C=n.memoizedProps;A.props=C;var R=A.context,O=o.contextType;typeof O=="object"&&O!==null?O=qt(O):(O=Ct(o)?dn:pt.current,O=zn(n,O));var W=o.getDerivedStateFromProps,G=typeof W=="function"||typeof A.getSnapshotBeforeUpdate=="function";G||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(C!==h||R!==O)&&qu(n,A,h,O),$s=!1;var H=n.memoizedState;A.state=H,na(n,h,A,g),R=n.memoizedState,C!==h||H!==R||Et.current||$s?(typeof W=="function"&&(yo(n,o,W,h),R=n.memoizedState),(C=$s||Wu(n,o,C,h,H,R,O))?(G||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(n.flags|=4194308)):(typeof A.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=h,n.memoizedState=R),A.props=h,A.state=R,A.context=O,h=C):(typeof A.componentDidMount=="function"&&(n.flags|=4194308),h=!1)}else{A=n.stateNode,yu(s,n),C=n.memoizedProps,O=n.type===n.elementType?C:ss(n.type,C),A.props=O,G=n.pendingProps,H=A.context,R=o.contextType,typeof R=="object"&&R!==null?R=qt(R):(R=Ct(o)?dn:pt.current,R=zn(n,R));var le=o.getDerivedStateFromProps;(W=typeof le=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(C!==G||H!==R)&&qu(n,A,h,R),$s=!1,H=n.memoizedState,A.state=H,na(n,h,A,g);var he=n.memoizedState;C!==G||H!==he||Et.current||$s?(typeof le=="function"&&(yo(n,o,le,h),he=n.memoizedState),(O=$s||Wu(n,o,O,h,H,he,R)||!1)?(W||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(h,he,R),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(h,he,R)),typeof A.componentDidUpdate=="function"&&(n.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof A.componentDidUpdate!="function"||C===s.memoizedProps&&H===s.memoizedState||(n.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||C===s.memoizedProps&&H===s.memoizedState||(n.flags|=1024),n.memoizedProps=h,n.memoizedState=he),A.props=h,A.state=he,A.context=R,h=O):(typeof A.componentDidUpdate!="function"||C===s.memoizedProps&&H===s.memoizedState||(n.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||C===s.memoizedProps&&H===s.memoizedState||(n.flags|=1024),h=!1)}return So(s,n,o,h,v,g)}function So(s,n,o,h,g,v){nh(s,n);var A=(n.flags&128)!==0;if(!h&&!A)return g&&cu(n,o,!1),Ss(s,n,v);h=n.stateNode,Jm.current=n;var C=A&&typeof o.getDerivedStateFromError!="function"?null:h.render();return n.flags|=1,s!==null&&A?(n.child=Hn(n,s.child,null,v),n.child=Hn(n,null,C,v)):At(s,n,C,v),n.memoizedState=h.state,g&&cu(n,o,!0),n.child}function rh(s){var n=s.stateNode;n.pendingContext?lu(s,n.pendingContext,n.pendingContext!==n.context):n.context&&lu(s,n.context,!1),lo(s,n.containerInfo)}function ah(s,n,o,h,g){return Un(),eo(g),n.flags|=256,At(s,n,o,h),n.child}var jo={dehydrated:null,treeContext:null,retryLane:0};function ko(s){return{baseLanes:s,cachePool:null,transitions:null}}function lh(s,n,o){var h=n.pendingProps,g=We.current,v=!1,A=(n.flags&128)!==0,C;if((C=A)||(C=s!==null&&s.memoizedState===null?!1:(g&2)!==0),C?(v=!0,n.flags&=-129):(s===null||s.memoizedState!==null)&&(g|=1),Oe(We,g&1),s===null)return Zl(n),s=n.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((n.mode&1)===0?n.lanes=1:s.data==="$!"?n.lanes=8:n.lanes=1073741824,null):(A=h.children,s=h.fallback,v?(h=n.mode,v=n.child,A={mode:"hidden",children:A},(h&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=A):v=_a(A,h,0,null),s=yn(s,h,o,null),v.return=n,s.return=n,v.sibling=s,n.child=v,n.child.memoizedState=ko(o),n.memoizedState=jo,s):Eo(n,A));if(g=s.memoizedState,g!==null&&(C=g.dehydrated,C!==null))return Zm(s,n,A,h,C,g,o);if(v){v=h.fallback,A=n.mode,g=s.child,C=g.sibling;var R={mode:"hidden",children:h.children};return(A&1)===0&&n.child!==g?(h=n.child,h.childLanes=0,h.pendingProps=R,n.deletions=null):(h=Ys(g,R),h.subtreeFlags=g.subtreeFlags&14680064),C!==null?v=Ys(C,v):(v=yn(v,A,o,null),v.flags|=2),v.return=n,h.return=n,h.sibling=v,n.child=h,h=v,v=n.child,A=s.child.memoizedState,A=A===null?ko(o):{baseLanes:A.baseLanes|o,cachePool:null,transitions:A.transitions},v.memoizedState=A,v.childLanes=s.childLanes&~o,n.memoizedState=jo,h}return v=s.child,s=v.sibling,h=Ys(v,{mode:"visible",children:h.children}),(n.mode&1)===0&&(h.lanes=o),h.return=n,h.sibling=null,s!==null&&(o=n.deletions,o===null?(n.deletions=[s],n.flags|=16):o.push(s)),n.child=h,n.memoizedState=null,h}function Eo(s,n){return n=_a({mode:"visible",children:n},s.mode,0,null),n.return=s,s.child=n}function ua(s,n,o,h){return h!==null&&eo(h),Hn(n,s.child,null,o),s=Eo(n,n.pendingProps.children),s.flags|=2,n.memoizedState=null,s}function Zm(s,n,o,h,g,v,A){if(o)return n.flags&256?(n.flags&=-257,h=No(Error(t(422))),ua(s,n,A,h)):n.memoizedState!==null?(n.child=s.child,n.flags|=128,null):(v=h.fallback,g=n.mode,h=_a({mode:"visible",children:h.children},g,0,null),v=yn(v,g,A,null),v.flags|=2,h.return=n,v.return=n,h.sibling=v,n.child=h,(n.mode&1)!==0&&Hn(n,s.child,null,A),n.child.memoizedState=ko(A),n.memoizedState=jo,v);if((n.mode&1)===0)return ua(s,n,A,null);if(g.data==="$!"){if(h=g.nextSibling&&g.nextSibling.dataset,h)var C=h.dgst;return h=C,v=Error(t(419)),h=No(v,h,void 0),ua(s,n,A,h)}if(C=(A&s.childLanes)!==0,Pt||C){if(h=lt,h!==null){switch(A&-A){case 4:g=2;break;case 16:g=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:g=32;break;case 536870912:g=268435456;break;default:g=0}g=(g&(h.suspendedLanes|A))!==0?0:g,g!==0&&g!==v.retryLane&&(v.retryLane=g,As(s,g),rs(h,s,g,-1))}return Ho(),h=No(Error(t(421))),ua(s,n,A,h)}return g.data==="$?"?(n.flags|=128,n.child=s.child,n=hg.bind(null,s),g._reactRetry=n,null):(s=v.treeContext,Ot=Fs(g.nextSibling),Ft=n,$e=!0,ts=null,s!==null&&(Wt[Gt++]=ws,Wt[Gt++]=Ns,Wt[Gt++]=un,ws=s.id,Ns=s.overflow,un=n),n=Eo(n,h.children),n.flags|=4096,n)}function oh(s,n,o){s.lanes|=n;var h=s.alternate;h!==null&&(h.lanes|=n),io(s.return,n,o)}function Co(s,n,o,h,g){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:g}:(v.isBackwards=n,v.rendering=null,v.renderingStartTime=0,v.last=h,v.tail=o,v.tailMode=g)}function ch(s,n,o){var h=n.pendingProps,g=h.revealOrder,v=h.tail;if(At(s,n,h.children,o),h=We.current,(h&2)!==0)h=h&1|2,n.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=n.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&oh(s,o,n);else if(s.tag===19)oh(s,o,n);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break e;for(;s.sibling===null;){if(s.return===null||s.return===n)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}h&=1}if(Oe(We,h),(n.mode&1)===0)n.memoizedState=null;else switch(g){case"forwards":for(o=n.child,g=null;o!==null;)s=o.alternate,s!==null&&ia(s)===null&&(g=o),o=o.sibling;o=g,o===null?(g=n.child,n.child=null):(g=o.sibling,o.sibling=null),Co(n,!1,g,o,v);break;case"backwards":for(o=null,g=n.child,n.child=null;g!==null;){if(s=g.alternate,s!==null&&ia(s)===null){n.child=g;break}s=g.sibling,g.sibling=o,o=g,g=s}Co(n,!0,o,null,v);break;case"together":Co(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function ha(s,n){(n.mode&1)===0&&s!==null&&(s.alternate=null,n.alternate=null,n.flags|=2)}function Ss(s,n,o){if(s!==null&&(n.dependencies=s.dependencies),gn|=n.lanes,(o&n.childLanes)===0)return null;if(s!==null&&n.child!==s.child)throw Error(t(153));if(n.child!==null){for(s=n.child,o=Ys(s,s.pendingProps),n.child=o,o.return=n;s.sibling!==null;)s=s.sibling,o=o.sibling=Ys(s,s.pendingProps),o.return=n;o.sibling=null}return n.child}function eg(s,n,o){switch(n.tag){case 3:rh(n),Un();break;case 5:Au(n);break;case 1:Ct(n.type)&&Xr(n);break;case 4:lo(n,n.stateNode.containerInfo);break;case 10:var h=n.type._context,g=n.memoizedProps.value;Oe(ea,h._currentValue),h._currentValue=g;break;case 13:if(h=n.memoizedState,h!==null)return h.dehydrated!==null?(Oe(We,We.current&1),n.flags|=128,null):(o&n.child.childLanes)!==0?lh(s,n,o):(Oe(We,We.current&1),s=Ss(s,n,o),s!==null?s.sibling:null);Oe(We,We.current&1);break;case 19:if(h=(o&n.childLanes)!==0,(s.flags&128)!==0){if(h)return ch(s,n,o);n.flags|=128}if(g=n.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Oe(We,We.current),h)break;return null;case 22:case 23:return n.lanes=0,sh(s,n,o)}return Ss(s,n,o)}var dh,Po,uh,hh;dh=function(s,n){for(var o=n.child;o!==null;){if(o.tag===5||o.tag===6)s.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},Po=function(){},uh=function(s,n,o,h){var g=s.memoizedProps;if(g!==h){s=n.stateNode,pn(hs.current);var v=null;switch(o){case"input":g=Ht(s,g),h=Ht(s,h),v=[];break;case"select":g=Q({},g,{value:void 0}),h=Q({},h,{value:void 0}),v=[];break;case"textarea":g=mi(s,g),h=mi(s,h),v=[];break;default:typeof g.onClick!="function"&&typeof h.onClick=="function"&&(s.onclick=Wr)}cl(o,h);var A;o=null;for(O in g)if(!h.hasOwnProperty(O)&&g.hasOwnProperty(O)&&g[O]!=null)if(O==="style"){var C=g[O];for(A in C)C.hasOwnProperty(A)&&(o||(o={}),o[A]="")}else O!=="dangerouslySetInnerHTML"&&O!=="children"&&O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&O!=="autoFocus"&&(r.hasOwnProperty(O)?v||(v=[]):(v=v||[]).push(O,null));for(O in h){var R=h[O];if(C=g?.[O],h.hasOwnProperty(O)&&R!==C&&(R!=null||C!=null))if(O==="style")if(C){for(A in C)!C.hasOwnProperty(A)||R&&R.hasOwnProperty(A)||(o||(o={}),o[A]="");for(A in R)R.hasOwnProperty(A)&&C[A]!==R[A]&&(o||(o={}),o[A]=R[A])}else o||(v||(v=[]),v.push(O,o)),o=R;else O==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,C=C?C.__html:void 0,R!=null&&C!==R&&(v=v||[]).push(O,R)):O==="children"?typeof R!="string"&&typeof R!="number"||(v=v||[]).push(O,""+R):O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&(r.hasOwnProperty(O)?(R!=null&&O==="onScroll"&&ze("scroll",s),v||C===R||(v=[])):(v=v||[]).push(O,R))}o&&(v=v||[]).push("style",o);var O=v;(n.updateQueue=O)&&(n.flags|=4)}},hh=function(s,n,o,h){o!==h&&(n.flags|=4)};function Xi(s,n){if(!$e)switch(s.tailMode){case"hidden":n=s.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?n||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function gt(s){var n=s.alternate!==null&&s.alternate.child===s.child,o=0,h=0;if(n)for(var g=s.child;g!==null;)o|=g.lanes|g.childLanes,h|=g.subtreeFlags&14680064,h|=g.flags&14680064,g.return=s,g=g.sibling;else for(g=s.child;g!==null;)o|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=s,g=g.sibling;return s.subtreeFlags|=h,s.childLanes=o,n}function tg(s,n,o){var h=n.pendingProps;switch(Ql(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gt(n),null;case 1:return Ct(n.type)&&qr(),gt(n),null;case 3:return h=n.stateNode,qn(),Be(Et),Be(pt),uo(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(Jr(n)?n.flags|=4:s===null||s.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,ts!==null&&(Bo(ts),ts=null))),Po(s,n),gt(n),null;case 5:oo(n);var g=pn(Ui.current);if(o=n.type,s!==null&&n.stateNode!=null)uh(s,n,o,h,g),s.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!h){if(n.stateNode===null)throw Error(t(166));return gt(n),null}if(s=pn(hs.current),Jr(n)){h=n.stateNode,o=n.type;var v=n.memoizedProps;switch(h[us]=n,h[Fi]=v,s=(n.mode&1)!==0,o){case"dialog":ze("cancel",h),ze("close",h);break;case"iframe":case"object":case"embed":ze("load",h);break;case"video":case"audio":for(g=0;g<Vi.length;g++)ze(Vi[g],h);break;case"source":ze("error",h);break;case"img":case"image":case"link":ze("error",h),ze("load",h);break;case"details":ze("toggle",h);break;case"input":an(h,v),ze("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!v.multiple},ze("invalid",h);break;case"textarea":J(h,v),ze("invalid",h)}cl(o,v),g=null;for(var A in v)if(v.hasOwnProperty(A)){var C=v[A];A==="children"?typeof C=="string"?h.textContent!==C&&(v.suppressHydrationWarning!==!0&&Hr(h.textContent,C,s),g=["children",C]):typeof C=="number"&&h.textContent!==""+C&&(v.suppressHydrationWarning!==!0&&Hr(h.textContent,C,s),g=["children",""+C]):r.hasOwnProperty(A)&&C!=null&&A==="onScroll"&&ze("scroll",h)}switch(o){case"input":wt(h),fi(h,v,!0);break;case"textarea":wt(h),En(h);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(h.onclick=Wr)}h=g,n.updateQueue=h,h!==null&&(n.flags|=4)}else{A=g.nodeType===9?g:g.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=Nr(o)),s==="http://www.w3.org/1999/xhtml"?o==="script"?(s=A.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof h.is=="string"?s=A.createElement(o,{is:h.is}):(s=A.createElement(o),o==="select"&&(A=s,h.multiple?A.multiple=!0:h.size&&(A.size=h.size))):s=A.createElementNS(s,o),s[us]=n,s[Fi]=h,dh(s,n,!1,!1),n.stateNode=s;e:{switch(A=dl(o,h),o){case"dialog":ze("cancel",s),ze("close",s),g=h;break;case"iframe":case"object":case"embed":ze("load",s),g=h;break;case"video":case"audio":for(g=0;g<Vi.length;g++)ze(Vi[g],s);g=h;break;case"source":ze("error",s),g=h;break;case"img":case"image":case"link":ze("error",s),ze("load",s),g=h;break;case"details":ze("toggle",s),g=h;break;case"input":an(s,h),g=Ht(s,h),ze("invalid",s);break;case"option":g=h;break;case"select":s._wrapperState={wasMultiple:!!h.multiple},g=Q({},h,{value:void 0}),ze("invalid",s);break;case"textarea":J(s,h),g=mi(s,h),ze("invalid",s);break;default:g=h}cl(o,g),C=g;for(v in C)if(C.hasOwnProperty(v)){var R=C[v];v==="style"?td(s,R):v==="dangerouslySetInnerHTML"?(R=R?R.__html:void 0,R!=null&&Zc(s,R)):v==="children"?typeof R=="string"?(o!=="textarea"||R!=="")&&gi(s,R):typeof R=="number"&&gi(s,""+R):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(r.hasOwnProperty(v)?R!=null&&v==="onScroll"&&ze("scroll",s):R!=null&&P(s,v,R,A))}switch(o){case"input":wt(s),fi(s,h,!1);break;case"textarea":wt(s),En(s);break;case"option":h.value!=null&&s.setAttribute("value",""+K(h.value));break;case"select":s.multiple=!!h.multiple,v=h.value,v!=null?Ts(s,!!h.multiple,v,!1):h.defaultValue!=null&&Ts(s,!!h.multiple,h.defaultValue,!0);break;default:typeof g.onClick=="function"&&(s.onclick=Wr)}switch(o){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return gt(n),null;case 6:if(s&&n.stateNode!=null)hh(s,n,s.memoizedProps,h);else{if(typeof h!="string"&&n.stateNode===null)throw Error(t(166));if(o=pn(Ui.current),pn(hs.current),Jr(n)){if(h=n.stateNode,o=n.memoizedProps,h[us]=n,(v=h.nodeValue!==o)&&(s=Ft,s!==null))switch(s.tag){case 3:Hr(h.nodeValue,o,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Hr(h.nodeValue,o,(s.mode&1)!==0)}v&&(n.flags|=4)}else h=(o.nodeType===9?o:o.ownerDocument).createTextNode(h),h[us]=n,n.stateNode=h}return gt(n),null;case 13:if(Be(We),h=n.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if($e&&Ot!==null&&(n.mode&1)!==0&&(n.flags&128)===0)mu(),Un(),n.flags|=98560,v=!1;else if(v=Jr(n),h!==null&&h.dehydrated!==null){if(s===null){if(!v)throw Error(t(318));if(v=n.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(t(317));v[us]=n}else Un(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;gt(n),v=!1}else ts!==null&&(Bo(ts),ts=null),v=!0;if(!v)return n.flags&65536?n:null}return(n.flags&128)!==0?(n.lanes=o,n):(h=h!==null,h!==(s!==null&&s.memoizedState!==null)&&h&&(n.child.flags|=8192,(n.mode&1)!==0&&(s===null||(We.current&1)!==0?nt===0&&(nt=3):Ho())),n.updateQueue!==null&&(n.flags|=4),gt(n),null);case 4:return qn(),Po(s,n),s===null&&Ii(n.stateNode.containerInfo),gt(n),null;case 10:return no(n.type._context),gt(n),null;case 17:return Ct(n.type)&&qr(),gt(n),null;case 19:if(Be(We),v=n.memoizedState,v===null)return gt(n),null;if(h=(n.flags&128)!==0,A=v.rendering,A===null)if(h)Xi(v,!1);else{if(nt!==0||s!==null&&(s.flags&128)!==0)for(s=n.child;s!==null;){if(A=ia(s),A!==null){for(n.flags|=128,Xi(v,!1),h=A.updateQueue,h!==null&&(n.updateQueue=h,n.flags|=4),n.subtreeFlags=0,h=o,o=n.child;o!==null;)v=o,s=h,v.flags&=14680066,A=v.alternate,A===null?(v.childLanes=0,v.lanes=s,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=A.childLanes,v.lanes=A.lanes,v.child=A.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=A.memoizedProps,v.memoizedState=A.memoizedState,v.updateQueue=A.updateQueue,v.type=A.type,s=A.dependencies,v.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),o=o.sibling;return Oe(We,We.current&1|2),n.child}s=s.sibling}v.tail!==null&&Ye()>Qn&&(n.flags|=128,h=!0,Xi(v,!1),n.lanes=4194304)}else{if(!h)if(s=ia(A),s!==null){if(n.flags|=128,h=!0,o=s.updateQueue,o!==null&&(n.updateQueue=o,n.flags|=4),Xi(v,!0),v.tail===null&&v.tailMode==="hidden"&&!A.alternate&&!$e)return gt(n),null}else 2*Ye()-v.renderingStartTime>Qn&&o!==1073741824&&(n.flags|=128,h=!0,Xi(v,!1),n.lanes=4194304);v.isBackwards?(A.sibling=n.child,n.child=A):(o=v.last,o!==null?o.sibling=A:n.child=A,v.last=A)}return v.tail!==null?(n=v.tail,v.rendering=n,v.tail=n.sibling,v.renderingStartTime=Ye(),n.sibling=null,o=We.current,Oe(We,h?o&1|2:o&1),n):(gt(n),null);case 22:case 23:return Uo(),h=n.memoizedState!==null,s!==null&&s.memoizedState!==null!==h&&(n.flags|=8192),h&&(n.mode&1)!==0?(zt&1073741824)!==0&&(gt(n),n.subtreeFlags&6&&(n.flags|=8192)):gt(n),null;case 24:return null;case 25:return null}throw Error(t(156,n.tag))}function sg(s,n){switch(Ql(n),n.tag){case 1:return Ct(n.type)&&qr(),s=n.flags,s&65536?(n.flags=s&-65537|128,n):null;case 3:return qn(),Be(Et),Be(pt),uo(),s=n.flags,(s&65536)!==0&&(s&128)===0?(n.flags=s&-65537|128,n):null;case 5:return oo(n),null;case 13:if(Be(We),s=n.memoizedState,s!==null&&s.dehydrated!==null){if(n.alternate===null)throw Error(t(340));Un()}return s=n.flags,s&65536?(n.flags=s&-65537|128,n):null;case 19:return Be(We),null;case 4:return qn(),null;case 10:return no(n.type._context),null;case 22:case 23:return Uo(),null;case 24:return null;default:return null}}var fa=!1,xt=!1,ng=typeof WeakSet=="function"?WeakSet:Set,de=null;function Yn(s,n){var o=s.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(h){Xe(s,n,h)}else o.current=null}function To(s,n,o){try{o()}catch(h){Xe(s,n,h)}}var fh=!1;function ig(s,n){if($l=Lr,s=Wd(),Ml(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var g=h.anchorOffset,v=h.focusNode;h=h.focusOffset;try{o.nodeType,v.nodeType}catch{o=null;break e}var A=0,C=-1,R=-1,O=0,W=0,G=s,H=null;t:for(;;){for(var le;G!==o||g!==0&&G.nodeType!==3||(C=A+g),G!==v||h!==0&&G.nodeType!==3||(R=A+h),G.nodeType===3&&(A+=G.nodeValue.length),(le=G.firstChild)!==null;)H=G,G=le;for(;;){if(G===s)break t;if(H===o&&++O===g&&(C=A),H===v&&++W===h&&(R=A),(le=G.nextSibling)!==null)break;G=H,H=G.parentNode}G=le}o=C===-1||R===-1?null:{start:C,end:R}}else o=null}o=o||{start:0,end:0}}else o=null;for(Ul={focusedElem:s,selectionRange:o},Lr=!1,de=n;de!==null;)if(n=de,s=n.child,(n.subtreeFlags&1028)!==0&&s!==null)s.return=n,de=s;else for(;de!==null;){n=de;try{var he=n.alternate;if((n.flags&1024)!==0)switch(n.tag){case 0:case 11:case 15:break;case 1:if(he!==null){var pe=he.memoizedProps,Ke=he.memoizedState,D=n.stateNode,M=D.getSnapshotBeforeUpdate(n.elementType===n.type?pe:ss(n.type,pe),Ke);D.__reactInternalSnapshotBeforeUpdate=M}break;case 3:var F=n.stateNode.containerInfo;F.nodeType===1?F.textContent="":F.nodeType===9&&F.documentElement&&F.removeChild(F.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Y){Xe(n,n.return,Y)}if(s=n.sibling,s!==null){s.return=n.return,de=s;break}de=n.return}return he=fh,fh=!1,he}function Yi(s,n,o){var h=n.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var g=h=h.next;do{if((g.tag&s)===s){var v=g.destroy;g.destroy=void 0,v!==void 0&&To(n,o,v)}g=g.next}while(g!==h)}}function pa(s,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var o=n=n.next;do{if((o.tag&s)===s){var h=o.create;o.destroy=h()}o=o.next}while(o!==n)}}function Ro(s){var n=s.ref;if(n!==null){var o=s.stateNode;s.tag,s=o,typeof n=="function"?n(s):n.current=s}}function ph(s){var n=s.alternate;n!==null&&(s.alternate=null,ph(n)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(n=s.stateNode,n!==null&&(delete n[us],delete n[Fi],delete n[ql],delete n[zm],delete n[Bm])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function mh(s){return s.tag===5||s.tag===3||s.tag===4}function gh(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||mh(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Lo(s,n,o){var h=s.tag;if(h===5||h===6)s=s.stateNode,n?o.nodeType===8?o.parentNode.insertBefore(s,n):o.insertBefore(s,n):(o.nodeType===8?(n=o.parentNode,n.insertBefore(s,o)):(n=o,n.appendChild(s)),o=o._reactRootContainer,o!=null||n.onclick!==null||(n.onclick=Wr));else if(h!==4&&(s=s.child,s!==null))for(Lo(s,n,o),s=s.sibling;s!==null;)Lo(s,n,o),s=s.sibling}function Mo(s,n,o){var h=s.tag;if(h===5||h===6)s=s.stateNode,n?o.insertBefore(s,n):o.appendChild(s);else if(h!==4&&(s=s.child,s!==null))for(Mo(s,n,o),s=s.sibling;s!==null;)Mo(s,n,o),s=s.sibling}var ut=null,ns=!1;function Hs(s,n,o){for(o=o.child;o!==null;)xh(s,n,o),o=o.sibling}function xh(s,n,o){if(ds&&typeof ds.onCommitFiberUnmount=="function")try{ds.onCommitFiberUnmount(kr,o)}catch{}switch(o.tag){case 5:xt||Yn(o,n);case 6:var h=ut,g=ns;ut=null,Hs(s,n,o),ut=h,ns=g,ut!==null&&(ns?(s=ut,o=o.stateNode,s.nodeType===8?s.parentNode.removeChild(o):s.removeChild(o)):ut.removeChild(o.stateNode));break;case 18:ut!==null&&(ns?(s=ut,o=o.stateNode,s.nodeType===8?Gl(s.parentNode,o):s.nodeType===1&&Gl(s,o),ki(s)):Gl(ut,o.stateNode));break;case 4:h=ut,g=ns,ut=o.stateNode.containerInfo,ns=!0,Hs(s,n,o),ut=h,ns=g;break;case 0:case 11:case 14:case 15:if(!xt&&(h=o.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){g=h=h.next;do{var v=g,A=v.destroy;v=v.tag,A!==void 0&&((v&2)!==0||(v&4)!==0)&&To(o,n,A),g=g.next}while(g!==h)}Hs(s,n,o);break;case 1:if(!xt&&(Yn(o,n),h=o.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=o.memoizedProps,h.state=o.memoizedState,h.componentWillUnmount()}catch(C){Xe(o,n,C)}Hs(s,n,o);break;case 21:Hs(s,n,o);break;case 22:o.mode&1?(xt=(h=xt)||o.memoizedState!==null,Hs(s,n,o),xt=h):Hs(s,n,o);break;default:Hs(s,n,o)}}function vh(s){var n=s.updateQueue;if(n!==null){s.updateQueue=null;var o=s.stateNode;o===null&&(o=s.stateNode=new ng),n.forEach(function(h){var g=fg.bind(null,s,h);o.has(h)||(o.add(h),h.then(g,g))})}}function is(s,n){var o=n.deletions;if(o!==null)for(var h=0;h<o.length;h++){var g=o[h];try{var v=s,A=n,C=A;e:for(;C!==null;){switch(C.tag){case 5:ut=C.stateNode,ns=!1;break e;case 3:ut=C.stateNode.containerInfo,ns=!0;break e;case 4:ut=C.stateNode.containerInfo,ns=!0;break e}C=C.return}if(ut===null)throw Error(t(160));xh(v,A,g),ut=null,ns=!1;var R=g.alternate;R!==null&&(R.return=null),g.return=null}catch(O){Xe(g,n,O)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)bh(n,s),n=n.sibling}function bh(s,n){var o=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(is(n,s),ps(s),h&4){try{Yi(3,s,s.return),pa(3,s)}catch(pe){Xe(s,s.return,pe)}try{Yi(5,s,s.return)}catch(pe){Xe(s,s.return,pe)}}break;case 1:is(n,s),ps(s),h&512&&o!==null&&Yn(o,o.return);break;case 5:if(is(n,s),ps(s),h&512&&o!==null&&Yn(o,o.return),s.flags&32){var g=s.stateNode;try{gi(g,"")}catch(pe){Xe(s,s.return,pe)}}if(h&4&&(g=s.stateNode,g!=null)){var v=s.memoizedProps,A=o!==null?o.memoizedProps:v,C=s.type,R=s.updateQueue;if(s.updateQueue=null,R!==null)try{C==="input"&&v.type==="radio"&&v.name!=null&&ui(g,v),dl(C,A);var O=dl(C,v);for(A=0;A<R.length;A+=2){var W=R[A],G=R[A+1];W==="style"?td(g,G):W==="dangerouslySetInnerHTML"?Zc(g,G):W==="children"?gi(g,G):P(g,W,G,O)}switch(C){case"input":hi(g,v);break;case"textarea":Le(g,v);break;case"select":var H=g._wrapperState.wasMultiple;g._wrapperState.wasMultiple=!!v.multiple;var le=v.value;le!=null?Ts(g,!!v.multiple,le,!1):H!==!!v.multiple&&(v.defaultValue!=null?Ts(g,!!v.multiple,v.defaultValue,!0):Ts(g,!!v.multiple,v.multiple?[]:"",!1))}g[Fi]=v}catch(pe){Xe(s,s.return,pe)}}break;case 6:if(is(n,s),ps(s),h&4){if(s.stateNode===null)throw Error(t(162));g=s.stateNode,v=s.memoizedProps;try{g.nodeValue=v}catch(pe){Xe(s,s.return,pe)}}break;case 3:if(is(n,s),ps(s),h&4&&o!==null&&o.memoizedState.isDehydrated)try{ki(n.containerInfo)}catch(pe){Xe(s,s.return,pe)}break;case 4:is(n,s),ps(s);break;case 13:is(n,s),ps(s),g=s.child,g.flags&8192&&(v=g.memoizedState!==null,g.stateNode.isHidden=v,!v||g.alternate!==null&&g.alternate.memoizedState!==null||(Do=Ye())),h&4&&vh(s);break;case 22:if(W=o!==null&&o.memoizedState!==null,s.mode&1?(xt=(O=xt)||W,is(n,s),xt=O):is(n,s),ps(s),h&8192){if(O=s.memoizedState!==null,(s.stateNode.isHidden=O)&&!W&&(s.mode&1)!==0)for(de=s,W=s.child;W!==null;){for(G=de=W;de!==null;){switch(H=de,le=H.child,H.tag){case 0:case 11:case 14:case 15:Yi(4,H,H.return);break;case 1:Yn(H,H.return);var he=H.stateNode;if(typeof he.componentWillUnmount=="function"){h=H,o=H.return;try{n=h,he.props=n.memoizedProps,he.state=n.memoizedState,he.componentWillUnmount()}catch(pe){Xe(h,o,pe)}}break;case 5:Yn(H,H.return);break;case 22:if(H.memoizedState!==null){Nh(G);continue}}le!==null?(le.return=H,de=le):Nh(G)}W=W.sibling}e:for(W=null,G=s;;){if(G.tag===5){if(W===null){W=G;try{g=G.stateNode,O?(v=g.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(C=G.stateNode,R=G.memoizedProps.style,A=R!=null&&R.hasOwnProperty("display")?R.display:null,C.style.display=ed("display",A))}catch(pe){Xe(s,s.return,pe)}}}else if(G.tag===6){if(W===null)try{G.stateNode.nodeValue=O?"":G.memoizedProps}catch(pe){Xe(s,s.return,pe)}}else if((G.tag!==22&&G.tag!==23||G.memoizedState===null||G===s)&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===s)break e;for(;G.sibling===null;){if(G.return===null||G.return===s)break e;W===G&&(W=null),G=G.return}W===G&&(W=null),G.sibling.return=G.return,G=G.sibling}}break;case 19:is(n,s),ps(s),h&4&&vh(s);break;case 21:break;default:is(n,s),ps(s)}}function ps(s){var n=s.flags;if(n&2){try{e:{for(var o=s.return;o!==null;){if(mh(o)){var h=o;break e}o=o.return}throw Error(t(160))}switch(h.tag){case 5:var g=h.stateNode;h.flags&32&&(gi(g,""),h.flags&=-33);var v=gh(s);Mo(s,v,g);break;case 3:case 4:var A=h.stateNode.containerInfo,C=gh(s);Lo(s,C,A);break;default:throw Error(t(161))}}catch(R){Xe(s,s.return,R)}s.flags&=-3}n&4096&&(s.flags&=-4097)}function rg(s,n,o){de=s,yh(s)}function yh(s,n,o){for(var h=(s.mode&1)!==0;de!==null;){var g=de,v=g.child;if(g.tag===22&&h){var A=g.memoizedState!==null||fa;if(!A){var C=g.alternate,R=C!==null&&C.memoizedState!==null||xt;C=fa;var O=xt;if(fa=A,(xt=R)&&!O)for(de=g;de!==null;)A=de,R=A.child,A.tag===22&&A.memoizedState!==null?Ah(g):R!==null?(R.return=A,de=R):Ah(g);for(;v!==null;)de=v,yh(v),v=v.sibling;de=g,fa=C,xt=O}wh(s)}else(g.subtreeFlags&8772)!==0&&v!==null?(v.return=g,de=v):wh(s)}}function wh(s){for(;de!==null;){var n=de;if((n.flags&8772)!==0){var o=n.alternate;try{if((n.flags&8772)!==0)switch(n.tag){case 0:case 11:case 15:xt||pa(5,n);break;case 1:var h=n.stateNode;if(n.flags&4&&!xt)if(o===null)h.componentDidMount();else{var g=n.elementType===n.type?o.memoizedProps:ss(n.type,o.memoizedProps);h.componentDidUpdate(g,o.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var v=n.updateQueue;v!==null&&Nu(n,v,h);break;case 3:var A=n.updateQueue;if(A!==null){if(o=null,n.child!==null)switch(n.child.tag){case 5:o=n.child.stateNode;break;case 1:o=n.child.stateNode}Nu(n,A,o)}break;case 5:var C=n.stateNode;if(o===null&&n.flags&4){o=C;var R=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":R.autoFocus&&o.focus();break;case"img":R.src&&(o.src=R.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var O=n.alternate;if(O!==null){var W=O.memoizedState;if(W!==null){var G=W.dehydrated;G!==null&&ki(G)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}xt||n.flags&512&&Ro(n)}catch(H){Xe(n,n.return,H)}}if(n===s){de=null;break}if(o=n.sibling,o!==null){o.return=n.return,de=o;break}de=n.return}}function Nh(s){for(;de!==null;){var n=de;if(n===s){de=null;break}var o=n.sibling;if(o!==null){o.return=n.return,de=o;break}de=n.return}}function Ah(s){for(;de!==null;){var n=de;try{switch(n.tag){case 0:case 11:case 15:var o=n.return;try{pa(4,n)}catch(R){Xe(n,o,R)}break;case 1:var h=n.stateNode;if(typeof h.componentDidMount=="function"){var g=n.return;try{h.componentDidMount()}catch(R){Xe(n,g,R)}}var v=n.return;try{Ro(n)}catch(R){Xe(n,v,R)}break;case 5:var A=n.return;try{Ro(n)}catch(R){Xe(n,A,R)}}}catch(R){Xe(n,n.return,R)}if(n===s){de=null;break}var C=n.sibling;if(C!==null){C.return=n.return,de=C;break}de=n.return}}var ag=Math.ceil,ma=k.ReactCurrentDispatcher,Vo=k.ReactCurrentOwner,Yt=k.ReactCurrentBatchConfig,Re=0,lt=null,Ze=null,ht=0,zt=0,Kn=Os(0),nt=0,Ki=null,gn=0,ga=0,Io=0,Qi=null,Tt=null,Do=0,Qn=1/0,js=null,xa=!1,Fo=null,Ws=null,va=!1,Gs=null,ba=0,Ji=0,Oo=null,ya=-1,wa=0;function _t(){return(Re&6)!==0?Ye():ya!==-1?ya:ya=Ye()}function qs(s){return(s.mode&1)===0?1:(Re&2)!==0&&ht!==0?ht&-ht:Um.transition!==null?(wa===0&&(wa=gd()),wa):(s=Ie,s!==0||(s=window.event,s=s===void 0?16:Sd(s.type)),s)}function rs(s,n,o,h){if(50<Ji)throw Ji=0,Oo=null,Error(t(185));Ni(s,o,h),((Re&2)===0||s!==lt)&&(s===lt&&((Re&2)===0&&(ga|=o),nt===4&&Xs(s,ht)),Rt(s,h),o===1&&Re===0&&(n.mode&1)===0&&(Qn=Ye()+500,Yr&&Bs()))}function Rt(s,n){var o=s.callbackNode;Up(s,n);var h=Pr(s,s===lt?ht:0);if(h===0)o!==null&&fd(o),s.callbackNode=null,s.callbackPriority=0;else if(n=h&-h,s.callbackPriority!==n){if(o!=null&&fd(o),n===1)s.tag===0?$m(Sh.bind(null,s)):du(Sh.bind(null,s)),Fm(function(){(Re&6)===0&&Bs()}),o=null;else{switch(xd(h)){case 1:o=xl;break;case 4:o=pd;break;case 16:o=jr;break;case 536870912:o=md;break;default:o=jr}o=Lh(o,_h.bind(null,s))}s.callbackPriority=n,s.callbackNode=o}}function _h(s,n){if(ya=-1,wa=0,(Re&6)!==0)throw Error(t(327));var o=s.callbackNode;if(Jn()&&s.callbackNode!==o)return null;var h=Pr(s,s===lt?ht:0);if(h===0)return null;if((h&30)!==0||(h&s.expiredLanes)!==0||n)n=Na(s,h);else{n=h;var g=Re;Re|=2;var v=kh();(lt!==s||ht!==n)&&(js=null,Qn=Ye()+500,vn(s,n));do try{cg();break}catch(C){jh(s,C)}while(!0);so(),ma.current=v,Re=g,Ze!==null?n=0:(lt=null,ht=0,n=nt)}if(n!==0){if(n===2&&(g=vl(s),g!==0&&(h=g,n=zo(s,g))),n===1)throw o=Ki,vn(s,0),Xs(s,h),Rt(s,Ye()),o;if(n===6)Xs(s,h);else{if(g=s.current.alternate,(h&30)===0&&!lg(g)&&(n=Na(s,h),n===2&&(v=vl(s),v!==0&&(h=v,n=zo(s,v))),n===1))throw o=Ki,vn(s,0),Xs(s,h),Rt(s,Ye()),o;switch(s.finishedWork=g,s.finishedLanes=h,n){case 0:case 1:throw Error(t(345));case 2:bn(s,Tt,js);break;case 3:if(Xs(s,h),(h&130023424)===h&&(n=Do+500-Ye(),10<n)){if(Pr(s,0)!==0)break;if(g=s.suspendedLanes,(g&h)!==h){_t(),s.pingedLanes|=s.suspendedLanes&g;break}s.timeoutHandle=Wl(bn.bind(null,s,Tt,js),n);break}bn(s,Tt,js);break;case 4:if(Xs(s,h),(h&4194240)===h)break;for(n=s.eventTimes,g=-1;0<h;){var A=31-Zt(h);v=1<<A,A=n[A],A>g&&(g=A),h&=~v}if(h=g,h=Ye()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*ag(h/1960))-h,10<h){s.timeoutHandle=Wl(bn.bind(null,s,Tt,js),h);break}bn(s,Tt,js);break;case 5:bn(s,Tt,js);break;default:throw Error(t(329))}}}return Rt(s,Ye()),s.callbackNode===o?_h.bind(null,s):null}function zo(s,n){var o=Qi;return s.current.memoizedState.isDehydrated&&(vn(s,n).flags|=256),s=Na(s,n),s!==2&&(n=Tt,Tt=o,n!==null&&Bo(n)),s}function Bo(s){Tt===null?Tt=s:Tt.push.apply(Tt,s)}function lg(s){for(var n=s;;){if(n.flags&16384){var o=n.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var h=0;h<o.length;h++){var g=o[h],v=g.getSnapshot;g=g.value;try{if(!es(v(),g))return!1}catch{return!1}}}if(o=n.child,n.subtreeFlags&16384&&o!==null)o.return=n,n=o;else{if(n===s)break;for(;n.sibling===null;){if(n.return===null||n.return===s)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Xs(s,n){for(n&=~Io,n&=~ga,s.suspendedLanes|=n,s.pingedLanes&=~n,s=s.expirationTimes;0<n;){var o=31-Zt(n),h=1<<o;s[o]=-1,n&=~h}}function Sh(s){if((Re&6)!==0)throw Error(t(327));Jn();var n=Pr(s,0);if((n&1)===0)return Rt(s,Ye()),null;var o=Na(s,n);if(s.tag!==0&&o===2){var h=vl(s);h!==0&&(n=h,o=zo(s,h))}if(o===1)throw o=Ki,vn(s,0),Xs(s,n),Rt(s,Ye()),o;if(o===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=n,bn(s,Tt,js),Rt(s,Ye()),null}function $o(s,n){var o=Re;Re|=1;try{return s(n)}finally{Re=o,Re===0&&(Qn=Ye()+500,Yr&&Bs())}}function xn(s){Gs!==null&&Gs.tag===0&&(Re&6)===0&&Jn();var n=Re;Re|=1;var o=Yt.transition,h=Ie;try{if(Yt.transition=null,Ie=1,s)return s()}finally{Ie=h,Yt.transition=o,Re=n,(Re&6)===0&&Bs()}}function Uo(){zt=Kn.current,Be(Kn)}function vn(s,n){s.finishedWork=null,s.finishedLanes=0;var o=s.timeoutHandle;if(o!==-1&&(s.timeoutHandle=-1,Dm(o)),Ze!==null)for(o=Ze.return;o!==null;){var h=o;switch(Ql(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&qr();break;case 3:qn(),Be(Et),Be(pt),uo();break;case 5:oo(h);break;case 4:qn();break;case 13:Be(We);break;case 19:Be(We);break;case 10:no(h.type._context);break;case 22:case 23:Uo()}o=o.return}if(lt=s,Ze=s=Ys(s.current,null),ht=zt=n,nt=0,Ki=null,Io=ga=gn=0,Tt=Qi=null,fn!==null){for(n=0;n<fn.length;n++)if(o=fn[n],h=o.interleaved,h!==null){o.interleaved=null;var g=h.next,v=o.pending;if(v!==null){var A=v.next;v.next=g,h.next=A}o.pending=h}fn=null}return s}function jh(s,n){do{var o=Ze;try{if(so(),ra.current=ca,aa){for(var h=Ge.memoizedState;h!==null;){var g=h.queue;g!==null&&(g.pending=null),h=h.next}aa=!1}if(mn=0,at=st=Ge=null,Hi=!1,Wi=0,Vo.current=null,o===null||o.return===null){nt=1,Ki=n,Ze=null;break}e:{var v=s,A=o.return,C=o,R=n;if(n=ht,C.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){var O=R,W=C,G=W.tag;if((W.mode&1)===0&&(G===0||G===11||G===15)){var H=W.alternate;H?(W.updateQueue=H.updateQueue,W.memoizedState=H.memoizedState,W.lanes=H.lanes):(W.updateQueue=null,W.memoizedState=null)}var le=Qu(A);if(le!==null){le.flags&=-257,Ju(le,A,C,v,n),le.mode&1&&Ku(v,O,n),n=le,R=O;var he=n.updateQueue;if(he===null){var pe=new Set;pe.add(R),n.updateQueue=pe}else he.add(R);break e}else{if((n&1)===0){Ku(v,O,n),Ho();break e}R=Error(t(426))}}else if($e&&C.mode&1){var Ke=Qu(A);if(Ke!==null){(Ke.flags&65536)===0&&(Ke.flags|=256),Ju(Ke,A,C,v,n),eo(Xn(R,C));break e}}v=R=Xn(R,C),nt!==4&&(nt=2),Qi===null?Qi=[v]:Qi.push(v),v=A;do{switch(v.tag){case 3:v.flags|=65536,n&=-n,v.lanes|=n;var D=Xu(v,R,n);wu(v,D);break e;case 1:C=R;var M=v.type,F=v.stateNode;if((v.flags&128)===0&&(typeof M.getDerivedStateFromError=="function"||F!==null&&typeof F.componentDidCatch=="function"&&(Ws===null||!Ws.has(F)))){v.flags|=65536,n&=-n,v.lanes|=n;var Y=Yu(v,C,n);wu(v,Y);break e}}v=v.return}while(v!==null)}Ch(o)}catch(me){n=me,Ze===o&&o!==null&&(Ze=o=o.return);continue}break}while(!0)}function kh(){var s=ma.current;return ma.current=ca,s===null?ca:s}function Ho(){(nt===0||nt===3||nt===2)&&(nt=4),lt===null||(gn&268435455)===0&&(ga&268435455)===0||Xs(lt,ht)}function Na(s,n){var o=Re;Re|=2;var h=kh();(lt!==s||ht!==n)&&(js=null,vn(s,n));do try{og();break}catch(g){jh(s,g)}while(!0);if(so(),Re=o,ma.current=h,Ze!==null)throw Error(t(261));return lt=null,ht=0,nt}function og(){for(;Ze!==null;)Eh(Ze)}function cg(){for(;Ze!==null&&!Mp();)Eh(Ze)}function Eh(s){var n=Rh(s.alternate,s,zt);s.memoizedProps=s.pendingProps,n===null?Ch(s):Ze=n,Vo.current=null}function Ch(s){var n=s;do{var o=n.alternate;if(s=n.return,(n.flags&32768)===0){if(o=tg(o,n,zt),o!==null){Ze=o;return}}else{if(o=sg(o,n),o!==null){o.flags&=32767,Ze=o;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{nt=6,Ze=null;return}}if(n=n.sibling,n!==null){Ze=n;return}Ze=n=s}while(n!==null);nt===0&&(nt=5)}function bn(s,n,o){var h=Ie,g=Yt.transition;try{Yt.transition=null,Ie=1,dg(s,n,o,h)}finally{Yt.transition=g,Ie=h}return null}function dg(s,n,o,h){do Jn();while(Gs!==null);if((Re&6)!==0)throw Error(t(327));o=s.finishedWork;var g=s.finishedLanes;if(o===null)return null;if(s.finishedWork=null,s.finishedLanes=0,o===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var v=o.lanes|o.childLanes;if(Hp(s,v),s===lt&&(Ze=lt=null,ht=0),(o.subtreeFlags&2064)===0&&(o.flags&2064)===0||va||(va=!0,Lh(jr,function(){return Jn(),null})),v=(o.flags&15990)!==0,(o.subtreeFlags&15990)!==0||v){v=Yt.transition,Yt.transition=null;var A=Ie;Ie=1;var C=Re;Re|=4,Vo.current=null,ig(s,o),bh(o,s),Pm(Ul),Lr=!!$l,Ul=$l=null,s.current=o,rg(o),Vp(),Re=C,Ie=A,Yt.transition=v}else s.current=o;if(va&&(va=!1,Gs=s,ba=g),v=s.pendingLanes,v===0&&(Ws=null),Fp(o.stateNode),Rt(s,Ye()),n!==null)for(h=s.onRecoverableError,o=0;o<n.length;o++)g=n[o],h(g.value,{componentStack:g.stack,digest:g.digest});if(xa)throw xa=!1,s=Fo,Fo=null,s;return(ba&1)!==0&&s.tag!==0&&Jn(),v=s.pendingLanes,(v&1)!==0?s===Oo?Ji++:(Ji=0,Oo=s):Ji=0,Bs(),null}function Jn(){if(Gs!==null){var s=xd(ba),n=Yt.transition,o=Ie;try{if(Yt.transition=null,Ie=16>s?16:s,Gs===null)var h=!1;else{if(s=Gs,Gs=null,ba=0,(Re&6)!==0)throw Error(t(331));var g=Re;for(Re|=4,de=s.current;de!==null;){var v=de,A=v.child;if((de.flags&16)!==0){var C=v.deletions;if(C!==null){for(var R=0;R<C.length;R++){var O=C[R];for(de=O;de!==null;){var W=de;switch(W.tag){case 0:case 11:case 15:Yi(8,W,v)}var G=W.child;if(G!==null)G.return=W,de=G;else for(;de!==null;){W=de;var H=W.sibling,le=W.return;if(ph(W),W===O){de=null;break}if(H!==null){H.return=le,de=H;break}de=le}}}var he=v.alternate;if(he!==null){var pe=he.child;if(pe!==null){he.child=null;do{var Ke=pe.sibling;pe.sibling=null,pe=Ke}while(pe!==null)}}de=v}}if((v.subtreeFlags&2064)!==0&&A!==null)A.return=v,de=A;else e:for(;de!==null;){if(v=de,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:Yi(9,v,v.return)}var D=v.sibling;if(D!==null){D.return=v.return,de=D;break e}de=v.return}}var M=s.current;for(de=M;de!==null;){A=de;var F=A.child;if((A.subtreeFlags&2064)!==0&&F!==null)F.return=A,de=F;else e:for(A=M;de!==null;){if(C=de,(C.flags&2048)!==0)try{switch(C.tag){case 0:case 11:case 15:pa(9,C)}}catch(me){Xe(C,C.return,me)}if(C===A){de=null;break e}var Y=C.sibling;if(Y!==null){Y.return=C.return,de=Y;break e}de=C.return}}if(Re=g,Bs(),ds&&typeof ds.onPostCommitFiberRoot=="function")try{ds.onPostCommitFiberRoot(kr,s)}catch{}h=!0}return h}finally{Ie=o,Yt.transition=n}}return!1}function Ph(s,n,o){n=Xn(o,n),n=Xu(s,n,1),s=Us(s,n,1),n=_t(),s!==null&&(Ni(s,1,n),Rt(s,n))}function Xe(s,n,o){if(s.tag===3)Ph(s,s,o);else for(;n!==null;){if(n.tag===3){Ph(n,s,o);break}else if(n.tag===1){var h=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Ws===null||!Ws.has(h))){s=Xn(o,s),s=Yu(n,s,1),n=Us(n,s,1),s=_t(),n!==null&&(Ni(n,1,s),Rt(n,s));break}}n=n.return}}function ug(s,n,o){var h=s.pingCache;h!==null&&h.delete(n),n=_t(),s.pingedLanes|=s.suspendedLanes&o,lt===s&&(ht&o)===o&&(nt===4||nt===3&&(ht&130023424)===ht&&500>Ye()-Do?vn(s,0):Io|=o),Rt(s,n)}function Th(s,n){n===0&&((s.mode&1)===0?n=1:(n=Cr,Cr<<=1,(Cr&130023424)===0&&(Cr=4194304)));var o=_t();s=As(s,n),s!==null&&(Ni(s,n,o),Rt(s,o))}function hg(s){var n=s.memoizedState,o=0;n!==null&&(o=n.retryLane),Th(s,o)}function fg(s,n){var o=0;switch(s.tag){case 13:var h=s.stateNode,g=s.memoizedState;g!==null&&(o=g.retryLane);break;case 19:h=s.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(n),Th(s,o)}var Rh;Rh=function(s,n,o){if(s!==null)if(s.memoizedProps!==n.pendingProps||Et.current)Pt=!0;else{if((s.lanes&o)===0&&(n.flags&128)===0)return Pt=!1,eg(s,n,o);Pt=(s.flags&131072)!==0}else Pt=!1,$e&&(n.flags&1048576)!==0&&uu(n,Qr,n.index);switch(n.lanes=0,n.tag){case 2:var h=n.type;ha(s,n),s=n.pendingProps;var g=zn(n,pt.current);Gn(n,o),g=po(null,n,h,s,g,o);var v=mo();return n.flags|=1,typeof g=="object"&&g!==null&&typeof g.render=="function"&&g.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,Ct(h)?(v=!0,Xr(n)):v=!1,n.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,ao(n),g.updater=da,n.stateNode=g,g._reactInternals=n,wo(n,h,s,o),n=So(null,n,h,!0,v,o)):(n.tag=0,$e&&v&&Kl(n),At(null,n,g,o),n=n.child),n;case 16:h=n.elementType;e:{switch(ha(s,n),s=n.pendingProps,g=h._init,h=g(h._payload),n.type=h,g=n.tag=mg(h),s=ss(h,s),g){case 0:n=_o(null,n,h,s,o);break e;case 1:n=ih(null,n,h,s,o);break e;case 11:n=Zu(null,n,h,s,o);break e;case 14:n=eh(null,n,h,ss(h.type,s),o);break e}throw Error(t(306,h,""))}return n;case 0:return h=n.type,g=n.pendingProps,g=n.elementType===h?g:ss(h,g),_o(s,n,h,g,o);case 1:return h=n.type,g=n.pendingProps,g=n.elementType===h?g:ss(h,g),ih(s,n,h,g,o);case 3:e:{if(rh(n),s===null)throw Error(t(387));h=n.pendingProps,v=n.memoizedState,g=v.element,yu(s,n),na(n,h,null,o);var A=n.memoizedState;if(h=A.element,v.isDehydrated)if(v={element:h,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},n.updateQueue.baseState=v,n.memoizedState=v,n.flags&256){g=Xn(Error(t(423)),n),n=ah(s,n,h,o,g);break e}else if(h!==g){g=Xn(Error(t(424)),n),n=ah(s,n,h,o,g);break e}else for(Ot=Fs(n.stateNode.containerInfo.firstChild),Ft=n,$e=!0,ts=null,o=vu(n,null,h,o),n.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Un(),h===g){n=Ss(s,n,o);break e}At(s,n,h,o)}n=n.child}return n;case 5:return Au(n),s===null&&Zl(n),h=n.type,g=n.pendingProps,v=s!==null?s.memoizedProps:null,A=g.children,Hl(h,g)?A=null:v!==null&&Hl(h,v)&&(n.flags|=32),nh(s,n),At(s,n,A,o),n.child;case 6:return s===null&&Zl(n),null;case 13:return lh(s,n,o);case 4:return lo(n,n.stateNode.containerInfo),h=n.pendingProps,s===null?n.child=Hn(n,null,h,o):At(s,n,h,o),n.child;case 11:return h=n.type,g=n.pendingProps,g=n.elementType===h?g:ss(h,g),Zu(s,n,h,g,o);case 7:return At(s,n,n.pendingProps,o),n.child;case 8:return At(s,n,n.pendingProps.children,o),n.child;case 12:return At(s,n,n.pendingProps.children,o),n.child;case 10:e:{if(h=n.type._context,g=n.pendingProps,v=n.memoizedProps,A=g.value,Oe(ea,h._currentValue),h._currentValue=A,v!==null)if(es(v.value,A)){if(v.children===g.children&&!Et.current){n=Ss(s,n,o);break e}}else for(v=n.child,v!==null&&(v.return=n);v!==null;){var C=v.dependencies;if(C!==null){A=v.child;for(var R=C.firstContext;R!==null;){if(R.context===h){if(v.tag===1){R=_s(-1,o&-o),R.tag=2;var O=v.updateQueue;if(O!==null){O=O.shared;var W=O.pending;W===null?R.next=R:(R.next=W.next,W.next=R),O.pending=R}}v.lanes|=o,R=v.alternate,R!==null&&(R.lanes|=o),io(v.return,o,n),C.lanes|=o;break}R=R.next}}else if(v.tag===10)A=v.type===n.type?null:v.child;else if(v.tag===18){if(A=v.return,A===null)throw Error(t(341));A.lanes|=o,C=A.alternate,C!==null&&(C.lanes|=o),io(A,o,n),A=v.sibling}else A=v.child;if(A!==null)A.return=v;else for(A=v;A!==null;){if(A===n){A=null;break}if(v=A.sibling,v!==null){v.return=A.return,A=v;break}A=A.return}v=A}At(s,n,g.children,o),n=n.child}return n;case 9:return g=n.type,h=n.pendingProps.children,Gn(n,o),g=qt(g),h=h(g),n.flags|=1,At(s,n,h,o),n.child;case 14:return h=n.type,g=ss(h,n.pendingProps),g=ss(h.type,g),eh(s,n,h,g,o);case 15:return th(s,n,n.type,n.pendingProps,o);case 17:return h=n.type,g=n.pendingProps,g=n.elementType===h?g:ss(h,g),ha(s,n),n.tag=1,Ct(h)?(s=!0,Xr(n)):s=!1,Gn(n,o),Gu(n,h,g),wo(n,h,g,o),So(null,n,h,!0,s,o);case 19:return ch(s,n,o);case 22:return sh(s,n,o)}throw Error(t(156,n.tag))};function Lh(s,n){return hd(s,n)}function pg(s,n,o,h){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kt(s,n,o,h){return new pg(s,n,o,h)}function Wo(s){return s=s.prototype,!(!s||!s.isReactComponent)}function mg(s){if(typeof s=="function")return Wo(s)?1:0;if(s!=null){if(s=s.$$typeof,s===ne)return 11;if(s===Se)return 14}return 2}function Ys(s,n){var o=s.alternate;return o===null?(o=Kt(s.tag,n,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=n,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&14680064,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,n=s.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o}function Aa(s,n,o,h,g,v){var A=2;if(h=s,typeof s=="function")Wo(s)&&(A=1);else if(typeof s=="string")A=5;else e:switch(s){case I:return yn(o.children,g,v,n);case $:A=8,g|=8;break;case te:return s=Kt(12,o,n,g|2),s.elementType=te,s.lanes=v,s;case se:return s=Kt(13,o,n,g),s.elementType=se,s.lanes=v,s;case xe:return s=Kt(19,o,n,g),s.elementType=xe,s.lanes=v,s;case Z:return _a(o,g,v,n);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case oe:A=10;break e;case ae:A=9;break e;case ne:A=11;break e;case Se:A=14;break e;case X:A=16,h=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return n=Kt(A,o,n,g),n.elementType=s,n.type=h,n.lanes=v,n}function yn(s,n,o,h){return s=Kt(7,s,h,n),s.lanes=o,s}function _a(s,n,o,h){return s=Kt(22,s,h,n),s.elementType=Z,s.lanes=o,s.stateNode={isHidden:!1},s}function Go(s,n,o){return s=Kt(6,s,null,n),s.lanes=o,s}function qo(s,n,o){return n=Kt(4,s.children!==null?s.children:[],s.key,n),n.lanes=o,n.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},n}function gg(s,n,o,h,g){this.tag=n,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bl(0),this.expirationTimes=bl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bl(0),this.identifierPrefix=h,this.onRecoverableError=g,this.mutableSourceEagerHydrationData=null}function Xo(s,n,o,h,g,v,A,C,R){return s=new gg(s,n,o,C,R),n===1?(n=1,v===!0&&(n|=8)):n=0,v=Kt(3,null,null,n),s.current=v,v.stateNode=s,v.memoizedState={element:h,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},ao(v),s}function xg(s,n,o){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:T,key:h==null?null:""+h,children:s,containerInfo:n,implementation:o}}function Mh(s){if(!s)return zs;s=s._reactInternals;e:{if(on(s)!==s||s.tag!==1)throw Error(t(170));var n=s;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(Ct(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(t(171))}if(s.tag===1){var o=s.type;if(Ct(o))return ou(s,o,n)}return n}function Vh(s,n,o,h,g,v,A,C,R){return s=Xo(o,h,!0,s,g,v,A,C,R),s.context=Mh(null),o=s.current,h=_t(),g=qs(o),v=_s(h,g),v.callback=n??null,Us(o,v,g),s.current.lanes=g,Ni(s,g,h),Rt(s,h),s}function Sa(s,n,o,h){var g=n.current,v=_t(),A=qs(g);return o=Mh(o),n.context===null?n.context=o:n.pendingContext=o,n=_s(v,A),n.payload={element:s},h=h===void 0?null:h,h!==null&&(n.callback=h),s=Us(g,n,A),s!==null&&(rs(s,g,A,v),sa(s,g,A)),A}function ja(s){return s=s.current,s.child?(s.child.tag===5,s.child.stateNode):null}function Ih(s,n){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<n?o:n}}function Yo(s,n){Ih(s,n),(s=s.alternate)&&Ih(s,n)}function vg(){return null}var Dh=typeof reportError=="function"?reportError:function(s){console.error(s)};function Ko(s){this._internalRoot=s}ka.prototype.render=Ko.prototype.render=function(s){var n=this._internalRoot;if(n===null)throw Error(t(409));Sa(s,n,null,null)},ka.prototype.unmount=Ko.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var n=s.containerInfo;xn(function(){Sa(null,s,null,null)}),n[bs]=null}};function ka(s){this._internalRoot=s}ka.prototype.unstable_scheduleHydration=function(s){if(s){var n=yd();s={blockedOn:null,target:s,priority:n};for(var o=0;o<Vs.length&&n!==0&&n<Vs[o].priority;o++);Vs.splice(o,0,s),o===0&&Ad(s)}};function Qo(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Ea(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function Fh(){}function bg(s,n,o,h,g){if(g){if(typeof h=="function"){var v=h;h=function(){var O=ja(A);v.call(O)}}var A=Vh(n,h,s,0,null,!1,!1,"",Fh);return s._reactRootContainer=A,s[bs]=A.current,Ii(s.nodeType===8?s.parentNode:s),xn(),A}for(;g=s.lastChild;)s.removeChild(g);if(typeof h=="function"){var C=h;h=function(){var O=ja(R);C.call(O)}}var R=Xo(s,0,!1,null,null,!1,!1,"",Fh);return s._reactRootContainer=R,s[bs]=R.current,Ii(s.nodeType===8?s.parentNode:s),xn(function(){Sa(n,R,o,h)}),R}function Ca(s,n,o,h,g){var v=o._reactRootContainer;if(v){var A=v;if(typeof g=="function"){var C=g;g=function(){var R=ja(A);C.call(R)}}Sa(n,A,s,g)}else A=bg(o,n,s,g,h);return ja(A)}vd=function(s){switch(s.tag){case 3:var n=s.stateNode;if(n.current.memoizedState.isDehydrated){var o=wi(n.pendingLanes);o!==0&&(yl(n,o|1),Rt(n,Ye()),(Re&6)===0&&(Qn=Ye()+500,Bs()))}break;case 13:xn(function(){var h=As(s,1);if(h!==null){var g=_t();rs(h,s,1,g)}}),Yo(s,1)}},wl=function(s){if(s.tag===13){var n=As(s,134217728);if(n!==null){var o=_t();rs(n,s,134217728,o)}Yo(s,134217728)}},bd=function(s){if(s.tag===13){var n=qs(s),o=As(s,n);if(o!==null){var h=_t();rs(o,s,n,h)}Yo(s,n)}},yd=function(){return Ie},wd=function(s,n){var o=Ie;try{return Ie=s,n()}finally{Ie=o}},fl=function(s,n,o){switch(n){case"input":if(hi(s,o),n=o.name,o.type==="radio"&&n!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<o.length;n++){var h=o[n];if(h!==s&&h.form===s.form){var g=Gr(h);if(!g)throw Error(t(90));dt(h),hi(h,g)}}}break;case"textarea":Le(s,o);break;case"select":n=o.value,n!=null&&Ts(s,!!o.multiple,n,!1)}},rd=$o,ad=xn;var yg={usingClientEntryPoint:!1,Events:[Oi,Fn,Gr,nd,id,$o]},Zi={findFiberByHostInstance:cn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wg={bundleType:Zi.bundleType,version:Zi.version,rendererPackageName:Zi.rendererPackageName,rendererConfig:Zi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:k.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=dd(s),s===null?null:s.stateNode},findFiberByHostInstance:Zi.findFiberByHostInstance||vg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pa.isDisabled&&Pa.supportsFiber)try{kr=Pa.inject(wg),ds=Pa}catch{}}return Lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yg,Lt.createPortal=function(s,n){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Qo(n))throw Error(t(200));return xg(s,n,null,o)},Lt.createRoot=function(s,n){if(!Qo(s))throw Error(t(299));var o=!1,h="",g=Dh;return n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(h=n.identifierPrefix),n.onRecoverableError!==void 0&&(g=n.onRecoverableError)),n=Xo(s,1,!1,null,null,o,!1,h,g),s[bs]=n.current,Ii(s.nodeType===8?s.parentNode:s),new Ko(n)},Lt.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var n=s._reactInternals;if(n===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=dd(n),s=s===null?null:s.stateNode,s},Lt.flushSync=function(s){return xn(s)},Lt.hydrate=function(s,n,o){if(!Ea(n))throw Error(t(200));return Ca(null,s,n,!0,o)},Lt.hydrateRoot=function(s,n,o){if(!Qo(s))throw Error(t(405));var h=o!=null&&o.hydratedSources||null,g=!1,v="",A=Dh;if(o!=null&&(o.unstable_strictMode===!0&&(g=!0),o.identifierPrefix!==void 0&&(v=o.identifierPrefix),o.onRecoverableError!==void 0&&(A=o.onRecoverableError)),n=Vh(n,null,s,1,o??null,g,!1,v,A),s[bs]=n.current,Ii(s),h)for(s=0;s<h.length;s++)o=h[s],g=o._getVersion,g=g(o._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[o,g]:n.mutableSourceEagerHydrationData.push(o,g);return new ka(n)},Lt.render=function(s,n,o){if(!Ea(n))throw Error(t(200));return Ca(null,s,n,!1,o)},Lt.unmountComponentAtNode=function(s){if(!Ea(s))throw Error(t(40));return s._reactRootContainer?(xn(function(){Ca(null,null,s,!1,function(){s._reactRootContainer=null,s[bs]=null})}),!0):!1},Lt.unstable_batchedUpdates=$o,Lt.unstable_renderSubtreeIntoContainer=function(s,n,o,h){if(!Ea(o))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Ca(s,n,o,!1,h)},Lt.version="18.3.1-next-f1338f8080-20240426",Lt}var Xh;function Ff(){if(Xh)return tc.exports;Xh=1;function u(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(u)}catch(e){console.error(e)}}return u(),tc.exports=Pg(),tc.exports}var Yh;function Tg(){if(Yh)return Ra;Yh=1;var u=Ff();return Ra.createRoot=u.createRoot,Ra.hydrateRoot=u.hydrateRoot,Ra}var Rg=Tg();const Lg=Rc(Rg);Ff();function fr(){return fr=Object.assign?Object.assign.bind():function(u){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(u[i]=t[i])}return u},fr.apply(this,arguments)}var Zs;(function(u){u.Pop="POP",u.Push="PUSH",u.Replace="REPLACE"})(Zs||(Zs={}));const Kh="popstate";function Mg(u){u===void 0&&(u={});function e(i,r){let{pathname:l,search:c,hash:d}=i.location;return yc("",{pathname:l,search:c,hash:d},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(i,r){return typeof r=="string"?r:Ba(r)}return Ig(e,t,null,u)}function qe(u,e){if(u===!1||u===null||typeof u>"u")throw new Error(e)}function Mc(u,e){if(!u){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Vg(){return Math.random().toString(36).substr(2,8)}function Qh(u,e){return{usr:u.state,key:u.key,idx:e}}function yc(u,e,t,i){return t===void 0&&(t=null),fr({pathname:typeof u=="string"?u:u.pathname,search:"",hash:""},typeof e=="string"?oi(e):e,{state:t,key:e&&e.key||i||Vg()})}function Ba(u){let{pathname:e="/",search:t="",hash:i=""}=u;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function oi(u){let e={};if(u){let t=u.indexOf("#");t>=0&&(e.hash=u.substr(t),u=u.substr(0,t));let i=u.indexOf("?");i>=0&&(e.search=u.substr(i),u=u.substr(0,i)),u&&(e.pathname=u)}return e}function Ig(u,e,t,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:l=!1}=i,c=r.history,d=Zs.Pop,f=null,p=m();p==null&&(p=0,c.replaceState(fr({},c.state,{idx:p}),""));function m(){return(c.state||{idx:null}).idx}function x(){d=Zs.Pop;let _=m(),j=_==null?null:_-p;p=_,f&&f({action:d,location:N.location,delta:j})}function b(_,j){d=Zs.Push;let S=yc(N.location,_,j);p=m()+1;let P=Qh(S,p),k=N.createHref(S);try{c.pushState(P,"",k)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;r.location.assign(k)}l&&f&&f({action:d,location:N.location,delta:1})}function w(_,j){d=Zs.Replace;let S=yc(N.location,_,j);p=m();let P=Qh(S,p),k=N.createHref(S);c.replaceState(P,"",k),l&&f&&f({action:d,location:N.location,delta:0})}function y(_){let j=r.location.origin!=="null"?r.location.origin:r.location.href,S=typeof _=="string"?_:Ba(_);return S=S.replace(/ $/,"%20"),qe(j,"No window.location.(origin|href) available to create URL for href: "+S),new URL(S,j)}let N={get action(){return d},get location(){return u(r,c)},listen(_){if(f)throw new Error("A history only accepts one active listener");return r.addEventListener(Kh,x),f=_,()=>{r.removeEventListener(Kh,x),f=null}},createHref(_){return e(r,_)},createURL:y,encodeLocation(_){let j=y(_);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:b,replace:w,go(_){return c.go(_)}};return N}var Jh;(function(u){u.data="data",u.deferred="deferred",u.redirect="redirect",u.error="error"})(Jh||(Jh={}));function Dg(u,e,t){return t===void 0&&(t="/"),Fg(u,e,t)}function Fg(u,e,t,i){let r=typeof e=="string"?oi(e):e,l=ai(r.pathname||"/",t);if(l==null)return null;let c=Of(u);Og(c);let d=null;for(let f=0;d==null&&f<c.length;++f){let p=Kg(l);d=Xg(c[f],p)}return d}function Of(u,e,t,i){e===void 0&&(e=[]),t===void 0&&(t=[]),i===void 0&&(i="");let r=(l,c,d)=>{let f={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};f.relativePath.startsWith("/")&&(qe(f.relativePath.startsWith(i),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(i.length));let p=en([i,f.relativePath]),m=t.concat(f);l.children&&l.children.length>0&&(qe(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+p+'".')),Of(l.children,e,m,p)),!(l.path==null&&!l.index)&&e.push({path:p,score:Gg(p,l.index),routesMeta:m})};return u.forEach((l,c)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))r(l,c);else for(let f of zf(l.path))r(l,c,f)}),e}function zf(u){let e=u.split("/");if(e.length===0)return[];let[t,...i]=e,r=t.endsWith("?"),l=t.replace(/\?$/,"");if(i.length===0)return r?[l,""]:[l];let c=zf(i.join("/")),d=[];return d.push(...c.map(f=>f===""?l:[l,f].join("/"))),r&&d.push(...c),d.map(f=>u.startsWith("/")&&f===""?"/":f)}function Og(u){u.sort((e,t)=>e.score!==t.score?t.score-e.score:qg(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}const zg=/^:[\w-]+$/,Bg=3,$g=2,Ug=1,Hg=10,Wg=-2,Zh=u=>u==="*";function Gg(u,e){let t=u.split("/"),i=t.length;return t.some(Zh)&&(i+=Wg),e&&(i+=$g),t.filter(r=>!Zh(r)).reduce((r,l)=>r+(zg.test(l)?Bg:l===""?Ug:Hg),i)}function qg(u,e){return u.length===e.length&&u.slice(0,-1).every((i,r)=>i===e[r])?u[u.length-1]-e[e.length-1]:0}function Xg(u,e,t){let{routesMeta:i}=u,r={},l="/",c=[];for(let d=0;d<i.length;++d){let f=i[d],p=d===i.length-1,m=l==="/"?e:e.slice(l.length)||"/",x=wc({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},m),b=f.route;if(!x)return null;Object.assign(r,x.params),c.push({params:r,pathname:en([l,x.pathname]),pathnameBase:tx(en([l,x.pathnameBase])),route:b}),x.pathnameBase!=="/"&&(l=en([l,x.pathnameBase]))}return c}function wc(u,e){typeof u=="string"&&(u={path:u,caseSensitive:!1,end:!0});let[t,i]=Yg(u.path,u.caseSensitive,u.end),r=e.match(t);if(!r)return null;let l=r[0],c=l.replace(/(.)\/+$/,"$1"),d=r.slice(1);return{params:i.reduce((p,m,x)=>{let{paramName:b,isOptional:w}=m;if(b==="*"){let N=d[x]||"";c=l.slice(0,l.length-N.length).replace(/(.)\/+$/,"$1")}const y=d[x];return w&&!y?p[b]=void 0:p[b]=(y||"").replace(/%2F/g,"/"),p},{}),pathname:l,pathnameBase:c,pattern:u}}function Yg(u,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Mc(u==="*"||!u.endsWith("*")||u.endsWith("/*"),'Route path "'+u+'" will be treated as if it were '+('"'+u.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+u.replace(/\*$/,"/*")+'".'));let i=[],r="^"+u.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,f)=>(i.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return u.endsWith("*")?(i.push({paramName:"*"}),r+=u==="*"||u==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":u!==""&&u!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function Kg(u){try{return u.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Mc(!1,'The URL path "'+u+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),u}}function ai(u,e){if(e==="/")return u;if(!u.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=u.charAt(t);return i&&i!=="/"?null:u.slice(t)||"/"}const Qg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Jg=u=>Qg.test(u);function Zg(u,e){e===void 0&&(e="/");let{pathname:t,search:i="",hash:r=""}=typeof u=="string"?oi(u):u,l;if(t)if(Jg(t))l=t;else{if(t.includes("//")){let c=t;t=t.replace(/\/\/+/g,"/"),Mc(!1,"Pathnames cannot have embedded double slashes - normalizing "+(c+" -> "+t))}t.startsWith("/")?l=ef(t.substring(1),"/"):l=ef(t,e)}else l=e;return{pathname:l,search:sx(i),hash:nx(r)}}function ef(u,e){let t=e.replace(/\/+$/,"").split("/");return u.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function ic(u,e,t,i){return"Cannot include a '"+u+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function ex(u){return u.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Vc(u,e){let t=ex(u);return e?t.map((i,r)=>r===t.length-1?i.pathname:i.pathnameBase):t.map(i=>i.pathnameBase)}function Ic(u,e,t,i){i===void 0&&(i=!1);let r;typeof u=="string"?r=oi(u):(r=fr({},u),qe(!r.pathname||!r.pathname.includes("?"),ic("?","pathname","search",r)),qe(!r.pathname||!r.pathname.includes("#"),ic("#","pathname","hash",r)),qe(!r.search||!r.search.includes("#"),ic("#","search","hash",r)));let l=u===""||r.pathname==="",c=l?"/":r.pathname,d;if(c==null)d=t;else{let x=e.length-1;if(!i&&c.startsWith("..")){let b=c.split("/");for(;b[0]==="..";)b.shift(),x-=1;r.pathname=b.join("/")}d=x>=0?e[x]:"/"}let f=Zg(r,d),p=c&&c!=="/"&&c.endsWith("/"),m=(l||c===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(p||m)&&(f.pathname+="/"),f}const en=u=>u.join("/").replace(/\/\/+/g,"/"),tx=u=>u.replace(/\/+$/,"").replace(/^\/*/,"/"),sx=u=>!u||u==="?"?"":u.startsWith("?")?u:"?"+u,nx=u=>!u||u==="#"?"":u.startsWith("#")?u:"#"+u;function ix(u){return u!=null&&typeof u.status=="number"&&typeof u.statusText=="string"&&typeof u.internal=="boolean"&&"data"in u}const Bf=["post","put","patch","delete"];new Set(Bf);const rx=["get",...Bf];new Set(rx);function pr(){return pr=Object.assign?Object.assign.bind():function(u){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(u[i]=t[i])}return u},pr.apply(this,arguments)}const Xa=E.createContext(null),$f=E.createContext(null),Ps=E.createContext(null),Ya=E.createContext(null),vs=E.createContext({outlet:null,matches:[],isDataRoute:!1}),Uf=E.createContext(null);function ax(u,e){let{relative:t}=e===void 0?{}:e;ci()||qe(!1);let{basename:i,navigator:r}=E.useContext(Ps),{hash:l,pathname:c,search:d}=Ka(u,{relative:t}),f=c;return i!=="/"&&(f=c==="/"?i:en([i,c])),r.createHref({pathname:f,search:d,hash:l})}function ci(){return E.useContext(Ya)!=null}function di(){return ci()||qe(!1),E.useContext(Ya).location}function Hf(u){E.useContext(Ps).static||E.useLayoutEffect(u)}function cs(){let{isDataRoute:u}=E.useContext(vs);return u?wx():lx()}function lx(){ci()||qe(!1);let u=E.useContext(Xa),{basename:e,future:t,navigator:i}=E.useContext(Ps),{matches:r}=E.useContext(vs),{pathname:l}=di(),c=JSON.stringify(Vc(r,t.v7_relativeSplatPath)),d=E.useRef(!1);return Hf(()=>{d.current=!0}),E.useCallback(function(p,m){if(m===void 0&&(m={}),!d.current)return;if(typeof p=="number"){i.go(p);return}let x=Ic(p,JSON.parse(c),l,m.relative==="path");u==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:en([e,x.pathname])),(m.replace?i.replace:i.push)(x,m.state,m)},[e,i,c,l,u])}const ox=E.createContext(null);function cx(u){let e=E.useContext(vs).outlet;return e&&E.createElement(ox.Provider,{value:u},e)}function vr(){let{matches:u}=E.useContext(vs),e=u[u.length-1];return e?e.params:{}}function Ka(u,e){let{relative:t}=e===void 0?{}:e,{future:i}=E.useContext(Ps),{matches:r}=E.useContext(vs),{pathname:l}=di(),c=JSON.stringify(Vc(r,i.v7_relativeSplatPath));return E.useMemo(()=>Ic(u,JSON.parse(c),l,t==="path"),[u,c,l,t])}function dx(u,e){return ux(u,e)}function ux(u,e,t,i){ci()||qe(!1);let{navigator:r}=E.useContext(Ps),{matches:l}=E.useContext(vs),c=l[l.length-1],d=c?c.params:{};c&&c.pathname;let f=c?c.pathnameBase:"/";c&&c.route;let p=di(),m;if(e){var x;let _=typeof e=="string"?oi(e):e;f==="/"||(x=_.pathname)!=null&&x.startsWith(f)||qe(!1),m=_}else m=p;let b=m.pathname||"/",w=b;if(f!=="/"){let _=f.replace(/^\//,"").split("/");w="/"+b.replace(/^\//,"").split("/").slice(_.length).join("/")}let y=Dg(u,{pathname:w}),N=gx(y&&y.map(_=>Object.assign({},_,{params:Object.assign({},d,_.params),pathname:en([f,r.encodeLocation?r.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?f:en([f,r.encodeLocation?r.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),l,t,i);return e&&N?E.createElement(Ya.Provider,{value:{location:pr({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Zs.Pop}},N):N}function hx(){let u=yx(),e=ix(u)?u.status+" "+u.statusText:u instanceof Error?u.message:JSON.stringify(u),t=u instanceof Error?u.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},e),t?E.createElement("pre",{style:r},t):null,null)}const fx=E.createElement(hx,null);class px extends E.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?E.createElement(vs.Provider,{value:this.props.routeContext},E.createElement(Uf.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function mx(u){let{routeContext:e,match:t,children:i}=u,r=E.useContext(Xa);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),E.createElement(vs.Provider,{value:e},i)}function gx(u,e,t,i){var r;if(e===void 0&&(e=[]),t===void 0&&(t=null),i===void 0&&(i=null),u==null){var l;if(!t)return null;if(t.errors)u=t.matches;else if((l=i)!=null&&l.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)u=t.matches;else return null}let c=u,d=(r=t)==null?void 0:r.errors;if(d!=null){let m=c.findIndex(x=>x.route.id&&d?.[x.route.id]!==void 0);m>=0||qe(!1),c=c.slice(0,Math.min(c.length,m+1))}let f=!1,p=-1;if(t&&i&&i.v7_partialHydration)for(let m=0;m<c.length;m++){let x=c[m];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(p=m),x.route.id){let{loaderData:b,errors:w}=t,y=x.route.loader&&b[x.route.id]===void 0&&(!w||w[x.route.id]===void 0);if(x.route.lazy||y){f=!0,p>=0?c=c.slice(0,p+1):c=[c[0]];break}}}return c.reduceRight((m,x,b)=>{let w,y=!1,N=null,_=null;t&&(w=d&&x.route.id?d[x.route.id]:void 0,N=x.route.errorElement||fx,f&&(p<0&&b===0?(Nx("route-fallback"),y=!0,_=null):p===b&&(y=!0,_=x.route.hydrateFallbackElement||null)));let j=e.concat(c.slice(0,b+1)),S=()=>{let P;return w?P=N:y?P=_:x.route.Component?P=E.createElement(x.route.Component,null):x.route.element?P=x.route.element:P=m,E.createElement(mx,{match:x,routeContext:{outlet:m,matches:j,isDataRoute:t!=null},children:P})};return t&&(x.route.ErrorBoundary||x.route.errorElement||b===0)?E.createElement(px,{location:t.location,revalidation:t.revalidation,component:N,error:w,children:S(),routeContext:{outlet:null,matches:j,isDataRoute:!0}}):S()},null)}var Wf=(function(u){return u.UseBlocker="useBlocker",u.UseRevalidator="useRevalidator",u.UseNavigateStable="useNavigate",u})(Wf||{}),Gf=(function(u){return u.UseBlocker="useBlocker",u.UseLoaderData="useLoaderData",u.UseActionData="useActionData",u.UseRouteError="useRouteError",u.UseNavigation="useNavigation",u.UseRouteLoaderData="useRouteLoaderData",u.UseMatches="useMatches",u.UseRevalidator="useRevalidator",u.UseNavigateStable="useNavigate",u.UseRouteId="useRouteId",u})(Gf||{});function xx(u){let e=E.useContext(Xa);return e||qe(!1),e}function vx(u){let e=E.useContext($f);return e||qe(!1),e}function bx(u){let e=E.useContext(vs);return e||qe(!1),e}function qf(u){let e=bx(),t=e.matches[e.matches.length-1];return t.route.id||qe(!1),t.route.id}function yx(){var u;let e=E.useContext(Uf),t=vx(),i=qf();return e!==void 0?e:(u=t.errors)==null?void 0:u[i]}function wx(){let{router:u}=xx(Wf.UseNavigateStable),e=qf(Gf.UseNavigateStable),t=E.useRef(!1);return Hf(()=>{t.current=!0}),E.useCallback(function(r,l){l===void 0&&(l={}),t.current&&(typeof r=="number"?u.navigate(r):u.navigate(r,pr({fromRouteId:e},l)))},[u,e])}const tf={};function Nx(u,e,t){tf[u]||(tf[u]=!0)}function Ax(u,e){u?.v7_startTransition,u?.v7_relativeSplatPath}function _x(u){let{to:e,replace:t,state:i,relative:r}=u;ci()||qe(!1);let{future:l,static:c}=E.useContext(Ps),{matches:d}=E.useContext(vs),{pathname:f}=di(),p=cs(),m=Ic(e,Vc(d,l.v7_relativeSplatPath),f,r==="path"),x=JSON.stringify(m);return E.useEffect(()=>p(JSON.parse(x),{replace:t,state:i,relative:r}),[p,x,r,t,i]),null}function Qa(u){return cx(u.context)}function De(u){qe(!1)}function Sx(u){let{basename:e="/",children:t=null,location:i,navigationType:r=Zs.Pop,navigator:l,static:c=!1,future:d}=u;ci()&&qe(!1);let f=e.replace(/^\/*/,"/"),p=E.useMemo(()=>({basename:f,navigator:l,static:c,future:pr({v7_relativeSplatPath:!1},d)}),[f,d,l,c]);typeof i=="string"&&(i=oi(i));let{pathname:m="/",search:x="",hash:b="",state:w=null,key:y="default"}=i,N=E.useMemo(()=>{let _=ai(m,f);return _==null?null:{location:{pathname:_,search:x,hash:b,state:w,key:y},navigationType:r}},[f,m,x,b,w,y,r]);return N==null?null:E.createElement(Ps.Provider,{value:p},E.createElement(Ya.Provider,{children:t,value:N}))}function jx(u){let{children:e,location:t}=u;return dx(Nc(e),t)}new Promise(()=>{});function Nc(u,e){e===void 0&&(e=[]);let t=[];return E.Children.forEach(u,(i,r)=>{if(!E.isValidElement(i))return;let l=[...e,r];if(i.type===E.Fragment){t.push.apply(t,Nc(i.props.children,l));return}i.type!==De&&qe(!1),!i.props.index||!i.props.children||qe(!1);let c={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=Nc(i.props.children,l)),t.push(c)}),t}function $a(){return $a=Object.assign?Object.assign.bind():function(u){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(u[i]=t[i])}return u},$a.apply(this,arguments)}function Xf(u,e){if(u==null)return{};var t={},i=Object.keys(u),r,l;for(l=0;l<i.length;l++)r=i[l],!(e.indexOf(r)>=0)&&(t[r]=u[r]);return t}function kx(u){return!!(u.metaKey||u.altKey||u.ctrlKey||u.shiftKey)}function Ex(u,e){return u.button===0&&(!e||e==="_self")&&!kx(u)}const Cx=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Px=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Tx="6";try{window.__reactRouterVersion=Tx}catch{}const Rx=E.createContext({isTransitioning:!1}),Lx="startTransition",sf=kg[Lx];function Mx(u){let{basename:e,children:t,future:i,window:r}=u,l=E.useRef();l.current==null&&(l.current=Mg({window:r,v5Compat:!0}));let c=l.current,[d,f]=E.useState({action:c.action,location:c.location}),{v7_startTransition:p}=i||{},m=E.useCallback(x=>{p&&sf?sf(()=>f(x)):f(x)},[f,p]);return E.useLayoutEffect(()=>c.listen(m),[c,m]),E.useEffect(()=>Ax(i),[i]),E.createElement(Sx,{basename:e,children:t,location:d.location,navigationType:d.action,navigator:c,future:i})}const Vx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Ix=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ie=E.forwardRef(function(e,t){let{onClick:i,relative:r,reloadDocument:l,replace:c,state:d,target:f,to:p,preventScrollReset:m,viewTransition:x}=e,b=Xf(e,Cx),{basename:w}=E.useContext(Ps),y,N=!1;if(typeof p=="string"&&Ix.test(p)&&(y=p,Vx))try{let P=new URL(window.location.href),k=p.startsWith("//")?new URL(P.protocol+p):new URL(p),L=ai(k.pathname,w);k.origin===P.origin&&L!=null?p=L+k.search+k.hash:N=!0}catch{}let _=ax(p,{relative:r}),j=Fx(p,{replace:c,state:d,target:f,preventScrollReset:m,relative:r,viewTransition:x});function S(P){i&&i(P),P.defaultPrevented||j(P)}return E.createElement("a",$a({},b,{href:y||_,onClick:N||l?i:S,ref:t,target:f}))}),ft=E.forwardRef(function(e,t){let{"aria-current":i="page",caseSensitive:r=!1,className:l="",end:c=!1,style:d,to:f,viewTransition:p,children:m}=e,x=Xf(e,Px),b=Ka(f,{relative:x.relative}),w=di(),y=E.useContext($f),{navigator:N,basename:_}=E.useContext(Ps),j=y!=null&&Ox(b)&&p===!0,S=N.encodeLocation?N.encodeLocation(b).pathname:b.pathname,P=w.pathname,k=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;r||(P=P.toLowerCase(),k=k?k.toLowerCase():null,S=S.toLowerCase()),k&&_&&(k=ai(k,_)||k);const L=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let T=P===S||!c&&P.startsWith(S)&&P.charAt(L)==="/",I=k!=null&&(k===S||!c&&k.startsWith(S)&&k.charAt(S.length)==="/"),$={isActive:T,isPending:I,isTransitioning:j},te=T?i:void 0,oe;typeof l=="function"?oe=l($):oe=[l,T?"active":null,I?"pending":null,j?"transitioning":null].filter(Boolean).join(" ");let ae=typeof d=="function"?d($):d;return E.createElement(ie,$a({},x,{"aria-current":te,className:oe,ref:t,style:ae,to:f,viewTransition:p}),typeof m=="function"?m($):m)});var Ac;(function(u){u.UseScrollRestoration="useScrollRestoration",u.UseSubmit="useSubmit",u.UseSubmitFetcher="useSubmitFetcher",u.UseFetcher="useFetcher",u.useViewTransitionState="useViewTransitionState"})(Ac||(Ac={}));var nf;(function(u){u.UseFetcher="useFetcher",u.UseFetchers="useFetchers",u.UseScrollRestoration="useScrollRestoration"})(nf||(nf={}));function Dx(u){let e=E.useContext(Xa);return e||qe(!1),e}function Fx(u,e){let{target:t,replace:i,state:r,preventScrollReset:l,relative:c,viewTransition:d}=e===void 0?{}:e,f=cs(),p=di(),m=Ka(u,{relative:c});return E.useCallback(x=>{if(Ex(x,t)){x.preventDefault();let b=i!==void 0?i:Ba(p)===Ba(m);f(u,{replace:b,state:r,preventScrollReset:l,relative:c,viewTransition:d})}},[p,f,m,i,r,t,u,l,c,d])}function Ox(u,e){e===void 0&&(e={});let t=E.useContext(Rx);t==null&&qe(!1);let{basename:i}=Dx(Ac.useViewTransitionState),r=Ka(u,{relative:e.relative});if(!t.isTransitioning)return!1;let l=ai(t.currentLocation.pathname,i)||t.currentLocation.pathname,c=ai(t.nextLocation.pathname,i)||t.nextLocation.pathname;return wc(r.pathname,c)!=null||wc(r.pathname,l)!=null}const zx={},rf=u=>{let e;const t=new Set,i=(m,x)=>{const b=typeof m=="function"?m(e):m;if(!Object.is(b,e)){const w=e;e=x??(typeof b!="object"||b===null)?b:Object.assign({},e,b),t.forEach(y=>y(e,w))}},r=()=>e,f={setState:i,getState:r,getInitialState:()=>p,subscribe:m=>(t.add(m),()=>t.delete(m)),destroy:()=>{(zx?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},p=e=u(i,r,f);return f},Bx=u=>u?rf(u):rf;var rc={exports:{}},ac={},lc={exports:{}},oc={};var af;function $x(){if(af)return oc;af=1;var u=xr();function e(x,b){return x===b&&(x!==0||1/x===1/b)||x!==x&&b!==b}var t=typeof Object.is=="function"?Object.is:e,i=u.useState,r=u.useEffect,l=u.useLayoutEffect,c=u.useDebugValue;function d(x,b){var w=b(),y=i({inst:{value:w,getSnapshot:b}}),N=y[0].inst,_=y[1];return l(function(){N.value=w,N.getSnapshot=b,f(N)&&_({inst:N})},[x,w,b]),r(function(){return f(N)&&_({inst:N}),x(function(){f(N)&&_({inst:N})})},[x]),c(w),w}function f(x){var b=x.getSnapshot;x=x.value;try{var w=b();return!t(x,w)}catch{return!0}}function p(x,b){return b()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:d;return oc.useSyncExternalStore=u.useSyncExternalStore!==void 0?u.useSyncExternalStore:m,oc}var lf;function Ux(){return lf||(lf=1,lc.exports=$x()),lc.exports}var of;function Hx(){if(of)return ac;of=1;var u=xr(),e=Ux();function t(p,m){return p===m&&(p!==0||1/p===1/m)||p!==p&&m!==m}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,l=u.useRef,c=u.useEffect,d=u.useMemo,f=u.useDebugValue;return ac.useSyncExternalStoreWithSelector=function(p,m,x,b,w){var y=l(null);if(y.current===null){var N={hasValue:!1,value:null};y.current=N}else N=y.current;y=d(function(){function j(T){if(!S){if(S=!0,P=T,T=b(T),w!==void 0&&N.hasValue){var I=N.value;if(w(I,T))return k=I}return k=T}if(I=k,i(P,T))return I;var $=b(T);return w!==void 0&&w(I,$)?(P=T,I):(P=T,k=$)}var S=!1,P,k,L=x===void 0?null:x;return[function(){return j(m())},L===null?void 0:function(){return j(L())}]},[m,x,b,w]);var _=r(p,y[0],y[1]);return c(function(){N.hasValue=!0,N.value=_},[_]),f(_),_},ac}var cf;function Wx(){return cf||(cf=1,rc.exports=Hx()),rc.exports}var Gx=Wx();const qx=Rc(Gx),Yf={},{useDebugValue:Xx}=Lc,{useSyncExternalStoreWithSelector:Yx}=qx;let df=!1;const Kx=u=>u;function Qx(u,e=Kx,t){(Yf?"production":void 0)!=="production"&&t&&!df&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),df=!0);const i=Yx(u.subscribe,u.getState,u.getServerState||u.getInitialState,e,t);return Xx(i),i}const uf=u=>{(Yf?"production":void 0)!=="production"&&typeof u!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof u=="function"?Bx(u):u,t=(i,r)=>Qx(e,i,r);return Object.assign(t,e),t},Jx=u=>u?uf(u):uf,Kf="/api".replace(/\/$/,"")||"/api";function Qf(){return localStorage.getItem("tarikh_token")}async function je(u,e={}){const{params:t,...i}=e,r=new URL(u.startsWith("http")?u:`${Kf}${u}`,window.location.origin);t&&Object.entries(t).forEach(([f,p])=>{p!==void 0&&p!==""&&r.searchParams.set(f,String(p))});const l=Qf(),c={...i.method!=="GET"&&typeof i.body?.append!="function"?{"Content-Type":"application/json"}:{},...i.headers};l&&(c.Authorization=`Bearer ${l}`);const d=await fetch(r.toString(),{...i,headers:c});if(!d.ok){const f=await d.json().catch(()=>({message:d.statusText}));throw new Error(f.message??"Erreur API")}if(d.status!==204)return d.json()}function cc(u){const e=Qf(),t=`${Kf}/documents/${u}/stream`;return e?`${t}?token=${encodeURIComponent(e)}`:t}const Ua={login:(u,e)=>je("/login",{method:"POST",body:JSON.stringify({email:u,password:e})}),register:(u,e,t,i,r="reader")=>je("/register",{method:"POST",body:JSON.stringify({name:u,email:e,password:t,password_confirmation:i,role:r})}),user:()=>je("/user"),logout:()=>je("/logout",{method:"POST"})},Jf={list:()=>je("/themes")},Zx={list:()=>je("/regions")};function e0(u,e){const t=e.slice(0,50).join(",");return je(`/documents/${u}/pages/urls`,{params:{pages:t}})}const Ha={list:u=>je("/documents",{params:u}),get:u=>je(`/documents/${u}`)},t0={list:()=>je("/banners")},ct={stats:u=>je("/admin/stats",{params:u}),documents:{list:u=>je("/admin/documents",{params:u}),create:u=>je("/admin/documents",{method:"POST",body:u}),get:u=>je(`/admin/documents/${u}`),update:(u,e)=>je(`/admin/documents/${u}`,{method:"PUT",body:e}),delete:u=>je(`/admin/documents/${u}`,{method:"DELETE"}),conversionProgress:u=>je(`/admin/documents/${u}/conversion-progress`),regeneratePages:u=>je(`/admin/documents/${u}/regenerate-pages`,{method:"POST"})},users:{list:u=>je("/admin/users",{params:u}),get:u=>je(`/admin/users/${u}`),create:u=>je("/admin/users",{method:"POST",body:JSON.stringify(u)}),update:(u,e)=>je(`/admin/users/${u}`,{method:"PUT",body:JSON.stringify(e)}),delete:u=>je(`/admin/users/${u}`,{method:"DELETE"})},banners:{list:()=>je("/admin/banners"),create:u=>je("/admin/banners",{method:"POST",body:u}),get:u=>je(`/admin/banners/${u}`),update:(u,e)=>je(`/admin/banners/${u}`,{method:"POST",body:e,params:{_method:"PUT"}}),delete:u=>je(`/admin/banners/${u}`,{method:"DELETE"})}},Cs={list:u=>je("/articles",{params:u}),get:u=>je(`/articles/${u}`),categories:()=>je("/article-categories"),myArticles:u=>je("/my-articles",{params:u}),create:u=>je("/articles",{method:"POST",body:u}),show:u=>je(`/articles/${u}/edit`),update:(u,e)=>je(`/articles/${u}`,{method:"PUT",body:e}),delete:u=>je(`/articles/${u}`,{method:"DELETE"}),submit:u=>je(`/articles/${u}/submit`,{method:"POST"})},wn={list:u=>je("/admin/articles",{params:u}),pending:u=>je("/admin/articles/pending",{params:u}),stats:()=>je("/admin/articles/stats"),show:u=>je(`/admin/articles/${u}`),approve:u=>je(`/admin/articles/${u}/approve`,{method:"POST"}),reject:(u,e)=>je(`/admin/articles/${u}/reject`,{method:"POST",body:JSON.stringify({comment:e})})},sr="tarikh_token",Ut=Jx(u=>({token:localStorage.getItem(sr),user:null,setAuth:(e,t)=>{localStorage.setItem(sr,e),u({token:e,user:t})},logout:async()=>{try{await Ua.logout()}catch{}localStorage.removeItem(sr),u({token:null,user:null})},loadUser:async()=>{const e=localStorage.getItem(sr);if(!e)return u({user:null});try{const t=await Ua.user();u({token:e,user:t})}catch{localStorage.removeItem(sr),u({token:null,user:null})}}}));function s0(){const{user:u,logout:e}=Ut(),[t,i]=E.useState(!1),r=()=>i(!t),l=()=>i(!1);return a.jsxs("header",{className:`fixed top-0 w-full z-50 transition-colors ${t?"bg-parchment":"glass-nav"} border-b border-accent-gold/20 px-6 lg:px-20 py-4`,children:[a.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[a.jsxs(ie,{to:"/",className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-accent-gold",children:a.jsx("span",{className:"material-symbols-outlined text-3xl",children:"auto_stories"})}),a.jsxs("h2",{className:"text-slate-900 text-2xl font-black tracking-tighter italic",children:["Tarikh",a.jsx("span",{className:"text-accent-gold",children:".ma"})]})]}),a.jsxs("nav",{className:"hidden md:flex items-center gap-10",children:[a.jsx(ft,{to:"/archives",className:({isActive:c})=>`text-sm font-medium transition-colors ${c?"text-accent-gold":"text-slate-600 hover:text-accent-gold"}`,children:"Collections"}),a.jsx(ft,{to:"/contribuer",className:({isActive:c})=>`text-sm font-medium transition-colors ${c?"text-accent-gold":"text-slate-600 hover:text-accent-gold"}`,children:"Contribuer"}),a.jsx(ie,{to:"/archives",className:"text-slate-600 hover:text-accent-gold text-sm font-medium transition-colors",children:"Archives"}),a.jsx(ft,{to:"/a-propos",className:({isActive:c})=>`text-sm font-medium transition-colors ${c?"text-accent-gold":"text-slate-600 hover:text-accent-gold"}`,children:" propos"}),(u?.role==="admin"||u?.role==="editor")&&a.jsx(ie,{to:"/admin",className:"text-sm font-medium text-accent-gold hover:text-accent-gold/80",children:"Admin"})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"hidden md:flex items-center gap-4",children:u?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-sm text-slate-500 hidden sm:inline",children:u.email}),a.jsx("button",{type:"button",onClick:()=>e(),className:"text-slate-600 hover:text-accent-gold text-sm font-medium transition-colors",children:"Dconnexion"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",className:"hidden sm:flex text-slate-600 text-sm font-bold items-center gap-1 hover:text-accent-gold transition-colors","aria-label":"Langue FR / AR",children:[a.jsx("span",{className:"material-symbols-outlined text-lg",children:"language"}),"FR / AR"]}),a.jsx(ie,{to:"/login",className:"bg-accent-gold hover:bg-accent-gold/90 text-white px-6 py-2 rounded-lg text-sm font-bold transition-all transform hover:scale-105 shadow-lg shadow-accent-gold/20",children:"Connexion"})]})}),a.jsx("button",{type:"button",onClick:r,className:"md:hidden p-2 text-slate-600 hover:text-accent-gold transition-colors","aria-label":"Toggle menu",children:a.jsx("span",{className:"material-symbols-outlined text-3xl",children:t?"close":"menu"})})]})]}),t&&a.jsxs("div",{className:"md:hidden fixed inset-0 top-[76px] bg-[#ffffff] z-[100] flex flex-col p-6 animate-fade-in shadow-2xl overflow-y-auto",children:[a.jsxs("nav",{className:"flex flex-col gap-6 mb-8",children:[a.jsx(ft,{to:"/archives",onClick:l,className:({isActive:c})=>`text-lg font-semibold transition-colors ${c?"text-accent-gold":"text-slate-900 border-b border-slate-100 pb-2"}`,children:"Collections"}),a.jsx(ft,{to:"/contribuer",onClick:l,className:({isActive:c})=>`text-lg font-semibold transition-colors ${c?"text-accent-gold":"text-slate-900 border-b border-slate-100 pb-2"}`,children:"Contribuer"}),a.jsx(ie,{to:"/archives",onClick:l,className:"text-lg font-semibold text-slate-900 border-b border-slate-100 pb-2",children:"Archives"}),a.jsx(ft,{to:"/a-propos",onClick:l,className:({isActive:c})=>`text-lg font-semibold transition-colors ${c?"text-accent-gold":"text-slate-900 border-b border-slate-100 pb-2"}`,children:" propos"}),(u?.role==="admin"||u?.role==="editor")&&a.jsx(ie,{to:"/admin",onClick:l,className:"text-lg font-semibold text-accent-gold border-b border-slate-100 pb-2",children:"Admin Panel"})]}),a.jsx("div",{className:"mt-auto pt-6 border-t border-slate-100 flex flex-col gap-4",children:u?a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx("span",{className:"text-sm text-slate-500 font-medium",children:u.email}),a.jsx("button",{type:"button",onClick:()=>{e(),l()},className:"w-full bg-slate-100 text-slate-900 py-3 rounded-xl font-bold hover:bg-slate-200 transition-colors",children:"Dconnexion"})]}):a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsxs("button",{type:"button",className:"flex items-center justify-center gap-2 text-slate-600 font-bold py-2",children:[a.jsx("span",{className:"material-symbols-outlined",children:"language"}),"FR / AR"]}),a.jsx(ie,{to:"/login",onClick:l,className:"w-full bg-accent-gold text-white text-center py-4 rounded-xl font-bold text-lg shadow-lg shadow-accent-gold/20",children:"Connexion"})]})})]})]})}function n0(){return a.jsxs("footer",{className:"bg-white text-slate-800 pt-20 pb-10 border-t border-slate-200",children:[a.jsxs("div",{className:"max-w-7xl mx-auto px-6 grid grid-cols-1 md:grid-cols-4 gap-12 mb-16",children:[a.jsxs("div",{className:"col-span-1 md:col-span-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("span",{className:"material-symbols-outlined text-accent-gold text-2xl",children:"auto_stories"}),a.jsx("h2",{className:"text-slate-900 text-2xl font-black italic",children:"Tarikh.ma"})]}),a.jsx("p",{className:"text-slate-500 text-sm leading-relaxed mb-6",children:"La plateforme numrique de rfrence ddie  la sauvegarde et  la diffusion du patrimoine documentaire du Royaume du Maroc."}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("a",{href:"#",className:"w-10 h-10 rounded-lg bg-slate-100 flex items-center justify-center hover:bg-accent-gold hover:text-white text-slate-600 transition-colors","aria-label":"Partager",children:a.jsx("span",{className:"material-symbols-outlined text-xl",children:"share"})}),a.jsx("a",{href:"mailto:contact@tarikh.ma",className:"w-10 h-10 rounded-lg bg-slate-100 flex items-center justify-center hover:bg-accent-gold hover:text-white text-slate-600 transition-colors","aria-label":"Email",children:a.jsx("span",{className:"material-symbols-outlined text-xl",children:"mail"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-6 text-accent-gold uppercase tracking-widest text-xs",children:"Explorer"}),a.jsxs("ul",{className:"space-y-4 text-sm text-slate-600",children:[a.jsx("li",{children:a.jsx(ie,{to:"/archives?type=manuscrit",className:"hover:text-slate-900 transition-colors",children:"Manuscrits Rares"})}),a.jsx("li",{children:a.jsx(ie,{to:"/archives?type=carte",className:"hover:text-slate-900 transition-colors",children:"Cartes Historiques"})}),a.jsx("li",{children:a.jsx(ie,{to:"/archives?type=photo",className:"hover:text-slate-900 transition-colors",children:"Photothque"})}),a.jsx("li",{children:a.jsx("a",{href:"#",className:"hover:text-slate-900 transition-colors",children:"Gnalogies"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-6 text-accent-gold uppercase tracking-widest text-xs",children:"l'Hritage de platforme"}),a.jsxs("ul",{className:"space-y-4 text-sm text-slate-600",children:[a.jsx("li",{children:a.jsx("a",{href:"#epoques",className:"hover:text-slate-900 transition-colors",children:"re Idriside"})}),a.jsx("li",{children:a.jsx("a",{href:"#epoques",className:"hover:text-slate-900 transition-colors",children:"Dynastie Almohade"})}),a.jsx("li",{children:a.jsx("a",{href:"#epoques",className:"hover:text-slate-900 transition-colors",children:"Rgne Saadien"})}),a.jsx("li",{children:a.jsx("a",{href:"#epoques",className:"hover:text-slate-900 transition-colors",children:"Archives Alaouites"})})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold mb-6 text-accent-gold uppercase tracking-widest text-xs",children:"Newsletter"}),a.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Recevez les nouveaux trsors numriss directement par email."}),a.jsxs("form",{className:"flex gap-2",onSubmit:u=>u.preventDefault(),children:[a.jsx("input",{type:"email",placeholder:"votre@email.com",className:"flex-1 bg-slate-50 border border-slate-200 rounded-lg text-xs text-slate-800 placeholder:text-slate-400 px-3 py-2 focus:ring-accent-gold focus:border-accent-gold outline-none"}),a.jsx("button",{type:"submit",className:"bg-accent-gold px-4 py-2 rounded-lg text-xs font-bold text-white hover:brightness-110 transition-all",children:"Ok"})]})]})]}),a.jsxs("div",{className:"max-w-7xl mx-auto px-6 pt-10 border-t border-slate-200 flex flex-col md:flex-row justify-between items-center gap-4",children:[a.jsxs("p",{className:"text-[10px] text-slate-400 uppercase tracking-widest text-center md:text-left",children:[" ",new Date().getFullYear()," Tarikh.ma - Tous droits rserv. Developped by ArtgonMEDIA"]}),a.jsxs("div",{className:"flex gap-8 text-[10px] text-slate-400 uppercase tracking-widest",children:[a.jsx("a",{href:"#",className:"hover:text-accent-gold transition-colors",children:"Mentions Lgales"}),a.jsx("a",{href:"#",className:"hover:text-accent-gold transition-colors",children:"Confidentialit"}),a.jsx("a",{href:"#",className:"hover:text-accent-gold transition-colors",children:"Partenariats"})]})]})]})}function i0(){return a.jsxs("div",{className:"min-h-screen flex flex-col",children:[a.jsx(s0,{}),a.jsx("main",{className:"flex-1 bg-white",children:a.jsx(Qa,{})}),a.jsx(n0,{})]})}function r0(){return a.jsx("div",{className:"min-h-screen h-screen bg-white font-display text-slate-900 flex flex-col overflow-hidden",children:a.jsx("div",{className:"flex-1 flex flex-col min-h-0 w-full",children:a.jsx(Qa,{})})})}function a0(){const u=Ut(l=>l.user),e=Ut(l=>l.logout),t=cs();if(E.useEffect(()=>{u?u.role!=="admin"&&u.role!=="editor"&&t("/",{replace:!0}):t("/login",{replace:!0})},[u,t]),!u||u.role!=="admin"&&u.role!=="editor")return null;const i=u.name?.split(/\s+/).map(l=>l[0]).join(". ")||u.email?.slice(0,2).toUpperCase()||"Admin",r=u.role==="admin"?"Super Admin":"diteur";return a.jsxs("div",{className:"flex h-screen overflow-hidden bg-admin-bg text-slate-900",children:[a.jsxs("aside",{className:"w-64 flex-shrink-0 border-r border-slate-200 bg-white hidden lg:flex flex-col",children:[a.jsxs("div",{className:"p-6 flex items-center gap-3",children:[a.jsx("div",{className:"bg-admin-primary rounded-lg p-2 text-white",children:a.jsx("span",{className:"material-symbols-outlined",children:"history_edu"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-sm font-bold leading-tight",children:u.role==="admin"?"Tarikh.ma Admin":"Tarikh.ma Contributeur"}),a.jsx("p",{className:"text-[11px] text-slate-500 uppercase tracking-wider font-semibold",children:u.role==="admin"?"Portail Analytique":"Espace de Publication"})]})]}),a.jsxs("nav",{className:"flex-1 px-4 space-y-2 mt-4",children:[a.jsxs(ft,{to:"/admin",end:!0,className:({isActive:l})=>`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${l?"bg-admin-primary/10 text-admin-primary":"text-slate-600 hover:bg-slate-100"}`,children:[a.jsx("span",{className:"material-symbols-outlined",children:"dashboard"}),a.jsx("span",{className:"text-sm font-medium",children:"Tableau de bord"})]}),a.jsxs(ft,{to:"/admin",end:!0,className:({isActive:l})=>`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${l?"bg-admin-primary/10 text-admin-primary":"text-slate-600 hover:bg-slate-100"}`,children:[a.jsx("span",{className:"material-symbols-outlined",style:{fontVariationSettings:'"FILL" 1'},children:"monitoring"}),a.jsx("span",{className:"text-sm font-semibold",children:"Analytiques"})]}),a.jsxs(ft,{to:"/admin/documents",className:({isActive:l})=>`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${l?"bg-admin-primary/10 text-admin-primary":"text-slate-600 hover:bg-slate-100"}`,children:[a.jsx("span",{className:"material-symbols-outlined",children:"description"}),a.jsx("span",{className:"text-sm font-medium",children:"Documents"})]}),u.role==="admin"&&a.jsxs(a.Fragment,{children:[a.jsxs(ft,{to:"/admin/articles",className:({isActive:l})=>`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${l?"bg-admin-primary/10 text-admin-primary":"text-slate-600 hover:bg-slate-100"}`,children:[a.jsx("span",{className:"material-symbols-outlined",children:"article"}),a.jsx("span",{className:"text-sm font-medium",children:"Articles"})]}),a.jsxs(ft,{to:"/admin/banners",className:({isActive:l})=>`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${l?"bg-admin-primary/10 text-admin-primary":"text-slate-600 hover:bg-slate-100"}`,children:[a.jsx("span",{className:"material-symbols-outlined",children:"ads_click"}),a.jsx("span",{className:"text-sm font-medium",children:"Bannires"})]}),a.jsxs(ft,{to:"/admin/users",className:({isActive:l})=>`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${l?"bg-admin-primary/10 text-admin-primary":"text-slate-600 hover:bg-slate-100"}`,children:[a.jsx("span",{className:"material-symbols-outlined",children:"group"}),a.jsx("span",{className:"text-sm font-medium",children:"Utilisateurs"})]})]}),a.jsxs("div",{className:"pt-4 border-t border-slate-100 mt-4",children:[a.jsx("p",{className:"px-3 text-[10px] font-bold text-slate-400 uppercase mb-2",children:"Support & Admin"}),u.role==="admin"?a.jsxs(ft,{to:"/admin/parametres",className:({isActive:l})=>`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${l?"bg-admin-primary/10 text-admin-primary":"text-slate-600 hover:bg-slate-100"}`,children:[a.jsx("span",{className:"material-symbols-outlined",children:"settings"}),a.jsx("span",{className:"text-sm font-medium",children:"Paramtres"})]}):a.jsxs("div",{className:"flex items-center gap-3 px-3 py-2 text-slate-400 cursor-not-allowed",children:[a.jsx("span",{className:"material-symbols-outlined",children:"help"}),a.jsx("span",{className:"text-sm font-medium",children:"Aide & Guide"})]})]})]}),a.jsxs("div",{className:"p-4 border-t border-slate-100",children:[a.jsxs("div",{className:"flex items-center gap-3 p-2 bg-slate-50 rounded-xl",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-300 flex items-center justify-center text-slate-600 text-sm font-bold overflow-hidden",children:i.slice(0,2)}),a.jsxs("div",{className:"flex-1 overflow-hidden",children:[a.jsx("p",{className:"text-xs font-bold truncate",children:u.name||u.email}),a.jsx("p",{className:"text-[10px] text-admin-primary font-semibold truncate",children:r})]})]}),a.jsx("button",{type:"button",onClick:()=>e(),className:"mt-2 w-full text-xs text-slate-500 hover:text-slate-700",children:"Dconnexion"})]})]}),a.jsx("main",{className:"flex-1 overflow-y-auto scroll-smooth",children:a.jsx(Qa,{})})]})}function l0(){const u=Ut(i=>i.user),e=Ut(i=>i.logout),t=cs();return E.useEffect(()=>{u||t("/login",{replace:!0})},[u,t]),u?a.jsxs("div",{className:"min-h-screen bg-slate-50",children:[a.jsx("header",{className:"bg-white border-b border-slate-200 px-6 py-4",children:a.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs(ft,{to:"/",className:"flex items-center gap-2 text-slate-900 hover:text-accent-gold transition-colors",children:[a.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"}),a.jsx("span",{className:"text-sm font-medium",children:"Retour au site"})]}),a.jsx("span",{className:"text-slate-300",children:"|"}),a.jsx("h1",{className:"text-lg font-bold text-slate-900",children:"Mon Espace"})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("span",{className:"text-sm text-slate-500",children:u.name||u.email}),a.jsx("button",{type:"button",onClick:()=>e(),className:"text-sm text-slate-500 hover:text-accent-gold transition-colors",children:"Dconnexion"})]})]})}),a.jsxs("div",{className:"max-w-7xl mx-auto flex gap-8 p-6",children:[a.jsx("aside",{className:"w-64 flex-shrink-0",children:a.jsxs("nav",{className:"bg-white rounded-2xl border border-slate-200 p-4 space-y-2 sticky top-24",children:[a.jsxs(ft,{to:"/dashboard",end:!0,className:({isActive:i})=>`flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${i?"bg-accent-gold/10 text-accent-gold font-bold":"text-slate-600 hover:bg-slate-50"}`,children:[a.jsx("span",{className:"material-symbols-outlined text-xl",children:"dashboard"}),a.jsx("span",{className:"text-sm",children:"Tableau de bord"})]}),a.jsxs(ft,{to:"/dashboard/articles",className:({isActive:i})=>`flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${i?"bg-accent-gold/10 text-accent-gold font-bold":"text-slate-600 hover:bg-slate-50"}`,children:[a.jsx("span",{className:"material-symbols-outlined text-xl",children:"article"}),a.jsx("span",{className:"text-sm",children:"Mes articles"})]}),a.jsxs(ft,{to:"/dashboard/articles/new",className:({isActive:i})=>`flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${i?"bg-accent-gold/10 text-accent-gold font-bold":"text-slate-600 hover:bg-slate-50"}`,children:[a.jsx("span",{className:"material-symbols-outlined text-xl",children:"edit_note"}),a.jsx("span",{className:"text-sm",children:"Rdiger un article"})]}),a.jsxs("div",{className:"pt-4 mt-4 border-t border-slate-100",children:[a.jsx("p",{className:"px-4 text-[10px] font-bold text-slate-400 uppercase mb-2",children:"Aide"}),a.jsxs("a",{href:"#",className:"flex items-center gap-3 px-4 py-3 rounded-xl text-slate-500 hover:bg-slate-50 transition-all",children:[a.jsx("span",{className:"material-symbols-outlined text-xl",children:"help"}),a.jsx("span",{className:"text-sm",children:"Guide de rdaction"})]})]})]})}),a.jsx("main",{className:"flex-1 min-w-0",children:a.jsx(Qa,{})})]})]}):null}const o0="https://lh3.googleusercontent.com/aida-public/AB6AXuBpIX9eFdB_PDh8VX_XwGjMSnshbOdlEt_5DyZZTzLhWCu14dvdgOfYRVHufwRim5HWN-y5zws2t_cehuoOgq8wbPGmbFt0MiSYdskfKDVjfyDnjHab714Df_83fOcvuf1-aFvJf3SF8i-LTMyjeRU9QNdkAz76uFM2RfX9-kCpBN2IZ2rc3bcaaum0R0-rYZtIJ2HZ0l4Fqzj5DJBkkYXeqxZN5cLU-zySzFI1G7niZ0Xs3-fUUUrMkBwjFTFdQY4XJrC_3-Wn6__B",c0=[{title:"Livres",description:"Ouvrages historiques et recueils littraires du patrimoine national.",icon:"library_books",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuBITFIPrXlrK_sX4lzqs74yHeyyg_ir4qWIb-0yMHo8UhqWcnpM4F_mWn1ZPWA5wMPRNvlfqGS_8u7IekgzfxGgdU5tYOx9LEXDSFzZesVBvxOrr34Cgzd7EStCxoqfZQ7CvqZ7yGKQBcoacGj09vrLW5hJ-x4SZnJBMzVfQJCcGkYFvtGiDGCMLcy4XBhDNT3YTEDBdPTwask6uOJFQQ_ioDkzV51u8Vygi0YlcHy2NDF3gU8ipR5OAXOJbwUti5X_JlUQf6MPBeHe",to:"/archives?type=livre"},{title:"Manuscrits",description:"Traits, dahirs et crits originaux  la plume.",icon:"menu_book",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuC7IYapK4EGetsL_RnTQwBUvwHL5a5B-qIjLOumYxyvWjE_JDl8rKzx0dljC3v_BkCs65Rw12yGxvrpqcboQPdZBp1UBYiBubcOz-u_hPBp5BH3_Wem9xWRsBv8U0oSLvoRsKfrvQuiiGJ-4F1EibEogb5Hz0KscEJNDk_XBa49-ZG0r32EVY6CaCk0QQ7m19zWjd1N3YWPOpVdHluSJUdvBh6OwEpxH29OtKX9Qp5cgNPFomhLOhMFF53VZ9nKHx_elUkIMOIKfj3x",to:"/archives?type=pdf"},{title:"Vidos",description:"Archives cinmatographiques et tmoignages visuels du pass.",icon:"videocam",image:"https://images.unsplash.com/photo-1485846234645-a62644f84728?auto=format&fit=crop&q=80&w=800",to:"/archives?type=video"},{title:"Cartes",description:"Plans anciens et cartographie de l'volution du Royaume.",icon:"map",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuBNl4A1QMa3XiOj2YLC-rPfz3YGjhDuA6IYuV5v53NFIlqTEWoPDZYS3lT2mHqFbLTApk3qZQbYlpCew2T6tfoDZrzBB5nw7_8M9_O3TQZOHBHt4nf6oy16c4rbNVxn6gslN5IJn-j5v9W6MT0YGi0tI6WIZPI0c8hi-mR5qplyULQ8vXlDJTv1BSR7Qqocc1Yh7lnq5ZOFU8MsH3fQlusRFJk2Iug6oEKsm0FACTJOL2hIC-3VG0CXpjTM5-lQOFZBJ3UpbHutM2OL",to:"/archives?type=carte"},{title:"Photos",description:"Clichs historiques et gravures d'poque.",icon:"photo_library",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuAhELtUk_EWB0svCP1CPN5I7_GjmSkaruom8rn-0NGIC9XWgHPHbmHNweG07Eh_bDyo1_iHvXNb47cJWohcfMM5SFh0ZyaMQcG76trgeHe7vPXj-pBxlsLBmABAFgjS0Ut1E7Qj7aJqk-zn2jcDtK51e8vwc7BBAz6doa3krqxYLN_WawebcbKvsNVhyGNr_W0U9wqvmjuDtNbX9M4zPBPZcyEtYyKPsi-baMAJLyk2lY05y7BlU7xrLrkeBdAzRrj4oNa88HjxG8hO",to:"/archives?type=image"},{title:"Articles",description:"Presse d'poque et analyses historiques.",icon:"article",image:"https://images.unsplash.com/photo-1504711434969-e33886168f5c?auto=format&fit=crop&q=80&w=800",to:"/archives?type=article"}];function d0(){const u=cs(),[e,t]=E.useState(""),[i,r]=E.useState([]),[l,c]=E.useState(!0),[d,f]=E.useState([]),[p,m]=E.useState(!0),[x,b]=E.useState([]);E.useEffect(()=>{Ha.list({per_page:6,page:1}).then(S=>r(S.data)).catch(S=>console.error("Erreur chargement archives:",S)).finally(()=>c(!1)),Ha.list({per_page:4,is_rare:!0}).then(S=>f(S.data)).catch(S=>console.error("Erreur chargement documents rares:",S)).finally(()=>m(!1)),t0.list().then(b).catch(S=>console.error("Erreur chargement bannires:",S))},[]);const w=E.useRef(null),y=E.useRef(null),[N,_]=E.useState(!1);E.useEffect(()=>{const S=setInterval(()=>{if(w.current){const{scrollLeft:P,offsetWidth:k,scrollWidth:L}=w.current;P+k>=L-10?w.current.scrollTo({left:0,behavior:"smooth"}):w.current.scrollBy({left:k/3,behavior:"smooth"})}},5e3);return()=>clearInterval(S)},[]),E.useEffect(()=>{if(N)return;const S=setInterval(()=>{if(y.current){const{scrollLeft:P,offsetWidth:k,scrollWidth:L}=y.current,T=window.innerWidth>=1024?k/3:window.innerWidth>=768?k/2:k;P+k>=L-10?y.current.scrollTo({left:0,behavior:"smooth"}):y.current.scrollBy({left:T,behavior:"smooth"})}},4e3);return()=>clearInterval(S)},[N,i.length]);const j=S=>{S.preventDefault(),e.trim()?u(`/archives?q=${encodeURIComponent(e.trim())}`):u("/archives")};return a.jsxs(a.Fragment,{children:[a.jsxs("section",{className:"relative min-h-[95vh] md:min-h-screen flex items-center justify-center pt-24 pb-12 overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 z-0",children:[a.jsx("div",{className:"absolute inset-0 hero-gradient z-10"}),a.jsx("img",{src:o0,alt:"Patrimoine manuscrit marocain",className:"w-full h-full object-cover"})]}),a.jsxs("div",{className:"relative z-20 max-w-5xl px-6 text-center",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-accent-gold/20 border border-accent-gold/30 text-accent-gold text-[10px] md:text-xs font-bold uppercase tracking-[0.2em] mb-8 animate-fade-in",children:[a.jsx("span",{className:"material-symbols-outlined text-sm",children:"verified"}),"Patrimoine National Numris"]}),a.jsxs("h1",{className:"text-white text-6xl md:text-8xl lg:text-9xl font-black leading-[1.05] mb-8 tracking-tighter vintage-text-shadow serif",children:["Prserver l'Histoire, ",a.jsx("br",{}),a.jsx("span",{className:"text-accent-gold italic",children:"clairer l'Avenir"})]}),a.jsx("p",{className:"text-parchment/90 text-xl md:text-2xl font-light mb-12 max-w-3xl mx-auto leading-relaxed serif underline decoration-accent-gold/20 decoration-1 underline-offset-[12px]",children:"Explorez les archives impriales du Royaume. Une collection unique de manuscrits rares, traits sculaires et photographies d'poque."}),a.jsxs("div",{className:"relative max-w-2xl mx-auto",children:[a.jsxs("form",{onSubmit:j,className:"flex flex-col md:flex-row items-center bg-black/30 backdrop-blur-xl border border-white/10 p-2 rounded-xl gap-2 shadow-2xl",children:[a.jsxs("div",{className:"flex flex-1 items-center px-4 gap-3 w-full",children:[a.jsx("span",{className:"material-symbols-outlined text-accent-gold",children:"search"}),a.jsx("input",{type:"text",value:e,onChange:S=>t(S.target.value),placeholder:"Rechercher un manuscrit, une ville, une dynastie...",className:"w-full bg-transparent border-none text-white placeholder:text-white/40 focus:ring-0 text-base py-3 outline-none"})]}),a.jsx("button",{type:"submit",className:"w-full md:w-auto bg-accent-gold hover:bg-yellow-700 text-background-dark font-black px-8 py-3 rounded-lg transition-all flex items-center justify-center gap-2 uppercase tracking-tighter",children:"Explorer"})]}),a.jsxs("div",{className:"mt-4 flex flex-wrap justify-center gap-4 text-parchment/60 text-xs",children:[a.jsx("span",{children:"Tendances :"}),a.jsx(ie,{to:"/archives?q=almohades",className:"hover:text-accent-gold transition-colors underline decoration-accent-gold/40",children:"Manuscrits Almohades"}),a.jsx(ie,{to:"/archives?q=Fs",className:"hover:text-accent-gold transition-colors underline decoration-accent-gold/40",children:"Cartographie de Fs"}),a.jsx(ie,{to:"/archives?q=traits",className:"hover:text-accent-gold transition-colors underline decoration-accent-gold/40",children:"Traits diplomatiques"})]})]})]}),a.jsx("div",{className:"absolute bottom-0 left-0 w-full h-32 bg-gradient-to-t from-background-dark to-transparent pointer-events-none"})]}),x.length>0&&a.jsx("section",{className:"bg-background-light py-8 px-6 border-b border-slate-100",children:a.jsx("div",{className:"max-w-7xl mx-auto",children:a.jsx("div",{className:"flex gap-6 overflow-x-auto scrollbar-hide snap-x snap-mandatory",children:x.map(S=>a.jsxs("a",{href:S.link_url||"#",target:S.link_url?"_blank":void 0,rel:"noopener noreferrer",className:"min-w-full md:min-w-[800px] lg:min-w-full h-32 md:h-48 rounded-2xl overflow-hidden snap-center block relative group border-2 border-accent-gold/5 hover:border-accent-gold/20 transition-all shadow-lg hover:shadow-xl",children:[a.jsx("img",{src:S.image_url,alt:S.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-1000"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black/40 via-transparent to-transparent flex items-center p-8 md:p-12",children:a.jsx("div",{className:"max-w-xl",children:a.jsx("h3",{className:"text-white text-xl md:text-3xl font-black serif drop-shadow-lg group-hover:translate-x-2 transition-transform",children:S.title})})}),S.link_url&&a.jsxs("div",{className:"absolute bottom-4 right-8 bg-white/20 backdrop-blur-md px-4 py-2 rounded-full text-white text-xs font-bold flex items-center gap-2 group-hover:bg-white group-hover:text-primary transition-all",children:["En savoir plus ",a.jsx("span",{className:"material-symbols-outlined text-sm",children:"open_in_new"})]})]},S.id))})})}),a.jsx("section",{className:"py-24 px-6 bg-parchment paper-texture zellij-pattern",id:"categories",children:a.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end mb-12 gap-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-black text-slate-900 mb-2 italic serif",children:"Explorer l'Hritage"}),a.jsx("div",{className:"h-1.5 w-24 bg-accent-gold rounded-full"})]}),a.jsxs(ie,{to:"/archives",className:"text-accent-gold font-bold flex items-center gap-1 hover:gap-2 transition-all",children:["Consulter les manuscrits ",a.jsx("span",{className:"material-symbols-outlined",children:"arrow_forward"})]})]}),a.jsx("div",{ref:w,className:"flex gap-8 overflow-x-auto pb-4 scrollbar-hide snap-x snap-mandatory touch-scroll",children:c0.map(S=>a.jsxs(ie,{to:S.to,className:"group relative overflow-hidden rounded-2xl aspect-[3/2] cursor-pointer block border-4 border-white shadow-xl shadow-accent-gold/10 flex-shrink-0 w-full sm:w-[calc(50%-1rem)] lg:w-[calc(33.333%-1.33rem)] snap-center",children:[a.jsx("img",{src:S.image,alt:"",className:"absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-100/95 via-slate-50/70 to-transparent opacity-100 transition-opacity duration-500 group-hover:from-slate-200/95"}),a.jsxs("div",{className:"absolute bottom-0 p-6",children:[a.jsx("span",{className:"material-symbols-outlined text-accent-gold text-3xl mb-2 block",children:S.icon}),a.jsx("h3",{className:"text-slate-900 text-xl font-bold mb-1 serif",children:S.title}),a.jsx("p",{className:"text-slate-600 text-xs leading-relaxed opacity-0 group-hover:opacity-100 transition-all duration-500 line-clamp-2",children:S.description})]}),a.jsx("div",{className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx("span",{className:"bg-white/20 backdrop-blur-md p-2 rounded-full text-white material-symbols-outlined text-sm",children:"north_east"})})]},S.title))})]})}),a.jsx("section",{className:"py-24 bg-white overflow-hidden border-t border-slate-100 relative",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-6 relative z-10",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end mb-12 gap-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-slate-900 text-3xl md:text-5xl font-black mb-3 italic serif",children:"Trsors Rcents"}),a.jsx("div",{className:"h-1.5 w-24 bg-accent-gold rounded-full mb-4"}),a.jsx("p",{className:"text-slate-500 serif",children:"Les dernires numrisations ajoutes aux Archives Nationales."})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>{if(y.current){const S=window.innerWidth>=1024?y.current.offsetWidth/3:y.current.offsetWidth;y.current.scrollBy({left:-S,behavior:"smooth"})}},className:"w-12 h-12 rounded-full border border-accent-gold/20 flex items-center justify-center text-accent-gold hover:bg-accent-gold hover:text-white transition-all",children:a.jsx("span",{className:"material-symbols-outlined",children:"chevron_left"})}),a.jsx("button",{onClick:()=>{if(y.current){const S=window.innerWidth>=1024?y.current.offsetWidth/3:y.current.offsetWidth;y.current.scrollBy({left:S,behavior:"smooth"})}},className:"w-12 h-12 rounded-full border border-accent-gold/20 flex items-center justify-center text-accent-gold hover:bg-accent-gold hover:text-white transition-all",children:a.jsx("span",{className:"material-symbols-outlined",children:"chevron_right"})})]}),a.jsxs(ie,{to:"/archives",className:"text-accent-gold font-bold flex items-center gap-2 hover:gap-3 transition-all group hidden sm:flex",children:["Voir tout ",a.jsx("span",{className:"material-symbols-outlined group-hover:translate-x-1 transition-transform",children:"arrow_forward"})]})]})]}),l?a.jsx("div",{className:"flex gap-6 overflow-hidden",children:[1,2,3].map(S=>a.jsx("div",{className:"w-full sm:w-[calc(50%-0.75rem)] lg:w-[calc(33.333%-1rem)] h-80 bg-slate-100 animate-pulse rounded-2xl flex-shrink-0"},S))}):a.jsx("div",{className:"relative group/carousel",children:a.jsx("div",{ref:y,onMouseEnter:()=>_(!0),onMouseLeave:()=>_(!1),className:"flex gap-6 overflow-x-auto pb-12 scrollbar-hide touch-scroll snap-x snap-mandatory",children:i.map(S=>a.jsxs(ie,{to:`/documents/${S.id}`,className:"w-full sm:w-[calc(50%-0.75rem)] lg:w-[calc(33.333%-1rem)] bg-parchment/30 border border-accent-gold/10 rounded-2xl overflow-hidden hover:shadow-2xl hover:shadow-accent-gold/5 transition-all group flex-shrink-0 relative snap-center flex flex-col",children:[a.jsxs("div",{className:"h-64 overflow-hidden relative",children:[S.thumbnail_url?a.jsx("img",{src:S.thumbnail_url,alt:S.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700"}):a.jsx("div",{className:"w-full h-full bg-parchment flex items-center justify-center",children:a.jsx("span",{className:"material-symbols-outlined text-accent-gold/30 text-7xl",children:"folded_paper"})}),a.jsx("div",{className:"absolute top-4 right-4 bg-white/80 backdrop-blur-md px-3 py-1 rounded-full text-[10px] font-black text-accent-gold uppercase border border-accent-gold/10",children:S.type})]}),a.jsxs("div",{className:"p-8",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx("span",{className:"text-accent-gold material-symbols-outlined text-sm",children:"calendar_today"}),a.jsx("span",{className:"text-slate-500 text-xs font-medium",children:S.year||"Anne inconnue"}),a.jsx("span",{className:"h-1 w-1 rounded-full bg-slate-300 mx-1"}),a.jsx("span",{className:"text-slate-500 text-xs font-medium",children:S.region?.name||"Royaume"})]}),a.jsx("h4",{className:"text-slate-900 text-xl font-bold mb-3 group-hover:text-accent-gold transition-colors serif line-clamp-2 leading-tight",children:S.title}),a.jsx("p",{className:"text-slate-500 text-sm leading-relaxed line-clamp-3 mb-6 font-medium italic serif",children:S.description||"Une pice historique d'une importance capitale pour la comprhension de l'volution structurelle et culturelle du Royaume."}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-accent-gold/5 mt-auto",children:[a.jsxs("span",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest",children:[S.views_count," vues"]}),a.jsxs("div",{className:"flex items-center gap-2 text-accent-gold text-xs font-black uppercase tracking-tighter group-hover:gap-3 transition-all",children:["Lire la suite ",a.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_forward"})]})]})]})]},S.id))})})]})}),a.jsx("section",{className:"py-24 px-6 bg-background-light border-t border-slate-100",id:"rare-documents",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-16",children:[a.jsxs("h2",{className:"text-slate-900 text-4xl md:text-6xl font-black mb-4 italic serif uppercase tracking-tighter",children:["Documents ",a.jsx("span",{className:"text-accent-gold",children:"Rare"})]}),a.jsx("div",{className:"h-1.5 w-32 bg-accent-gold mx-auto rounded-full mb-6"}),a.jsx("p",{className:"text-slate-500 max-w-2xl mx-auto text-lg serif italic",children:"Une slection exclusive des pices les plus prcieuses de notre patrimoine national."})]}),p?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[1,2,3,4].map(S=>a.jsx("div",{className:"aspect-[3/4] bg-slate-100 animate-pulse rounded-2xl"},S))}):d.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:d.map(S=>a.jsxs(ie,{to:`/documents/${S.id}`,className:"group relative aspect-[3/4] rounded-2xl overflow-hidden border border-accent-gold/20 shadow-xl hover:shadow-2xl transition-all duration-500",children:[a.jsx("img",{src:S.thumbnail_url||"/placeholder-archive.jpg",alt:S.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent opacity-80 group-hover:opacity-90 transition-opacity"}),a.jsx("div",{className:"absolute inset-0 p-6 flex flex-col justify-end",children:a.jsxs("div",{className:"translate-y-4 group-hover:translate-y-0 transition-transform duration-500",children:[a.jsxs("span",{className:"text-accent-gold text-[10px] font-bold uppercase tracking-widest mb-2 block border-l-2 border-accent-gold pl-2",children:[S.type,"  ",S.year||"poque Royale"]}),a.jsx("h3",{className:"text-white text-xl font-bold serif mb-3 leading-tight leading-clamp-2",children:S.title}),a.jsxs("div",{className:"flex items-center gap-2 text-parchment/60 text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-500 delay-100",children:[a.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"visibility"}),a.jsx("span",{children:"Consulter ce trsor"})]})]})}),a.jsx("div",{className:"absolute top-4 right-4 bg-accent-gold text-background-dark p-2 rounded-full shadow-lg scale-0 group-hover:scale-100 transition-transform duration-500",children:a.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"star"})})]},S.id))}):a.jsxs("div",{className:"text-center py-20 bg-parchment/30 rounded-3xl border-2 border-dashed border-accent-gold/10",children:[a.jsx("span",{className:"material-symbols-outlined text-accent-gold/20 text-6xl mb-4",children:"auto_stories"}),a.jsx("p",{className:"text-slate-400 serif italic",children:"Bientt, dcouvrez ici nos plus rares manuscrits..."})]})]})})]})}function u0(){return a.jsxs("div",{className:"relative flex flex-col overflow-x-hidden bg-white",children:[a.jsxs("section",{className:"relative h-[420px] sm:h-[500px] flex items-center justify-center overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 z-0",children:[a.jsx("img",{alt:"Bibliothque historique",className:"w-full h-full object-cover opacity-20 grayscale brightness-75",src:"https://lh3.googleusercontent.com/aida-public/AB6AXuAMAiUkLX4Ef90560Doe2G93v3yek3cb0Ui2NXaou2ZmdA-JaRLKqN5iQj6K-JouT3lxAWl4qKtnZ3GwYkE2gjjn6fLtK2dH3DcTrf0fizOeK2eCS5zaJNyb5DBiCCJTGNHdxfoMHjh4eINssVYHRipFMpN4S6OJu6Kgl6gEqp2_NgSPr6RsgULGJdGlK3z240igcdNUF-FjAZow4CjH_efTaMRC6qffLZdfHnmZ0V0lgRG-JqWqCGxVHkpLE9bmeP3Mzm_dgybSmPu"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent to-white"})]}),a.jsxs("div",{className:"relative z-10 max-w-4xl px-6 text-center",children:[a.jsx("span",{className:"inline-block px-4 py-1.5 rounded-full bg-accent-gold/10 text-accent-gold font-bold text-[10px] uppercase tracking-[0.2em] mb-6",children:"Institutionnel"}),a.jsxs("h1",{className:"text-4xl sm:text-5xl md:text-7xl font-black mb-6 leading-[1.1] tracking-tight text-slate-900",children:["Notre Mission : ",a.jsx("br",{}),a.jsx("span",{className:"text-accent-gold italic font-serif",children:"Porter l'Hritage"})]}),a.jsx("p",{className:"text-lg sm:text-xl text-slate-600 max-w-2xl mx-auto leading-relaxed",children:"Tarikh.ma est la sentinelle numrique du patrimoine marocain. Nous uvrons pour que chaque manuscrit, chaque carte et chaque rcit trouve sa place dans la mmoire du futur."})]})]}),a.jsx("section",{className:"max-w-7xl mx-auto px-6 sm:px-10 py-16 sm:py-24 bg-white",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 sm:gap-8",children:[a.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow group",children:[a.jsx("div",{className:"w-12 h-12 bg-accent-gold/10 rounded-lg flex items-center justify-center text-accent-gold mb-6 group-hover:bg-accent-gold group-hover:text-white transition-colors",children:a.jsx("span",{className:"material-symbols-outlined",children:"hub"})}),a.jsx("h3",{className:"font-bold text-xl mb-3 text-slate-900",children:"Centralisation"}),a.jsx("p",{className:"text-slate-500 text-sm leading-relaxed",children:"Unification des archives disperses pour crer un corpus national cohrent et accessible."})]}),a.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow group",children:[a.jsx("div",{className:"w-12 h-12 bg-accent-gold/10 rounded-lg flex items-center justify-center text-accent-gold mb-6 group-hover:bg-accent-gold group-hover:text-white transition-colors",children:a.jsx("span",{className:"material-symbols-outlined",children:"public"})}),a.jsx("h3",{className:"font-bold text-xl mb-3 text-slate-900",children:"Accessibilit"}),a.jsx("p",{className:"text-slate-500 text-sm leading-relaxed",children:"Dmocratisation du savoir historique pour les chercheurs, les tudiants et les curieux du monde entier."})]}),a.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow group",children:[a.jsx("div",{className:"w-12 h-12 bg-accent-gold/10 rounded-lg flex items-center justify-center text-accent-gold mb-6 group-hover:bg-accent-gold group-hover:text-white transition-colors",children:a.jsx("span",{className:"material-symbols-outlined",children:"devices"})}),a.jsx("h3",{className:"font-bold text-xl mb-3 text-slate-900",children:"Exprience Moderne"}),a.jsx("p",{className:"text-slate-500 text-sm leading-relaxed",children:"Interfaces intuitives et outils de visualisation avancs pour une exploration fluide de l'histoire."})]}),a.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow group",children:[a.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center text-primary mb-6 group-hover:bg-primary group-hover:text-white transition-colors",children:a.jsx("span",{className:"material-symbols-outlined",children:"encrypted"})}),a.jsx("h3",{className:"font-bold text-xl mb-3 text-slate-900",children:"Scurit"}),a.jsx("p",{className:"text-slate-500 text-sm leading-relaxed",children:"Protection cryptographique et prennit numrique des documents sensibles et rares."})]})]})}),a.jsx("section",{className:"bg-parchment sm:bg-slate-50/80 py-16 sm:py-24 px-6 sm:px-10",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-14 sm:mb-20",children:[a.jsx("h2",{className:"text-3xl font-black mb-4 text-slate-900 italic serif",children:"Gense du Projet"}),a.jsx("div",{className:"w-16 h-1.5 bg-accent-gold mx-auto rounded-full"})]}),a.jsxs("div",{className:"relative space-y-12 sm:space-y-16",children:[a.jsx("div",{className:"absolute left-8 top-0 bottom-0 w-0.5 bg-slate-200 timeline-line"}),a.jsxs("div",{className:"relative flex items-start gap-8 sm:gap-12 group",children:[a.jsx("div",{className:"z-10 flex items-center justify-center w-16 h-16 rounded-full bg-accent-gold text-white shadow-lg ring-8 ring-white sm:ring-slate-50 transition-transform group-hover:scale-110",children:a.jsx("span",{className:"material-symbols-outlined text-2xl",children:"lightbulb"})}),a.jsxs("div",{className:"pt-2 min-w-0",children:[a.jsx("span",{className:"text-accent-gold font-black text-sm uppercase tracking-tighter",children:"2021  Phase d'tude"}),a.jsx("h4",{className:"text-xl font-bold mt-1 mb-3 text-slate-900",children:"closion de la vision"}),a.jsx("p",{className:"text-slate-600 leading-relaxed",children:"Une quipe pluridisciplinaire d'historiens, d'archivistes et d'ingnieurs se runit pour dfinir les standards de numrisation du patrimoine marocain."})]})]}),a.jsxs("div",{className:"relative flex items-start gap-8 sm:gap-12 group",children:[a.jsx("div",{className:"z-10 flex items-center justify-center w-16 h-16 rounded-full bg-white text-accent-gold border-4 border-accent-gold shadow-lg ring-8 ring-white sm:ring-slate-50 transition-transform group-hover:scale-110",children:a.jsx("span",{className:"material-symbols-outlined text-2xl",children:"handshake"})}),a.jsxs("div",{className:"pt-2 min-w-0",children:[a.jsx("span",{className:"text-accent-gold font-black text-sm uppercase tracking-tighter",children:"2022  Alliances Stratgiques"}),a.jsx("h4",{className:"text-xl font-bold mt-1 mb-3 text-slate-900",children:"Partenariats Institutionnels"}),a.jsx("p",{className:"text-slate-600 leading-relaxed",children:"Signature d'accords historiques avec les Archives Nationales et les bibliothques universitaires pour centraliser plus de 500000 documents rares."})]})]}),a.jsxs("div",{className:"relative flex items-start gap-8 sm:gap-12 group",children:[a.jsx("div",{className:"z-10 flex items-center justify-center w-16 h-16 rounded-full bg-primary text-white shadow-lg ring-8 ring-white sm:ring-parchment transition-transform group-hover:scale-110",children:a.jsx("span",{className:"material-symbols-outlined text-2xl",children:"rocket_launch"})}),a.jsxs("div",{className:"pt-2 min-w-0",children:[a.jsx("span",{className:"text-primary font-black text-sm uppercase tracking-tighter",children:"2023  Dploiement"}),a.jsx("h4",{className:"text-xl font-bold mt-1 mb-3 text-slate-900",children:"Lancement de la plateforme"}),a.jsx("p",{className:"text-slate-600 leading-relaxed",children:"Mise en ligne de Tarikh.ma avec son moteur de recherche smantique et ses outils de visualisation cartographique du Maroc  travers les ges."})]})]})]})]})}),a.jsxs("section",{className:"flex flex-col lg:flex-row min-h-[500px] sm:min-h-[600px] bg-white",children:[a.jsxs("div",{className:"lg:w-1/2 relative min-h-[320px] sm:min-h-[400px]",children:[a.jsx("img",{alt:"Manuscrit marocain",className:"absolute inset-0 w-full h-full object-cover grayscale",src:"https://lh3.googleusercontent.com/aida-public/AB6AXuAUi5BOTSw9nRYZNMewX2G9maChHwU9aq9HL0CWgvk_n4b2wMh3uLoz88z6dhm2WVwMoboRK19O6u9pdrFVZF9NsRnlHYsPVE-X2G_Fq71ltP3xQN1ARq2xoUACzOW8BPOFc-MriNGeID6QaFu7cSdrUGxQLYkLV0JYP6clwtNRSJ4QRKdE-ZOG21Vs7M7zzTvHdTSUEaZYwrUxZjVqZoveQg07siRWnIXI-EFulrrYpBXFo6F6JxmyVHqi44Ml8Bc6MPD1ahKYTfYp"}),a.jsx("div",{className:"absolute inset-0 bg-accent-gold/10 mix-blend-multiply"})]}),a.jsxs("div",{className:"lg:w-1/2 bg-slate-50 border-t lg:border-t-0 lg:border-l border-slate-200 flex flex-col justify-center p-8 sm:p-12 lg:p-24 space-y-6 sm:space-y-8",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-black font-serif italic text-accent-gold",children:"Un devoir de mmoire"}),a.jsx("p",{className:"text-base sm:text-lg text-slate-600 leading-relaxed font-light italic",children:"La culture est ce qui reste quand on a tout oubli. En prservant les traces de notre pass, nous ne faisons pas que regarder en arrire, nous construisons les fondations d'un avenir plus conscient et plus fier de son identit plurielle."}),a.jsxs("div",{className:"pt-6 border-t border-slate-200",children:[a.jsx("p",{className:"font-bold text-slate-900 tracking-widest uppercase text-sm mb-1",children:"Dr. Ahmed El Mansouri"}),a.jsx("p",{className:"text-accent-gold text-xs font-semibold",children:"Conservateur en Chef, Projet Tarikh"})]})]})]}),a.jsx("section",{className:"py-16 sm:py-24 px-6 sm:px-10 text-center bg-white",children:a.jsxs("div",{className:"max-w-2xl mx-auto space-y-6 sm:space-y-8",children:[a.jsx("div",{className:"text-accent-gold",children:a.jsx("span",{className:"material-symbols-outlined text-5xl sm:text-6xl",children:"menu_book"})}),a.jsx("h2",{className:"text-2xl sm:text-3xl font-black text-slate-900",children:"Prt  explorer notre histoire ?"}),a.jsx("p",{className:"text-slate-500",children:"Plongez dans des sicles de savoir, de culture et de dcouvertes. Rejoignez les milliers de citoyens et chercheurs qui redcouvrent le Maroc chaque jour."}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[a.jsx(ie,{to:"/archives",className:"w-full sm:w-auto bg-accent-gold text-white px-10 py-5 rounded-xl font-bold hover:shadow-2xl hover:shadow-accent-gold/20 hover:brightness-110 transition-all text-center",children:"Explorer les archives"}),a.jsx(ie,{to:"/archives",className:"w-full sm:w-auto border-2 border-slate-200 px-10 py-4 rounded-xl font-bold hover:bg-slate-50 transition-all text-center text-slate-800",children:"Devenir partenaire"})]})]})})]})}function h0(){return a.jsxs("div",{className:"relative flex flex-col overflow-x-hidden bg-white",children:[a.jsxs("section",{className:"relative h-[500px] flex items-center justify-center overflow-hidden bg-background-dark",children:[a.jsxs("div",{className:"absolute inset-0 z-0",children:[a.jsx("img",{alt:"Collaboration historique",className:"w-full h-full object-cover opacity-50 grayscale",src:"https://images.unsplash.com/photo-1455390582262-044cdead277a?q=80&w=1973&auto=format&fit=crop"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-white via-white/20 to-transparent"})]}),a.jsxs("div",{className:"relative z-10 max-w-4xl px-6 text-center",children:[a.jsx("span",{className:"inline-block px-4 py-1.5 rounded-full bg-accent-gold/20 text-accent-gold font-bold text-xs uppercase tracking-widest mb-6 border border-accent-gold/30",children:"Espace Collaborative"}),a.jsxs("h1",{className:"text-4xl sm:text-5xl md:text-7xl font-black mb-6 leading-[1.1] tracking-tight text-slate-900 serif",children:["crivons l'Histoire ",a.jsx("br",{}),a.jsx("span",{className:"text-accent-gold italic text-shadow-sm",children:"Ensemble"})]}),a.jsx("p",{className:"text-lg sm:text-xl text-slate-700 max-w-2xl mx-auto leading-relaxed serif italic",children:"Partagez vos archives, manuscrits et recherches pour enrichir le patrimoine numrique du Maroc. Chaque document compte."}),a.jsxs("div",{className:"mt-10 flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsx(ie,{to:"/register",className:"bg-accent-gold text-white px-8 py-4 rounded-xl font-bold hover:shadow-2xl hover:shadow-accent-gold/20 hover:scale-105 transition-all",children:"Devenir Contributeur"}),a.jsx(ie,{to:"/login",className:"bg-white border-2 border-slate-200 text-slate-900 px-8 py-4 rounded-xl font-bold hover:bg-slate-50 hover:border-accent-gold/30 transition-all",children:"Accder au Dashboard"})]})]})]}),a.jsx("section",{className:"py-24 px-6 max-w-7xl mx-auto",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-12",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"w-14 h-14 bg-accent-gold/10 rounded-2xl flex items-center justify-center text-accent-gold shadow-sm",children:a.jsx("span",{className:"material-symbols-outlined text-3xl",children:"protected_policy"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 serif",children:"Protection & Prservation"}),a.jsx("p",{className:"text-slate-500 leading-relaxed",children:"Assurez la prennit de vos documents physiques en les numrisant et en les intgrant dans une archive nationale scurise."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"w-14 h-14 bg-accent-gold/10 rounded-2xl flex items-center justify-center text-accent-gold shadow-sm",children:a.jsx("span",{className:"material-symbols-outlined text-3xl",children:"visibility"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 serif",children:"Visibilit Mondiale"}),a.jsx("p",{className:"text-slate-500 leading-relaxed",children:"Offrez une plateforme  vos recherches. Vos contributions seront consultables par des chercheurs et passionns du monde entier."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"w-14 h-14 bg-accent-gold/10 rounded-2xl flex items-center justify-center text-accent-gold shadow-sm",children:a.jsx("span",{className:"material-symbols-outlined text-3xl",children:"groups"})}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 serif",children:"Communaut Active"}),a.jsx("p",{className:"text-slate-500 leading-relaxed",children:"changez avec d'autres collectionneurs et historiens pour authentifier et contextrualiser les trsors du pass."})]})]})}),a.jsx("section",{className:"bg-slate-50 py-24 border-y border-slate-100",children:a.jsxs("div",{className:"max-w-4xl mx-auto px-6 text-center",children:[a.jsx("h2",{className:"text-3xl md:text-5xl font-black text-slate-900 mb-16 serif italic",children:"Comment a marche ?"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 relative",children:[a.jsxs("div",{className:"relative z-10",children:[a.jsx("div",{className:"w-16 h-16 bg-white border border-accent-gold/20 rounded-full flex items-center justify-center text-accent-gold font-black text-xl mx-auto mb-6 shadow-sm",children:"1"}),a.jsx("h4",{className:"font-bold text-slate-900 mb-2",children:"Inscription"}),a.jsx("p",{className:"text-sm text-slate-500",children:'Crez un compte "Contributeur" en quelques secondes.'})]}),a.jsxs("div",{className:"relative z-10",children:[a.jsx("div",{className:"w-16 h-16 bg-white border border-accent-gold/20 rounded-full flex items-center justify-center text-accent-gold font-black text-xl mx-auto mb-6 shadow-sm",children:"2"}),a.jsx("h4",{className:"font-bold text-slate-900 mb-2",children:"Publication"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Uploadez vos fichiers et renseignez les mtadonnes (poque, rgion, type)."})]}),a.jsxs("div",{className:"relative z-10",children:[a.jsx("div",{className:"w-16 h-16 bg-white border border-accent-gold/20 rounded-full flex items-center justify-center text-accent-gold font-black text-xl mx-auto mb-6 shadow-sm",children:"3"}),a.jsx("h4",{className:"font-bold text-slate-900 mb-2",children:"Validation"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Notre quipe valide l'authenticit avant publication officielle."})]}),a.jsx("div",{className:"hidden md:block absolute top-8 left-1/4 right-1/4 h-px bg-slate-200 z-0"})]})]})}),a.jsx("section",{className:"py-24 px-6 text-center",children:a.jsxs("div",{className:"max-w-3xl mx-auto bg-background-dark p-12 sm:p-20 rounded-[40px] relative overflow-hidden shadow-2xl",children:[a.jsx("div",{className:"absolute inset-0 opacity-10 grayscale paper-texture"}),a.jsxs("div",{className:"relative z-10 space-y-8",children:[a.jsx("h2",{className:"text-3xl md:text-5xl font-black text-white px-4 serif",children:"Prt  prserver notre hritage ?"}),a.jsx("p",{className:"text-slate-300 text-lg font-light serif italic",children:"Rejoignez les dizaines de contributeurs qui uvrent chaque jour pour la mmoire du Royaume."}),a.jsx("div",{className:"pt-4",children:a.jsx(ie,{to:"/register",className:"bg-accent-gold text-white px-12 py-5 rounded-2xl font-black text-lg hover:scale-105 transition-all shadow-xl shadow-accent-gold/20 inline-block",children:"Commencer maintenant"})})]})]})})]})}function f0(){const u=cs(),e=Ut(x=>x.setAuth),[t,i]=E.useState(""),[r,l]=E.useState(""),[c,d]=E.useState(""),[f,p]=E.useState(!1);async function m(x){x.preventDefault(),d(""),p(!0);try{const b=await Ua.login(t,r);e(b.token,{id:b.user.id,email:b.user.email,name:b.user.name,role:b.user.role}),u("/archives",{replace:!0})}catch(b){d(b instanceof Error?b.message:"Connexion impossible")}finally{p(!1)}}return a.jsxs("div",{className:"max-w-md mx-auto py-16 px-6",children:[a.jsx("h1",{className:"text-3xl font-black text-slate-900 dark:text-white mb-2",children:"Connexion"}),a.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-8",children:"Accdez  votre compte Tarikh.ma"}),a.jsxs("form",{onSubmit:m,className:"space-y-6",children:[c&&a.jsx("div",{className:"bg-red-500/10 border border-red-500/30 text-red-600 dark:text-red-400 rounded-lg px-4 py-3 text-sm",children:c}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Email"}),a.jsx("input",{id:"email",type:"email",value:t,onChange:x=>i(x.target.value),required:!0,className:"w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary focus:border-primary outline-none",placeholder:"vous@exemple.ma"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Mot de passe"}),a.jsx("input",{id:"password",type:"password",value:r,onChange:x=>l(x.target.value),required:!0,className:"w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary focus:border-primary outline-none"})]}),a.jsx("button",{type:"submit",disabled:f,className:"w-full bg-accent-gold text-white py-4 rounded-xl font-bold hover:brightness-110 transition-all disabled:opacity-50 shadow-lg shadow-accent-gold/20",children:f?"Connexion":"Se connecter"})]}),a.jsxs("p",{className:"mt-8 text-center text-sm text-slate-500 dark:text-slate-400",children:["Pas encore de compte ?"," ",a.jsx(ie,{to:"/register",className:"text-accent-gold font-bold hover:underline",children:"S'inscrire"})]})]})}function p0(){const u=cs(),e=Ut(j=>j.setAuth),[t,i]=E.useState(""),[r,l]=E.useState(""),[c,d]=E.useState(""),[f,p]=E.useState(""),[m,x]=E.useState("reader"),[b,w]=E.useState(""),[y,N]=E.useState(!1);async function _(j){j.preventDefault(),w(""),N(!0);try{const S=await Ua.register(f,t,r,c,m);e(S.token,{id:S.user.id,email:S.user.email,name:S.user.name,role:S.user.role}),S.user.role==="editor"?u("/admin",{replace:!0}):u("/archives",{replace:!0})}catch(S){w(S instanceof Error?S.message:"Inscription impossible")}finally{N(!1)}}return a.jsxs("div",{className:"max-w-md mx-auto py-16 px-6",children:[a.jsx("h1",{className:"text-3xl font-black text-slate-900 dark:text-white mb-2",children:"Inscription"}),a.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-8",children:"Crez votre compte Tarikh.ma"}),a.jsxs("form",{onSubmit:_,className:"space-y-6",children:[b&&a.jsx("div",{className:"bg-red-500/10 border border-red-500/30 text-red-600 dark:text-red-400 rounded-lg px-4 py-3 text-sm",children:b}),a.jsxs("div",{className:"flex gap-4 p-2 bg-slate-100 rounded-2xl mb-8",children:[a.jsx("button",{type:"button",onClick:()=>x("reader"),className:`flex-1 py-3 rounded-xl font-bold text-sm transition-all ${m==="reader"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Lecteur"}),a.jsx("button",{type:"button",onClick:()=>x("editor"),className:`flex-1 py-3 rounded-xl font-bold text-sm transition-all ${m==="editor"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Contributeur"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Nom *"}),a.jsx("input",{id:"name",type:"text",value:f,onChange:j=>p(j.target.value),required:!0,className:"w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary focus:border-primary outline-none",placeholder:"Votre nom"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Email"}),a.jsx("input",{id:"email",type:"email",value:t,onChange:j=>i(j.target.value),required:!0,className:"w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary focus:border-primary outline-none",placeholder:"vous@exemple.ma"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Mot de passe"}),a.jsx("input",{id:"password",type:"password",value:r,onChange:j=>l(j.target.value),required:!0,minLength:6,className:"w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary focus:border-primary outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password_confirmation",className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Confirmer le mot de passe *"}),a.jsx("input",{id:"password_confirmation",type:"password",value:c,onChange:j=>d(j.target.value),required:!0,minLength:6,className:"w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary focus:border-primary outline-none"})]}),a.jsx("button",{type:"submit",disabled:y,className:"w-full bg-accent-gold text-white py-4 rounded-xl font-bold hover:brightness-110 transition-all disabled:opacity-50 shadow-lg shadow-accent-gold/20",children:y?"Inscription":"S'inscrire"})]}),a.jsxs("p",{className:"mt-8 text-center text-sm text-slate-500 dark:text-slate-400",children:["Dj un compte ?"," ",a.jsx(ie,{to:"/login",className:"text-accent-gold font-bold hover:underline",children:"Se connecter"})]})]})}function m0(){const[u,e]=E.useState(null),[t,i]=E.useState([]),[r,l]=E.useState(!0),[c,d]=E.useState(""),[f,p]=E.useState(1),[m,x]=E.useState([]),[b,w]=E.useState(""),[y,N]=E.useState([1500,2024]),[_,j]=E.useState("latest");E.useEffect(()=>{Jf.list().then(i).catch(()=>[])},[]),E.useEffect(()=>{l(!0),Ha.list({page:f,per_page:9,q:c||void 0,type:m.length>0?m:void 0,theme_id:b||void 0,year_min:y[0],year_max:y[1],sort_by:_}).then(k=>e(k)).catch(()=>e({data:[],current_page:1,last_page:1,total:0,per_page:9})).finally(()=>l(!1))},[f,c,m,b,y,_]);const S=k=>{x(L=>L.includes(k)?L.filter(T=>T!==k):[...L,k]),p(1)},P=()=>{d(""),x([]),w(""),N([1500,2024]),j("latest"),p(1)};return a.jsxs("div",{className:"min-h-screen bg-white text-slate-900 relative overflow-hidden paper-texture",children:[a.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-accent-gold/5 rounded-full blur-[120px] -translate-y-1/2 translate-x-1/2 pointer-events-none"}),a.jsx("div",{className:"absolute bottom-0 left-0 w-[400px] h-[400px] bg-primary/5 rounded-full blur-[100px] translate-y-1/2 -translate-x-1/2 pointer-events-none"}),a.jsxs("div",{className:"max-w-[1600px] mx-auto px-6 pt-28 pb-12 relative z-10",children:[a.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-between gap-8 mb-20",children:[a.jsxs("div",{className:"flex-1 w-full max-w-3xl relative group",children:[a.jsx("div",{className:"absolute inset-0 bg-accent-gold/5 blur-xl rounded-full opacity-0 group-focus-within:opacity-100 transition-opacity"}),a.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 material-symbols-outlined text-accent-gold text-2xl group-focus-within:text-accent-gold transition-colors z-10",children:"search"}),a.jsx("input",{type:"text",placeholder:"Rechercher un manuscrit, une ville, une date...",value:c,onChange:k=>d(k.target.value),className:"w-full bg-white border-2 border-accent-gold/10 rounded-3xl pl-16 pr-8 py-6 text-slate-800 focus:outline-none focus:ring-4 focus:ring-accent-gold/5 focus:border-accent-gold/40 placeholder:text-slate-300 transition-all font-serif italic text-xl shadow-xl shadow-accent-gold/5 relative z-10"})]}),a.jsx("div",{className:"flex items-center gap-4 shrink-0",children:a.jsxs("button",{className:"px-10 py-5 rounded-3xl bg-accent-gold text-white font-bold text-sm hover:bg-accent-gold/90 hover:scale-105 transition-all shadow-2xl shadow-accent-gold/20 flex items-center gap-2",children:[a.jsx("span",{className:"material-symbols-outlined text-lg",children:"add_circle"}),"Contribuer"]})})]}),a.jsxs("div",{className:"flex flex-col lg:flex-row gap-16",children:[a.jsxs("aside",{className:"lg:w-80 flex-shrink-0 space-y-12",children:[a.jsxs("div",{className:"flex items-center justify-between px-2",children:[a.jsxs("h2",{className:"text-slate-900 text-2xl font-black italic serif tracking-tight",children:["Filtres ",a.jsx("span",{className:"text-accent-gold",children:"Avancs"})]}),a.jsx("button",{onClick:P,className:"text-[10px] uppercase tracking-widest font-black text-slate-400 hover:text-accent-gold transition-colors",children:"Rinitialiser"})]}),a.jsxs("div",{className:"space-y-6 bg-parchment/20 p-6 rounded-3xl border border-accent-gold/10",children:[a.jsx("label",{className:"block text-[10px] font-black text-slate-500 uppercase tracking-[0.2em] mb-4",children:"Priode Historique"}),a.jsxs("div",{className:"px-2",children:[a.jsx("input",{type:"range",min:"1500",max:"2024",value:y[1],onChange:k=>N([y[0],parseInt(k.target.value)]),className:"w-full h-1.5 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-accent-gold"}),a.jsxs("div",{className:"flex justify-between mt-6 text-[11px] font-bold font-mono",children:[a.jsx("span",{className:"text-slate-400",children:"1500"}),a.jsx("div",{className:"bg-white px-3 py-1 rounded-full border border-accent-gold/20 shadow-sm",children:a.jsxs("span",{className:"text-accent-gold",children:["Jusqu' ",y[1]]})}),a.jsx("span",{className:"text-slate-400",children:"2024"})]})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsx("label",{className:"block text-[10px] font-black text-slate-500 uppercase tracking-[0.2em]",children:"Nature des Archives"}),a.jsx("div",{className:"space-y-4",children:[{id:"livre",label:"Livres",icon:"auto_stories"},{id:"pdf",label:"Manuscrits",icon:"menu_book"},{id:"video",label:"Vidos",icon:"videocam"},{id:"carte",label:"Cartes",icon:"map"},{id:"image",label:"Photos",icon:"photo_library"},{id:"article",label:"Articles",icon:"article"}].map(k=>a.jsxs("label",{className:"flex items-center gap-4 cursor-pointer group",children:[a.jsx("div",{onClick:()=>S(k.id),className:`w-6 h-6 rounded-lg border flex items-center justify-center transition-all ${m.includes(k.id)?"bg-accent-gold border-accent-gold shadow-md shadow-accent-gold/20":"border-slate-200 bg-white group-hover:border-accent-gold/50"}`,children:m.includes(k.id)&&a.jsx("span",{className:"material-symbols-outlined text-white text-[16px] font-bold",children:"check"})}),a.jsx("span",{className:`text-sm transition-colors ${m.includes(k.id)?"text-slate-900 font-bold":"text-slate-500 group-hover:text-slate-700"}`,children:k.label})]},k.id))})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsx("label",{className:"block text-[10px] font-black text-slate-500 uppercase tracking-[0.2em]",children:"Thmatiques Populaires"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{onClick:()=>w(""),className:`px-5 py-2.5 rounded-full text-[11px] font-bold border transition-all ${b===""?"bg-accent-gold border-accent-gold text-white shadow-lg shadow-accent-gold/20":"bg-white border-slate-100 text-slate-500 hover:border-accent-gold/30 hover:text-accent-gold"}`,children:"Toutes"}),t.map(k=>a.jsx("button",{onClick:()=>w(k.id),className:`px-5 py-2.5 rounded-full text-[11px] font-bold border transition-all ${b===k.id?"bg-accent-gold border-accent-gold text-white shadow-lg shadow-accent-gold/20":"bg-white border-slate-100 text-slate-500 hover:border-accent-gold/30 hover:text-accent-gold"}`,children:k.name},k.id))]})]})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-12 pb-8 border-b border-slate-100",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-3xl font-black text-slate-900 italic serif tracking-tight",children:["Rsultats ",c&&a.jsxs("span",{children:["pour ",a.jsxs("span",{className:"text-accent-gold",children:['"',c,'"']})]})]}),a.jsxs("p",{className:"text-slate-400 text-sm mt-2 font-medium",children:[a.jsx("span",{className:"text-accent-gold font-bold",children:u?.total||0})," documents prcieux extraits de l'inventaire national."]})]}),a.jsxs("div",{className:"flex items-center gap-4 bg-slate-50 p-2 rounded-2xl border border-slate-100",children:[a.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest pl-4",children:"Trier par :"}),a.jsxs("select",{value:_,onChange:k=>j(k.target.value),className:"bg-white border border-slate-200 rounded-xl px-4 py-2 text-xs font-bold text-slate-700 outline-none focus:ring-2 focus:ring-accent-gold/30 cursor-pointer shadow-sm",children:[a.jsx("option",{value:"latest",children:"Dernires Acquisitions"}),a.jsx("option",{value:"oldest",children:"Trsors les plus anciens"}),a.jsx("option",{value:"views",children:"Les plus consults"}),a.jsx("option",{value:"title",children:"Ordre Alphabtique"}),a.jsx("option",{value:"year_asc",children:"Chronologie (Croissante)"}),a.jsx("option",{value:"year_desc",children:"Chronologie (Dcroissante)"})]})]})]}),r?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10",children:[1,2,3,4,5,6].map(k=>a.jsx("div",{className:"bg-slate-50 rounded-[2.5rem] h-[480px] animate-pulse border border-slate-100"},k))}):u&&u.data.length>0?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10",children:u.data.map(k=>a.jsxs(ie,{to:`/documents/${k.id}`,className:"group bg-white rounded-[2.5rem] border border-slate-100 overflow-hidden shadow-[0_10px_30px_rgba(0,0,0,0.03)] hover:shadow-[0_30px_60px_rgba(126,96,80,0.12)] hover:border-accent-gold/20 hover:-translate-y-3 transition-all duration-700 flex flex-col h-full relative",children:[a.jsxs("div",{className:"h-64 relative overflow-hidden m-4 rounded-[2rem]",children:[k.thumbnail_url?a.jsx("img",{src:k.thumbnail_url,alt:"",className:"w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110"}):a.jsx("div",{className:"w-full h-full bg-parchment/30 flex items-center justify-center grayscale opacity-60",children:a.jsx("span",{className:"material-symbols-outlined text-7xl text-accent-gold/20",children:"auto_stories"})}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),a.jsx("div",{className:"absolute top-6 left-6",children:a.jsx("div",{className:"w-12 h-12 rounded-2xl bg-white border border-accent-gold/10 flex items-center justify-center text-accent-gold shadow-lg group-hover:bg-accent-gold group-hover:text-white transition-all",children:a.jsx("span",{className:"material-symbols-outlined text-2xl",children:k.type==="pdf"?"menu_book":k.type==="image"?"image":k.type==="carte"?"map":"description"})})})]}),a.jsxs("div",{className:"p-8 pt-4 flex flex-col flex-1",children:[a.jsxs("div",{className:"flex items-center justify-between mb-5",children:[a.jsx("span",{className:"px-3 py-1 bg-accent-gold/5 text-[9px] font-black text-accent-gold rounded-full uppercase tracking-widest",children:k.region?.name||"Royaume"}),a.jsxs("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:[k.year||""," AP. J.-C."]})]}),a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4 group-hover:text-accent-gold transition-colors line-clamp-2 serif leading-snug",children:k.title}),a.jsx("p",{className:"text-slate-500 text-sm leading-relaxed line-clamp-3 mb-8 font-medium italic serif",children:k.description||"Une pice historique d'une importance capitale pour la comprhension de l'volution structurelle et culturelle du Royaume."}),a.jsxs("div",{className:"mt-auto pt-6 border-t border-slate-50 flex items-center justify-between",children:[a.jsxs("span",{className:"text-[9px] font-black text-slate-300 uppercase tracking-widest font-mono",children:["ID: TK-",k.id.toString().padStart(5,"0")]}),a.jsxs("div",{className:"flex items-center gap-2 text-accent-gold text-xs font-black uppercase tracking-tighter opacity-0 group-hover:opacity-100 group-hover:translate-x-0 -translate-x-4 transition-all duration-500",children:["Lire la suite ",a.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_forward"})]})]})]})]},k.id))}),u.last_page>1&&a.jsxs("div",{className:"mt-24 flex justify-center items-center gap-3",children:[a.jsx("button",{onClick:()=>p(k=>Math.max(1,k-1)),disabled:f<=1,className:"w-14 h-14 rounded-2xl flex items-center justify-center border border-slate-100 bg-white text-slate-400 hover:border-accent-gold hover:text-accent-gold hover:shadow-xl hover:shadow-accent-gold/10 transition-all disabled:opacity-20",children:a.jsx("span",{className:"material-symbols-outlined text-2xl",children:"chevron_left"})}),Array.from({length:Math.min(5,u.last_page)},(k,L)=>{const T=L+1;return a.jsx("button",{onClick:()=>p(T),className:`w-14 h-14 rounded-2xl font-black text-sm transition-all shadow-sm ${f===T?"bg-accent-gold text-white shadow-xl shadow-accent-gold/30 scale-110":"bg-white border border-slate-100 text-slate-500 hover:border-accent-gold hover:text-accent-gold"}`,children:T},T)}),u.last_page>5&&a.jsx("span",{className:"text-slate-300 px-2 font-black",children:"..."}),a.jsx("button",{onClick:()=>p(k=>Math.min(u.last_page,k+1)),disabled:f>=u.last_page,className:"w-14 h-14 rounded-2xl flex items-center justify-center border border-slate-100 bg-white text-slate-400 hover:border-accent-gold hover:text-accent-gold hover:shadow-xl hover:shadow-accent-gold/10 transition-all disabled:opacity-20",children:a.jsx("span",{className:"material-symbols-outlined text-2xl",children:"chevron_right"})})]})]}):a.jsxs("div",{className:"flex flex-col items-center justify-center py-48 bg-parchment/10 rounded-[4rem] border-4 border-dashed border-slate-100",children:[a.jsx("div",{className:"w-24 h-24 rounded-[2rem] bg-white shadow-2xl flex items-center justify-center text-accent-gold/30 mb-8 border border-accent-gold/5",children:a.jsx("span",{className:"material-symbols-outlined text-5xl",children:"history_edu"})}),a.jsx("h3",{className:"text-2xl font-black text-slate-800 mb-3 serif italic",children:"Le silence des manuscrits..."}),a.jsx("p",{className:"text-slate-400 text-base font-medium max-w-md text-center leading-relaxed",children:"Nous n'avons trouv aucune pice correspondant  vos critres dans nos registres actuels."}),a.jsx("button",{onClick:P,className:"mt-10 px-8 py-3 bg-white border border-accent-gold/20 text-accent-gold rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] hover:bg-accent-gold hover:text-white transition-all shadow-lg shadow-accent-gold/5",children:"Effacer tous les filtres"})]})]})]})]}),a.jsxs("footer",{className:"max-w-[1600px] mx-auto px-6 py-16 border-t border-slate-50 mt-24 flex flex-col md:flex-row items-center justify-between gap-8",children:[a.jsx("div",{className:"flex items-center gap-8 text-[10px] font-black text-slate-400 uppercase tracking-[0.3em]",children:a.jsx("span",{children:" 2026 Tarikh.ma - Tous droits rserv. Developped by ArtgonMEDIA"})}),a.jsxs("div",{className:"flex gap-10 text-[10px] font-black text-slate-500 uppercase tracking-widest",children:[a.jsx("a",{href:"#",className:"hover:text-primary transition-colors",children:"Portail Officiel"}),a.jsx("a",{href:"#",className:"hover:text-primary transition-colors",children:"Documentation"}),a.jsx("a",{href:"#",className:"hover:text-primary transition-colors",children:"Archives Numriques"})]})]})]})}const g0=2,x0=1,v0="data:audio/mp3;base64,//uQxAAAAAANIAAAAAExBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7kMQAD8AAADSAAAAANIAAADSAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==";let La=null;function b0(){return La||(La=new Audio(v0),La.volume=.25),La}function Qs(){try{const u=b0();u.currentTime=0,u.play().catch(()=>{})}catch{}}function y0(u,e){const t=[];for(let i=u;i<=e;i++)t.push(i);return t}function w0({documentId:u,totalPages:e,currentPage:t,onRequestPrev:i,onRequestNext:r,zoom:l=100,title:c,className:d="",flipPhase:f,flipDirection:p,onFlipAnimationEnd:m,isFlipping:x}){const[b,w]=E.useState({}),[y,N]=E.useState(!0),[_,j]=E.useState(!1),S=E.useRef(new Set),P=E.useCallback(async L=>{const T=L.filter(I=>I>=1&&I<=e&&!S.current.has(I));if(T.length!==0){T.forEach(I=>S.current.add(I));try{const I=await e0(u,T);w($=>({...$,...I}))}catch{j(!0)}finally{N(!1)}}},[u,e]);E.useEffect(()=>{const L=Math.max(1,t-x0),T=Math.min(e,t+g0);P(y0(L,T))},[u,t,e,P]);const k=b[t];return E.useEffect(()=>{const L=T=>{T.key==="ArrowLeft"?(T.preventDefault(),Qs(),i()):T.key==="ArrowRight"&&(T.preventDefault(),Qs(),r())};return window.addEventListener("keydown",L),()=>window.removeEventListener("keydown",L)},[i,r]),_?a.jsx("div",{className:`flex items-center justify-center bg-slate-100 rounded ${d}`,style:{minHeight:280},children:a.jsx("span",{className:"text-slate-600 text-sm",children:"Impossible de charger les pages."})}):a.jsxs("div",{className:`cahier-viewer cahier-viewer-brochure relative w-full flex-1 flex items-center justify-center min-h-0 overflow-hidden ${x?"is-flipping":""} ${d}`,children:[a.jsx("button",{type:"button",onClick:()=>{Qs(),i()},disabled:t<=1||x,className:"absolute left-2 sm:left-4 top-1/2 -translate-y-1/2 z-10 w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center rounded-full bg-white/90 shadow-md border border-slate-200/80 text-slate-600 hover:bg-white hover:text-slate-900 disabled:opacity-40 disabled:pointer-events-none transition-all hover:scale-105","aria-label":"Page prcdente",children:a.jsx("span",{className:"material-symbols-outlined text-2xl sm:text-3xl font-light",children:"chevron_left"})}),a.jsx("button",{type:"button",onClick:()=>{Qs(),r()},disabled:t>=e||x,className:"absolute right-2 sm:right-4 top-1/2 -translate-y-1/2 z-10 w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center rounded-full bg-white/90 shadow-md border border-slate-200/80 text-slate-600 hover:bg-white hover:text-slate-900 disabled:opacity-40 disabled:pointer-events-none transition-all hover:scale-105","aria-label":"Page suivante",children:a.jsx("span",{className:"material-symbols-outlined text-2xl sm:text-3xl font-light",children:"chevron_right"})}),a.jsx("div",{role:"button",tabIndex:0,onClick:()=>{Qs(),i()},onKeyDown:L=>{L.key==="Enter"&&(Qs(),i())},className:"cahier-zone-prev","aria-label":"Page prcdente (zone)","aria-disabled":x}),a.jsx("div",{role:"button",tabIndex:0,onClick:()=>{Qs(),r()},onKeyDown:L=>{L.key==="Enter"&&(Qs(),r())},className:"cahier-zone-next","aria-label":"Page suivante (zone)","aria-disabled":x}),a.jsx("div",{className:`cahier-page relative w-full h-full flex items-center justify-center min-h-[50vh] sm:min-h-[60vh] max-h-[75vh] sm:max-h-[80vh] ${f&&p?`turn-${p}-${f}`:""}`,onAnimationEnd:m,children:a.jsxs("div",{className:"cahier-page-inner absolute inset-0 flex items-center justify-center rounded overflow-hidden bg-white shadow-[0_2px_16px_rgba(0,0,0,0.08),inset_0_0_0_1px_rgba(0,0,0,0.06)]",children:[y&&!k&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-50 rounded",children:a.jsx("span",{className:"text-slate-500 text-sm",children:"Chargement de la page"})}),k&&a.jsx("img",{src:k,alt:c?`Page ${t}  ${c}`:`Page ${t}`,className:"max-w-full max-h-full w-auto h-auto object-contain select-none",style:{transform:`scale(${l/100})`},draggable:!1,onContextMenu:L=>L.preventDefault()})]})}),[t+1,t+2].map(L=>L>e||!b[L]?null:a.jsx("link",{rel:"preload",as:"image",href:b[L]},L))]})}var dr={};dr.d=(u,e)=>{for(var t in e)dr.o(e,t)&&!dr.o(u,t)&&Object.defineProperty(u,t,{enumerable:!0,get:e[t]})};dr.o=(u,e)=>Object.prototype.hasOwnProperty.call(u,e);var _e=globalThis.pdfjsLib={};dr.d(_e,{AbortException:()=>sn,AnnotationEditorLayer:()=>Es,AnnotationEditorParamsType:()=>Te,AnnotationEditorType:()=>ke,AnnotationEditorUIManager:()=>nn,AnnotationLayer:()=>gb,AnnotationMode:()=>Js,ColorPicker:()=>Jt,DOMSVGFactory:()=>Xc,DrawLayer:()=>St,FeatureTest:()=>kt,GlobalWorkerOptions:()=>hr,ImageKind:()=>Fa,InvalidPDFException:()=>Sc,MissingPDFException:()=>mr,OPS:()=>ls,OutputScale:()=>jc,PDFDataRangeTransport:()=>xp,PDFDateString:()=>tp,PDFWorker:()=>ni,PasswordResponses:()=>S0,PermissionFlag:()=>_0,PixelsPerInch:()=>li,RenderingCancelledException:()=>Oc,TextLayer:()=>jt,TouchManager:()=>il,UnexpectedResponseException:()=>Wa,Util:()=>ge,VerbosityLevel:()=>Ja,XfaLayer:()=>bp,build:()=>Kv,createValidAbsoluteUrl:()=>C0,fetchData:()=>sl,getDocument:()=>Bv,getFilenameFromUrl:()=>F0,getPdfFilenameFromUrl:()=>O0,getXfaPageViewport:()=>z0,isDataScheme:()=>nl,isPdfFile:()=>zc,noContextMenu:()=>os,normalizeUnicode:()=>V0,setLayerDimensions:()=>Sn,shadow:()=>Pe,stopEvent:()=>$t,version:()=>Yv});const yt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Zf=[1,0,0,1,0,0],_c=[.001,0,0,.001,0,0],N0=1e7,dc=1.35,Bt={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Js={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},A0="pdfjs_internal_editor_",ke={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Te={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},_0={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},vt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Fa={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},it={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},nr={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Ja={ERRORS:0,WARNINGS:1,INFOS:5},ls={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},S0={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Za=Ja.WARNINGS;function j0(u){Number.isInteger(u)&&(Za=u)}function k0(){return Za}function el(u){Za>=Ja.INFOS&&console.log(`Info: ${u}`)}function Ee(u){Za>=Ja.WARNINGS&&console.log(`Warning: ${u}`)}function Fe(u){throw new Error(u)}function tt(u,e){u||Fe(e)}function E0(u){switch(u?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function C0(u,e=null,t=null){if(!u)return null;try{if(t&&typeof u=="string"&&(t.addDefaultProtocol&&u.startsWith("www.")&&u.match(/\./g)?.length>=2&&(u=`http://${u}`),t.tryConvertEncoding))try{u=M0(u)}catch{}const i=e?new URL(u,e):new URL(u);if(E0(i))return i}catch{}return null}function Pe(u,e,t,i=!1){return Object.defineProperty(u,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const rn=(function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e})();class hf extends rn{constructor(e,t){super(e,"PasswordException"),this.code=t}}class uc extends rn{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Sc extends rn{constructor(e){super(e,"InvalidPDFException")}}class mr extends rn{constructor(e){super(e,"MissingPDFException")}}class Wa extends rn{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class P0 extends rn{constructor(e){super(e,"FormatError")}}class sn extends rn{constructor(e){super(e,"AbortException")}}function ep(u){(typeof u!="object"||u?.length===void 0)&&Fe("Invalid argument for bytesToString");const e=u.length,t=8192;if(e<t)return String.fromCharCode.apply(null,u);const i=[];for(let r=0;r<e;r+=t){const l=Math.min(r+t,e),c=u.subarray(r,l);i.push(String.fromCharCode.apply(null,c))}return i.join("")}function tl(u){typeof u!="string"&&Fe("Invalid argument for stringToBytes");const e=u.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=u.charCodeAt(i)&255;return t}function T0(u){return String.fromCharCode(u>>24&255,u>>16&255,u>>8&255,u&255)}function Dc(u){const e=Object.create(null);for(const[t,i]of u)e[t]=i;return e}function R0(){const u=new Uint8Array(4);return u[0]=1,new Uint32Array(u.buffer,0,1)[0]===1}function L0(){try{return new Function(""),!0}catch{return!1}}class kt{static get isLittleEndian(){return Pe(this,"isLittleEndian",R0())}static get isEvalSupported(){return Pe(this,"isEvalSupported",L0())}static get isOffscreenCanvasSupported(){return Pe(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Pe(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?Pe(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):Pe(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return Pe(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const hc=Array.from(Array(256).keys(),u=>u.toString(16).padStart(2,"0"));class ge{static makeHexColor(e,t,i){return`#${hc[e]}${hc[t]}${hc[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const i=e[0]*t[0]+e[1]*t[2]+t[4],r=e[0]*t[1]+e[1]*t[3]+t[5];return[i,r]}static applyInverseTransform(e,t){const i=t[0]*t[3]-t[1]*t[2],r=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/i,l=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/i;return[r,l]}static getAxialAlignedBoundingBox(e,t){const i=this.applyTransform(e,t),r=this.applyTransform(e.slice(2,4),t),l=this.applyTransform([e[0],e[3]],t),c=this.applyTransform([e[2],e[1]],t);return[Math.min(i[0],r[0],l[0],c[0]),Math.min(i[1],r[1],l[1],c[1]),Math.max(i[0],r[0],l[0],c[0]),Math.max(i[1],r[1],l[1],c[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],i=e[0]*t[0]+e[1]*t[2],r=e[0]*t[1]+e[1]*t[3],l=e[2]*t[0]+e[3]*t[2],c=e[2]*t[1]+e[3]*t[3],d=(i+c)/2,f=Math.sqrt((i+c)**2-4*(i*c-l*r))/2,p=d+f||1,m=d-f||1;return[Math.sqrt(p),Math.sqrt(m)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>r)return null;const l=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),c=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return l>c?null:[i,l,r,c]}static#e(e,t,i,r,l,c,d,f,p,m){if(p<=0||p>=1)return;const x=1-p,b=p*p,w=b*p,y=x*(x*(x*e+3*p*t)+3*b*i)+w*r,N=x*(x*(x*l+3*p*c)+3*b*d)+w*f;m[0]=Math.min(m[0],y),m[1]=Math.min(m[1],N),m[2]=Math.max(m[2],y),m[3]=Math.max(m[3],N)}static#t(e,t,i,r,l,c,d,f,p,m,x,b){if(Math.abs(p)<1e-12){Math.abs(m)>=1e-12&&this.#e(e,t,i,r,l,c,d,f,-x/m,b);return}const w=m**2-4*x*p;if(w<0)return;const y=Math.sqrt(w),N=2*p;this.#e(e,t,i,r,l,c,d,f,(-m+y)/N,b),this.#e(e,t,i,r,l,c,d,f,(-m-y)/N,b)}static bezierBoundingBox(e,t,i,r,l,c,d,f,p){return p?(p[0]=Math.min(p[0],e,d),p[1]=Math.min(p[1],t,f),p[2]=Math.max(p[2],e,d),p[3]=Math.max(p[3],t,f)):p=[Math.min(e,d),Math.min(t,f),Math.max(e,d),Math.max(t,f)],this.#t(e,i,l,d,t,r,c,f,3*(-e+3*(i-l)+d),6*(e-2*i+l),3*(i-e),p),this.#t(e,i,l,d,t,r,c,f,3*(-t+3*(r-c)+f),6*(t-2*r+c),3*(r-t),p),p}}function M0(u){return decodeURIComponent(escape(u))}let fc=null,ff=null;function V0(u){return fc||(fc=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,ff=new Map([["","t"]])),u.replaceAll(fc,(e,t,i)=>t?t.normalize("NFKC"):ff.get(i))}function I0(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const u=new Uint8Array(32);return crypto.getRandomValues(u),ep(u)}const Fc="pdfjs_internal_id_";function D0(u){return Uint8Array.prototype.toBase64?u.toBase64():btoa(ep(u))}typeof Promise.try!="function"&&(Promise.try=function(u,...e){return new Promise(t=>{t(u(...e))})});const ks="http://www.w3.org/2000/svg";class li{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function sl(u,e="text"){if(or(u,document.baseURI)){const t=await fetch(u);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const r=new XMLHttpRequest;r.open("GET",u,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}i(new Error(r.statusText))}},r.send(null)})}class br{constructor({viewBox:e,userUnit:t,scale:i,rotation:r,offsetX:l=0,offsetY:c=0,dontFlip:d=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=r,this.offsetX=l,this.offsetY=c,i*=t;const f=(e[2]+e[0])/2,p=(e[3]+e[1])/2;let m,x,b,w;switch(r%=360,r<0&&(r+=360),r){case 180:m=-1,x=0,b=0,w=1;break;case 90:m=0,x=1,b=1,w=0;break;case 270:m=0,x=-1,b=-1,w=0;break;case 0:m=1,x=0,b=0,w=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}d&&(b=-b,w=-w);let y,N,_,j;m===0?(y=Math.abs(p-e[1])*i+l,N=Math.abs(f-e[0])*i+c,_=(e[3]-e[1])*i,j=(e[2]-e[0])*i):(y=Math.abs(f-e[0])*i+l,N=Math.abs(p-e[1])*i+c,_=(e[2]-e[0])*i,j=(e[3]-e[1])*i),this.transform=[m*i,x*i,b*i,w*i,y-m*i*f-b*i*p,N-x*i*f-w*i*p],this.width=_,this.height=j}get rawDims(){const{userUnit:e,viewBox:t}=this,i=t.map(r=>r*e);return Pe(this,"rawDims",{pageWidth:i[2]-i[0],pageHeight:i[3]-i[1],pageX:i[0],pageY:i[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:r=this.offsetY,dontFlip:l=!1}={}){return new br({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:r,dontFlip:l})}convertToViewportPoint(e,t){return ge.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=ge.applyTransform([e[0],e[1]],this.transform),i=ge.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){return ge.applyInverseTransform([e,t],this.transform)}}class Oc extends rn{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function nl(u){const e=u.length;let t=0;for(;t<e&&u[t].trim()==="";)t++;return u.substring(t,t+5).toLowerCase()==="data:"}function zc(u){return typeof u=="string"&&/\.pdf$/i.test(u)}function F0(u){return[u]=u.split(/[#?]/,1),u.substring(u.lastIndexOf("/")+1)}function O0(u,e="document.pdf"){if(typeof u!="string")return e;if(nl(u))return Ee('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=t.exec(u);let l=i.exec(r[1])||i.exec(r[2])||i.exec(r[3]);if(l&&(l=l[0],l.includes("%")))try{l=i.exec(decodeURIComponent(l))[0]}catch{}return l||e}class pf{started=Object.create(null);times=[];time(e){e in this.started&&Ee(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ee(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:r,end:l}of this.times)e.push(`${i.padEnd(t)} ${l-r}ms
`);return e.join("")}}function or(u,e){try{const{protocol:t}=e?new URL(u,e):new URL(u);return t==="http:"||t==="https:"}catch{return!1}}function os(u){u.preventDefault()}function $t(u){u.preventDefault(),u.stopPropagation()}class tp{static#e;static toDateObject(e){if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const i=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let l=parseInt(t[3],10);l=l>=1&&l<=31?l:1;let c=parseInt(t[4],10);c=c>=0&&c<=23?c:0;let d=parseInt(t[5],10);d=d>=0&&d<=59?d:0;let f=parseInt(t[6],10);f=f>=0&&f<=59?f:0;const p=t[7]||"Z";let m=parseInt(t[8],10);m=m>=0&&m<=23?m:0;let x=parseInt(t[9],10)||0;return x=x>=0&&x<=59?x:0,p==="-"?(c+=m,d+=x):p==="+"&&(c-=m,d-=x),new Date(Date.UTC(i,r,l,c,d,f))}}function z0(u,{scale:e=1,rotation:t=0}){const{width:i,height:r}=u.attributes.style,l=[0,0,parseInt(i),parseInt(r)];return new br({viewBox:l,userUnit:1,scale:e,rotation:t})}function Bc(u){if(u.startsWith("#")){const e=parseInt(u.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return u.startsWith("rgb(")?u.slice(4,-1).split(",").map(e=>parseInt(e)):u.startsWith("rgba(")?u.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ee(`Not a valid color format: "${u}"`),[0,0,0])}function B0(u){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of u.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;u.set(t,Bc(i))}e.remove()}function He(u){const{a:e,b:t,c:i,d:r,e:l,f:c}=u.getTransform();return[e,t,i,r,l,c]}function ms(u){const{a:e,b:t,c:i,d:r,e:l,f:c}=u.getTransform().invertSelf();return[e,t,i,r,l,c]}function Sn(u,e,t=!1,i=!0){if(e instanceof br){const{pageWidth:r,pageHeight:l}=e.rawDims,{style:c}=u,d=kt.isCSSRoundSupported,f=`var(--scale-factor) * ${r}px`,p=`var(--scale-factor) * ${l}px`,m=d?`round(down, ${f}, var(--scale-round-x, 1px))`:`calc(${f})`,x=d?`round(down, ${p}, var(--scale-round-y, 1px))`:`calc(${p})`;!t||e.rotation%180===0?(c.width=m,c.height=x):(c.width=x,c.height=m)}i&&u.setAttribute("data-main-rotation",e.rotation)}class jc{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}class ur{#e=null;#t=null;#s;#n=null;#r=null;static#i=null;constructor(e){this.#s=e,ur.#i||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#s._uiManager._signal;e.addEventListener("contextmenu",os,{signal:t}),e.addEventListener("pointerdown",ur.#o,{signal:t});const i=this.#n=document.createElement("div");i.className="buttons",e.append(i);const r=this.#s.toolbarPosition;if(r){const{style:l}=e,c=this.#s._uiManager.direction==="ltr"?1-r[0]:r[0];l.insetInlineEnd=`${100*c}%`,l.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return this.#h(),e}get div(){return this.#e}static#o(e){e.stopPropagation()}#l(e){this.#s._focusEventsAllowed=!1,$t(e)}#d(e){this.#s._focusEventsAllowed=!0,$t(e)}#c(e){const t=this.#s._uiManager._signal;e.addEventListener("focusin",this.#l.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#d.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",os,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#r?.shown()}#h(){const{editorType:e,_uiManager:t}=this.#s,i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",ur.#i[e]),this.#c(i),i.addEventListener("click",r=>{t.delete()},{signal:t._signal}),this.#n.append(i)}get#u(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#c(t),this.#n.prepend(t,this.#u),this.#r=e}addColorPicker(e){this.#t=e;const t=e.renderButton();this.#c(t),this.#n.prepend(t,this.#u)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class $0{#e=null;#t=null;#s;constructor(e){this.#s=e}#n(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",os,{signal:this.#s._signal});const t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#i(),e}#r(e,t){let i=0,r=0;for(const l of e){const c=l.y+l.height;if(c<i)continue;const d=l.x+(t?l.width:0);if(c>i){r=d,i=c;continue}t?d>r&&(r=d):d<r&&(r=d)}return[t?1-r:r,i]}show(e,t,i){const[r,l]=this.#r(t,i),{style:c}=this.#t||=this.#n();e.append(this.#t),c.insetInlineEnd=`${100*r}%`,c.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#i(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=this.#s._signal;e.addEventListener("contextmenu",os,{signal:i}),e.addEventListener("click",()=>{this.#s.highlightSelection("floating_button")},{signal:i}),this.#e.append(e)}}function Ga(u,e,t){for(const i of t)e.addEventListener(i,u[i].bind(u))}class U0{#e=0;get id(){return`${A0}${this.#e++}`}}class $c{#e=I0();#t=0;#s=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;const l=r.decode().then(()=>(i.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return Pe(this,"_isSVGFittingCanvas",l)}async#n(e,t){this.#s||=new Map;let i=this.#s.get(e);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let r;if(typeof t=="string"?(i.url=t,r=await sl(t,"blob")):t instanceof File?r=i.file=t:t instanceof Blob&&(r=t),r.type==="image/svg+xml"){const l=$c._isSVGFittingCanvas,c=new FileReader,d=new Image,f=new Promise((p,m)=>{d.onload=()=>{i.bitmap=d,i.isSvg=!0,p()},c.onload=async()=>{const x=i.svgUrl=c.result;d.src=await l?`${x}#svgView(preserveAspectRatio(none))`:x},d.onerror=c.onerror=m});c.readAsDataURL(r),await f}else i.bitmap=await createImageBitmap(r);i.refCounter=1}catch(r){Ee(r),i=null}return this.#s.set(e,i),i&&this.#s.set(i.id,i),i}async getFromFile(e){const{lastModified:t,name:i,size:r,type:l}=e;return this.#n(`${t}_${i}_${r}_${l}`,e)}async getFromUrl(e){return this.#n(e,e)}async getFromBlob(e,t){const i=await t;return this.#n(e,i)}async getFromId(e){this.#s||=new Map;const t=this.#s.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#s||=new Map;let i=this.#s.get(e);if(i?.bitmap)return i.refCounter+=1,i;const r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),i={bitmap:r.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#s.set(e,i),this.#s.set(i.id,i),i}getSvgUrl(e){const t=this.#s.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#s||=new Map;const t=this.#s.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=r.convertToBlob()}i.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class H0{#e=[];#t=!1;#s;#n=-1;constructor(e=128){this.#s=e}add({cmd:e,undo:t,post:i,mustExec:r,type:l=NaN,overwriteIfSameType:c=!1,keepUndo:d=!1}){if(r&&e(),this.#t)return;const f={cmd:e,undo:t,post:i,type:l};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(f);return}if(c&&this.#e[this.#n].type===l){d&&(f.undo=this.#e[this.#n].undo),this.#e[this.#n]=f;return}const p=this.#n+1;p===this.#s?this.#e.splice(0,1):(this.#n=p,p<this.#e.length&&this.#e.splice(p)),this.#e.push(f)}undo(){if(this.#n===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1,this.#n-=1}redo(){if(this.#n<this.#e.length-1){this.#n+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}cleanType(e){if(this.#n!==-1){for(let t=this.#n;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#n-t),this.#n=t;return}this.#e.length=0,this.#n=-1}}destroy(){this.#e=null}}class yr{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=kt.platform;for(const[i,r,l={}]of e)for(const c of i){const d=c.startsWith("mac+");t&&d?(this.callbacks.set(c.slice(4),{callback:r,options:l}),this.allKeys.add(c.split("+").at(-1))):!t&&!d&&(this.callbacks.set(c,{callback:r,options:l}),this.allKeys.add(c.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(this.#e(t));if(!i)return;const{callback:r,options:{bubbles:l=!1,args:c=[],checker:d=null}}=i;d&&!d(e,t)||(r.bind(e,...c,t)(),l||$t(t))}}class Uc{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return B0(e),Pe(this,"_colors",e)}convert(e){const t=Bc(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,r]of this._colors)if(r.every((l,c)=>l===t[c]))return Uc._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?ge.makeHexColor(...t):e}}class nn{#e=new AbortController;#t=null;#s=new Map;#n=new Map;#r=null;#i=null;#o=null;#l=new H0;#d=null;#c=null;#h=0;#u=new Set;#f=null;#a=null;#p=new Set;_editorUndoBar=null;#g=!1;#m=!1;#x=!1;#y=null;#v=null;#w=null;#A=null;#S=!1;#k=null;#C=new U0;#N=!1;#E=!1;#j=null;#T=null;#M=null;#I=null;#_=ke.NONE;#b=new Set;#L=null;#B=null;#$=null;#U={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#D=[0,0];#V=null;#F=null;#H=null;#R=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=nn.prototype,t=c=>c.#F.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),i=(c,{target:d})=>{if(d instanceof HTMLInputElement){const{type:f}=d;return f!=="text"&&f!=="number"}return!0},r=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return Pe(this,"_keyboardManager",new yr([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(c,{target:d})=>!(d instanceof HTMLButtonElement)&&c.#F.contains(d)&&!c.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(c,{target:d})=>!(d instanceof HTMLButtonElement)&&c.#F.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-l,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[l,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-l],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,l],checker:t}]]))}constructor(e,t,i,r,l,c,d,f,p,m,x,b,w){const y=this._signal=this.#e.signal;this.#F=e,this.#H=t,this.#r=i,this._eventBus=r,r._on("editingaction",this.onEditingAction.bind(this),{signal:y}),r._on("pagechanging",this.onPageChanging.bind(this),{signal:y}),r._on("scalechanging",this.onScaleChanging.bind(this),{signal:y}),r._on("rotationchanging",this.onRotationChanging.bind(this),{signal:y}),r._on("setpreference",this.onSetPreference.bind(this),{signal:y}),r._on("switchannotationeditorparams",N=>this.updateParams(N.type,N.value),{signal:y}),this.#te(),this.#re(),this.#X(),this.#i=l.annotationStorage,this.#y=l.filterFactory,this.#B=c,this.#A=d||null,this.#g=f,this.#m=p,this.#x=m,this.#I=x||null,this.viewParameters={realScale:li.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=b||null,this._supportsPinchToZoom=w!==!1}destroy(){this.#R?.resolve(),this.#R=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#n.values())e.destroy();this.#n.clear(),this.#s.clear(),this.#p.clear(),this.#t=null,this.#b.clear(),this.#l.destroy(),this.#r?.destroy(),this.#k?.hide(),this.#k=null,this.#v&&(clearTimeout(this.#v),this.#v=null),this.#V&&(clearTimeout(this.#V),this.#V=null),this._editorUndoBar?.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#I}get useNewAltTextFlow(){return this.#m}get useNewAltTextWhenAddingImage(){return this.#x}get hcmFilter(){return Pe(this,"hcmFilter",this.#B?this.#y.addHCMFilter(this.#B.foreground,this.#B.background):"none")}get direction(){return Pe(this,"direction",getComputedStyle(this.#F).direction)}get highlightColors(){return Pe(this,"highlightColors",this.#A?new Map(this.#A.split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return Pe(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#c=e}setMainHighlightColorPicker(e){this.#M=e}editAltText(e,t=!1){this.#r?.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){e==="enableNewAltTextWhenAddingImage"&&(this.#x=t)}onPageChanging({pageNumber:e}){this.#h=e-1}focusMainContainer(){this.#F.focus()}findParent(e,t){for(const i of this.#n.values()){const{x:r,y:l,width:c,height:d}=i.div.getBoundingClientRect();if(e>=r&&e<=r+c&&t>=l&&t<=l+d)return i}return null}disableUserSelect(e=!1){this.#H.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*li.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#c?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#O({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#q(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of this.#n.values())if(i.hasTextLayer(e))return i;return null}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:i,anchorOffset:r,focusNode:l,focusOffset:c}=t,d=t.toString(),p=this.#O(t).closest(".textLayer"),m=this.getSelectionBoxes(p);if(!m)return;t.empty();const x=this.#q(p),b=this.#_===ke.NONE,w=()=>{x?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:m,anchorNode:i,anchorOffset:r,focusNode:l,focusOffset:c,text:d}),b&&this.showAllEditors("highlight",!0,!0)};if(b){this.switchToMode(ke.HIGHLIGHT,w);return}w()}#Z(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=this.#O(e).closest(".textLayer"),r=this.getSelectionBoxes(i);r&&(this.#k||=new $0(this),this.#k.show(i,r,this.direction==="ltr"))}addToAnnotationStorage(e){!e.isEmpty()&&this.#i&&!this.#i.has(e.id)&&this.#i.setValue(e.id,e)}#ee(){const e=document.getSelection();if(!e||e.isCollapsed){this.#L&&(this.#k?.hide(),this.#L=null,this.#P({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#L)return;const r=this.#O(e).closest(".textLayer");if(!r){this.#L&&(this.#k?.hide(),this.#L=null,this.#P({hasSelectedText:!1}));return}if(this.#k?.hide(),this.#L=t,this.#P({hasSelectedText:!0}),!(this.#_!==ke.HIGHLIGHT&&this.#_!==ke.NONE)&&(this.#_===ke.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#S=this.isShiftKeyDown,!this.isShiftKeyDown)){const l=this.#_===ke.HIGHLIGHT?this.#q(r):null;l?.toggleDrawing();const c=new AbortController,d=this.combinedSignal(c),f=p=>{p.type==="pointerup"&&p.button!==0||(c.abort(),l?.toggleDrawing(!0),p.type==="pointerup"&&this.#G("main_toolbar"))};window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("blur",f,{signal:d})}}#G(e=""){this.#_===ke.HIGHLIGHT?this.highlightSelection(e):this.#g&&this.#Z()}#te(){document.addEventListener("selectionchange",this.#ee.bind(this),{signal:this._signal})}#se(){if(this.#w)return;this.#w=new AbortController;const e=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#ne(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#G("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#b)if(t.div.contains(e)){this.#T=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#T)return;const[e,t]=this.#T;this.#T=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#X(){if(this.#j)return;this.#j=new AbortController;const e=this.combinedSignal(this.#j);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#ie(){this.#j?.abort(),this.#j=null}#Y(){if(this.#d)return;this.#d=new AbortController;const e=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#K(){this.#d?.abort(),this.#d=null}#re(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#X(),this.#Y()}removeEditListeners(){this.#ie(),this.#K()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of this.#a)if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of this.#a)if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of this.#b){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const l of t.items)for(const c of this.#a)if(c.isHandlingMimeForPasting(l.type)){c.paste(l,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(l){Ee(`paste: "${l.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const r=this.currentLayer;try{const l=[];for(const f of i){const p=await r.deserialize(f);if(!p)return;l.push(p)}const c=()=>{for(const f of l)this.#Q(f);this.#J(l)},d=()=>{for(const f of l)f.remove()};this.addCommands({cmd:c,undo:d,mustExec:!0})}catch(l){Ee(`paste: "${l.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#_!==ke.NONE&&!this.isEditorHandlingKeyboard&&nn._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#G("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#P(e){Object.entries(e).some(([i,r])=>this.#U[i]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#U,e)}),this.#_===ke.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#z([[Te.HIGHLIGHT_FREE,!0]]))}#z(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#se(),this.#Y(),this.#P({isEditing:this.#_!==ke.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:this.#l.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ne(),this.#K(),this.#P({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#a){this.#a=e;for(const t of this.#a)this.#z(t.defaultPropertiesToUpdate)}}getId(){return this.#C.id}get currentLayer(){return this.#n.get(this.#h)}getLayer(e){return this.#n.get(e)}get currentPageIndex(){return this.#h}addLayer(e){this.#n.set(e.pageIndex,e),this.#N?e.enable():e.disable()}removeLayer(e){this.#n.delete(e.pageIndex)}async updateMode(e,t=null,i=!1){if(this.#_!==e&&!(this.#R&&(await this.#R.promise,!this.#R))){if(this.#R=Promise.withResolvers(),this.#_=e,e===ke.NONE){this.setEditingState(!1),this.#le(),this._editorUndoBar?.hide(),this.#R.resolve();return}this.setEditingState(!0),await this.#ae(),this.unselectAll();for(const r of this.#n.values())r.updateMode(e);if(!t){i&&this.addNewEditorFromKeyboard(),this.#R.resolve();return}for(const r of this.#s.values())r.annotationElementId===t?(this.setSelected(r),r.enterInEditMode()):r.unselect();this.#R.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==this.#_&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){if(this.#a){switch(e){case Te.CREATE:this.currentLayer.addNewEditor();return;case Te.HIGHLIGHT_DEFAULT_COLOR:this.#M?.updateColor(t);break;case Te.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#$||=new Map).set(e,t),this.showAllEditors("highlight",t);break}for(const i of this.#b)i.updateParams(e,t);for(const i of this.#a)i.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){for(const l of this.#s.values())l.editorType===e&&l.show(t);(this.#$?.get(Te.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#z([[Te.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#E!==e){this.#E=e;for(const t of this.#n.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#ae(){if(!this.#N){this.#N=!0;const e=[];for(const t of this.#n.values())e.push(t.enable());await Promise.all(e);for(const t of this.#s.values())t.enable()}}#le(){if(this.unselectAll(),this.#N){this.#N=!1;for(const e of this.#n.values())e.disable();for(const e of this.#s.values())e.disable()}}getEditors(e){const t=[];for(const i of this.#s.values())i.pageIndex===e&&t.push(i);return t}getEditor(e){return this.#s.get(e)}addEditor(e){this.#s.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.focusMainContainer(),this.#v=null},0)),this.#s.delete(e.id),this.unselect(e),(!e.annotationElementId||!this.#u.has(e.annotationElementId))&&this.#i?.remove(e.id)}addDeletedAnnotationElement(e){this.#u.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#u.has(e)}removeDeletedAnnotationElement(e){this.#u.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#Q(e){const t=this.#n.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#z(e.propertiesToUpdate))}get#oe(){let e=null;for(e of this.#b);return e}updateUI(e){this.#oe===e&&this.#z(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#z(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#b.has(e)){this.#b.delete(e),e.unselect(),this.#P({hasSelectedEditor:this.hasSelection});return}this.#b.add(e),e.select(),this.#z(e.propertiesToUpdate),this.#P({hasSelectedEditor:!0})}setSelected(e){this.#c?.commitOrRemove();for(const t of this.#b)t!==e&&t.unselect();this.#b.clear(),this.#b.add(e),e.select(),this.#z(e.propertiesToUpdate),this.#P({hasSelectedEditor:!0})}isSelected(e){return this.#b.has(e)}get firstSelectedEditor(){return this.#b.values().next().value}unselect(e){e.unselect(),this.#b.delete(e),this.#P({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#b.size!==0}get isEnterHandled(){return this.#b.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#l.undo(),this.#P({hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()}),this._editorUndoBar?.hide()}redo(){this.#l.redo(),this.#P({hasSomethingToUndo:!0,hasSomethingToRedo:this.#l.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(e){this.#l.add(e),this.#P({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}cleanUndoStack(e){this.#l.cleanType(e)}#W(){if(this.#s.size===0)return!0;if(this.#s.size===1)for(const e of this.#s.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#b],i=()=>{this._editorUndoBar?.show(r,t.length===1?t[0].editorType:t.length);for(const l of t)l.remove()},r=()=>{for(const l of t)this.#Q(l)};this.addCommands({cmd:i,undo:r,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#J(e){for(const t of this.#b)t.unselect();this.#b.clear();for(const t of e)t.isEmpty()||(this.#b.add(t),t.select());this.#P({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#b)e.commit();this.#J(this.#s.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#_!==ke.NONE))&&!this.#c?.commitOrRemove()&&this.hasSelection){for(const e of this.#b)e.unselect();this.#b.clear(),this.#P({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#D[0]+=e,this.#D[1]+=t;const[r,l]=this.#D,c=[...this.#b],d=1e3;this.#V&&clearTimeout(this.#V),this.#V=setTimeout(()=>{this.#V=null,this.#D[0]=this.#D[1]=0,this.addCommands({cmd:()=>{for(const f of c)this.#s.has(f.id)&&f.translateInPage(r,l)},undo:()=>{for(const f of c)this.#s.has(f.id)&&f.translateInPage(-r,-l)},mustExec:!1})},d);for(const f of c)f.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#f=new Map;for(const e of this.#b)this.#f.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#f)return!1;this.disableUserSelect(!1);const e=this.#f;this.#f=null;let t=!1;for(const[{x:r,y:l,pageIndex:c},d]of e)d.newX=r,d.newY=l,d.newPageIndex=c,t||=r!==d.savedX||l!==d.savedY||c!==d.savedPageIndex;if(!t)return!1;const i=(r,l,c,d)=>{if(this.#s.has(r.id)){const f=this.#n.get(d);f?r._setParentAndPosition(f,l,c):(r.pageIndex=d,r.x=l,r.y=c)}};return this.addCommands({cmd:()=>{for(const[r,{newX:l,newY:c,newPageIndex:d}]of e)i(r,l,c,d)},undo:()=>{for(const[r,{savedX:l,savedY:c,savedPageIndex:d}]of e)i(r,l,c,d)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#f)for(const i of this.#f.keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#b.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#_}get imageManager(){return Pe(this,"imageManager",new $c)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let p=0,m=t.rangeCount;p<m;p++)if(!e.contains(t.getRangeAt(p).commonAncestorContainer))return null;const{x:i,y:r,width:l,height:c}=e.getBoundingClientRect();let d;switch(e.getAttribute("data-main-rotation")){case"90":d=(p,m,x,b)=>({x:(m-r)/c,y:1-(p+x-i)/l,width:b/c,height:x/l});break;case"180":d=(p,m,x,b)=>({x:1-(p+x-i)/l,y:1-(m+b-r)/c,width:x/l,height:b/c});break;case"270":d=(p,m,x,b)=>({x:1-(m+b-r)/c,y:(p-i)/l,width:b/c,height:x/l});break;default:d=(p,m,x,b)=>({x:(p-i)/l,y:(m-r)/c,width:x/l,height:b/c});break}const f=[];for(let p=0,m=t.rangeCount;p<m;p++){const x=t.getRangeAt(p);if(!x.collapsed)for(const{x:b,y:w,width:y,height:N}of x.getClientRects())y===0||N===0||f.push(d(b,w,y,N))}return f.length===0?null:f}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#o||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#o?.delete(e)}renderAnnotationElement(e){const t=this.#o?.get(e.data.id);if(!t)return;const i=this.#i.getRawValue(t);i&&(this.#_===ke.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}}class xs{#e=null;#t=!1;#s=null;#n=null;#r=null;#i=null;#o=!1;#l=null;#d=null;#c=null;#h=null;#u=!1;static#f=null;static _l10n=null;constructor(e){this.#d=e,this.#u=e._uiManager.useNewAltTextFlow,xs.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){xs._l10n??=e}async render(){const e=this.#s=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#n=document.createElement("span");e.append(t),this.#u?(e.classList.add("new"),e.setAttribute("data-l10n-id",xs.#f.missing),t.setAttribute("data-l10n-id",xs.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#d._uiManager._signal;e.addEventListener("contextmenu",os,{signal:i}),e.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:i});const r=l=>{l.preventDefault(),this.#d._uiManager.editAltText(this.#d),this.#u&&this.#d._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#a}})};return e.addEventListener("click",r,{capture:!0,signal:i}),e.addEventListener("keydown",l=>{l.target===e&&l.key==="Enter"&&(this.#o=!0,r(l))},{signal:i}),await this.#p(),e}get#a(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#s&&(this.#s.focus({focusVisible:this.#o}),this.#o=!1)}isEmpty(){return this.#u?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#u?this.#e!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(e){this.#e===null&&(this.#c=e,this.#h=await xs._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#p())}toggleAltTextBadge(e=!1){if(!this.#u||this.#e){this.#l?.remove(),this.#l=null;return}if(!this.#l){const t=this.#l=document.createElement("div");t.className="noAltTextBadge",this.#d.div.append(t)}this.#l.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#c===t&&(t=this.#h),{altText:t,decorative:this.#t,guessedText:this.#c,textWithDisclaimer:this.#h}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:r,cancel:l=!1}){i&&(this.#c=i,this.#h=r),!(this.#e===e&&this.#t===t)&&(l||(this.#e=e,this.#t=t),this.#p())}toggle(e=!1){this.#s&&(!e&&this.#i&&(clearTimeout(this.#i),this.#i=null),this.#s.disabled=!e)}shown(){this.#d._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#a}})}destroy(){this.#s?.remove(),this.#s=null,this.#n=null,this.#r=null,this.#l?.remove(),this.#l=null}async#p(){const e=this.#s;if(!e)return;if(this.#u){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",xs.#f[this.#a]),this.#n?.setAttribute("data-l10n-id",xs.#f[`${this.#a}-label`]),!this.#e){this.#r?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#r?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#r;if(!t){this.#r=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#d.id}`;const r=100,l=this.#d._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(this.#i),this.#i=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#i=setTimeout(()=>{this.#i=null,this.#r.classList.add("show"),this.#d._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:l}),e.addEventListener("mouseleave",()=>{this.#i&&(clearTimeout(this.#i),this.#i=null),this.#r?.classList.remove("show")},{signal:l})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#d.getImageForAltText()?.setAttribute("aria-describedby",t.id)}}class il{#e;#t=!1;#s=null;#n;#r;#i;#o;#l;#d=null;#c;#h=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:r=null,onPinching:l=null,onPinchEnd:c=null,signal:d}){this.#e=e,this.#s=i,this.#n=t,this.#r=r,this.#i=l,this.#o=c,this.#c=new AbortController,this.#l=AbortSignal.any([d,this.#c.signal]),e.addEventListener("touchstart",this.#u.bind(this),{passive:!1,signal:this.#l})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return Pe(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}#u(e){if(this.#n?.()||e.touches.length<2)return;if(!this.#h){this.#h=new AbortController;const r=AbortSignal.any([this.#l,this.#h.signal]),l=this.#e,c={signal:r,passive:!1};l.addEventListener("touchmove",this.#f.bind(this),c),l.addEventListener("touchend",this.#a.bind(this),c),l.addEventListener("touchcancel",this.#a.bind(this),c),this.#r?.()}if($t(e),e.touches.length!==2||this.#s?.()){this.#d=null;return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),this.#d={touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#f(e){if(!this.#d||e.touches.length!==2)return;let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);const{screenX:r,screenY:l}=t,{screenX:c,screenY:d}=i,f=this.#d,{touch0X:p,touch0Y:m,touch1X:x,touch1Y:b}=f,w=x-p,y=b-m,N=c-r,_=d-l,j=Math.hypot(N,_)||1,S=Math.hypot(w,y)||1;if(!this.#t&&Math.abs(S-j)<=il.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(f.touch0X=r,f.touch0Y=l,f.touch1X=c,f.touch1Y=d,e.preventDefault(),!this.#t){this.#t=!0;return}const P=[(r+c)/2,(l+d)/2];this.#i?.(P,S,j)}#a(e){this.#h.abort(),this.#h=null,this.#o?.(),this.#d&&(e.preventDefault(),this.#d=null,this.#t=!1)}destroy(){this.#c?.abort(),this.#c=null}}class Ne{#e=null;#t=null;#s=null;#n=!1;#r=null;#i="";#o=!1;#l=null;#d=null;#c=null;#h=null;#u="";#f=!1;#a=null;#p=!1;#g=!1;#m=!1;#x=null;#y=0;#v=0;#w=null;#A=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#S=!1;#k=Ne._zIndex++;static _borderLineWidth=-1;static _colorManager=new Uc;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=Ne.prototype._resizeWithKeyboard,t=nn.TRANSLATE_SMALL,i=nn.TRANSLATE_BIG;return Pe(this,"_resizerKeyboardManager",new yr([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],Ne.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:r,pageX:l,pageY:c}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,r],this.pageTranslation=[l,c];const[d,f]=this.parentDimensions;this.x=e.x/d,this.y=e.y/f,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Pe(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new W0({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Ne._l10n??=e,Ne._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Ne._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Ne._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Fe("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#S}set _isDraggable(e){this.#S=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#k}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#O(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#f?this.#f=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,r){const[l,c]=this.parentDimensions;[i,r]=this.screenToPageTranslation(i,r),this.x=(e+i)/l,this.y=(t+r)/c,this.fixAndSetPosition()}#C([e,t],i,r){[i,r]=this.screenToPageTranslation(i,r),this.x+=i/e,this.y+=r/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#C(this.parentDimensions,e,t)}translateInPage(e,t){this.#a||=[this.x,this.y,this.width,this.height],this.#C(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){this.#a||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[r,l]}=this;if(this.x+=e/r,this.y+=t/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x,y:b}=this.div.getBoundingClientRect();this.parent.findNewParent(this,x,b)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:d}=this;const[f,p]=this.getBaseTranslation();c+=f,d+=p;const{style:m}=i;m.left=`${(100*c).toFixed(2)}%`,m.top=`${(100*d).toFixed(2)}%`,this._onTranslating(c,d),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#a&&(this.#a[0]!==this.x||this.#a[1]!==this.y)}get _hasBeenResized(){return!!this.#a&&(this.#a[2]!==this.width||this.#a[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=Ne,r=i/e,l=i/t;switch(this.rotation){case 90:return[-r,l];case 180:return[r,l];case 270:return[r,-l];default:return[-r,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,r]}=this;let{x:l,y:c,width:d,height:f}=this;if(d*=i,f*=r,l*=i,c*=r,this._mustFixPosition)switch(e){case 0:l=Math.max(0,Math.min(i-d,l)),c=Math.max(0,Math.min(r-f,c));break;case 90:l=Math.max(0,Math.min(i-f,l)),c=Math.min(r,Math.max(d,c));break;case 180:l=Math.min(i,Math.max(d,l)),c=Math.min(r,Math.max(f,c));break;case 270:l=Math.min(i,Math.max(f,l)),c=Math.max(0,Math.min(r-d,c));break}this.x=l/=i,this.y=c/=r;const[p,m]=this.getBaseTranslation();l+=p,c+=m,t.left=`${(100*l).toFixed(2)}%`,t.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#N(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return Ne.#N(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return Ne.#N(e,t,360-this.parentRotation)}#E(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(e,t){const[i,r]=this.parentDimensions,{style:l}=this.div;l.width=`${(100*e/i).toFixed(2)}%`,this.#o||(l.height=`${(100*t/r).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:i}=e,r=i.endsWith("%"),l=!this.#o&&t.endsWith("%");if(r&&l)return;const[c,d]=this.parentDimensions;r||(e.width=`${(100*parseFloat(i)/c).toFixed(2)}%`),!this.#o&&!l&&(e.height=`${(100*parseFloat(t)/d).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#j(){if(this.#l)return;this.#l=document.createElement("div"),this.#l.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const r=document.createElement("div");this.#l.append(r),r.classList.add("resizer",i),r.setAttribute("data-resizer-name",i),r.addEventListener("pointerdown",this.#T.bind(this,i),{signal:t}),r.addEventListener("contextmenu",os,{signal:t}),r.tabIndex=-1}this.div.prepend(this.#l)}#T(e,t){t.preventDefault();const{isMac:i}=kt.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#s?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#d=[t.screenX,t.screenY];const l=new AbortController,c=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#_.bind(this,e),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",$t,{passive:!1,signal:c}),window.addEventListener("contextmenu",os,{signal:c}),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const d=this.parent.div.style.cursor,f=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const p=()=>{l.abort(),this.parent.togglePointerEvents(!0),this.#s?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=d,this.div.style.cursor=f,this.#I()};window.addEventListener("pointerup",p,{signal:c}),window.addEventListener("blur",p,{signal:c})}#M(e,t,i,r){this.width=i,this.height=r,this.x=e,this.y=t;const[l,c]=this.parentDimensions;this.setDims(l*i,c*r),this.fixAndSetPosition(),this._onResized()}_onResized(){}#I(){if(!this.#c)return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:r}=this.#c;this.#c=null;const l=this.x,c=this.y,d=this.width,f=this.height;l===e&&c===t&&d===i&&f===r||this.addCommands({cmd:this.#M.bind(this,l,c,d,f),undo:this.#M.bind(this,e,t,i,r),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#_(e,t){const[i,r]=this.parentDimensions,l=this.x,c=this.y,d=this.width,f=this.height,p=Ne.MIN_SIZE/i,m=Ne.MIN_SIZE/r,x=this.#E(this.rotation),b=(X,Z)=>[x[0]*X+x[2]*Z,x[1]*X+x[3]*Z],w=this.#E(360-this.rotation),y=(X,Z)=>[w[0]*X+w[2]*Z,w[1]*X+w[3]*Z];let N,_,j=!1,S=!1;switch(e){case"topLeft":j=!0,N=(X,Z)=>[0,0],_=(X,Z)=>[X,Z];break;case"topMiddle":N=(X,Z)=>[X/2,0],_=(X,Z)=>[X/2,Z];break;case"topRight":j=!0,N=(X,Z)=>[X,0],_=(X,Z)=>[0,Z];break;case"middleRight":S=!0,N=(X,Z)=>[X,Z/2],_=(X,Z)=>[0,Z/2];break;case"bottomRight":j=!0,N=(X,Z)=>[X,Z],_=(X,Z)=>[0,0];break;case"bottomMiddle":N=(X,Z)=>[X/2,Z],_=(X,Z)=>[X/2,0];break;case"bottomLeft":j=!0,N=(X,Z)=>[0,Z],_=(X,Z)=>[X,0];break;case"middleLeft":S=!0,N=(X,Z)=>[0,Z/2],_=(X,Z)=>[X,Z/2];break}const P=N(d,f),k=_(d,f);let L=b(...k);const T=Ne._round(l+L[0]),I=Ne._round(c+L[1]);let $=1,te=1,oe,ae;if(t.fromKeyboard)({deltaX:oe,deltaY:ae}=t);else{const{screenX:X,screenY:Z}=t,[q,re]=this.#d;[oe,ae]=this.screenToPageTranslation(X-q,Z-re),this.#d[0]=X,this.#d[1]=Z}if([oe,ae]=y(oe/i,ae/r),j){const X=Math.hypot(d,f);$=te=Math.max(Math.min(Math.hypot(k[0]-P[0]-oe,k[1]-P[1]-ae)/X,1/d,1/f),p/d,m/f)}else S?$=Math.max(p,Math.min(1,Math.abs(k[0]-P[0]-oe)))/d:te=Math.max(m,Math.min(1,Math.abs(k[1]-P[1]-ae)))/f;const ne=Ne._round(d*$),se=Ne._round(f*te);L=b(..._(ne,se));const xe=T-L[0],Se=I-L[1];this.#a||=[this.x,this.y,this.width,this.height],this.width=ne,this.height=se,this.x=xe,this.y=Se,this.setDims(i*ne,r*se),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#s?.finish()}async addEditToolbar(){return this._editToolbar||this.#g?this._editToolbar:(this._editToolbar=new ur(this),this.div.append(this._editToolbar.render()),this.#s&&await this._editToolbar.addAltText(this.#s),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#s?.destroy())}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#s||(xs.initialize(Ne._l10n),this.#s=new xs(this),this.#e&&(this.#s.data=this.#e,this.#e=null),await this.addEditToolbar())}get altTextData(){return this.#s?.data}set altTextData(e){this.#s&&(this.#s.data=e)}get guessedAltText(){return this.#s?.guessedText}async setGuessedAltText(e){await this.#s?.setGuessedText(e)}serializeAltText(e){return this.#s?.serialize(e)}hasAltText(){return!!this.#s&&!this.#s.isEmpty()}hasAltTextData(){return this.#s?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#n?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#D();const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[i,r]=this.getInitialTranslation();return this.translate(i,r),Ga(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#A||=new il({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#b.bind(this),onPinching:this.#L.bind(this),onPinchEnd:this.#B.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),this.div}#b(){this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#s?.toggle(!1),this.parent.togglePointerEvents(!1)}#L(e,t,i){let l=.7*(i/t)+1-.7;if(l===1)return;const c=this.#E(this.rotation),d=(T,I)=>[c[0]*T+c[2]*I,c[1]*T+c[3]*I],[f,p]=this.parentDimensions,m=this.x,x=this.y,b=this.width,w=this.height,y=Ne.MIN_SIZE/f,N=Ne.MIN_SIZE/p;l=Math.max(Math.min(l,1/b,1/w),y/b,N/w);const _=Ne._round(b*l),j=Ne._round(w*l);if(_===b&&j===w)return;this.#a||=[m,x,b,w];const S=d(b/2,w/2),P=Ne._round(m+S[0]),k=Ne._round(x+S[1]),L=d(_/2,j/2);this.x=P-L[0],this.y=k-L[1],this.width=_,this.height=j,this.setDims(f*_,p*j),this.fixAndSetPosition(),this._onResizing()}#B(){this.#s?.toggle(!0),this.parent.togglePointerEvents(!0),this.#I()}pointerdown(e){const{isMac:t}=kt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#f=!0,this._isDraggable){this.#U(e);return}this.#$(e)}get isSelected(){return this._uiManager.isSelected(this)}#$(e){const{isMac:t}=kt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1;const r=new AbortController,l=this._uiManager.combinedSignal(r),c={capture:!0,passive:!1,signal:l},d=p=>{r.abort(),this.#r=null,this.#f=!1,this._uiManager.endDragSession()||this.#$(p),i&&this._onStopDragging()};t&&(this.#y=e.clientX,this.#v=e.clientY,this.#r=e.pointerId,this.#i=e.pointerType,window.addEventListener("pointermove",p=>{i||(i=!0,this._onStartDragging());const{clientX:m,clientY:x,pointerId:b}=p;if(b!==this.#r){$t(p);return}const[w,y]=this.screenToPageTranslation(m-this.#y,x-this.#v);this.#y=m,this.#v=x,this._uiManager.dragSelectedEditors(w,y)},c),window.addEventListener("touchmove",$t,c),window.addEventListener("pointerdown",p=>{p.pointerType===this.#i&&(this.#A||p.isPrimary)&&d(p),$t(p)},c));const f=p=>{if(!this.#r||this.#r===p.pointerId){d(p);return}$t(p)};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.#x=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const r=this.parentScale,[l,c]=this.pageDimensions,[d,f]=this.pageTranslation,p=e/r,m=t/r,x=this.x*l,b=this.y*c,w=this.width*l,y=this.height*c;switch(i){case 0:return[x+p+d,c-b-m-y+f,x+p+w+d,c-b-m+f];case 90:return[x+m+d,c-b+p+f,x+m+y+d,c-b+p+w+f];case 180:return[x-p-w+d,c-b+m+f,x-p+d,c-b+m+y+f];case 270:return[x-m-y+d,c-b-p-w+f,x-m+d,c-b-p+f];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,r,l,c]=e,d=l-i,f=c-r;switch(this.rotation){case 0:return[i,t-c,d,f];case 90:return[i,t-r,f,d];case 180:return[l,t-r,d,f];case 270:return[l,t-c,f,d];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){this.#g=!0}disableEditMode(){this.#g=!1}isInEditMode(){return this.#g}shouldGetKeyboardEvents(){return this.#m}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:i,right:r}=this.getClientDimensions(),{innerHeight:l,innerWidth:c}=window;return t<c&&r>0&&e<l&&i>0}#D(){if(this.#h||!this.div)return;this.#h=new AbortController;const e=this._uiManager.combinedSignal(this.#h);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#D()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){Fe("An editor must be serializable")}static async deserialize(e,t,i){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i});r.rotation=e.rotation,r.#e=e.accessibilityData;const[l,c]=r.pageDimensions,[d,f,p,m]=r.getRectInCurrentCoords(e.rect,c);return r.x=d/l,r.y=f/c,r.width=p/l,r.height=m/c,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#h?.abort(),this.#h=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#x&&(clearTimeout(this.#x),this.#x=null),this.#O(),this.removeEditToolbar(),this.#w){for(const e of this.#w.values())clearTimeout(e);this.#w=null}this.parent=null,this.#A?.destroy(),this.#A=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#j(),this.#l.classList.remove("hidden"),Ga(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#l.children;if(!this.#t){this.#t=Array.from(t);const c=this.#V.bind(this),d=this.#F.bind(this),f=this._uiManager._signal;for(const p of this.#t){const m=p.getAttribute("data-resizer-name");p.setAttribute("role","spinbutton"),p.addEventListener("keydown",c,{signal:f}),p.addEventListener("blur",d,{signal:f}),p.addEventListener("focus",this.#H.bind(this,m),{signal:f}),p.setAttribute("data-l10n-id",Ne._l10nResizer[m])}}const i=this.#t[0];let r=0;for(const c of t){if(c===i)break;r++}const l=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(l!==r){if(l<r)for(let d=0;d<r-l;d++)this.#l.append(this.#l.firstChild);else if(l>r)for(let d=0;d<l-r;d++)this.#l.firstChild.before(this.#l.lastChild);let c=0;for(const d of t){const p=this.#t[c++].getAttribute("data-resizer-name");d.setAttribute("data-l10n-id",Ne._l10nResizer[p])}}this.#R(0),this.#m=!0,this.#l.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#V(e){Ne._resizerKeyboardManager.exec(this,e)}#F(e){this.#m&&e.relatedTarget?.parentNode!==this.#l&&this.#O()}#H(e){this.#u=this.#m?e:""}#R(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#m&&this.#_(this.#u,{deltaX:e,deltaY:t,fromKeyboard:!0})}#O(){this.#m=!1,this.#R(-1),this.#I()}_stopResizingWithKeyboard(){this.#O(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#s?.toggleAltTextBadge(!1)}unselect(){this.#l?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#s?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#o=!0;const i=e/t,{style:r}=this.div;r.aspectRatio=i,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#w||=new Map;const{action:i}=e;let r=this.#w.get(i);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),this.#w.delete(i),this.#w.size===0&&(this.#w=null)},Ne._telemetryTimeout),this.#w.set(i,r);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#n=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#n=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class W0 extends Ne{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const mf=3285377520,Qt=4294901760,gs=65535;class sp{constructor(e){this.h1=e?e&4294967295:mf,this.h2=e?e&4294967295:mf}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let N=0,_=e.length;N<_;N++){const j=e.charCodeAt(N);j<=255?t[i++]=j:(t[i++]=j>>>8,t[i++]=j&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=i>>2,l=i-r*4,c=new Uint32Array(t.buffer,0,r);let d=0,f=0,p=this.h1,m=this.h2;const x=3432918353,b=461845907,w=x&gs,y=b&gs;for(let N=0;N<r;N++)N&1?(d=c[N],d=d*x&Qt|d*w&gs,d=d<<15|d>>>17,d=d*b&Qt|d*y&gs,p^=d,p=p<<13|p>>>19,p=p*5+3864292196):(f=c[N],f=f*x&Qt|f*w&gs,f=f<<15|f>>>17,f=f*b&Qt|f*y&gs,m^=f,m=m<<13|m>>>19,m=m*5+3864292196);switch(d=0,l){case 3:d^=t[r*4+2]<<16;case 2:d^=t[r*4+1]<<8;case 1:d^=t[r*4],d=d*x&Qt|d*w&gs,d=d<<15|d>>>17,d=d*b&Qt|d*y&gs,r&1?p^=d:m^=d}this.h1=p,this.h2=m}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Qt|e*36045&gs,t=t*4283543511&Qt|((t<<16|e>>>16)*2950163797&Qt)>>>16,e^=t>>>1,e=e*444984403&Qt|e*60499&gs,t=t*3301882366&Qt|((t<<16|e>>>16)*3120437893&Qt)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const kc=Object.freeze({map:null,hash:"",transfer:void 0});class Hc{#e=!1;#t=null;#s=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=this.#s.get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return this.#s.get(e)}remove(e){if(this.#s.delete(e),this.#s.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of this.#s.values())if(t instanceof Ne)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=this.#s.get(e);let r=!1;if(i!==void 0)for(const[l,c]of Object.entries(t))i[l]!==c&&(r=!0,i[l]=c);else r=!0,this.#s.set(e,t);r&&this.#n(),t instanceof Ne&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#s.has(e)}getAll(){return this.#s.size>0?Dc(this.#s):null}setAll(e){for(const[t,i]of Object.entries(e))this.setValue(t,i)}get size(){return this.#s.size}#n(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new np(this)}get serializable(){if(this.#s.size===0)return kc;const e=new Map,t=new sp,i=[],r=Object.create(null);let l=!1;for(const[c,d]of this.#s){const f=d instanceof Ne?d.serialize(!1,r):d;f&&(e.set(c,f),t.update(`${c}:${JSON.stringify(f)}`),l||=!!f.bitmap)}if(l)for(const c of e.values())c.bitmap&&i.push(c.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:kc}get editorStats(){let e=null;const t=new Map;for(const i of this.#s.values()){if(!(i instanceof Ne))continue;const r=i.telemetryFinalData;if(!r)continue;const{type:l}=r;t.has(l)||t.set(l,Object.getPrototypeOf(i).constructor),e||=Object.create(null);const c=e[l]||=new Map;for(const[d,f]of Object.entries(r)){if(d==="type")continue;let p=c.get(d);p||(p=new Map,c.set(d,p));const m=p.get(f)??0;p.set(f,m+1)}}for(const[i,r]of t)e[i]=r.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;const e=[];for(const t of this.#s.values())!(t instanceof Ne)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}}class np extends Hc{#e;constructor(e){super();const{map:t,hash:i,transfer:r}=e.serializable,l=structuredClone(t,r?{transfer:r}:null);this.#e={map:l,hash:i,transfer:r}}get print(){Fe("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return Pe(this,"modifiedIds",{ids:new Set,hash:""})}}class G0{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||this.#e.has(e.loadedName))){if(tt(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:r,style:l}=e,c=new FontFace(i,r,l);this.addNativeFontFace(c);try{await c.load(),this.#e.add(i),t?.(e)}catch{Ee(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}Fe("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(r){throw Ee(`Failed to load font '${i.family}': '${r}'.`),e.disableFontFace=!0,r}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const r=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,r)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return Pe(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(yt||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),Pe(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(tt(!r.done,"completeRequest() cannot be called twice."),r.done=!0;i.length>0&&i[0].done;){const l=i.shift();setTimeout(l.callback,0)}}const{loadingRequests:i}=this,r={done:!1,complete:t,callback:e};return i.push(r),r}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Pe(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(k,L){return k.charCodeAt(L)<<24|k.charCodeAt(L+1)<<16|k.charCodeAt(L+2)<<8|k.charCodeAt(L+3)&255}function r(k,L,T,I){const $=k.substring(0,L),te=k.substring(L+T);return $+I+te}let l,c;const d=this._document.createElement("canvas");d.width=1,d.height=1;const f=d.getContext("2d");let p=0;function m(k,L){if(++p>30){Ee("Load test font never loaded."),L();return}if(f.font="30px "+k,f.fillText(".",0,20),f.getImageData(0,0,1,1).data[3]>0){L();return}setTimeout(m.bind(null,k,L))}const x=`lt${Date.now()}${this.loadTestFontId++}`;let b=this._loadTestFont;b=r(b,976,x.length,x);const y=16,N=1482184792;let _=i(b,y);for(l=0,c=x.length-3;l<c;l+=4)_=_-N+i(x,l)|0;l<x.length&&(_=_-N+i(x+"XXX",l)|0),b=r(b,y,4,T0(_));const j=`url(data:font/opentype;base64,${btoa(b)});`,S=`@font-face {font-family:"${x}";src:${j}}`;this.insertRule(S);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const k of[e.loadedName,x]){const L=this._document.createElement("span");L.textContent="Hi",L.style.fontFamily=k,P.append(L)}this._document.body.append(P),m(x,()=>{P.remove(),t.complete()})}}class q0{constructor(e,{disableFontFace:t=!1,fontExtraProperties:i=!1,inspectFont:r=null}){this.compiledGlyphs=Object.create(null);for(const l in e)this[l]=e[l];this.disableFontFace=t===!0,this.fontExtraProperties=i===!0,this._inspectFont=r}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${D0(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let r;try{r=e.get(i)}catch(c){Ee(`getPathGenerator - ignoring character: "${c}".`)}const l=new Path2D(r||"");return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=l}}const Ma={DATA:1,ERROR:2},et={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function gf(){}function Vt(u){if(u instanceof sn||u instanceof Sc||u instanceof mr||u instanceof hf||u instanceof Wa||u instanceof uc)return u;switch(u instanceof Error||typeof u=="object"&&u!==null||Fe('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),u.name){case"AbortException":return new sn(u.message);case"InvalidPDFException":return new Sc(u.message);case"MissingPDFException":return new mr(u.message);case"PasswordException":return new hf(u.message,u.code);case"UnexpectedResponseException":return new Wa(u.message,u.status);case"UnknownErrorException":return new uc(u.message,u.details)}return new uc(u.message,u.toString())}class cr{#e=new AbortController;constructor(e,t,i){this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#n(e);return}if(e.callback){const i=e.callbackId,r=this.callbackCapabilities[i];if(!r)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===Ma.DATA)r.resolve(e.data);else if(e.callback===Ma.ERROR)r.reject(Vt(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,r=e.sourceName,l=this.comObj;Promise.try(t,e.data).then(function(c){l.postMessage({sourceName:i,targetName:r,callback:Ma.DATA,callbackId:e.callbackId,data:c})},function(c){l.postMessage({sourceName:i,targetName:r,callback:Ma.ERROR,callbackId:e.callbackId,reason:Vt(c)})});return}if(e.streamId){this.#s(e);return}t(e.data)}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const r=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[r]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},i)}catch(c){l.reject(c)}return l.promise}sendWithStream(e,t,i,r){const l=this.streamId++,c=this.sourceName,d=this.targetName,f=this.comObj;return new ReadableStream({start:p=>{const m=Promise.withResolvers();return this.streamControllers[l]={controller:p,startCall:m,pullCall:null,cancelCall:null,isClosed:!1},f.postMessage({sourceName:c,targetName:d,action:e,streamId:l,data:t,desiredSize:p.desiredSize},r),m.promise},pull:p=>{const m=Promise.withResolvers();return this.streamControllers[l].pullCall=m,f.postMessage({sourceName:c,targetName:d,stream:et.PULL,streamId:l,desiredSize:p.desiredSize}),m.promise},cancel:p=>{tt(p instanceof Error,"cancel must have a valid reason");const m=Promise.withResolvers();return this.streamControllers[l].cancelCall=m,this.streamControllers[l].isClosed=!0,f.postMessage({sourceName:c,targetName:d,stream:et.CANCEL,streamId:l,reason:Vt(p)}),m.promise}},i)}#s(e){const t=e.streamId,i=this.sourceName,r=e.sourceName,l=this.comObj,c=this,d=this.actionHandler[e.action],f={enqueue(p,m=1,x){if(this.isCancelled)return;const b=this.desiredSize;this.desiredSize-=m,b>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:i,targetName:r,stream:et.ENQUEUE,streamId:t,chunk:p},x)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:i,targetName:r,stream:et.CLOSE,streamId:t}),delete c.streamSinks[t])},error(p){tt(p instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:i,targetName:r,stream:et.ERROR,streamId:t,reason:Vt(p)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};f.sinkCapability.resolve(),f.ready=f.sinkCapability.promise,this.streamSinks[t]=f,Promise.try(d,e.data,f).then(function(){l.postMessage({sourceName:i,targetName:r,stream:et.START_COMPLETE,streamId:t,success:!0})},function(p){l.postMessage({sourceName:i,targetName:r,stream:et.START_COMPLETE,streamId:t,reason:Vt(p)})})}#n(e){const t=e.streamId,i=this.sourceName,r=e.sourceName,l=this.comObj,c=this.streamControllers[t],d=this.streamSinks[t];switch(e.stream){case et.START_COMPLETE:e.success?c.startCall.resolve():c.startCall.reject(Vt(e.reason));break;case et.PULL_COMPLETE:e.success?c.pullCall.resolve():c.pullCall.reject(Vt(e.reason));break;case et.PULL:if(!d){l.postMessage({sourceName:i,targetName:r,stream:et.PULL_COMPLETE,streamId:t,success:!0});break}d.desiredSize<=0&&e.desiredSize>0&&d.sinkCapability.resolve(),d.desiredSize=e.desiredSize,Promise.try(d.onPull||gf).then(function(){l.postMessage({sourceName:i,targetName:r,stream:et.PULL_COMPLETE,streamId:t,success:!0})},function(p){l.postMessage({sourceName:i,targetName:r,stream:et.PULL_COMPLETE,streamId:t,reason:Vt(p)})});break;case et.ENQUEUE:if(tt(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(e.chunk);break;case et.CLOSE:if(tt(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#r(c,t);break;case et.ERROR:tt(c,"error should have stream controller"),c.controller.error(Vt(e.reason)),this.#r(c,t);break;case et.CANCEL_COMPLETE:e.success?c.cancelCall.resolve():c.cancelCall.reject(Vt(e.reason)),this.#r(c,t);break;case et.CANCEL:if(!d)break;const f=Vt(e.reason);Promise.try(d.onCancel||gf,f).then(function(){l.postMessage({sourceName:i,targetName:r,stream:et.CANCEL_COMPLETE,streamId:t,success:!0})},function(p){l.postMessage({sourceName:i,targetName:r,stream:et.CANCEL_COMPLETE,streamId:t,reason:Vt(p)})}),d.sinkCapability.reject(f),d.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#r(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class ip{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Fe("Abstract method `_createCanvas` called.")}}class X0 extends ip{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class rp{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Fe("Abstract method `_fetch` called.")}}class ap extends rp{async _fetch(e){const t=await sl(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):tl(t)}}class lp{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,r,l){return"none"}destroy(e=!1){}}class Y0 extends lp{#e;#t;#s;#n;#r;#i;#o=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#n=e,this.#r=t}get#l(){return this.#t||=new Map}get#d(){return this.#i||=new Map}get#c(){if(!this.#s){const e=this.#r.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const i=this.#r.createElementNS(ks,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#s=this.#r.createElementNS(ks,"defs"),e.append(i),i.append(this.#s),this.#r.body.append(e)}return this.#s}#h(e){if(e.length===1){const f=e[0],p=new Array(256);for(let x=0;x<256;x++)p[x]=f[x]/255;const m=p.join(",");return[m,m,m]}const[t,i,r]=e,l=new Array(256),c=new Array(256),d=new Array(256);for(let f=0;f<256;f++)l[f]=t[f]/255,c[f]=i[f]/255,d[f]=r[f]/255;return[l.join(","),c.join(","),d.join(",")]}#u(e){if(this.#e===void 0){this.#e="";const t=this.#r.URL;t!==this.#r.baseURI&&(nl(t)?Ee('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=t.split("#",1)[0])}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#l.get(e);if(t)return t;const[i,r,l]=this.#h(e),c=e.length===1?i:`${i}${r}${l}`;if(t=this.#l.get(c),t)return this.#l.set(e,t),t;const d=`g_${this.#n}_transfer_map_${this.#o++}`,f=this.#u(d);this.#l.set(e,f),this.#l.set(c,f);const p=this.#p(d);return this.#m(i,r,l,p),f}addHCMFilter(e,t){const i=`${e}-${t}`,r="base";let l=this.#d.get(r);if(l?.key===i||(l?(l.filter?.remove(),l.key=i,l.url="none",l.filter=null):(l={key:i,url:"none",filter:null},this.#d.set(r,l)),!e||!t))return l.url;const c=this.#y(e);e=ge.makeHexColor(...c);const d=this.#y(t);if(t=ge.makeHexColor(...d),this.#c.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return l.url;const f=new Array(256);for(let w=0;w<=255;w++){const y=w/255;f[w]=y<=.03928?y/12.92:((y+.055)/1.055)**2.4}const p=f.join(","),m=`g_${this.#n}_hcm_filter`,x=l.filter=this.#p(m);this.#m(p,p,p,x),this.#a(x);const b=(w,y)=>{const N=c[w]/255,_=d[w]/255,j=new Array(y+1);for(let S=0;S<=y;S++)j[S]=N+S/y*(_-N);return j.join(",")};return this.#m(b(0,5),b(1,5),b(2,5),x),l.url=this.#u(m),l.url}addAlphaFilter(e){let t=this.#l.get(e);if(t)return t;const[i]=this.#h([e]),r=`alpha_${i}`;if(t=this.#l.get(r),t)return this.#l.set(e,t),t;const l=`g_${this.#n}_alpha_map_${this.#o++}`,c=this.#u(l);this.#l.set(e,c),this.#l.set(r,c);const d=this.#p(l);return this.#x(i,d),c}addLuminosityFilter(e){let t=this.#l.get(e||"luminosity");if(t)return t;let i,r;if(e?([i]=this.#h([e]),r=`luminosity_${i}`):r="luminosity",t=this.#l.get(r),t)return this.#l.set(e,t),t;const l=`g_${this.#n}_luminosity_map_${this.#o++}`,c=this.#u(l);this.#l.set(e,c),this.#l.set(r,c);const d=this.#p(l);return this.#f(d),e&&this.#x(i,d),c}addHighlightHCMFilter(e,t,i,r,l){const c=`${t}-${i}-${r}-${l}`;let d=this.#d.get(e);if(d?.key===c||(d?(d.filter?.remove(),d.key=c,d.url="none",d.filter=null):(d={key:c,url:"none",filter:null},this.#d.set(e,d)),!t||!i))return d.url;const[f,p]=[t,i].map(this.#y.bind(this));let m=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),x=Math.round(.2126*p[0]+.7152*p[1]+.0722*p[2]),[b,w]=[r,l].map(this.#y.bind(this));x<m&&([m,x,b,w]=[x,m,w,b]),this.#c.style.color="";const y=(j,S,P)=>{const k=new Array(256),L=(x-m)/P,T=j/255,I=(S-j)/(255*P);let $=0;for(let te=0;te<=P;te++){const oe=Math.round(m+te*L),ae=T+te*I;for(let ne=$;ne<=oe;ne++)k[ne]=ae;$=oe+1}for(let te=$;te<256;te++)k[te]=k[$-1];return k.join(",")},N=`g_${this.#n}_hcm_${e}_filter`,_=d.filter=this.#p(N);return this.#a(_),this.#m(y(b[0],w[0],5),y(b[1],w[1],5),y(b[2],w[2],5),_),d.url=this.#u(N),d.url}destroy(e=!1){e&&this.#i?.size||(this.#s?.parentNode.parentNode.remove(),this.#s=null,this.#t?.clear(),this.#t=null,this.#i?.clear(),this.#i=null,this.#o=0)}#f(e){const t=this.#r.createElementNS(ks,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#a(e){const t=this.#r.createElementNS(ks,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#p(e){const t=this.#r.createElementNS(ks,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#c.append(t),t}#g(e,t,i){const r=this.#r.createElementNS(ks,t);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),e.append(r)}#m(e,t,i,r){const l=this.#r.createElementNS(ks,"feComponentTransfer");r.append(l),this.#g(l,"feFuncR",e),this.#g(l,"feFuncG",t),this.#g(l,"feFuncB",i)}#x(e,t){const i=this.#r.createElementNS(ks,"feComponentTransfer");t.append(i),this.#g(i,"feFuncA",e)}#y(e){return this.#c.style.color=e,Bc(getComputedStyle(this.#c).getPropertyValue("color"))}}class op{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Fe("Abstract method `_fetch` called.")}}class cp extends op{async _fetch(e){const t=await sl(e,"arraybuffer");return new Uint8Array(t)}}yt&&Ee("Please use the `legacy` build in Node.js environments.");async function dp(u){const t=await process.getBuiltinModule("fs").promises.readFile(u);return new Uint8Array(t)}class K0 extends lp{}class Q0 extends ip{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class J0 extends rp{async _fetch(e){return dp(e)}}class Z0 extends op{async _fetch(e){return dp(e)}}const bt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Ec(u,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,i),u.clip(r)}class Wc{getPattern(){Fe("Abstract method `getPattern` called.")}}class ev extends Wc{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(e,t,i,r){let l;if(r===bt.STROKE||r===bt.FILL){const c=t.current.getClippedPathBoundingBox(r,He(e))||[0,0,0,0],d=Math.ceil(c[2]-c[0])||1,f=Math.ceil(c[3]-c[1])||1,p=t.cachedCanvases.getCanvas("pattern",d,f),m=p.context;m.clearRect(0,0,m.canvas.width,m.canvas.height),m.beginPath(),m.rect(0,0,m.canvas.width,m.canvas.height),m.translate(-c[0],-c[1]),i=ge.transform(i,[1,0,0,1,c[0],c[1]]),m.transform(...t.baseTransform),this.matrix&&m.transform(...this.matrix),Ec(m,this._bbox),m.fillStyle=this._createGradient(m),m.fill(),l=e.createPattern(p.canvas,"no-repeat");const x=new DOMMatrix(i);l.setTransform(x)}else Ec(e,this._bbox),l=this._createGradient(e);return l}}function pc(u,e,t,i,r,l,c,d){const f=e.coords,p=e.colors,m=u.data,x=u.width*4;let b;f[t+1]>f[i+1]&&(b=t,t=i,i=b,b=l,l=c,c=b),f[i+1]>f[r+1]&&(b=i,i=r,r=b,b=c,c=d,d=b),f[t+1]>f[i+1]&&(b=t,t=i,i=b,b=l,l=c,c=b);const w=(f[t]+e.offsetX)*e.scaleX,y=(f[t+1]+e.offsetY)*e.scaleY,N=(f[i]+e.offsetX)*e.scaleX,_=(f[i+1]+e.offsetY)*e.scaleY,j=(f[r]+e.offsetX)*e.scaleX,S=(f[r+1]+e.offsetY)*e.scaleY;if(y>=S)return;const P=p[l],k=p[l+1],L=p[l+2],T=p[c],I=p[c+1],$=p[c+2],te=p[d],oe=p[d+1],ae=p[d+2],ne=Math.round(y),se=Math.round(S);let xe,Se,X,Z,q,re,Q,V;for(let z=ne;z<=se;z++){if(z<_){const ee=z<y?0:(y-z)/(y-_);xe=w-(w-N)*ee,Se=P-(P-T)*ee,X=k-(k-I)*ee,Z=L-(L-$)*ee}else{let ee;z>S?ee=1:_===S?ee=0:ee=(_-z)/(_-S),xe=N-(N-j)*ee,Se=T-(T-te)*ee,X=I-(I-oe)*ee,Z=$-($-ae)*ee}let ce;z<y?ce=0:z>S?ce=1:ce=(y-z)/(y-S),q=w-(w-j)*ce,re=P-(P-te)*ce,Q=k-(k-oe)*ce,V=L-(L-ae)*ce;const ve=Math.round(Math.min(xe,q)),U=Math.round(Math.max(xe,q));let B=x*z+ve*4;for(let ee=ve;ee<=U;ee++)ce=(xe-ee)/(xe-q),ce<0?ce=0:ce>1&&(ce=1),m[B++]=Se-(Se-re)*ce|0,m[B++]=X-(X-Q)*ce|0,m[B++]=Z-(Z-V)*ce|0,m[B++]=255}}function tv(u,e,t){const i=e.coords,r=e.colors;let l,c;switch(e.type){case"lattice":const d=e.verticesPerRow,f=Math.floor(i.length/d)-1,p=d-1;for(l=0;l<f;l++){let m=l*d;for(let x=0;x<p;x++,m++)pc(u,t,i[m],i[m+1],i[m+d],r[m],r[m+1],r[m+d]),pc(u,t,i[m+d+1],i[m+1],i[m+d],r[m+d+1],r[m+1],r[m+d])}break;case"triangles":for(l=0,c=i.length;l<c;l+=3)pc(u,t,i[l],i[l+1],i[l+2],r[l],r[l+1],r[l+2]);break;default:throw new Error("illegal figure")}}class sv extends Wc{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,i){const d=Math.floor(this._bounds[0]),f=Math.floor(this._bounds[1]),p=Math.ceil(this._bounds[2])-d,m=Math.ceil(this._bounds[3])-f,x=Math.min(Math.ceil(Math.abs(p*e[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(m*e[1]*1.1)),3e3),w=p/x,y=m/b,N={coords:this._coords,colors:this._colors,offsetX:-d,offsetY:-f,scaleX:1/w,scaleY:1/y},_=x+4,j=b+4,S=i.getCanvas("mesh",_,j),P=S.context,k=P.createImageData(x,b);if(t){const T=k.data;for(let I=0,$=T.length;I<$;I+=4)T[I]=t[0],T[I+1]=t[1],T[I+2]=t[2],T[I+3]=255}for(const T of this._figures)tv(k,T,N);return P.putImageData(k,2,2),{canvas:S.canvas,offsetX:d-2*w,offsetY:f-2*y,scaleX:w,scaleY:y}}getPattern(e,t,i,r){Ec(e,this._bbox);let l;if(r===bt.SHADING)l=ge.singularValueDecompose2dScale(He(e));else if(l=ge.singularValueDecompose2dScale(t.baseTransform),this.matrix){const d=ge.singularValueDecompose2dScale(this.matrix);l=[l[0]*d[0],l[1]*d[1]]}const c=this._createMeshCanvas(l,r===bt.SHADING?null:this._background,t.cachedCanvases);return r!==bt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(c.offsetX,c.offsetY),e.scale(c.scaleX,c.scaleY),e.createPattern(c.canvas,"no-repeat")}}class nv extends Wc{getPattern(){return"hotpink"}}function iv(u){switch(u[0]){case"RadialAxial":return new ev(u);case"Mesh":return new sv(u);case"Dummy":return new nv}throw new Error(`Unknown IR type: ${u[0]}`)}const xf={COLORED:1,UNCOLORED:2};class Gc{static MAX_PATTERN_SIZE=3e3;constructor(e,t,i,r,l){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=i,this.canvasGraphicsFactory=r,this.baseTransform=l}createPatternCanvas(e){const{bbox:t,operatorList:i,paintType:r,tilingType:l,color:c,canvasGraphicsFactory:d}=this;let{xstep:f,ystep:p}=this;f=Math.abs(f),p=Math.abs(p),el("TilingType: "+l);const m=t[0],x=t[1],b=t[2],w=t[3],y=b-m,N=w-x,_=ge.singularValueDecompose2dScale(this.matrix),j=ge.singularValueDecompose2dScale(this.baseTransform),S=_[0]*j[0],P=_[1]*j[1];let k=y,L=N,T=!1,I=!1;const $=Math.ceil(f*S),te=Math.ceil(p*P),oe=Math.ceil(y*S),ae=Math.ceil(N*P);$>=oe?k=f:T=!0,te>=ae?L=p:I=!0;const ne=this.getSizeAndScale(k,this.ctx.canvas.width,S),se=this.getSizeAndScale(L,this.ctx.canvas.height,P),xe=e.cachedCanvases.getCanvas("pattern",ne.size,se.size),Se=xe.context,X=d.createCanvasGraphics(Se);if(X.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(X,r,c),Se.translate(-ne.scale*m,-se.scale*x),X.transform(ne.scale,0,0,se.scale,0,0),Se.save(),this.clipBbox(X,m,x,b,w),X.baseTransform=He(X.ctx),X.executeOperatorList(i),X.endDrawing(),Se.restore(),T||I){const Z=xe.canvas;T&&(k=f),I&&(L=p);const q=this.getSizeAndScale(k,this.ctx.canvas.width,S),re=this.getSizeAndScale(L,this.ctx.canvas.height,P),Q=q.size,V=re.size,z=e.cachedCanvases.getCanvas("pattern-workaround",Q,V),ce=z.context,ve=T?Math.floor(y/f):0,U=I?Math.floor(N/p):0;for(let B=0;B<=ve;B++)for(let ee=0;ee<=U;ee++)ce.drawImage(Z,Q*B,V*ee,Q,V,0,0,Q,V);return{canvas:z.canvas,scaleX:q.scale,scaleY:re.scale,offsetX:m,offsetY:x}}return{canvas:xe.canvas,scaleX:ne.scale,scaleY:se.scale,offsetX:m,offsetY:x}}getSizeAndScale(e,t,i){const r=Math.max(Gc.MAX_PATTERN_SIZE,t);let l=Math.ceil(e*i);return l>=r?l=r:i=l/e,{scale:i,size:l}}clipBbox(e,t,i,r,l){const c=r-t,d=l-i;e.ctx.rect(t,i,c,d),e.current.updateRectMinMax(He(e.ctx),[t,i,r,l]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const r=e.ctx,l=e.current;switch(t){case xf.COLORED:const c=this.ctx;r.fillStyle=c.fillStyle,r.strokeStyle=c.strokeStyle,l.fillColor=c.fillStyle,l.strokeColor=c.strokeStyle;break;case xf.UNCOLORED:const d=ge.makeHexColor(i[0],i[1],i[2]);r.fillStyle=d,r.strokeStyle=d,l.fillColor=d,l.strokeColor=d;break;default:throw new P0(`Unsupported paint type: ${t}`)}}getPattern(e,t,i,r){let l=i;r!==bt.SHADING&&(l=ge.transform(l,t.baseTransform),this.matrix&&(l=ge.transform(l,this.matrix)));const c=this.createPatternCanvas(t);let d=new DOMMatrix(l);d=d.translate(c.offsetX,c.offsetY),d=d.scale(1/c.scaleX,1/c.scaleY);const f=e.createPattern(c.canvas,"repeat");return f.setTransform(d),f}}function rv({src:u,srcPos:e=0,dest:t,width:i,height:r,nonBlackColor:l=4294967295,inverseDecode:c=!1}){const d=kt.isLittleEndian?4278190080:255,[f,p]=c?[l,d]:[d,l],m=i>>3,x=i&7,b=u.length;t=new Uint32Array(t.buffer);let w=0;for(let y=0;y<r;y++){for(const _=e+m;e<_;e++){const j=e<b?u[e]:255;t[w++]=j&128?p:f,t[w++]=j&64?p:f,t[w++]=j&32?p:f,t[w++]=j&16?p:f,t[w++]=j&8?p:f,t[w++]=j&4?p:f,t[w++]=j&2?p:f,t[w++]=j&1?p:f}if(x===0)continue;const N=e<b?u[e++]:255;for(let _=0;_<x;_++)t[w++]=N&1<<7-_?p:f}return{srcPos:e,destPos:w}}const vf=16,bf=100,av=15,yf=10,wf=1e3,It=16;function lv(u,e){if(u._removeMirroring)throw new Error("Context is already forwarding operations.");u.__originalSave=u.save,u.__originalRestore=u.restore,u.__originalRotate=u.rotate,u.__originalScale=u.scale,u.__originalTranslate=u.translate,u.__originalTransform=u.transform,u.__originalSetTransform=u.setTransform,u.__originalResetTransform=u.resetTransform,u.__originalClip=u.clip,u.__originalMoveTo=u.moveTo,u.__originalLineTo=u.lineTo,u.__originalBezierCurveTo=u.bezierCurveTo,u.__originalRect=u.rect,u.__originalClosePath=u.closePath,u.__originalBeginPath=u.beginPath,u._removeMirroring=()=>{u.save=u.__originalSave,u.restore=u.__originalRestore,u.rotate=u.__originalRotate,u.scale=u.__originalScale,u.translate=u.__originalTranslate,u.transform=u.__originalTransform,u.setTransform=u.__originalSetTransform,u.resetTransform=u.__originalResetTransform,u.clip=u.__originalClip,u.moveTo=u.__originalMoveTo,u.lineTo=u.__originalLineTo,u.bezierCurveTo=u.__originalBezierCurveTo,u.rect=u.__originalRect,u.closePath=u.__originalClosePath,u.beginPath=u.__originalBeginPath,delete u._removeMirroring},u.save=function(){e.save(),this.__originalSave()},u.restore=function(){e.restore(),this.__originalRestore()},u.translate=function(i,r){e.translate(i,r),this.__originalTranslate(i,r)},u.scale=function(i,r){e.scale(i,r),this.__originalScale(i,r)},u.transform=function(i,r,l,c,d,f){e.transform(i,r,l,c,d,f),this.__originalTransform(i,r,l,c,d,f)},u.setTransform=function(i,r,l,c,d,f){e.setTransform(i,r,l,c,d,f),this.__originalSetTransform(i,r,l,c,d,f)},u.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},u.rotate=function(i){e.rotate(i),this.__originalRotate(i)},u.clip=function(i){e.clip(i),this.__originalClip(i)},u.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},u.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},u.bezierCurveTo=function(t,i,r,l,c,d){e.bezierCurveTo(t,i,r,l,c,d),this.__originalBezierCurveTo(t,i,r,l,c,d)},u.rect=function(t,i,r,l){e.rect(t,i,r,l),this.__originalRect(t,i,r,l)},u.closePath=function(){e.closePath(),this.__originalClosePath()},u.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class ov{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,i)):(r=this.canvasFactory.create(t,i),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Va(u,e,t,i,r,l,c,d,f,p){const[m,x,b,w,y,N]=He(u);if(x===0&&b===0){const S=c*m+y,P=Math.round(S),k=d*w+N,L=Math.round(k),T=(c+f)*m+y,I=Math.abs(Math.round(T)-P)||1,$=(d+p)*w+N,te=Math.abs(Math.round($)-L)||1;return u.setTransform(Math.sign(m),0,0,Math.sign(w),P,L),u.drawImage(e,t,i,r,l,0,0,I,te),u.setTransform(m,x,b,w,y,N),[I,te]}if(m===0&&w===0){const S=d*b+y,P=Math.round(S),k=c*x+N,L=Math.round(k),T=(d+p)*b+y,I=Math.abs(Math.round(T)-P)||1,$=(c+f)*x+N,te=Math.abs(Math.round($)-L)||1;return u.setTransform(0,Math.sign(x),Math.sign(b),0,P,L),u.drawImage(e,t,i,r,l,0,0,te,I),u.setTransform(m,x,b,w,y,N),[te,I]}u.drawImage(e,t,i,r,l,c,d,f,p);const _=Math.hypot(m,x),j=Math.hypot(b,w);return[_*f,j*p]}function cv(u){const{width:e,height:t}=u;if(e>wf||t>wf)return null;const i=1e3,r=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),l=e+1;let c=new Uint8Array(l*(t+1)),d,f,p;const m=e+7&-8;let x=new Uint8Array(m*t),b=0;for(const j of u.data){let S=128;for(;S>0;)x[b++]=j&S?0:255,S>>=1}let w=0;for(b=0,x[b]!==0&&(c[0]=1,++w),f=1;f<e;f++)x[b]!==x[b+1]&&(c[f]=x[b]?2:1,++w),b++;for(x[b]!==0&&(c[f]=2,++w),d=1;d<t;d++){b=d*m,p=d*l,x[b-m]!==x[b]&&(c[p]=x[b]?1:8,++w);let j=(x[b]?4:0)+(x[b-m]?8:0);for(f=1;f<e;f++)j=(j>>2)+(x[b+1]?4:0)+(x[b-m+1]?8:0),r[j]&&(c[p+f]=r[j],++w),b++;if(x[b-m]!==x[b]&&(c[p+f]=x[b]?2:4,++w),w>i)return null}for(b=m*(t-1),p=d*l,x[b]!==0&&(c[p]=8,++w),f=1;f<e;f++)x[b]!==x[b+1]&&(c[p+f]=x[b]?4:8,++w),b++;if(x[b]!==0&&(c[p+f]=4,++w),w>i)return null;const y=new Int32Array([0,l,-1,0,-l,0,0,0,1]),N=new Path2D;for(d=0;w&&d<=t;d++){let j=d*l;const S=j+e;for(;j<S&&!c[j];)j++;if(j===S)continue;N.moveTo(j%l,d);const P=j;let k=c[j];do{const L=y[k];do j+=L;while(!c[j]);const T=c[j];T!==5&&T!==10?(k=T,c[j]=0):(k=T&51*k>>4,c[j]&=k>>2|k<<2),N.lineTo(j%l,j/l|0),c[j]||--w}while(P!==j);--d}return x=null,c=null,function(j){j.save(),j.scale(1/e,-1/t),j.translate(0,-t),j.fill(N),j.beginPath(),j.restore()}}class Nf{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=Zf,this.textMatrixScale=1,this.fontMatrix=_c,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=vt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,i){[t,i]=ge.applyTransform([t,i],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(e,t){const i=ge.applyTransform(t,e),r=ge.applyTransform(t.slice(2),e),l=ge.applyTransform([t[0],t[3]],e),c=ge.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,i[0],r[0],l[0],c[0]),this.minY=Math.min(this.minY,i[1],r[1],l[1],c[1]),this.maxX=Math.max(this.maxX,i[0],r[0],l[0],c[0]),this.maxY=Math.max(this.maxY,i[1],r[1],l[1],c[1])}updateScalingPathMinMax(e,t){ge.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,i,r,l,c,d,f,p,m){const x=ge.bezierBoundingBox(t,i,r,l,c,d,f,p,m);m||this.updateRectMinMax(e,x)}getPathBoundingBox(e=bt.FILL,t=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(e===bt.STROKE){t||Fe("Stroke bounding box must include transform.");const r=ge.singularValueDecompose2dScale(t),l=r[0]*this.lineWidth/2,c=r[1]*this.lineWidth/2;i[0]-=l,i[1]-=c,i[2]+=l,i[3]+=c}return i}updateClipFromPath(){const e=ge.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=bt.FILL,t=null){return ge.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Af(u,e){if(e instanceof ImageData){u.putImageData(e,0,0);return}const t=e.height,i=e.width,r=t%It,l=(t-r)/It,c=r===0?l:l+1,d=u.createImageData(i,It);let f=0,p;const m=e.data,x=d.data;let b,w,y,N;if(e.kind===Fa.GRAYSCALE_1BPP){const _=m.byteLength,j=new Uint32Array(x.buffer,0,x.byteLength>>2),S=j.length,P=i+7>>3,k=4294967295,L=kt.isLittleEndian?4278190080:255;for(b=0;b<c;b++){for(y=b<l?It:r,p=0,w=0;w<y;w++){const T=_-f;let I=0;const $=T>P?i:T*8-7,te=$&-8;let oe=0,ae=0;for(;I<te;I+=8)ae=m[f++],j[p++]=ae&128?k:L,j[p++]=ae&64?k:L,j[p++]=ae&32?k:L,j[p++]=ae&16?k:L,j[p++]=ae&8?k:L,j[p++]=ae&4?k:L,j[p++]=ae&2?k:L,j[p++]=ae&1?k:L;for(;I<$;I++)oe===0&&(ae=m[f++],oe=128),j[p++]=ae&oe?k:L,oe>>=1}for(;p<S;)j[p++]=0;u.putImageData(d,0,b*It)}}else if(e.kind===Fa.RGBA_32BPP){for(w=0,N=i*It*4,b=0;b<l;b++)x.set(m.subarray(f,f+N)),f+=N,u.putImageData(d,0,w),w+=It;b<c&&(N=i*r*4,x.set(m.subarray(f,f+N)),u.putImageData(d,0,w))}else if(e.kind===Fa.RGB_24BPP)for(y=It,N=i*y,b=0;b<c;b++){for(b>=l&&(y=r,N=i*y),p=0,w=N;w--;)x[p++]=m[f++],x[p++]=m[f++],x[p++]=m[f++],x[p++]=255;u.putImageData(d,0,b*It)}else throw new Error(`bad image kind: ${e.kind}`)}function _f(u,e){if(e.bitmap){u.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,r=t%It,l=(t-r)/It,c=r===0?l:l+1,d=u.createImageData(i,It);let f=0;const p=e.data,m=d.data;for(let x=0;x<c;x++){const b=x<l?It:r;({srcPos:f}=rv({src:p,srcPos:f,dest:m,width:i,height:b,nonBlackColor:0})),u.putImageData(d,0,x*It)}}function ir(u,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)u[i]!==void 0&&(e[i]=u[i]);u.setLineDash!==void 0&&(e.setLineDash(u.getLineDash()),e.lineDashOffset=u.lineDashOffset)}function Ia(u){if(u.strokeStyle=u.fillStyle="#000000",u.fillRule="nonzero",u.globalAlpha=1,u.lineWidth=1,u.lineCap="butt",u.lineJoin="miter",u.miterLimit=10,u.globalCompositeOperation="source-over",u.font="10px sans-serif",u.setLineDash!==void 0&&(u.setLineDash([]),u.lineDashOffset=0),!yt){const{filter:e}=u;e!=="none"&&e!==""&&(u.filter="none")}}function Sf(u,e){if(e)return!0;const t=ge.singularValueDecompose2dScale(u);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*li.PDF_TO_CSS_UNITS);return t[0]<=i&&t[1]<=i}const dv=["butt","round","square"],uv=["miter","round","bevel"],hv={},jf={};class si{constructor(e,t,i,r,l,{optionalContentConfig:c,markedContentStack:d=null},f,p){this.ctx=e,this.current=new Nf(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=r,this.filterFactory=l,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=d||[],this.optionalContentConfig=c,this.cachedCanvases=new ov(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=f,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=p,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:r=null}){const l=this.ctx.canvas.width,c=this.ctx.canvas.height,d=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,l,c),this.ctx.fillStyle=d,i){const f=this.cachedCanvases.getCanvas("transparent",l,c);this.compositeCtx=this.ctx,this.transparentCanvas=f.canvas,this.ctx=f.context,this.ctx.save(),this.ctx.transform(...He(this.compositeCtx))}this.ctx.save(),Ia(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=He(this.ctx)}executeOperatorList(e,t,i,r){const l=e.argsArray,c=e.fnArray;let d=t||0;const f=l.length;if(f===d)return d;const p=f-d>yf&&typeof i=="function",m=p?Date.now()+av:0;let x=0;const b=this.commonObjs,w=this.objs;let y;for(;;){if(r!==void 0&&d===r.nextBreakPoint)return r.breakIt(d,i),d;if(y=c[d],y!==ls.dependency)this[y].apply(this,l[d]);else for(const N of l[d]){const _=N.startsWith("g_")?b:w;if(!_.has(N))return _.get(N,i),d}if(d++,d===f)return d;if(p&&++x>yf){if(Date.now()>m)return i(),d;x=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const i=e.width??e.displayWidth,r=e.height??e.displayHeight;let l=Math.max(Math.hypot(t[0],t[1]),1),c=Math.max(Math.hypot(t[2],t[3]),1),d=i,f=r,p="prescale1",m,x;for(;l>2&&d>1||c>2&&f>1;){let b=d,w=f;l>2&&d>1&&(b=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d/2),l/=d/b),c>2&&f>1&&(w=f>=16384?Math.floor(f/2)-1||1:Math.ceil(f)/2,c/=f/w),m=this.cachedCanvases.getCanvas(p,b,w),x=m.context,x.clearRect(0,0,b,w),x.drawImage(e,0,0,d,f,0,0,b,w),e=m.canvas,d=b,f=w,p=p==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:d,paintHeight:f}}_createMaskCanvas(e){const t=this.ctx,{width:i,height:r}=e,l=this.current.fillColor,c=this.current.patternFill,d=He(t);let f,p,m,x;if((e.bitmap||e.data)&&e.count>1){const $=e.bitmap||e.data.buffer;p=JSON.stringify(c?d:[d.slice(0,4),l]),f=this._cachedBitmapsMap.get($),f||(f=new Map,this._cachedBitmapsMap.set($,f));const te=f.get(p);if(te&&!c){const oe=Math.round(Math.min(d[0],d[2])+d[4]),ae=Math.round(Math.min(d[1],d[3])+d[5]);return{canvas:te,offsetX:oe,offsetY:ae}}m=te}m||(x=this.cachedCanvases.getCanvas("maskCanvas",i,r),_f(x.context,e));let b=ge.transform(d,[1/i,0,0,-1/r,0,0]);b=ge.transform(b,[1,0,0,1,0,-r]);const[w,y,N,_]=ge.getAxialAlignedBoundingBox([0,0,i,r],b),j=Math.round(N-w)||1,S=Math.round(_-y)||1,P=this.cachedCanvases.getCanvas("fillCanvas",j,S),k=P.context,L=w,T=y;k.translate(-L,-T),k.transform(...b),m||(m=this._scaleImage(x.canvas,ms(k)),m=m.img,f&&c&&f.set(p,m)),k.imageSmoothingEnabled=Sf(He(k),e.interpolate),Va(k,m,0,0,m.width,m.height,0,0,i,r),k.globalCompositeOperation="source-in";const I=ge.transform(ms(k),[1,0,0,1,-L,-T]);return k.fillStyle=c?l.getPattern(t,this,I,bt.FILL):l,k.fillRect(0,0,i,r),f&&!c&&(this.cachedCanvases.delete("fillCanvas"),f.set(p,P.canvas)),{canvas:P.canvas,offsetX:Math.round(L),offsetY:Math.round(T)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=dv[e]}setLineJoin(e){this.ctx.lineJoin=uv[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,i]of e)switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(i,e,t);this.suspendedCtx=this.ctx,this.ctx=r.context;const l=this.ctx;l.setTransform(...He(this.suspendedCtx)),ir(this.suspendedCtx,l),lv(l,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),ir(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,r){const l=r[0],c=r[1],d=r[2]-l,f=r[3]-c;d===0||f===0||(this.genericComposeSMask(t.context,i,d,f,t.subtype,t.backdrop,t.transferMap,l,c,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,r,l,c,d,f,p,m,x){let b=e.canvas,w=f-m,y=p-x;if(c){const _=ge.makeHexColor(...c);if(w<0||y<0||w+i>b.width||y+r>b.height){const j=this.cachedCanvases.getCanvas("maskExtension",i,r),S=j.context;S.drawImage(b,-w,-y),S.globalCompositeOperation="destination-atop",S.fillStyle=_,S.fillRect(0,0,i,r),S.globalCompositeOperation="source-over",b=j.canvas,w=y=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const j=new Path2D;j.rect(w,y,i,r),e.clip(j),e.globalCompositeOperation="destination-atop",e.fillStyle=_,e.fillRect(w,y,i,r),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),l==="Alpha"&&d?t.filter=this.filterFactory.addAlphaFilter(d):l==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(d));const N=new Path2D;N.rect(f,p,i,r),t.clip(N),t.globalCompositeOperation="destination-in",t.drawImage(b,w,y,i,r,f,p,i,r),t.restore()}save(){this.inSMaskMode?(ir(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),ir(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,i,r,l,c){this.ctx.transform(e,t,i,r,l,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i){const r=this.ctx,l=this.current;let c=l.x,d=l.y,f,p;const m=He(r),x=m[0]===0&&m[3]===0||m[1]===0&&m[2]===0,b=x?i.slice(0):null;for(let w=0,y=0,N=e.length;w<N;w++)switch(e[w]|0){case ls.rectangle:c=t[y++],d=t[y++];const _=t[y++],j=t[y++],S=c+_,P=d+j;r.moveTo(c,d),_===0||j===0?r.lineTo(S,P):(r.lineTo(S,d),r.lineTo(S,P),r.lineTo(c,P)),x||l.updateRectMinMax(m,[c,d,S,P]),r.closePath();break;case ls.moveTo:c=t[y++],d=t[y++],r.moveTo(c,d),x||l.updatePathMinMax(m,c,d);break;case ls.lineTo:c=t[y++],d=t[y++],r.lineTo(c,d),x||l.updatePathMinMax(m,c,d);break;case ls.curveTo:f=c,p=d,c=t[y+4],d=t[y+5],r.bezierCurveTo(t[y],t[y+1],t[y+2],t[y+3],c,d),l.updateCurvePathMinMax(m,f,p,t[y],t[y+1],t[y+2],t[y+3],c,d,b),y+=6;break;case ls.curveTo2:f=c,p=d,r.bezierCurveTo(c,d,t[y],t[y+1],t[y+2],t[y+3]),l.updateCurvePathMinMax(m,f,p,c,d,t[y],t[y+1],t[y+2],t[y+3],b),c=t[y+2],d=t[y+3],y+=4;break;case ls.curveTo3:f=c,p=d,c=t[y+2],d=t[y+3],r.bezierCurveTo(t[y],t[y+1],c,d,c,d),l.updateCurvePathMinMax(m,f,p,t[y],t[y+1],c,d,c,d,b),y+=4;break;case ls.closePath:r.closePath();break}x&&l.updateScalingPathMinMax(m,b),l.setCurrentPoint(c,d)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,i=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&i?.getPattern?(t.save(),t.strokeStyle=i.getPattern(t,this,ms(t),bt.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,i=this.current.fillColor,r=this.current.patternFill;let l=!1;r&&(t.save(),t.fillStyle=i.getPattern(t,this,ms(t),bt.FILL),l=!0);const c=this.current.getClippedPathBoundingBox();this.contentVisible&&c!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),l&&t.restore(),e&&this.consumePath(c)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=hv}eoClip(){this.pendingClip=jf}beginText(){this.current.textMatrix=Zf,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const i=new Path2D,r=t.getTransform().invertSelf();for(const{transform:l,x:c,y:d,fontSize:f,path:p}of e)i.addPath(p,new DOMMatrix(l).preMultiplySelf(r).translate(c,d).scale(f,-f));t.clip(i),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const i=this.commonObjs.get(e),r=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=i.fontMatrix||_c,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&Ee("Invalid font matrix for font "+e),t<0?(t=-t,r.fontDirection=-1):r.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const l=i.loadedName||"sans-serif",c=i.systemFontInfo?.css||`"${l}", ${i.fallbackName}`;let d="normal";i.black?d="900":i.bold&&(d="bold");const f=i.italic?"italic":"normal";let p=t;t<vf?p=vf:t>bf&&(p=bf),this.current.fontSizeScale=t/p,this.ctx.font=`${f} ${d} ${p}px ${c}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,i,r,l,c){this.current.textMatrix=[e,t,i,r,l,c],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#s(e,t,i){const r=new Path2D;return r.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),r}paintChar(e,t,i,r,l){const c=this.ctx,d=this.current,f=d.font,p=d.textRenderingMode,m=d.fontSize/d.fontSizeScale,x=p&vt.FILL_STROKE_MASK,b=!!(p&vt.ADD_TO_PATH_FLAG),w=d.patternFill&&!f.missingFile,y=d.patternStroke&&!f.missingFile;let N;if((f.disableFontFace||b||w||y)&&(N=f.getPathGenerator(this.commonObjs,e)),f.disableFontFace||w||y){if(c.save(),c.translate(t,i),c.scale(m,-m),x===vt.FILL||x===vt.FILL_STROKE)if(r){const _=c.getTransform();c.setTransform(...r),c.fill(this.#s(N,_,r))}else c.fill(N);if(x===vt.STROKE||x===vt.FILL_STROKE)if(l){const _=c.getTransform();c.setTransform(...l),c.stroke(this.#s(N,_,l))}else c.lineWidth/=m,c.stroke(N);c.restore()}else(x===vt.FILL||x===vt.FILL_STROKE)&&c.fillText(e,t,i),(x===vt.STROKE||x===vt.FILL_STROKE)&&c.strokeText(e,t,i);b&&(this.pendingTextPaths||=[]).push({transform:He(c),x:t,y:i,fontSize:m,path:N})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){i=!0;break}return Pe(this,"isFontSubpixelAAEnabled",i)}showText(e){const t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(e);const r=t.fontSize;if(r===0)return;const l=this.ctx,c=t.fontSizeScale,d=t.charSpacing,f=t.wordSpacing,p=t.fontDirection,m=t.textHScale*p,x=e.length,b=i.vertical,w=b?1:-1,y=i.defaultVMetrics,N=r*t.fontMatrix[0],_=t.textRenderingMode===vt.FILL&&!i.disableFontFace&&!t.patternFill;l.save(),l.transform(...t.textMatrix),l.translate(t.x,t.y+t.textRise),p>0?l.scale(m,-1):l.scale(m,1);let j,S;if(t.patternFill){l.save();const I=t.fillColor.getPattern(l,this,ms(l),bt.FILL);j=He(l),l.restore(),l.fillStyle=I}if(t.patternStroke){l.save();const I=t.strokeColor.getPattern(l,this,ms(l),bt.STROKE);S=He(l),l.restore(),l.strokeStyle=I}let P=t.lineWidth;const k=t.textMatrixScale;if(k===0||P===0){const I=t.textRenderingMode&vt.FILL_STROKE_MASK;(I===vt.STROKE||I===vt.FILL_STROKE)&&(P=this.getSinglePixelWidth())}else P/=k;if(c!==1&&(l.scale(c,c),P/=c),l.lineWidth=P,i.isInvalidPDFjsFont){const I=[];let $=0;for(const te of e)I.push(te.unicode),$+=te.width;l.fillText(I.join(""),0,0),t.x+=$*N*m,l.restore(),this.compose();return}let L=0,T;for(T=0;T<x;++T){const I=e[T];if(typeof I=="number"){L+=w*I*r/1e3;continue}let $=!1;const te=(I.isSpace?f:0)+d,oe=I.fontChar,ae=I.accent;let ne,se,xe=I.width;if(b){const X=I.vmetric||y,Z=-(I.vmetric?X[1]:xe*.5)*N,q=X[2]*N;xe=X?-X[0]:xe,ne=Z/c,se=(L+q)/c}else ne=L/c,se=0;if(i.remeasure&&xe>0){const X=l.measureText(oe).width*1e3/r*c;if(xe<X&&this.isFontSubpixelAAEnabled){const Z=xe/X;$=!0,l.save(),l.scale(Z,1),ne/=Z}else xe!==X&&(ne+=(xe-X)/2e3*r/c)}if(this.contentVisible&&(I.isInFont||i.missingFile)){if(_&&!ae)l.fillText(oe,ne,se);else if(this.paintChar(oe,ne,se,j,S),ae){const X=ne+r*ae.offset.x/c,Z=se-r*ae.offset.y/c;this.paintChar(ae.fontChar,X,Z,j,S)}}const Se=b?xe*N-te*p:xe*N+te*p;L+=Se,$&&l.restore()}b?t.y-=L:t.x+=L*m,l.restore(),this.compose()}showType3Text(e){const t=this.ctx,i=this.current,r=i.font,l=i.fontSize,c=i.fontDirection,d=r.vertical?1:-1,f=i.charSpacing,p=i.wordSpacing,m=i.textHScale*c,x=i.fontMatrix||_c,b=e.length,w=i.textRenderingMode===vt.INVISIBLE;let y,N,_,j;if(!(w||l===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...i.textMatrix),t.translate(i.x,i.y),t.scale(m,c),y=0;y<b;++y){if(N=e[y],typeof N=="number"){j=d*N*l/1e3,this.ctx.translate(j,0),i.x+=j*m;continue}const S=(N.isSpace?p:0)+f,P=r.charProcOperatorList[N.operatorListId];if(!P){Ee(`Type3 character "${N.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=N,this.save(),t.scale(l,l),t.transform(...x),this.executeOperatorList(P),this.restore()),_=ge.applyTransform([N.width,0],x)[0]*l+S,t.translate(_,0),i.x+=_*m}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,i,r,l,c){this.ctx.rect(i,r,l-i,c-r),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const i=e[1],r=this.baseTransform||He(this.ctx),l={createCanvasGraphics:c=>new si(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new Gc(e,i,this.ctx,l,r)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,i){this.ctx.strokeStyle=this.current.strokeColor=ge.makeHexColor(e,t,i),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,i){this.ctx.fillStyle=this.current.fillColor=ge.makeHexColor(e,t,i),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=iv(this.getObject(e)),this.cachedPatterns.set(e,i)),t&&(i.matrix=t),i}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const i=this._getPattern(e);t.fillStyle=i.getPattern(t,this,ms(t),bt.SHADING);const r=ms(t);if(r){const{width:l,height:c}=t.canvas,[d,f,p,m]=ge.getAxialAlignedBoundingBox([0,0,l,c],r);this.ctx.fillRect(d,f,p-d,m-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Fe("Should not call beginInlineImage")}beginImageData(){Fe("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=He(this.ctx),t)){const i=t[2]-t[0],r=t[3]-t[1];this.ctx.rect(t[0],t[1],i,r),this.current.updateRectMinMax(He(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||el("TODO: Support non-isolated groups."),e.knockout&&Ee("Knockout groups not supported.");const i=He(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=ge.getAxialAlignedBoundingBox(e.bbox,He(t));const l=[0,0,t.canvas.width,t.canvas.height];r=ge.intersect(r,l)||[0,0,0,0];const c=Math.floor(r[0]),d=Math.floor(r[1]),f=Math.max(Math.ceil(r[2])-c,1),p=Math.max(Math.ceil(r[3])-d,1);this.current.startNewPathAndClipBox([0,0,f,p]);let m="groupAt"+this.groupLevel;e.smask&&(m+="_smask_"+this.smaskCounter++%2);const x=this.cachedCanvases.getCanvas(m,f,p),b=x.context;b.translate(-c,-d),b.transform(...i),e.smask?this.smaskStack.push({canvas:x.canvas,context:b,offsetX:c,offsetY:d,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(c,d),t.save()),ir(t,b),this.ctx=b,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const r=He(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...r);const l=ge.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],r);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(e,t,i,r,l){if(this.#e(),Ia(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const c=t[2]-t[0],d=t[3]-t[1];if(l&&this.annotationCanvasMap){i=i.slice(),i[4]-=t[0],i[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=c,t[3]=d;const[f,p]=ge.singularValueDecompose2dScale(He(this.ctx)),{viewportScale:m}=this,x=Math.ceil(c*this.outputScaleX*m),b=Math.ceil(d*this.outputScaleY*m);this.annotationCanvas=this.canvasFactory.create(x,b);const{canvas:w,context:y}=this.annotationCanvas;this.annotationCanvasMap.set(e,w),this.annotationCanvas.savedCtx=this.ctx,this.ctx=y,this.ctx.save(),this.ctx.setTransform(f,0,0,-p,0,d*p),Ia(this.ctx)}else Ia(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],c,d),this.ctx.clip(),this.ctx.beginPath()}this.current=new Nf(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...r)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const i=this.ctx,r=this.processingType3;if(r&&(r.compiled===void 0&&(r.compiled=cv(e)),r.compiled)){r.compiled(i);return}const l=this._createMaskCanvas(e),c=l.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(c,l.offsetX,l.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i=0,r=0,l,c){if(!this.contentVisible)return;e=this.getObject(e.data,e);const d=this.ctx;d.save();const f=He(d);d.transform(t,i,r,l,0,0);const p=this._createMaskCanvas(e);d.setTransform(1,0,0,1,p.offsetX-f[4],p.offsetY-f[5]);for(let m=0,x=c.length;m<x;m+=2){const b=ge.transform(f,[t,i,r,l,c[m],c[m+1]]),[w,y]=ge.applyTransform([0,0],b);d.drawImage(p.canvas,w,y)}d.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,i=this.current.fillColor,r=this.current.patternFill;for(const l of e){const{data:c,width:d,height:f,transform:p}=l,m=this.cachedCanvases.getCanvas("maskCanvas",d,f),x=m.context;x.save();const b=this.getObject(c,l);_f(x,b),x.globalCompositeOperation="source-in",x.fillStyle=r?i.getPattern(x,this,ms(t),bt.FILL):i,x.fillRect(0,0,d,f),x.restore(),t.save(),t.transform(...p),t.scale(1,-1),Va(t,m.canvas,0,0,d,f,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Ee("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,i,r){if(!this.contentVisible)return;const l=this.getObject(e);if(!l){Ee("Dependent image isn't ready yet");return}const c=l.width,d=l.height,f=[];for(let p=0,m=r.length;p<m;p+=2)f.push({transform:[t,0,0,i,r[p],r[p+1]],x:0,y:0,w:c,h:d});this.paintInlineImageXObjectGroup(l,f)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:r}=e,l=this.cachedCanvases.getCanvas("inlineImage",i,r),c=l.context;return c.filter=this.current.transferMaps,c.drawImage(t,0,0),c.filter="none",l.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,i=e.height,r=this.ctx;if(this.save(),!yt){const{filter:d}=r;d!=="none"&&d!==""&&(r.filter="none")}r.scale(1/t,-1/i);let l;if(e.bitmap)l=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)l=e;else{const f=this.cachedCanvases.getCanvas("inlineImage",t,i).context;Af(f,e),l=this.applyTransferMapsToCanvas(f)}const c=this._scaleImage(l,ms(r));r.imageSmoothingEnabled=Sf(He(r),e.interpolate),Va(r,c.img,0,0,c.paintWidth,c.paintHeight,0,-i,t,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const i=this.ctx;let r;if(e.bitmap)r=e.bitmap;else{const l=e.width,c=e.height,f=this.cachedCanvases.getCanvas("inlineImage",l,c).context;Af(f,e),r=this.applyTransferMapsToCanvas(f)}for(const l of t)i.save(),i.transform(...l.transform),i.scale(1,-1),Va(i,r,l.x,l.y,l.w,l.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const i=this.ctx;this.pendingClip&&(t||(this.pendingClip===jf?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=He(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:r,d:l}=this.ctx.getTransform();let c,d;if(i===0&&r===0){const f=Math.abs(t),p=Math.abs(l);if(f===p)if(e===0)c=d=1/f;else{const m=f*e;c=d=m<1?1/m:1}else if(e===0)c=1/f,d=1/p;else{const m=f*e,x=p*e;c=m<1?1/m:1,d=x<1?1/x:1}}else{const f=Math.abs(t*l-i*r),p=Math.hypot(t,i),m=Math.hypot(r,l);if(e===0)c=m/f,d=p/f;else{const x=e*f;c=m>x?m/x:1,d=p>x?p/x:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=d}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:i}=this.current,[r,l]=this.getScaleForStroking();if(t.lineWidth=i||1,r===1&&l===1){t.stroke();return}const c=t.getLineDash();if(e&&t.save(),t.scale(r,l),c.length>0){const d=Math.max(r,l);t.setLineDash(c.map(f=>f/d)),t.lineDashOffset/=d}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const u in ls)si.prototype[u]!==void 0&&(si.prototype[ls[u]]=si.prototype[u]);class hr{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class fv{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}getAll(){return Dc(this.#e)}has(e){return this.#e.has(e)}}const ei=Symbol("INTERNAL");class pv{#e=!1;#t=!1;#s=!1;#n=!0;constructor(e,{name:t,intent:i,usage:r,rbGroups:l}){this.#e=!!(e&Bt.DISPLAY),this.#t=!!(e&Bt.PRINT),this.name=t,this.intent=i,this.usage=r,this.rbGroups=l}get visible(){if(this.#s)return this.#n;if(!this.#n)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,i=!1){e!==ei&&Fe("Internal method `_setVisible` called."),this.#s=i,this.#n=t}}class mv{#e=null;#t=new Map;#s=null;#n=null;constructor(e,t=Bt.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#n=e.order;for(const i of e.groups)this.#t.set(i.id,new pv(t,i));if(e.baseState==="OFF")for(const i of this.#t.values())i._setVisible(ei,!1);for(const i of e.on)this.#t.get(i)._setVisible(ei,!0);for(const i of e.off)this.#t.get(i)._setVisible(ei,!1);this.#s=this.getHash()}}#r(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let r=1;r<t;r++){const l=e[r];let c;if(Array.isArray(l))c=this.#r(l);else if(this.#t.has(l))c=this.#t.get(l).visible;else return Ee(`Optional content group not found: ${l}`),!0;switch(i){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return i==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return el("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(Ee(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#r(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return Ee(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return Ee(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return Ee(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return Ee(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return Ee(`Unknown optional content policy ${e.policy}.`),!0}return Ee(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){const r=this.#t.get(e);if(!r){Ee(`Optional content group not found: ${e}`);return}if(i&&t&&r.rbGroups.length)for(const l of r.rbGroups)for(const c of l)c!==e&&this.#t.get(c)?._setVisible(ei,!1,!0);r._setVisible(ei,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let i;for(const r of e){switch(r){case"ON":case"OFF":case"Toggle":i=r;continue}const l=this.#t.get(r);if(l)switch(i){case"ON":this.setVisibility(r,!0,t);break;case"OFF":this.setVisibility(r,!1,t);break;case"Toggle":this.setVisibility(r,!l.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#s===null||this.getHash()===this.#s}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?Dc(this.#t):null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new sp;for(const[t,i]of this.#t)e.update(`${t}:${i.visible}`);return this.#e=e.hexdigest()}}class gv{constructor(e,{disableRange:t=!1,disableStream:i=!1}){tt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:l,progressiveDone:c,contentDispositionFilename:d}=e;if(this._queuedChunks=[],this._progressiveDone=c,this._contentDispositionFilename=d,l?.length>0){const f=l instanceof Uint8Array&&l.byteLength===l.buffer.byteLength?l.buffer:new Uint8Array(l).buffer;this._queuedChunks.push(f)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((f,p)=>{this._onReceiveData({begin:f,chunk:p})}),e.addProgressListener((f,p)=>{this._onProgress({loaded:f,total:p})}),e.addProgressiveReadListener(f=>{this._onReceiveData({chunk:f})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const r=this._rangeReaders.some(function(l){return l._begin!==e?!1:(l._enqueue(i),!0)});tt(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){tt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new xv(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new vv(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class xv{constructor(e,t,i=!1,r=null){this._stream=e,this._done=i||!1,this._filename=zc(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(const l of this._queuedChunks)this._loaded+=l.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class vv{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function bv(u){let e=!0,t=i("filename\\*","i").exec(u);if(t){t=t[1];let m=d(t);return m=unescape(m),m=f(m),m=p(m),l(m)}if(t=c(u),t){const m=p(t);return l(m)}if(t=i("filename","i").exec(u),t){t=t[1];let m=d(t);return m=p(m),l(m)}function i(m,x){return new RegExp("(?:^|;)\\s*"+m+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',x)}function r(m,x){if(m){if(!/^[\x00-\xFF]+$/.test(x))return x;try{const b=new TextDecoder(m,{fatal:!0}),w=tl(x);x=b.decode(w),e=!1}catch{}}return x}function l(m){return e&&/[\x80-\xff]/.test(m)&&(m=r("utf-8",m),e&&(m=r("iso-8859-1",m))),m}function c(m){const x=[];let b;const w=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=w.exec(m))!==null;){let[,N,_,j]=b;if(N=parseInt(N,10),N in x){if(N===0)break;continue}x[N]=[_,j]}const y=[];for(let N=0;N<x.length&&N in x;++N){let[_,j]=x[N];j=d(j),_&&(j=unescape(j),N===0&&(j=f(j))),y.push(j)}return y.join("")}function d(m){if(m.startsWith('"')){const x=m.slice(1).split('\\"');for(let b=0;b<x.length;++b){const w=x[b].indexOf('"');w!==-1&&(x[b]=x[b].slice(0,w),x.length=b+1),x[b]=x[b].replaceAll(/\\(.)/g,"$1")}m=x.join('"')}return m}function f(m){const x=m.indexOf("'");if(x===-1)return m;const b=m.slice(0,x),y=m.slice(x+1).replace(/^[^']*'/,"");return r(b,y)}function p(m){return!m.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(m)?m:m.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(x,b,w,y){if(w==="q"||w==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(N,_){return String.fromCharCode(parseInt(_,16))}),r(b,y);try{y=atob(y)}catch{}return r(b,y)})}return""}function up(u,e){const t=new Headers;if(!u||!e||typeof e!="object")return t;for(const i in e){const r=e[i];r!==void 0&&t.append(i,r)}return t}function rl(u){try{return new URL(u).origin}catch{}return null}function hp({responseHeaders:u,isHttp:e,rangeChunkSize:t,disableRange:i}){const r={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(u.get("Content-Length"),10);return!Number.isInteger(l)||(r.suggestedLength=l,l<=2*t)||i||!e||u.get("Accept-Ranges")!=="bytes"||(u.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function fp(u){const e=u.get("Content-Disposition");if(e){let t=bv(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(zc(t))return t}return null}function al(u,e){return u===404||u===0&&e.startsWith("file:")?new mr('Missing PDF "'+e+'".'):new Wa(`Unexpected server response (${u}) while retrieving PDF "${e}".`,u)}function pp(u){return u===200||u===206}function mp(u,e,t){return{method:"GET",headers:u,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function gp(u){return u instanceof Uint8Array?u.buffer:u instanceof ArrayBuffer?u:(Ee(`getArrayBuffer - unexpected data format: ${u}`),new Uint8Array(u).buffer)}class kf{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=up(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return tt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new yv(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new wv(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class yv{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const i=new Headers(e.headers),r=t.url;fetch(r,mp(i,this._withCredentials,this._abortController)).then(l=>{if(e._responseOrigin=rl(l.url),!pp(l.status))throw al(l.status,r);this._reader=l.body.getReader(),this._headersCapability.resolve();const c=l.headers,{allowRangeRequests:d,suggestedLength:f}=hp({responseHeaders:c,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=d,this._contentLength=f||this._contentLength,this._filename=fp(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new sn("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:gp(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class wv{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;const r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const l=new Headers(e.headers);l.append("Range",`bytes=${t}-${i-1}`);const c=r.url;fetch(c,mp(l,this._withCredentials,this._abortController)).then(d=>{const f=rl(d.url);if(f!==e._responseOrigin)throw new Error(`Expected range response-origin "${f}" to match "${e._responseOrigin}".`);if(!pp(d.status))throw al(d.status,c);this._readCapability.resolve(),this._reader=d.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:gp(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const mc=200,gc=206;function Nv(u){const e=u.response;return typeof e!="string"?e:tl(e).buffer}class Av{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:i}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=up(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,i=this.currXhrId++,r=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[l,c]of this.headers)t.setRequestHeader(l,c);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=gc):r.expectedStatus=mc,t.responseType="arraybuffer",tt(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){const i=this.pendingRequests[e];i&&i.onProgress?.(t)}onStateChange(e,t){const i=this.pendingRequests[e];if(!i)return;const r=i.xhr;if(r.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){i.onError(r.status);return}const l=r.status||mc;if(!(l===mc&&i.expectedStatus===gc)&&l!==i.expectedStatus){i.onError(r.status);return}const d=Nv(r);if(l===gc){const f=r.getResponseHeader("Content-Range"),p=/bytes (\d+)-(\d+)\/(\d+)/.exec(f);p?i.onDone({begin:parseInt(p[1],10),chunk:d}):(Ee('Missing or invalid "Content-Range" header.'),i.onError(0))}else d?i.onDone({begin:0,chunk:d}):i.onError(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class _v{constructor(e){this._source=e,this._manager=new Av(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return tt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Sv(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const i=new jv(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class Sv{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=rl(t.responseURL);const i=t.getAllResponseHeaders(),r=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(d=>{const[f,...p]=d.split(": ");return[f,p.join(": ")]}):[]),{allowRangeRequests:l,suggestedLength:c}=hp({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});l&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=fp(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=al(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class jv{constructor(e,t,i){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=rl(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=al(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const kv=/^[a-z][a-z0-9\-+.]+:/i;function Ev(u){if(kv.test(u))return new URL(u);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(u))}class Cv{constructor(e){this.source=e,this.url=Ev(e.url),tt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return tt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new Pv(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new Tv(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class Pv{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=new mr(`Missing PDF "${this._url}".`)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new sn("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Tv{constructor(e,t,i){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=e.source;this._isStreamingSupported=!r.disableStream;const l=process.getBuiltinModule("fs");this._setReadableStream(l.createReadStream(this._url,{start:t,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Rv=1e5,Mt=30,Lv=.8;class jt{#e=Promise.withResolvers();#t=null;#s=!1;#n=!!globalThis.FontInspector?.enabled;#r=null;#i=null;#o=0;#l=0;#d=null;#c=null;#h=0;#u=0;#f=Object.create(null);#a=[];#p=null;#g=[];#m=new WeakMap;#x=null;static#y=new Map;static#v=new Map;static#w=new WeakMap;static#A=null;static#S=new Set;constructor({textContentSource:e,container:t,viewport:i}){if(e instanceof ReadableStream)this.#p=e;else if(typeof e=="object")this.#p=new ReadableStream({start(f){f.enqueue(e),f.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#c=t,this.#u=i.scale*(globalThis.devicePixelRatio||1),this.#h=i.rotation,this.#i={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:l,pageX:c,pageY:d}=i.rawDims;this.#x=[1,0,0,-1,-c,d+l],this.#l=r,this.#o=l,jt.#T(),Sn(t,i),this.#e.promise.finally(()=>{jt.#S.delete(this),this.#i=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=kt.platform;return Pe(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#d.read().then(({value:t,done:i})=>{if(i){this.#e.resolve();return}this.#r??=t.lang,Object.assign(this.#f,t.styles),this.#k(t.items),e()},this.#e.reject)};return this.#d=this.#p.getReader(),jt.#S.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const i=e.scale*(globalThis.devicePixelRatio||1),r=e.rotation;if(r!==this.#h&&(t?.(),this.#h=r,Sn(this.#c,{rotation:r})),i!==this.#u){t?.(),this.#u=i;const l={div:null,properties:null,ctx:jt.#E(this.#r)};for(const c of this.#g)l.properties=this.#m.get(c),l.div=c,this.#N(l)}}cancel(){const e=new sn("TextLayer task cancelled.");this.#d?.cancel(e).catch(()=>{}),this.#d=null,this.#e.reject(e)}get textDivs(){return this.#g}get textContentItemsStr(){return this.#a}#k(e){if(this.#s)return;this.#i.ctx??=jt.#E(this.#r);const t=this.#g,i=this.#a;for(const r of e){if(t.length>Rv){Ee("Ignoring additional textDivs for performance reasons."),this.#s=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const l=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),r.id!==null&&this.#t.setAttribute("id",`${r.id}`),l.append(this.#t)}else r.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}i.push(r.str),this.#C(r)}}#C(e){const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#g.push(t);const r=ge.transform(this.#x,e.transform);let l=Math.atan2(r[1],r[0]);const c=this.#f[e.fontName];c.vertical&&(l+=Math.PI/2);let d=this.#n&&c.fontSubstitution||c.fontFamily;d=jt.fontFamilyMap.get(d)||d;const f=Math.hypot(r[2],r[3]),p=f*jt.#M(d,this.#r);let m,x;l===0?(m=r[4],x=r[5]-p):(m=r[4]+p*Math.sin(l),x=r[5]-p*Math.cos(l));const b="calc(var(--scale-factor)*",w=t.style;this.#t===this.#c?(w.left=`${(100*m/this.#l).toFixed(2)}%`,w.top=`${(100*x/this.#o).toFixed(2)}%`):(w.left=`${b}${m.toFixed(2)}px)`,w.top=`${b}${x.toFixed(2)}px)`),w.fontSize=`${b}${(jt.#A*f).toFixed(2)}px)`,w.fontFamily=d,i.fontSize=f,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#n&&(t.dataset.fontName=c.fontSubstitutionLoadedName||e.fontName),l!==0&&(i.angle=l*(180/Math.PI));let y=!1;if(e.str.length>1)y=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const N=Math.abs(e.transform[0]),_=Math.abs(e.transform[3]);N!==_&&Math.max(N,_)/Math.min(N,_)>1.5&&(y=!0)}if(y&&(i.canvasWidth=c.vertical?e.height:e.width),this.#m.set(t,i),this.#i.div=t,this.#i.properties=i,this.#N(this.#i),i.hasText&&this.#t.append(t),i.hasEOL){const N=document.createElement("br");N.setAttribute("role","presentation"),this.#t.append(N)}}#N(e){const{div:t,properties:i,ctx:r}=e,{style:l}=t;let c="";if(jt.#A>1&&(c=`scale(${1/jt.#A})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:d}=l,{canvasWidth:f,fontSize:p}=i;jt.#j(r,p*this.#u,d);const{width:m}=r.measureText(t.textContent);m>0&&(c=`scaleX(${f*this.#u/m}) ${c}`)}i.angle!==0&&(c=`rotate(${i.angle}deg) ${c}`),c.length>0&&(l.transform=c)}static cleanup(){if(!(this.#S.size>0)){this.#y.clear();for(const{canvas:e}of this.#v.values())e.remove();this.#v.clear()}}static#E(e=null){let t=this.#v.get(e||="");if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#v.set(e,t),this.#w.set(t,{size:0,family:""})}return t}static#j(e,t,i){const r=this.#w.get(e);t===r.size&&i===r.family||(e.font=`${t}px ${i}`,r.size=t,r.family=i)}static#T(){if(this.#A!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#A=e.getBoundingClientRect().height,e.remove()}static#M(e,t){const i=this.#y.get(e);if(i)return i;const r=this.#E(t);r.canvas.width=r.canvas.height=Mt,this.#j(r,Mt,e);const l=r.measureText("");let c=l.fontBoundingBoxAscent,d=Math.abs(l.fontBoundingBoxDescent);if(c){const m=c/(c+d);return this.#y.set(e,m),r.canvas.width=r.canvas.height=0,m}r.strokeStyle="red",r.clearRect(0,0,Mt,Mt),r.strokeText("g",0,0);let f=r.getImageData(0,0,Mt,Mt).data;d=0;for(let m=f.length-1-3;m>=0;m-=4)if(f[m]>0){d=Math.ceil(m/4/Mt);break}r.clearRect(0,0,Mt,Mt),r.strokeText("A",0,Mt),f=r.getImageData(0,0,Mt,Mt).data,c=0;for(let m=0,x=f.length;m<x;m+=4)if(f[m]>0){c=Mt-Math.floor(m/4/Mt);break}r.canvas.width=r.canvas.height=0;const p=c?c/(c+d):Lv;return this.#y.set(e,p),p}}class gr{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function r(l){if(!l)return;let c=null;const d=l.name;if(d==="#text")c=l.value;else if(gr.shouldBuildText(d))l?.attributes?.textContent?c=l.attributes.textContent:l.value&&(c=l.value);else return;if(c!==null&&t.push({str:c}),!!l.children)for(const f of l.children)r(f)}return r(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const Mv=65536,Vv=100,Iv=5e3,Dv=yt?Q0:X0,Fv=yt?J0:ap,Ov=yt?K0:Y0,zv=yt?Z0:cp;function Bv(u={}){typeof u=="string"||u instanceof URL?u={url:u}:(u instanceof ArrayBuffer||ArrayBuffer.isView(u))&&(u={data:u});const e=new qc,{docId:t}=e,i=u.url?$v(u.url):null,r=u.data?Uv(u.data):null,l=u.httpHeaders||null,c=u.withCredentials===!0,d=u.password??null,f=u.range instanceof xp?u.range:null,p=Number.isInteger(u.rangeChunkSize)&&u.rangeChunkSize>0?u.rangeChunkSize:Mv;let m=u.worker instanceof ni?u.worker:null;const x=u.verbosity,b=typeof u.docBaseUrl=="string"&&!nl(u.docBaseUrl)?u.docBaseUrl:null,w=typeof u.cMapUrl=="string"?u.cMapUrl:null,y=u.cMapPacked!==!1,N=u.CMapReaderFactory||Fv,_=typeof u.standardFontDataUrl=="string"?u.standardFontDataUrl:null,j=u.StandardFontDataFactory||zv,S=u.stopAtErrors!==!0,P=Number.isInteger(u.maxImageSize)&&u.maxImageSize>-1?u.maxImageSize:-1,k=u.isEvalSupported!==!1,L=typeof u.isOffscreenCanvasSupported=="boolean"?u.isOffscreenCanvasSupported:!yt,T=typeof u.isImageDecoderSupported=="boolean"?u.isImageDecoderSupported:!yt&&(kt.platform.isFirefox||!globalThis.chrome),I=Number.isInteger(u.canvasMaxAreaInBytes)?u.canvasMaxAreaInBytes:-1,$=typeof u.disableFontFace=="boolean"?u.disableFontFace:yt,te=u.fontExtraProperties===!0,oe=u.enableXfa===!0,ae=u.ownerDocument||globalThis.document,ne=u.disableRange===!0,se=u.disableStream===!0,xe=u.disableAutoFetch===!0,Se=u.pdfBug===!0,X=u.CanvasFactory||Dv,Z=u.FilterFactory||Ov,q=u.enableHWA===!0,re=f?f.length:u.length??NaN,Q=typeof u.useSystemFonts=="boolean"?u.useSystemFonts:!yt&&!$,V=typeof u.useWorkerFetch=="boolean"?u.useWorkerFetch:N===ap&&j===cp&&w&&_&&or(w,document.baseURI)&&or(_,document.baseURI),z=null;j0(x);const ce={canvasFactory:new X({ownerDocument:ae,enableHWA:q}),filterFactory:new Z({docId:t,ownerDocument:ae}),cMapReaderFactory:V?null:new N({baseUrl:w,isCompressed:y}),standardFontDataFactory:V?null:new j({baseUrl:_})};if(!m){const B={verbosity:x,port:hr.workerPort};m=B.port?ni.fromPort(B):new ni(B),e._worker=m}const ve={docId:t,apiVersion:"4.10.38",data:r,password:d,disableAutoFetch:xe,rangeChunkSize:p,length:re,docBaseUrl:b,enableXfa:oe,evaluatorOptions:{maxImageSize:P,disableFontFace:$,ignoreErrors:S,isEvalSupported:k,isOffscreenCanvasSupported:L,isImageDecoderSupported:T,canvasMaxAreaInBytes:I,fontExtraProperties:te,useSystemFonts:Q,cMapUrl:V?w:null,standardFontDataUrl:V?_:null}},U={disableFontFace:$,fontExtraProperties:te,ownerDocument:ae,pdfBug:Se,styleElement:z,loadingParams:{disableAutoFetch:xe,enableXfa:oe}};return m.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const B=m.messageHandler.sendWithPromise("GetDocRequest",ve,r?[r.buffer]:null);let ee;if(f)ee=new gv(f,{disableRange:ne,disableStream:se});else if(!r){if(!i)throw new Error("getDocument - no `url` parameter provided.");let K;if(yt)if(or(i)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");K=kf}else K=Cv;else K=or(i)?kf:_v;ee=new K({url:i,length:re,httpHeaders:l,withCredentials:c,rangeChunkSize:p,disableRange:ne,disableStream:se})}return B.then(K=>{if(e.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const fe=new cr(t,K,m.port),Ve=new qv(fe,e,ee,U,ce);e._transport=Ve,fe.send("Ready",null)})}).catch(e._capability.reject),e}function $v(u){if(u instanceof URL)return u.href;try{return new URL(u,window.location).href}catch{if(yt&&typeof u=="string")return u}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Uv(u){if(yt&&typeof Buffer<"u"&&u instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(u instanceof Uint8Array&&u.byteLength===u.buffer.byteLength)return u;if(typeof u=="string")return tl(u);if(u instanceof ArrayBuffer||ArrayBuffer.isView(u)||typeof u=="object"&&!isNaN(u?.length))return new Uint8Array(u);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Ef(u){return typeof u=="object"&&Number.isInteger(u?.num)&&u.num>=0&&Number.isInteger(u?.gen)&&u.gen>=0}class qc{static#e=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${qc.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}}class xp{constructor(e,t,i=!1,r=null){this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const i of this._rangeListeners)i(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Fe("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Hv{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Pe(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class Wv{#e=null;#t=!1;constructor(e,t,i,r=!1){this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=r?new pf:null,this._pdfBug=r,this.commonObjs=i.commonObjs,this.objs=new vp,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:r=0,dontFlip:l=!1}={}){return new br({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:r,dontFlip:l})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Pe(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:i="display",annotationMode:r=Js.ENABLE,transform:l=null,background:c=null,optionalContentConfigPromise:d=null,annotationCanvasMap:f=null,pageColors:p=null,printAnnotationStorage:m=null,isEditing:x=!1}){this._stats?.time("Overall");const b=this._transport.getRenderingIntent(i,r,m,x),{renderingIntent:w,cacheKey:y}=b;this.#t=!1,this.#n(),d||=this._transport.getOptionalContentConfig(w);let N=this._intentStates.get(y);N||(N=Object.create(null),this._intentStates.set(y,N)),N.streamReaderCancelTimeout&&(clearTimeout(N.streamReaderCancelTimeout),N.streamReaderCancelTimeout=null);const _=!!(w&Bt.PRINT);N.displayReadyCapability||(N.displayReadyCapability=Promise.withResolvers(),N.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(b));const j=k=>{N.renderTasks.delete(S),(this._maybeCleanupAfterRender||_)&&(this.#t=!0),this.#s(!_),k?(S.capability.reject(k),this._abortOperatorList({intentState:N,reason:k instanceof Error?k:new Error(k)})):S.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},S=new ti({callback:j,params:{canvasContext:e,viewport:t,transform:l,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:N.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!_,pdfBug:this._pdfBug,pageColors:p});(N.renderTasks||=new Set).add(S);const P=S.task;return Promise.all([N.displayReadyCapability.promise,d]).then(([k,L])=>{if(this.destroyed){j();return}if(this._stats?.time("Rendering"),!(L.renderingIntent&w))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");S.initializeGraphics({transparency:k,optionalContentConfig:L}),S.operatorListChanged()}).catch(j),P}getOperatorList({intent:e="display",annotationMode:t=Js.ENABLE,printAnnotationStorage:i=null,isEditing:r=!1}={}){function l(){d.operatorList.lastChunk&&(d.opListReadCapability.resolve(d.operatorList),d.renderTasks.delete(f))}const c=this._transport.getRenderingIntent(e,t,i,r,!0);let d=this._intentStates.get(c.cacheKey);d||(d=Object.create(null),this._intentStates.set(c.cacheKey,d));let f;return d.opListReadCapability||(f=Object.create(null),f.operatorListChanged=l,d.opListReadCapability=Promise.withResolvers(),(d.renderTasks||=new Set).add(f),d.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),d.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>gr.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,r){function l(){c.read().then(function({value:f,done:p}){if(p){i(d);return}d.lang??=f.lang,Object.assign(d.styles,f.styles),d.items.push(...f.items),l()},r)}const c=t.getReader(),d={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,this.#n(),Promise.all(e)}cleanup(e=!1){this.#t=!0;const t=this.#s(!1);return e&&t&&(this._stats&&=new pf),t}#s(e=!1){if(this.#n(),!this.#t||this.destroyed)return!1;if(e)return this.#e=setTimeout(()=>{this.#e=null,this.#s(!1)},Iv),!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#n(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(e,t){const i=this._intentStates.get(t);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let i=0,r=e.length;i<r;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&this.#s(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:r}){const{map:l,transfer:c}=i,f=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:l,modifiedIds:r},c).getReader(),p=this._intentStates.get(t);p.streamReader=f;const m=()=>{f.read().then(({value:x,done:b})=>{if(b){p.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(x,p),m())},x=>{if(p.streamReader=null,!this._transport.destroyed){if(p.operatorList){p.operatorList.lastChunk=!0;for(const b of p.renderTasks)b.operatorListChanged();this.#s(!0)}if(p.displayReadyCapability)p.displayReadyCapability.reject(x);else if(p.opListReadCapability)p.opListReadCapability.reject(x);else throw x}})};m()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof Oc){let r=Vv;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new sn(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[r,l]of this._intentStates)if(l===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}class Gv{#e=new Map;#t=Promise.resolve();postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[r]of this.#e)r.call(this,i)})}addEventListener(e,t,i=null){let r=null;if(i?.signal instanceof AbortSignal){const{signal:l}=i;if(l.aborted){Ee("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(e,t);r=()=>l.removeEventListener("abort",c),l.addEventListener("abort",c)}this.#e.set(t,r)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}var qa,An,_n,ii,Oa,ri,za;const Ue=class Ue{constructor({name:e=null,port:t=null,verbosity:i=k0()}={}){Zn(this,ii);if(this.name=e,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(as(Ue,_n)?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(as(Ue,_n)||er(Ue,_n,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new cr("main","worker",e),this._messageHandler.on("ready",function(){}),Ta(this,ii,Oa).call(this)}_initialize(){if(as(Ue,An)||as(Ue,ri,za)){this._setupFakeWorker();return}let{workerSrc:e}=Ue;try{Ue._isSameOrigin(window.location.href,e)||(e=Ue._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new cr("main","worker",t),r=()=>{l.abort(),i.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},l=new AbortController;t.addEventListener("error",()=>{this._webWorker||r()},{signal:l.signal}),i.on("test",d=>{if(l.abort(),this.destroyed||!d){r();return}this._messageHandler=i,this._port=t,this._webWorker=t,Ta(this,ii,Oa).call(this)}),i.on("ready",d=>{if(l.abort(),this.destroyed){r();return}try{c()}catch{this._setupFakeWorker()}});const c=()=>{const d=new Uint8Array;i.send("test",d,[d.buffer])};c();return}catch{el("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){as(Ue,An)||(Ee("Setting up fake worker."),er(Ue,An,!0)),Ue._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new Gv;this._port=t;const i=`fake${zh(Ue,qa)._++}`,r=new cr(i+"_worker",i,t);e.setup(r,t),this._messageHandler=new cr(i,i+"_worker",t),Ta(this,ii,Oa).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker?.terminate(),this._webWorker=null,as(Ue,_n)?.delete(this._port),this._port=null,this._messageHandler?.destroy(),this._messageHandler=null}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const t=as(this,_n)?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Ue(e)}static get workerSrc(){if(hr.workerSrc)return hr.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Pe(this,"_setupFakeWorkerGlobal",(async()=>as(this,ri,za)?as(this,ri,za):(await import(this.workerSrc)).WorkerMessageHandler)())}};qa=new WeakMap,An=new WeakMap,_n=new WeakMap,ii=new WeakSet,Oa=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},ri=new WeakSet,za=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Zn(Ue,ri),Zn(Ue,qa,0),Zn(Ue,An,!1),Zn(Ue,_n),yt&&(er(Ue,An,!0),hr.workerSrc||="./pdf.worker.mjs"),Ue._isSameOrigin=(e,t)=>{let i;try{if(i=new URL(e),!i.origin||i.origin==="null")return!1}catch{return!1}const r=new URL(t,i);return i.origin===r.origin},Ue._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let ni=Ue;class qv{#e=new Map;#t=new Map;#s=new Map;#n=new Map;#r=null;constructor(e,t,i,r,l){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new vp,this.fontLoader=new G0({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#i(e,t=null){const i=this.#e.get(e);if(i)return i;const r=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,r),r}get annotationStorage(){return Pe(this,"annotationStorage",new Hc)}getRenderingIntent(e,t=Js.ENABLE,i=null,r=!1,l=!1){let c=Bt.DISPLAY,d=kc;switch(e){case"any":c=Bt.ANY;break;case"display":break;case"print":c=Bt.PRINT;break;default:Ee(`getRenderingIntent - invalid intent: ${e}`)}const f=c&Bt.PRINT&&i instanceof np?i:this.annotationStorage;switch(t){case Js.DISABLE:c+=Bt.ANNOTATIONS_DISABLE;break;case Js.ENABLE:break;case Js.ENABLE_FORMS:c+=Bt.ANNOTATIONS_FORMS;break;case Js.ENABLE_STORAGE:c+=Bt.ANNOTATIONS_STORAGE,d=f.serializable;break;default:Ee(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(c+=Bt.IS_EDITING),l&&(c+=Bt.OPLIST);const{ids:p,hash:m}=f.modifiedIds,x=[c,d.hash,m];return{renderingIntent:c,cacheKey:x.join("_"),annotationStorageSerializable:d,modifiedIds:p}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of this.#t.values())e.push(i._destroy());this.#t.clear(),this.#s.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),jt.cleanup(),this._networkStream?.cancelAllRequests(new sn("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,r)=>{tt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=l=>{this._lastProgress={loaded:l.loaded,total:l.total}},r.onPull=()=>{this._fullReader.read().then(function({value:l,done:c}){if(c){r.close();return}tt(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{r.error(l)})},r.onCancel=l=>{this._fullReader.cancel(l),r.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("ReaderHeadersReady",async i=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:l,contentLength:c}=this._fullReader;return(!r||!l)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=d=>{t.onProgress?.({loaded:d.loaded,total:d.total})}),{isStreamingSupported:r,isRangeSupported:l,contentLength:c}}),e.on("GetRangeReader",(i,r)=>{tt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const l=this._networkStream.getRangeReader(i.begin,i.end);if(!l){r.close();return}r.onPull=()=>{l.read().then(function({value:c,done:d}){if(d){r.close();return}tt(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{r.error(c)})},r.onCancel=c=>{l.cancel(c),r.ready.catch(d=>{if(!this.destroyed)throw d})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new Hv(i,this))}),e.on("DocException",i=>{t._capability.reject(Vt(i))}),e.on("PasswordRequest",i=>{this.#r=Promise.withResolvers();try{if(!t.onPassword)throw Vt(i);const r=l=>{l instanceof Error?this.#r.reject(l):this.#r.resolve({password:l})};t.onPassword(r,i.code)}catch(r){this.#r.reject(r)}return this.#r.promise}),e.on("DataLoaded",i=>{t.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;this.#t.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,r,l])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(r){case"Font":const{disableFontFace:c,fontExtraProperties:d,pdfBug:f}=this._params;if("error"in l){const b=l.error;Ee(`Error during font loading: ${b}`),this.commonObjs.resolve(i,b);break}const p=f&&globalThis.FontInspector?.enabled?(b,w)=>globalThis.FontInspector.fontAdded(b,w):null,m=new q0(l,{disableFontFace:c,fontExtraProperties:d,inspectFont:p});this.fontLoader.bind(m).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!d&&m.data&&(m.data=null),this.commonObjs.resolve(i,m)});break;case"CopyLocalImage":const{imageRef:x}=l;tt(x,"The imageRef must be defined.");for(const b of this.#t.values())for(const[,w]of b.objs)if(w?.ref===x)return w.dataLen?(this.commonObjs.resolve(i,structuredClone(w)),w.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,l);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([i,r,l,c])=>{if(this.destroyed)return;const d=this.#t.get(r);if(!d.objs.has(i)){if(d._intentStates.size===0){c?.bitmap?.close();return}switch(l){case"Image":d.objs.resolve(i,c),c?.dataLen>N0&&(d._maybeCleanupAfterRender=!0);break;case"Pattern":d.objs.resolve(i,c);break;default:throw new Error(`Got unknown object type ${l}`)}}}),e.on("DocProgress",i=>{this.destroyed||t.onProgress?.({loaded:i.loaded,total:i.total})}),e.on("FetchBuiltInCMap",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(i)}),e.on("FetchStandardFontData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Ee("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=this.#s.get(t);if(i)return i;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&this.#n.set(l.refStr,e);const c=new Wv(t,l,this,this._params.pdfBug);return this.#t.set(t,c),c});return this.#s.set(t,r),r}getPageIndex(e){return Ef(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#i("GetFieldObjects")}hasJSActions(){return this.#i("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#i("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#i("GetOptionalContentConfig").then(t=>new mv(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(r=>({info:r[0],metadata:r[1]?new fv(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),jt.cleanup()}}cachedPageNumber(e){if(!Ef(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#n.get(t)??null}}const rr=Symbol("INITIAL_DATA");class vp{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:rr}}get(e,t=null){if(t){const r=this.#t(e);return r.promise.then(()=>t(r.data)),null}const i=this.#e[e];if(!i||i.data===rr)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=this.#e[e];return!!t&&t.data!==rr}delete(e){const t=this.#e[e];return!t||t.data===rr?!1:(delete this.#e[e],!0)}resolve(e,t=null){const i=this.#t(e);i.data=t,i.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==rr&&(yield[e,t])}}}class Xv{#e=null;constructor(e){this.#e=e,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class ti{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:i,commonObjs:r,annotationCanvasMap:l,operatorList:c,pageIndex:d,canvasFactory:f,filterFactory:p,useRequestAnimationFrame:m=!1,pdfBug:x=!1,pageColors:b=null}){this.callback=e,this.params=t,this.objs=i,this.commonObjs=r,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=d,this.canvasFactory=f,this.filterFactory=p,this._pdfBug=x,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=m===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Xv(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(ti.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");ti.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:r,transform:l,background:c}=this.params;this.gfx=new si(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:l,viewport:r,transparency:e,background:c}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),ti.#t.delete(this._canvas),this.callback(e||new Oc(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),ti.#t.delete(this._canvas),this.callback())))}}const Yv="4.10.38",Kv="f9bea397f";function Cf(u){return Math.floor(Math.max(0,Math.min(1,u))*255).toString(16).padStart(2,"0")}function ar(u){return Math.max(0,Math.min(255,255*u))}class Pf{static CMYK_G([e,t,i,r]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=ar(e),[e,e,e]}static G_HTML([e]){const t=Cf(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(ar)}static RGB_HTML(e){return`#${e.map(Cf).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,i+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,i,r]){return[ar(1-Math.min(1,e+r)),ar(1-Math.min(1,i+r)),ar(1-Math.min(1,t+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const r=1-e,l=1-t,c=1-i,d=Math.min(r,l,c);return["CMYK",r,l,c,d]}}class Qv{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),i||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Fe("Abstract method `_createSVG` called.")}}class Xc extends Qv{_createSVG(e){return document.createElementNS(ks,e)}}class bp{static setupStorage(e,t,i,r,l){const c=r.getValue(t,{value:null});switch(i.name){case"textarea":if(c.value!==null&&(e.textContent=c.value),l==="print")break;e.addEventListener("input",d=>{r.setValue(t,{value:d.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(c.value===i.attributes.xfaOn?e.setAttribute("checked",!0):c.value===i.attributes.xfaOff&&e.removeAttribute("checked"),l==="print")break;e.addEventListener("change",d=>{r.setValue(t,{value:d.target.checked?d.target.getAttribute("xfaOn"):d.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&e.setAttribute("value",c.value),l==="print")break;e.addEventListener("input",d=>{r.setValue(t,{value:d.target.value})})}break;case"select":if(c.value!==null){e.setAttribute("value",c.value);for(const d of i.children)d.attributes.value===c.value?d.attributes.selected=!0:d.attributes.hasOwnProperty("selected")&&delete d.attributes.selected}e.addEventListener("input",d=>{const f=d.target.options,p=f.selectedIndex===-1?"":f[f.selectedIndex].value;r.setValue(t,{value:p})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:r,linkService:l}){const{attributes:c}=t,d=e instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${r}`);for(const[f,p]of Object.entries(c))if(p!=null)switch(f){case"class":p.length&&e.setAttribute(f,p.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",p);break;case"style":Object.assign(e.style,p);break;case"textContent":e.textContent=p;break;default:(!d||f!=="href"&&f!=="newWindow")&&e.setAttribute(f,p)}d&&l.addLinkAttributes(e,c.href,c.newWindow),i&&c.dataId&&this.setupStorage(e,c.dataId,t,i)}static render(e){const t=e.annotationStorage,i=e.linkService,r=e.xfaHtml,l=e.intent||"display",c=document.createElement(r.name);r.attributes&&this.setAttributes({html:c,element:r,intent:l,linkService:i});const d=l!=="richText",f=e.div;if(f.append(c),e.viewport){const x=`matrix(${e.viewport.transform.join(",")})`;f.style.transform=x}d&&f.setAttribute("class","xfaLayer xfaFont");const p=[];if(r.children.length===0){if(r.value){const x=document.createTextNode(r.value);c.append(x),d&&gr.shouldBuildText(r.name)&&p.push(x)}return{textDivs:p}}const m=[[r,-1,c]];for(;m.length>0;){const[x,b,w]=m.at(-1);if(b+1===x.children.length){m.pop();continue}const y=x.children[++m.at(-1)[1]];if(y===null)continue;const{name:N}=y;if(N==="#text"){const j=document.createTextNode(y.value);p.push(j),w.append(j);continue}const _=y?.attributes?.xmlns?document.createElementNS(y.attributes.xmlns,N):document.createElement(N);if(w.append(_),y.attributes&&this.setAttributes({html:_,element:y,storage:t,intent:l,linkService:i}),y.children?.length>0)m.push([y,-1,_]);else if(y.value){const j=document.createTextNode(y.value);d&&gr.shouldBuildText(N)&&p.push(j),_.append(j)}}for(const x of f.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))x.setAttribute("readOnly",!0);return{textDivs:p}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const wr=1e3,Jv=9,jn=new WeakSet;function tn(u){return{width:u[2]-u[0],height:u[3]-u[1]}}class Zv{static create(e){switch(e.data.annotationType){case it.LINK:return new yp(e);case it.TEXT:return new eb(e);case it.WIDGET:switch(e.data.fieldType){case"Tx":return new tb(e);case"Btn":return e.data.radioButton?new wp(e):e.data.checkBox?new nb(e):new ib(e);case"Ch":return new rb(e);case"Sig":return new sb(e)}return new kn(e);case it.POPUP:return new Cc(e);case it.FREETEXT:return new Np(e);case it.LINE:return new lb(e);case it.SQUARE:return new ob(e);case it.CIRCLE:return new cb(e);case it.POLYLINE:return new Ap(e);case it.CARET:return new ub(e);case it.INK:return new Yc(e);case it.POLYGON:return new db(e);case it.HIGHLIGHT:return new _p(e);case it.UNDERLINE:return new hb(e);case it.SQUIGGLY:return new fb(e);case it.STRIKEOUT:return new pb(e);case it.STAMP:return new Sp(e);case it.FILEATTACHMENT:return new mb(e);default:return new Je(e)}}}class Je{#e=null;#t=!1;#s=null;constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(i)),r&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:i}){return!!(e?.str||t?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Je._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};const{rect:t}=e;t&&this.#n(t),this.#s?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#n(this.#e.rect),this.#s?.popup.resetEdited(),this.#e=null)}#n(e){const{container:{style:t},data:{rect:i,rotation:r},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:c,pageX:d,pageY:f}}}}=this;i?.splice(0,4,...e);const{width:p,height:m}=tn(e);t.left=`${100*(e[0]-d)/l}%`,t.top=`${100*(c-e[3]+f)/c}%`,r===0?(t.width=`${100*p/l}%`,t.height=`${100*m/c}%`):this.setRotation(r)}_createContainer(e){const{data:t,parent:{page:i,viewport:r}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",t.id),this instanceof kn||(l.tabIndex=wr);const{style:c}=l;if(c.zIndex=this.parent.zIndex++,t.alternativeText&&(l.title=t.alternativeText),t.noRotate&&l.classList.add("norotate"),!t.rect||this instanceof Cc){const{rotation:N}=t;return!t.hasOwnCanvas&&N!==0&&this.setRotation(N,l),l}const{width:d,height:f}=tn(t.rect);if(!e&&t.borderStyle.width>0){c.borderWidth=`${t.borderStyle.width}px`;const N=t.borderStyle.horizontalCornerRadius,_=t.borderStyle.verticalCornerRadius;if(N>0||_>0){const S=`calc(${N}px * var(--scale-factor)) / calc(${_}px * var(--scale-factor))`;c.borderRadius=S}else if(this instanceof wp){const S=`calc(${d}px * var(--scale-factor)) / calc(${f}px * var(--scale-factor))`;c.borderRadius=S}switch(t.borderStyle.style){case nr.SOLID:c.borderStyle="solid";break;case nr.DASHED:c.borderStyle="dashed";break;case nr.BEVELED:Ee("Unimplemented border style: beveled");break;case nr.INSET:Ee("Unimplemented border style: inset");break;case nr.UNDERLINE:c.borderBottomStyle="solid";break}const j=t.borderColor||null;j?(this.#t=!0,c.borderColor=ge.makeHexColor(j[0]|0,j[1]|0,j[2]|0)):c.borderWidth=0}const p=ge.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:m,pageHeight:x,pageX:b,pageY:w}=r.rawDims;c.left=`${100*(p[0]-b)/m}%`,c.top=`${100*(p[1]-w)/x}%`;const{rotation:y}=t;return t.hasOwnCanvas||y===0?(c.width=`${100*d/m}%`,c.height=`${100*f/x}%`):this.setRotation(y,l),l}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:r}=this.parent.viewport.rawDims,{width:l,height:c}=tn(this.data.rect);let d,f;e%180===0?(d=100*l/i,f=100*c/r):(d=100*c/i,f=100*l/r),t.style.width=`${d}%`,t.style.height=`${f}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,r)=>{const l=r.detail[t],c=l[0],d=l.slice(1);r.target.style[i]=Pf[`${c}_HTML`](d),this.annotationStorage.setValue(this.data.id,{[i]:Pf[`${c}_rgb`](d)})};return Pe(this,"_commonActions",{display:t=>{const{display:i}=t.detail,r=i%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const r of Object.keys(t.detail))(e[r]||i[r])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[r,l]of Object.entries(t)){const c=i[r];if(c){const d={detail:{[r]:l},target:e};c(d),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,r,l]=this.data.rect.map(N=>Math.fround(N));if(e.length===8){const[N,_,j,S]=e.subarray(2,6);if(r===N&&l===_&&t===j&&i===S)return}const{style:c}=this.container;let d;if(this.#t){const{borderColor:N,borderWidth:_}=c;c.borderWidth=0,d=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${N}" stroke-width="${_}">`],this.container.classList.add("hasBorder")}const f=r-t,p=l-i,{svgFactory:m}=this,x=m.createElement("svg");x.classList.add("quadrilateralsContainer"),x.setAttribute("width",0),x.setAttribute("height",0);const b=m.createElement("defs");x.append(b);const w=m.createElement("clipPath"),y=`clippath_${this.data.id}`;w.setAttribute("id",y),w.setAttribute("clipPathUnits","objectBoundingBox"),b.append(w);for(let N=2,_=e.length;N<_;N+=8){const j=e[N],S=e[N+1],P=e[N+2],k=e[N+3],L=m.createElement("rect"),T=(P-t)/f,I=(l-S)/p,$=(j-P)/f,te=(S-k)/p;L.setAttribute("x",T),L.setAttribute("y",I),L.setAttribute("width",$),L.setAttribute("height",te),w.append(L),d?.push(`<rect vector-effect="non-scaling-stroke" x="${T}" y="${I}" width="${$}" height="${te}"/>`)}this.#t&&(d.push("</g></svg>')"),c.backgroundImage=d.join("")),this.container.append(x),this.container.style.clipPath=`url(#${y})`}_createPopup(){const{data:e}=this,t=this.#s=new Cc({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){Fe("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const r=this._fieldObjects[e];if(r)for(const{page:l,id:c,exportValues:d}of r){if(l===-1||c===t)continue;const f=typeof d=="string"?d:null,p=document.querySelector(`[data-element-id="${c}"]`);if(p&&!jn.has(p)){Ee(`_getElementsByName - element not allowed: ${c}`);continue}i.push({id:c,exportValue:f,domElement:p})}return i}for(const r of document.getElementsByName(e)){const{exportValue:l}=r,c=r.getAttribute("data-element-id");c!==t&&jn.has(r)&&i.push({id:c,exportValue:l,domElement:r})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}}class yp extends Je{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,i=document.createElement("a");i.setAttribute("data-element-id",e.id);let r=!1;return e.url?(t.addLinkAttributes(i,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(i,e.action),r=!0):e.attachment?(this.#t(i,e.attachment,e.attachmentDest),r=!0):e.setOCGState?(this.#s(i,e.setOCGState),r=!0):e.dest?(this._bindLink(i,e.dest),r=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,e),r=!0),e.resetForm?(this._bindResetFormAction(i,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,i=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,i),!1),this.#e()}#s(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(t.actions)){const l=i.get(r);l&&(e[l]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:r}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const i=e.onclick;if(i||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){Ee('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(e.onclick=()=>!1);return}e.onclick=()=>{i?.();const{fields:r,refs:l,include:c}=t,d=[];if(r.length!==0||l.length!==0){const m=new Set(l);for(const x of r){const b=this._fieldObjects[x]||[];for(const{id:w}of b)m.add(w)}for(const x of Object.values(this._fieldObjects))for(const b of x)m.has(b.id)===c&&d.push(b)}else for(const m of Object.values(this._fieldObjects))d.push(...m);const f=this.annotationStorage,p=[];for(const m of d){const{id:x}=m;switch(p.push(x),m.type){case"text":{const w=m.defaultValue||"";f.setValue(x,{value:w});break}case"checkbox":case"radiobutton":{const w=m.defaultValue===m.exportValues;f.setValue(x,{value:w});break}case"combobox":case"listbox":{const w=m.defaultValue||"";f.setValue(x,{value:w});break}default:continue}const b=document.querySelector(`[data-element-id="${x}"]`);if(b){if(!jn.has(b)){Ee(`_bindResetFormAction - element not allowed: ${x}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:p,name:"ResetForm"}}),!1}}}class eb extends Je{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class kn extends Je{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return kt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,r,l){i.includes("mouse")?e.addEventListener(i,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):e.addEventListener(i,c=>{if(i==="blur"){if(!t.focused||!c.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}l&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l(c)}})})}_setEventListeners(e,t,i,r){for(const[l,c]of i)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,l,c,r),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":ge.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||Jv,l=e.style;let c;const d=2,f=p=>Math.round(10*p)/10;if(this.data.multiLine){const p=Math.abs(this.data.rect[3]-this.data.rect[1]-d),m=Math.round(p/(dc*r))||1,x=p/m;c=Math.min(r,f(x/dc))}else{const p=Math.abs(this.data.rect[3]-this.data.rect[1]-d);c=Math.min(r,f(p/dc))}l.fontSize=`calc(${c}px * var(--scale-factor))`,l.color=ge.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(l.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class tb extends kn{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,r){const l=this.annotationStorage;for(const c of this._getElementsByName(e.name,e.id))c.domElement&&(c.domElement[t]=i),l.setValue(c.id,{[r]:i})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const r=e.getValue(t,{value:this.data.fieldValue});let l=r.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let d=r.formattedValue||this.data.textContent?.join(`
`)||null;d&&this.data.comb&&(d=d.replaceAll(/\s+/g,""));const f={userValue:l,formattedValue:d,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=d??l,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",d??l),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),jn.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=wr,this._setRequired(i,this.data.required),c&&(i.maxLength=c),i.addEventListener("input",m=>{e.setValue(t,{value:m.target.value}),this.setPropertyOnSiblings(i,"value",m.target.value,"value"),f.formattedValue=null}),i.addEventListener("resetform",m=>{const x=this.data.defaultFieldValue??"";i.value=f.userValue=x,f.formattedValue=null});let p=m=>{const{formattedValue:x}=f;x!=null&&(m.target.value=x),m.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",x=>{if(f.focused)return;const{target:b}=x;f.userValue&&(b.value=f.userValue),f.lastCommittedValue=b.value,f.commitKey=1,this.data.actions?.Focus||(f.focused=!0)}),i.addEventListener("updatefromsandbox",x=>{this.showElementAndHideCanvas(x.target);const b={value(w){f.userValue=w.detail.value??"",e.setValue(t,{value:f.userValue.toString()}),w.target.value=f.userValue},formattedValue(w){const{formattedValue:y}=w.detail;f.formattedValue=y,y!=null&&w.target!==document.activeElement&&(w.target.value=y),e.setValue(t,{formattedValue:y})},selRange(w){w.target.setSelectionRange(...w.detail.selRange)},charLimit:w=>{const{charLimit:y}=w.detail,{target:N}=w;if(y===0){N.removeAttribute("maxLength");return}N.setAttribute("maxLength",y);let _=f.userValue;!_||_.length<=y||(_=_.slice(0,y),N.value=f.userValue=_,e.setValue(t,{value:_}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:_,willCommit:!0,commitKey:1,selStart:N.selectionStart,selEnd:N.selectionEnd}}))}};this._dispatchEventFromSandbox(b,x)}),i.addEventListener("keydown",x=>{f.commitKey=1;let b=-1;if(x.key==="Escape"?b=0:x.key==="Enter"&&!this.data.multiLine?b=2:x.key==="Tab"&&(f.commitKey=3),b===-1)return;const{value:w}=x.target;f.lastCommittedValue!==w&&(f.lastCommittedValue=w,f.userValue=w,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:b,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}}))});const m=p;p=null,i.addEventListener("blur",x=>{if(!f.focused||!x.relatedTarget)return;this.data.actions?.Blur||(f.focused=!1);const{value:b}=x.target;f.userValue=b,f.lastCommittedValue!==b&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:f.commitKey,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}}),m(x)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",x=>{f.lastCommittedValue=null;const{data:b,target:w}=x,{value:y,selectionStart:N,selectionEnd:_}=w;let j=N,S=_;switch(x.inputType){case"deleteWordBackward":{const P=y.substring(0,N).match(/\w*[^\w]*$/);P&&(j-=P[0].length);break}case"deleteWordForward":{const P=y.substring(N).match(/^[^\w]*\w*/);P&&(S+=P[0].length);break}case"deleteContentBackward":N===_&&(j-=1);break;case"deleteContentForward":N===_&&(S+=1);break}x.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:y,change:b||"",willCommit:!1,selStart:j,selEnd:S}})}),this._setEventListeners(i,f,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],x=>x.target.value)}if(p&&i.addEventListener("blur",p),this.data.comb){const x=(this.data.rect[2]-this.data.rect[0])/c;i.classList.add("comb"),i.style.letterSpacing=`calc(${x}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class sb extends kn{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class nb extends kn{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let r=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(i,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return jn.add(l),l.setAttribute("data-element-id",i),l.disabled=t.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=t.fieldName,r&&l.setAttribute("checked",!0),l.setAttribute("exportValue",t.exportValue),l.tabIndex=wr,l.addEventListener("change",c=>{const{name:d,checked:f}=c.target;for(const p of this._getElementsByName(d,i)){const m=f&&p.exportValue===t.exportValue;p.domElement&&(p.domElement.checked=m),e.setValue(p.id,{value:m})}e.setValue(i,{value:f})}),l.addEventListener("resetform",c=>{const d=t.defaultFieldValue||"Off";c.target.checked=d===t.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",c=>{const d={value(f){f.target.checked=f.detail.value!=="Off",e.setValue(i,{value:f.target.checked})}};this._dispatchEventFromSandbox(d,c)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class wp extends kn{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let r=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(i,{value:r})),r)for(const c of this._getElementsByName(t.fieldName,i))e.setValue(c.id,{value:!1});const l=document.createElement("input");if(jn.add(l),l.setAttribute("data-element-id",i),l.disabled=t.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=t.fieldName,r&&l.setAttribute("checked",!0),l.tabIndex=wr,l.addEventListener("change",c=>{const{name:d,checked:f}=c.target;for(const p of this._getElementsByName(d,i))e.setValue(p.id,{value:!1});e.setValue(i,{value:f})}),l.addEventListener("resetform",c=>{const d=t.defaultFieldValue;c.target.checked=d!=null&&d===t.buttonValue}),this.enableScripting&&this.hasJSActions){const c=t.buttonValue;l.addEventListener("updatefromsandbox",d=>{const f={value:p=>{const m=c===p.detail.value;for(const x of this._getElementsByName(p.target.name)){const b=m&&x.id===i;x.domElement&&(x.domElement.checked=b),e.setValue(x.id,{value:b})}}};this._dispatchEventFromSandbox(f,d)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],d=>d.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class ib extends yp{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class rb extends kn{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");jn.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=wr;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",m=>{const x=this.data.defaultFieldValue;for(const b of r.options)b.selected=b.value===x});for(const m of this.data.options){const x=document.createElement("option");x.textContent=m.displayValue,x.value=m.exportValue,i.value.includes(m.exportValue)&&(x.setAttribute("selected",!0),l=!1),r.append(x)}let c=null;if(l){const m=document.createElement("option");m.value=" ",m.setAttribute("hidden",!0),m.setAttribute("selected",!0),r.prepend(m),c=()=>{m.remove(),r.removeEventListener("input",c),c=null},r.addEventListener("input",c)}const d=m=>{const x=m?"value":"textContent",{options:b,multiple:w}=r;return w?Array.prototype.filter.call(b,y=>y.selected).map(y=>y[x]):b.selectedIndex===-1?null:b[b.selectedIndex][x]};let f=d(!1);const p=m=>{const x=m.target.options;return Array.prototype.map.call(x,b=>({displayValue:b.textContent,exportValue:b.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",m=>{const x={value(b){c?.();const w=b.detail.value,y=new Set(Array.isArray(w)?w:[w]);for(const N of r.options)N.selected=y.has(N.value);e.setValue(t,{value:d(!0)}),f=d(!1)},multipleSelection(b){r.multiple=!0},remove(b){const w=r.options,y=b.detail.remove;w[y].selected=!1,r.remove(y),w.length>0&&Array.prototype.findIndex.call(w,_=>_.selected)===-1&&(w[0].selected=!0),e.setValue(t,{value:d(!0),items:p(b)}),f=d(!1)},clear(b){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),f=d(!1)},insert(b){const{index:w,displayValue:y,exportValue:N}=b.detail.insert,_=r.children[w],j=document.createElement("option");j.textContent=y,j.value=N,_?_.before(j):r.append(j),e.setValue(t,{value:d(!0),items:p(b)}),f=d(!1)},items(b){const{items:w}=b.detail;for(;r.length!==0;)r.remove(0);for(const y of w){const{displayValue:N,exportValue:_}=y,j=document.createElement("option");j.textContent=N,j.value=_,r.append(j)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:d(!0),items:p(b)}),f=d(!1)},indices(b){const w=new Set(b.detail.indices);for(const y of b.target.options)y.selected=w.has(y.index);e.setValue(t,{value:d(!0)}),f=d(!1)},editable(b){b.target.disabled=!b.detail.editable}};this._dispatchEventFromSandbox(x,m)}),r.addEventListener("input",m=>{const x=d(!0),b=d(!1);e.setValue(t,{value:x}),m.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:f,change:b,changeEx:x,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],m=>m.target.value)):r.addEventListener("input",function(m){e.setValue(t,{value:d(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Cc extends Je{constructor(e){const{data:t,elements:i}=e;super(e,{isRenderable:Je._hasPopupData(t)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new ab({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const i of this.elements)i.popup=e,i.container.ariaHasPopup="dialog",t.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(i=>`${Fc}${i}`).join(",")),this.container}}class ab{#e=this.#k.bind(this);#t=this.#j.bind(this);#s=this.#E.bind(this);#n=this.#N.bind(this);#r=null;#i=null;#o=null;#l=null;#d=null;#c=null;#h=null;#u=!1;#f=null;#a=null;#p=null;#g=null;#m=null;#x=null;#y=!1;constructor({container:e,color:t,elements:i,titleObj:r,modificationDate:l,contentsObj:c,richText:d,parent:f,rect:p,parentRect:m,open:x}){this.#i=e,this.#m=r,this.#o=c,this.#g=d,this.#c=f,this.#r=t,this.#p=p,this.#h=m,this.#d=i,this.#l=tp.toDateObject(l),this.trigger=i.flatMap(b=>b.getElementsToTriggerPopup());for(const b of this.trigger)b.addEventListener("click",this.#n),b.addEventListener("mouseenter",this.#s),b.addEventListener("mouseleave",this.#t),b.classList.add("popupTriggerArea");for(const b of i)b.container?.addEventListener("keydown",this.#e);this.#i.hidden=!0,x&&this.#N()}render(){if(this.#f)return;const e=this.#f=document.createElement("div");if(e.className="popup",this.#r){const l=e.style.outlineColor=ge.makeHexColor(...this.#r);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${l} 30%, white)`:e.style.backgroundColor=ge.makeHexColor(...this.#r.map(d=>Math.floor(.7*(255-d)+d)))}const t=document.createElement("span");t.className="header";const i=document.createElement("h1");if(t.append(i),{dir:i.dir,str:i.textContent}=this.#m,e.append(t),this.#l){const l=document.createElement("span");l.classList.add("popupDate"),l.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),l.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#l.valueOf()})),t.append(l)}const r=this.#v;if(r)bp.render({xfaHtml:r,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const l=this._formatContents(this.#o);e.append(l)}this.#i.append(e)}get#v(){const e=this.#g,t=this.#o;return e?.str&&(!t?.str||t.str===e.str)&&this.#g.html||null}get#w(){return this.#v?.attributes?.style?.fontSize||0}get#A(){return this.#v?.attributes?.style?.color||null}#S(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:this.#A,fontSize:this.#w?`calc(${this.#w}px * var(--scale-factor))`:""}};for(const l of e.split(`
`))t.push({name:"span",value:l,attributes:r});return i}_formatContents({str:e,dir:t}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=t;const r=e.split(/(?:\r\n?|\n)/);for(let l=0,c=r.length;l<c;++l){const d=r[l];i.append(document.createTextNode(d)),l<c-1&&i.append(document.createElement("br"))}return i}#k(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#u)&&this.#N()}updateEdited({rect:e,popupContent:t}){this.#x||={contentsObj:this.#o,richText:this.#g},e&&(this.#a=null),t&&(this.#g=this.#S(t),this.#o=null),this.#f?.remove(),this.#f=null}resetEdited(){this.#x&&({contentsObj:this.#o,richText:this.#g}=this.#x,this.#x=null,this.#f?.remove(),this.#f=null,this.#a=null)}#C(){if(this.#a!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:r,pageY:l}}}=this.#c;let c=!!this.#h,d=c?this.#h:this.#p;for(const y of this.#d)if(!d||ge.intersect(y.data.rect,d)!==null){d=y.data.rect,c=!0;break}const f=ge.normalizeRect([d[0],e[3]-d[1]+e[1],d[2],e[3]-d[3]+e[1]]),m=c?d[2]-d[0]+5:0,x=f[0]+m,b=f[1];this.#a=[100*(x-r)/t,100*(b-l)/i];const{style:w}=this.#i;w.left=`${this.#a[0]}%`,w.top=`${this.#a[1]}%`}#N(){this.#u=!this.#u,this.#u?(this.#E(),this.#i.addEventListener("click",this.#n),this.#i.addEventListener("keydown",this.#e)):(this.#j(),this.#i.removeEventListener("click",this.#n),this.#i.removeEventListener("keydown",this.#e))}#E(){this.#f||this.render(),this.isVisible?this.#u&&this.#i.classList.add("focused"):(this.#C(),this.#i.hidden=!1,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)+1e3)}#j(){this.#i.classList.remove("focused"),!(this.#u||!this.isVisible)&&(this.#i.hidden=!0,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)-1e3)}forceHide(){this.#y=this.isVisible,this.#y&&(this.#i.hidden=!0)}maybeShow(){this.#y&&(this.#f||this.#E(),this.#y=!1,this.#i.hidden=!1)}get isVisible(){return this.#i.hidden===!1}}class Np extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=ke.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class lb extends Je{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:t,height:i}=tn(e.rect),r=this.svgFactory.create(t,i,!0),l=this.#e=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),l.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),l.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),l.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),l.setAttribute("stroke-width",e.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class ob extends Je{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:t,height:i}=tn(e.rect),r=this.svgFactory.create(t,i,!0),l=e.borderStyle.width,c=this.#e=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",t-l),c.setAttribute("height",i-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class cb extends Je{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:t,height:i}=tn(e.rect),r=this.svgFactory.create(t,i,!0),l=e.borderStyle.width,c=this.#e=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",t/2),c.setAttribute("cy",i/2),c.setAttribute("rx",t/2-l/2),c.setAttribute("ry",i/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Ap extends Je{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:i,popupRef:r}}=this;if(!t)return this.container;const{width:l,height:c}=tn(e),d=this.svgFactory.create(l,c,!0);let f=[];for(let m=0,x=t.length;m<x;m+=2){const b=t[m]-e[0],w=e[3]-t[m+1];f.push(`${b},${w}`)}f=f.join(" ");const p=this.#e=this.svgFactory.createElement(this.svgElementName);return p.setAttribute("points",f),p.setAttribute("stroke-width",i.width||1),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),d.append(p),this.container.append(d),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class db extends Ap{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class ub extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Yc extends Je{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ke.HIGHLIGHT:ke.INK}#s(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:i,borderStyle:r,popupRef:l}}=this,{transform:c,width:d,height:f}=this.#s(t,e),p=this.svgFactory.create(d,f,!0),m=this.#e=this.svgFactory.createElement("svg:g");p.append(m),m.setAttribute("stroke-width",r.width||1),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),m.setAttribute("stroke-miterlimit",10),m.setAttribute("stroke","transparent"),m.setAttribute("fill","transparent"),m.setAttribute("transform",c);for(let x=0,b=i.length;x<b;x++){const w=this.svgFactory.createElement(this.svgElementName);this.#t.push(w),w.setAttribute("points",i[x].join(",")),m.append(w)}return!l&&this.hasPopupData&&this._createPopup(),this.container.append(p),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:i,rect:r}=e,l=this.#e;if(t>=0&&l.setAttribute("stroke-width",t||1),i)for(let c=0,d=this.#t.length;c<d;c++)this.#t[c].setAttribute("points",i[c].join(","));if(r){const{transform:c,width:d,height:f}=this.#s(this.data.rotation,r);l.parentElement.setAttribute("viewBox",`0 0 ${d} ${f}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class _p extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ke.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class hb extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class fb extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class pb extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Sp extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ke.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class mb extends Je{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let i;t.hasAppearance||t.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#t.bind(this)),this.#e=i;const{isMac:r}=kt.platform;return e.addEventListener("keydown",l=>{l.key==="Enter"&&(r?l.metaKey:l.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),e.append(i),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class gb{#e=null;#t=null;#s=new Map;#n=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:r,page:l,viewport:c,structTreeLayer:d}){this.div=e,this.#e=t,this.#t=i,this.#n=d||null,this.page=l,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return this.#s.size>0}async#r(e,t){const i=e.firstChild||e,r=i.id=`${Fc}${t}`,l=await this.#n?.getAriaAttributes(r);if(l)for(const[c,d]of l)i.setAttribute(c,d);this.div.append(e),this.#e?.moveElementInDOM(this.div,e,i,!1)}async render(e){const{annotations:t}=e,i=this.div;Sn(i,this.viewport);const r=new Map,l={data:null,layer:i,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Xc,annotationStorage:e.annotationStorage||new Hc,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const d=c.annotationType===it.POPUP;if(d){const m=r.get(c.id);if(!m)continue;l.elements=m}else{const{width:m,height:x}=tn(c.rect);if(m<=0||x<=0)continue}l.data=c;const f=Zv.create(l);if(!f.isRenderable)continue;if(!d&&c.popupRef){const m=r.get(c.popupRef);m?m.push(f):r.set(c.popupRef,[f])}const p=f.render();c.hidden&&(p.style.visibility="hidden"),await this.#r(p,c.id),f._isEditable&&(this.#s.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}this.#i()}update({viewport:e}){const t=this.div;this.viewport=e,Sn(t,{rotation:e.rotation}),this.#i(),t.hidden=!1}#i(){if(!this.#t)return;const e=this.div;for(const[t,i]of this.#t){const r=e.querySelector(`[data-annotation-id="${t}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:l}=r;l?l.nodeName==="CANVAS"?l.replaceWith(i):l.classList.contains("annotationContent")?l.after(i):l.before(i):r.append(i)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#s.values())}getEditableAnnotation(e){return this.#s.get(e)}}const Da=/\r\n?|\n/g;class rt extends Ne{#e;#t="";#s=`${this.id}-editor`;#n=null;#r;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=rt.prototype,t=l=>l.isEmpty(),i=nn.TRANSLATE_SMALL,r=nn.TRANSLATE_BIG;return Pe(this,"_keyboardManager",new yr([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,r],checker:t}]]))}static _type="freetext";static _editorType=ke.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.#e=e.color||rt._defaultColor||Ne._defaultLineColor,this.#r=e.fontSize||rt._defaultFontSize}static initialize(e,t){Ne.initialize(e,t);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case Te.FREETEXT_SIZE:rt._defaultFontSize=t;break;case Te.FREETEXT_COLOR:rt._defaultColor=t;break}}updateParams(e,t){switch(e){case Te.FREETEXT_SIZE:this.#i(t);break;case Te.FREETEXT_COLOR:this.#o(t);break}}static get defaultPropertiesToUpdate(){return[[Te.FREETEXT_SIZE,rt._defaultFontSize],[Te.FREETEXT_COLOR,rt._defaultColor||Ne._defaultLineColor]]}get propertiesToUpdate(){return[[Te.FREETEXT_SIZE,this.#r],[Te.FREETEXT_COLOR,this.#e]]}#i(e){const t=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-this.#r)*this.parentScale),this.#r=r,this.#d()},i=this.#r;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#o(e){const t=r=>{this.#e=this.editorDiv.style.color=r},i=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-rt._internalPadding*e,-(rt._internalPadding+this.#r)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(ke.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const e=this._uiManager.combinedSignal(this.#n);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#s),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#l(){const e=[];this.editorDiv.normalize();let t=null;for(const i of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(e.push(rt.#c(i)),t=i);return e.join(`
`)}#d(){const[e,t]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:l}=this,c=l.style.display,d=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",r.div.append(this.div),i=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",d)}this.rotation%180===this.parentRotation%180?(this.width=i.width/e,this.height=i.height/t):(this.width=i.height/e,this.height=i.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#t,t=this.#t=this.#l().trimEnd();if(e===t)return;const i=r=>{if(this.#t=r,!r){this.remove();return}this.#h(),this._uiManager.rebuild(this),this.#d()};this.addCommands({cmd:()=>{i(t)},undo:()=>{i(e)},mustExec:!1}),this.#d()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){rt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#s),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#r}px * var(--scale-factor))`,i.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Ga(this,this.div,["dblclick","keydown"]),this.width){const[r,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[d,f]=this.getInitialTranslation();[d,f]=this.pageTranslationToScreen(d,f);const[p,m]=this.pageDimensions,[x,b]=this.pageTranslation;let w,y;switch(this.rotation){case 0:w=e+(c[0]-x)/p,y=t+this.height-(c[1]-b)/m;break;case 90:w=e+(c[0]-x)/p,y=t-(c[1]-b)/m,[d,f]=[f,-d];break;case 180:w=e-this.width+(c[0]-x)/p,y=t-(c[1]-b)/m,[d,f]=[-d,-f];break;case 270:w=e+(c[0]-x-this.height*m)/p,y=t+(c[1]-b-this.width*p)/m,[d,f]=[-f,d];break}this.setAt(w*r,y*l,d,f)}else this.setAt(e*r,t*l,this.width*r,this.height*l);this.#h(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Da,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:i}=t;if(i.length===1&&i[0]==="text/plain")return;e.preventDefault();const r=rt.#f(t.getData("text")||"").replaceAll(Da,`
`);if(!r)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!r.includes(`
`)){c.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:d,startOffset:f}=c,p=[],m=[];if(d.nodeType===Node.TEXT_NODE){const w=d.parentElement;if(m.push(d.nodeValue.slice(f).replaceAll(Da,"")),w!==this.editorDiv){let y=p;for(const N of this.editorDiv.childNodes){if(N===w){y=m;continue}y.push(rt.#c(N))}}p.push(d.nodeValue.slice(0,f).replaceAll(Da,""))}else if(d===this.editorDiv){let w=p,y=0;for(const N of this.editorDiv.childNodes)y++===f&&(w=m),w.push(rt.#c(N))}this.#t=`${p.join(`
`)}${r}${m.join(`
`)}`,this.#h();const x=new Range;let b=p.reduce((w,y)=>w+y.length,0);for(const{firstChild:w}of this.editorDiv.childNodes)if(w.nodeType===Node.TEXT_NODE){const y=w.nodeValue.length;if(b<=y){x.setStart(w,b),x.setEnd(w,b);break}b-=y}l.removeAllRanges(),l.addRange(x)}#h(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const e of this.#t.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#u(){return this.#t.replaceAll(""," ")}static#f(e){return e.replaceAll(" ","")}get contentDiv(){return this.editorDiv}static async deserialize(e,t,i){let r=null;if(e instanceof Np){const{data:{defaultAppearanceData:{fontSize:c,fontColor:d},rect:f,rotation:p,id:m,popupRef:x},textContent:b,textPosition:w,parent:{page:{pageNumber:y}}}=e;if(!b||b.length===0)return null;r=e={annotationType:ke.FREETEXT,color:Array.from(d),fontSize:c,value:b.join(`
`),position:w,pageIndex:y-1,rect:f.slice(0),rotation:p,id:m,deleted:!1,popupRef:x}}const l=await super.deserialize(e,t,i);return l.#r=e.fontSize,l.#e=ge.makeHexColor(...e.color),l.#t=rt.#f(e.value),l.annotationElementId=e.id||null,l._initialData=r,l}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=rt._internalPadding*this.parentScale,i=this.getRect(t,t),r=Ne._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),l={annotationType:ke.FREETEXT,color:r,fontSize:this.#r,value:this.#u(),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?l:this.annotationElementId&&!this.#a(l)?null:(l.id=this.annotationElementId,l)}#a(e){const{value:t,fontSize:i,color:r,pageIndex:l}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==i||e.color.some((c,d)=>c!==r[d])||e.pageIndex!==l}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(this.deleted)return t;const{style:i}=t;i.fontSize=`calc(${this.#r}px * var(--scale-factor))`,i.color=this.#e,t.replaceChildren();for(const l of this.#t.split(`
`)){const c=document.createElement("div");c.append(l?document.createTextNode(l):document.createElement("br")),t.append(c)}const r=rt._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(r,r),popupContent:this.#t}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class ue{static PRECISION=1e-4;toSVGPath(){Fe("Abstract method `toSVGPath` must be implemented.")}get box(){Fe("Abstract getter `box` must be implemented.")}serialize(e,t){Fe("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,r,l,c){c||=new Float32Array(e.length);for(let d=0,f=e.length;d<f;d+=2)c[d]=t+e[d]*r,c[d+1]=i+e[d+1]*l;return c}static _rescaleAndSwap(e,t,i,r,l,c){c||=new Float32Array(e.length);for(let d=0,f=e.length;d<f;d+=2)c[d]=t+e[d+1]*r,c[d+1]=i+e[d]*l;return c}static _translate(e,t,i,r){r||=new Float32Array(e.length);for(let l=0,c=e.length;l<c;l+=2)r[l]=t+e[l],r[l+1]=i+e[l+1];return r}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,r,l){switch(l){case 90:return[1-t/i,e/r];case 180:return[1-e/i,1-t/r];case 270:return[t/i,1-e/r];default:return[e/i,t/r]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,i,r,l,c){return[(e+5*i)/6,(t+5*r)/6,(5*i+l)/6,(5*r+c)/6,(i+l)/2,(r+c)/2]}}class Nn{#e;#t=[];#s;#n;#r=[];#i=new Float32Array(18);#o;#l;#d;#c;#h;#u;#f=[];static#a=8;static#p=2;static#g=Nn.#a+Nn.#p;constructor({x:e,y:t},i,r,l,c,d=0){this.#e=i,this.#u=l*r,this.#n=c,this.#i.set([NaN,NaN,NaN,NaN,e,t],6),this.#s=d,this.#c=Nn.#a*r,this.#d=Nn.#g*r,this.#h=r,this.#f.push(e,t)}isEmpty(){return isNaN(this.#i[8])}#m(){const e=this.#i.subarray(4,6),t=this.#i.subarray(16,18),[i,r,l,c]=this.#e;return[(this.#o+(e[0]-t[0])/2-i)/l,(this.#l+(e[1]-t[1])/2-r)/c,(this.#o+(t[0]-e[0])/2-i)/l,(this.#l+(t[1]-e[1])/2-r)/c]}add({x:e,y:t}){this.#o=e,this.#l=t;const[i,r,l,c]=this.#e;let[d,f,p,m]=this.#i.subarray(8,12);const x=e-p,b=t-m,w=Math.hypot(x,b);if(w<this.#d)return!1;const y=w-this.#c,N=y/w,_=N*x,j=N*b;let S=d,P=f;d=p,f=m,p+=_,m+=j,this.#f?.push(e,t);const k=-j/y,L=_/y,T=k*this.#u,I=L*this.#u;return this.#i.set(this.#i.subarray(2,8),0),this.#i.set([p+T,m+I],4),this.#i.set(this.#i.subarray(14,18),12),this.#i.set([p-T,m-I],16),isNaN(this.#i[6])?(this.#r.length===0&&(this.#i.set([d+T,f+I],2),this.#r.push(NaN,NaN,NaN,NaN,(d+T-i)/l,(f+I-r)/c),this.#i.set([d-T,f-I],14),this.#t.push(NaN,NaN,NaN,NaN,(d-T-i)/l,(f-I-r)/c)),this.#i.set([S,P,d,f,p,m],6),!this.isEmpty()):(this.#i.set([S,P,d,f,p,m],6),Math.abs(Math.atan2(P-f,S-d)-Math.atan2(j,_))<Math.PI/2?([d,f,p,m]=this.#i.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((d+p)/2-i)/l,((f+m)/2-r)/c),[d,f,S,P]=this.#i.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((S+d)/2-i)/l,((P+f)/2-r)/c),!0):([S,P,d,f,p,m]=this.#i.subarray(0,6),this.#r.push(((S+5*d)/6-i)/l,((P+5*f)/6-r)/c,((5*d+p)/6-i)/l,((5*f+m)/6-r)/c,((d+p)/2-i)/l,((f+m)/2-r)/c),[p,m,d,f,S,P]=this.#i.subarray(12,18),this.#t.push(((S+5*d)/6-i)/l,((P+5*f)/6-r)/c,((5*d+p)/6-i)/l,((5*f+m)/6-r)/c,((d+p)/2-i)/l,((f+m)/2-r)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#r,t=this.#t;if(isNaN(this.#i[6])&&!this.isEmpty())return this.#x();const i=[];i.push(`M${e[4]} ${e[5]}`);for(let r=6;r<e.length;r+=6)isNaN(e[r])?i.push(`L${e[r+4]} ${e[r+5]}`):i.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);this.#v(i);for(let r=t.length-6;r>=6;r-=6)isNaN(t[r])?i.push(`L${t[r+4]} ${t[r+5]}`):i.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);return this.#y(i),i.join(" ")}#x(){const[e,t,i,r]=this.#e,[l,c,d,f]=this.#m();return`M${(this.#i[2]-e)/i} ${(this.#i[3]-t)/r} L${(this.#i[4]-e)/i} ${(this.#i[5]-t)/r} L${l} ${c} L${d} ${f} L${(this.#i[16]-e)/i} ${(this.#i[17]-t)/r} L${(this.#i[14]-e)/i} ${(this.#i[15]-t)/r} Z`}#y(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#v(e){const[t,i,r,l]=this.#e,c=this.#i.subarray(4,6),d=this.#i.subarray(16,18),[f,p,m,x]=this.#m();e.push(`L${(c[0]-t)/r} ${(c[1]-i)/l} L${f} ${p} L${m} ${x} L${(d[0]-t)/r} ${(d[1]-i)/l}`)}newFreeDrawOutline(e,t,i,r,l,c){return new jp(e,t,i,r,l,c)}getOutlines(){const e=this.#r,t=this.#t,i=this.#i,[r,l,c,d]=this.#e,f=new Float32Array((this.#f?.length??0)+2);for(let x=0,b=f.length-2;x<b;x+=2)f[x]=(this.#f[x]-r)/c,f[x+1]=(this.#f[x+1]-l)/d;if(f[f.length-2]=(this.#o-r)/c,f[f.length-1]=(this.#l-l)/d,isNaN(i[6])&&!this.isEmpty())return this.#w(f);const p=new Float32Array(this.#r.length+24+this.#t.length);let m=e.length;for(let x=0;x<m;x+=2){if(isNaN(e[x])){p[x]=p[x+1]=NaN;continue}p[x]=e[x],p[x+1]=e[x+1]}m=this.#S(p,m);for(let x=t.length-6;x>=6;x-=6)for(let b=0;b<6;b+=2){if(isNaN(t[x+b])){p[m]=p[m+1]=NaN,m+=2;continue}p[m]=t[x+b],p[m+1]=t[x+b+1],m+=2}return this.#A(p,m),this.newFreeDrawOutline(p,f,this.#e,this.#h,this.#s,this.#n)}#w(e){const t=this.#i,[i,r,l,c]=this.#e,[d,f,p,m]=this.#m(),x=new Float32Array(36);return x.set([NaN,NaN,NaN,NaN,(t[2]-i)/l,(t[3]-r)/c,NaN,NaN,NaN,NaN,(t[4]-i)/l,(t[5]-r)/c,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,p,m,NaN,NaN,NaN,NaN,(t[16]-i)/l,(t[17]-r)/c,NaN,NaN,NaN,NaN,(t[14]-i)/l,(t[15]-r)/c],0),this.newFreeDrawOutline(x,e,this.#e,this.#h,this.#s,this.#n)}#A(e,t){const i=this.#t;return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6}#S(e,t){const i=this.#i.subarray(4,6),r=this.#i.subarray(16,18),[l,c,d,f]=this.#e,[p,m,x,b]=this.#m();return e.set([NaN,NaN,NaN,NaN,(i[0]-l)/d,(i[1]-c)/f,NaN,NaN,NaN,NaN,p,m,NaN,NaN,NaN,NaN,x,b,NaN,NaN,NaN,NaN,(r[0]-l)/d,(r[1]-c)/f],t),t+=24}}class jp extends ue{#e;#t=new Float32Array(4);#s;#n;#r;#i;#o;constructor(e,t,i,r,l,c){super(),this.#o=e,this.#r=t,this.#e=i,this.#i=r,this.#s=l,this.#n=c,this.lastPoint=[NaN,NaN],this.#l(c);const[d,f,p,m]=this.#t;for(let x=0,b=e.length;x<b;x+=2)e[x]=(e[x]-d)/p,e[x+1]=(e[x+1]-f)/m;for(let x=0,b=t.length;x<b;x+=2)t[x]=(t[x]-d)/p,t[x+1]=(t[x+1]-f)/m}toSVGPath(){const e=[`M${this.#o[4]} ${this.#o[5]}`];for(let t=6,i=this.#o.length;t<i;t+=6){if(isNaN(this.#o[t])){e.push(`L${this.#o[t+4]} ${this.#o[t+5]}`);continue}e.push(`C${this.#o[t]} ${this.#o[t+1]} ${this.#o[t+2]} ${this.#o[t+3]} ${this.#o[t+4]} ${this.#o[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,i,r],l){const c=i-e,d=r-t;let f,p;switch(l){case 0:f=ue._rescale(this.#o,e,r,c,-d),p=ue._rescale(this.#r,e,r,c,-d);break;case 90:f=ue._rescaleAndSwap(this.#o,e,t,c,d),p=ue._rescaleAndSwap(this.#r,e,t,c,d);break;case 180:f=ue._rescale(this.#o,i,t,-c,d),p=ue._rescale(this.#r,i,t,-c,d);break;case 270:f=ue._rescaleAndSwap(this.#o,i,r,-c,-d),p=ue._rescaleAndSwap(this.#r,i,r,-c,-d);break}return{outline:Array.from(f),points:[Array.from(p)]}}#l(e){const t=this.#o;let i=t[4],r=t[5],l=i,c=r,d=i,f=r,p=i,m=r;const x=e?Math.max:Math.min;for(let w=6,y=t.length;w<y;w+=6){if(isNaN(t[w]))l=Math.min(l,t[w+4]),c=Math.min(c,t[w+5]),d=Math.max(d,t[w+4]),f=Math.max(f,t[w+5]),m<t[w+5]?(p=t[w+4],m=t[w+5]):m===t[w+5]&&(p=x(p,t[w+4]));else{const N=ge.bezierBoundingBox(i,r,...t.slice(w,w+6));l=Math.min(l,N[0]),c=Math.min(c,N[1]),d=Math.max(d,N[2]),f=Math.max(f,N[3]),m<N[3]?(p=N[2],m=N[3]):m===N[3]&&(p=x(p,N[2]))}i=t[w+4],r=t[w+5]}const b=this.#t;b[0]=l-this.#s,b[1]=c-this.#s,b[2]=d-l+2*this.#s,b[3]=f-c+2*this.#s,this.lastPoint=[p,m]}get box(){return this.#t}newOutliner(e,t,i,r,l,c=0){return new Nn(e,t,i,r,l,c)}getNewOutline(e,t){const[i,r,l,c]=this.#t,[d,f,p,m]=this.#e,x=l*p,b=c*m,w=i*p+d,y=r*m+f,N=this.newOutliner({x:this.#r[0]*x+w,y:this.#r[1]*b+y},this.#e,this.#i,e,this.#n,t??this.#s);for(let _=2;_<this.#r.length;_+=2)N.add({x:this.#r[_]*x+w,y:this.#r[_+1]*b+y});return N.getOutlines()}}class Pc{#e;#t;#s=[];#n=[];constructor(e,t=0,i=0,r=!0){let l=1/0,c=-1/0,d=1/0,f=-1/0;const p=10**-4;for(const{x:_,y:j,width:S,height:P}of e){const k=Math.floor((_-t)/p)*p,L=Math.ceil((_+S+t)/p)*p,T=Math.floor((j-t)/p)*p,I=Math.ceil((j+P+t)/p)*p,$=[k,T,I,!0],te=[L,T,I,!1];this.#s.push($,te),l=Math.min(l,k),c=Math.max(c,L),d=Math.min(d,T),f=Math.max(f,I)}const m=c-l+2*i,x=f-d+2*i,b=l-i,w=d-i,y=this.#s.at(r?-1:-2),N=[y[0],y[2]];for(const _ of this.#s){const[j,S,P]=_;_[0]=(j-b)/m,_[1]=(S-w)/x,_[2]=(P-w)/x}this.#e=new Float32Array([b,w,m,x]),this.#t=N}getOutlines(){this.#s.sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of this.#s)t[3]?(e.push(...this.#d(t)),this.#o(t)):(this.#l(t),e.push(...this.#d(t)));return this.#r(e)}#r(e){const t=[],i=new Set;for(const c of e){const[d,f,p]=c;t.push([d,f,c],[d,p,c])}t.sort((c,d)=>c[1]-d[1]||c[0]-d[0]);for(let c=0,d=t.length;c<d;c+=2){const f=t[c][2],p=t[c+1][2];f.push(p),p.push(f),i.add(f),i.add(p)}const r=[];let l;for(;i.size>0;){const c=i.values().next().value;let[d,f,p,m,x]=c;i.delete(c);let b=d,w=f;for(l=[d,p],r.push(l);;){let y;if(i.has(m))y=m;else if(i.has(x))y=x;else break;i.delete(y),[d,f,p,m,x]=y,b!==d&&(l.push(b,w,d,w===f?f:p),b=d),w=w===f?p:f}l.push(b,w)}return new xb(r,this.#e,this.#t)}#i(e){const t=this.#n;let i=0,r=t.length-1;for(;i<=r;){const l=i+r>>1,c=t[l][0];if(c===e)return l;c<e?i=l+1:r=l-1}return r+1}#o([,e,t]){const i=this.#i(e);this.#n.splice(i,0,[e,t])}#l([,e,t]){const i=this.#i(e);for(let r=i;r<this.#n.length;r++){const[l,c]=this.#n[r];if(l!==e)break;if(l===e&&c===t){this.#n.splice(r,1);return}}for(let r=i-1;r>=0;r--){const[l,c]=this.#n[r];if(l!==e)break;if(l===e&&c===t){this.#n.splice(r,1);return}}}#d(e){const[t,i,r]=e,l=[[t,i,r]],c=this.#i(r);for(let d=0;d<c;d++){const[f,p]=this.#n[d];for(let m=0,x=l.length;m<x;m++){const[,b,w]=l[m];if(!(p<=b||w<=f)){if(b>=f){if(w>p)l[m][1]=p;else{if(x===1)return[];l.splice(m,1),m--,x--}continue}l[m][2]=f,w>p&&l.push([t,p,w])}}}return l}}class xb extends ue{#e;#t;constructor(e,t,i){super(),this.#t=e,this.#e=t,this.lastPoint=i}toSVGPath(){const e=[];for(const t of this.#t){let[i,r]=t;e.push(`M${i} ${r}`);for(let l=2;l<t.length;l+=2){const c=t[l],d=t[l+1];c===i?(e.push(`V${d}`),r=d):d===r&&(e.push(`H${c}`),i=c)}e.push("Z")}return e.join(" ")}serialize([e,t,i,r],l){const c=[],d=i-e,f=r-t;for(const p of this.#t){const m=new Array(p.length);for(let x=0;x<p.length;x+=2)m[x]=e+p[x]*d,m[x+1]=r-p[x+1]*f;c.push(m)}return c}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class Tc extends Nn{newFreeDrawOutline(e,t,i,r,l,c){return new vb(e,t,i,r,l,c)}}class vb extends jp{newOutliner(e,t,i,r,l,c=0){return new Tc(e,t,i,r,l,c)}}class Jt{#e=null;#t=null;#s;#n=null;#r=!1;#i=!1;#o=null;#l;#d=null;#c=null;#h;static#u=null;static get _keyboardManager(){return Pe(this,"_keyboardManager",new yr([[["Escape","mac+Escape"],Jt.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Jt.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Jt.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Jt.prototype._moveToPrevious],[["Home","mac+Home"],Jt.prototype._moveToBeginning],[["End","mac+End"],Jt.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#i=!1,this.#h=Te.HIGHLIGHT_COLOR,this.#o=e):(this.#i=!0,this.#h=Te.HIGHLIGHT_DEFAULT_COLOR),this.#c=e?._uiManager||t,this.#l=this.#c._eventBus,this.#s=e?.color||this.#c?.highlightColors.values().next().value||"#FFFF98",Jt.#u||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=this.#c._signal;e.addEventListener("click",this.#g.bind(this),{signal:t}),e.addEventListener("keydown",this.#p.bind(this),{signal:t});const i=this.#t=document.createElement("span");return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=this.#s,e.append(i),e}renderMainDropdown(){const e=this.#n=this.#f();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#f(){const e=document.createElement("div"),t=this.#c._signal;e.addEventListener("contextmenu",os,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,r]of this.#c.highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",r),l.title=i,l.setAttribute("data-l10n-id",Jt.#u[i]);const c=document.createElement("span");l.append(c),c.className="swatch",c.style.backgroundColor=r,l.setAttribute("aria-selected",r===this.#s),l.addEventListener("click",this.#a.bind(this,r),{signal:t}),e.append(l)}return e.addEventListener("keydown",this.#p.bind(this),{signal:t}),e}#a(e,t){t.stopPropagation(),this.#l.dispatch("switchannotationeditorparams",{source:this,type:this.#h,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#g(e);return}const t=e.target.getAttribute("data-color");t&&this.#a(t,e)}_moveToNext(e){if(!this.#x){this.#g(e);return}if(e.target===this.#e){this.#n.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#n?.firstChild||e.target===this.#e){this.#x&&this._hideDropdownFromKeyboard();return}this.#x||this.#g(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#x){this.#g(e);return}this.#n.firstChild?.focus()}_moveToEnd(e){if(!this.#x){this.#g(e);return}this.#n.lastChild?.focus()}#p(e){Jt._keyboardManager.exec(this,e)}#g(e){if(this.#x){this.hideDropdown();return}if(this.#r=e.detail===0,this.#d||(this.#d=new AbortController,window.addEventListener("pointerdown",this.#m.bind(this),{signal:this.#c.combinedSignal(this.#d)})),this.#n){this.#n.classList.remove("hidden");return}const t=this.#n=this.#f();this.#e.append(t)}#m(e){this.#n?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#d?.abort(),this.#d=null}get#x(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#i){if(!this.#x){this.#o?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#n)return;const t=this.#c.highlightColors.values();for(const i of this.#n.children)i.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#n?.remove(),this.#n=null}}class Qe extends Ne{#e=null;#t=0;#s;#n=null;#r=null;#i=null;#o=null;#l=0;#d=null;#c=null;#h=null;#u=!1;#f=null;#a;#p=null;#g="";#m;#x="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=ke.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=Qe.prototype;return Pe(this,"_keyboardManager",new yr([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||Qe._defaultColor,this.#m=e.thickness||Qe._defaultThickness,this.#a=e.opacity||Qe._defaultOpacity,this.#s=e.boxes||null,this.#x=e.methodOfCreation||"",this.#g=e.text||"",this._isDraggable=!1,e.highlightId>-1?(this.#u=!0,this.#v(e),this.#C()):this.#s&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#o=e.focusNode,this.#l=e.focusOffset,this.#y(),this.#C(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#m,methodOfCreation:this.#x}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#y(){const e=new Pc(this.#s,.001);this.#c=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const t=new Pc(this.#s,.0025,.001,this._uiManager.direction==="ltr");this.#i=t.getOutlines();const{lastPoint:i}=this.#i;this.#f=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]}#v({highlightOutlines:e,highlightId:t,clipPathId:i}){this.#c=e;const r=1.5;if(this.#i=e.getNewOutline(this.#m/2+r,.0025),t>=0)this.#h=t,this.#n=i,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},!0);else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:Qe.#N(this.#c.box,(m-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:Qe.#N(this.#i.box,m),path:{d:this.#i.toSVGPath()}})}const[l,c,d,f]=e.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=d,this.height=f;break;case 90:{const[m,x]=this.parentDimensions;this.x=c,this.y=1-l,this.width=d*x/m,this.height=f*m/x;break}case 180:this.x=1-l,this.y=1-c,this.width=d,this.height=f;break;case 270:{const[m,x]=this.parentDimensions;this.x=1-c,this.y=l,this.width=d*x/m,this.height=f*m/x;break}}const{lastPoint:p}=this.#i;this.#f=[(p[0]-l)/d,(p[1]-c)/f]}static initialize(e,t){Ne.initialize(e,t),Qe._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case Te.HIGHLIGHT_DEFAULT_COLOR:Qe._defaultColor=t;break;case Te.HIGHLIGHT_THICKNESS:Qe._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#f}updateParams(e,t){switch(e){case Te.HIGHLIGHT_COLOR:this.#w(t);break;case Te.HIGHLIGHT_THICKNESS:this.#A(t);break}}static get defaultPropertiesToUpdate(){return[[Te.HIGHLIGHT_DEFAULT_COLOR,Qe._defaultColor],[Te.HIGHLIGHT_THICKNESS,Qe._defaultThickness]]}get propertiesToUpdate(){return[[Te.HIGHLIGHT_COLOR,this.color||Qe._defaultColor],[Te.HIGHLIGHT_THICKNESS,this.#m||Qe._defaultThickness],[Te.HIGHLIGHT_FREE,this.#u]]}#w(e){const t=(l,c)=>{this.color=l,this.#a=c,this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:l,"fill-opacity":c}}),this.#r?.updateColor(l)},i=this.color,r=this.#a;this.addCommands({cmd:t.bind(this,e,Qe._defaultOpacity),undo:t.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#A(e){const t=this.#m,i=r=>{this.#m=r,this.#S(r)};this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(this.#r=new Jt({editor:this}),e.addColorPicker(this.#r)),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#T())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#T())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#k(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#C(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#k():e&&(this.#C(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#S(e){if(!this.#u)return;this.#v({highlightOutlines:this.#c.getNewOutline(e/2)}),this.fixAndSetPosition();const[t,i]=this.parentDimensions;this.setDims(this.width*t,this.height*i)}#k(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#C(e=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#n}=e.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#a},rootClass:{highlight:!0,free:this.#u},path:{d:this.#c.toSVGPath()}},!1,!0),this.#p=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},this.#u),this.#d&&(this.#d.style.clipPath=this.#n))}static#N([e,t,i,r],l){switch(l){case 90:return[1-t-r,e,r,i];case 180:return[1-e-i,1-t-r,i,r];case 270:return[t,1-e-i,r,i]}return[e,t,i,r]}rotate(e){const{drawLayer:t}=this.parent;let i;this.#u?(e=(e-this.rotation+360)%360,i=Qe.#N(this.#c.box,e)):i=Qe.#N([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#h,{bbox:i,root:{"data-main-rotation":e}}),t.updateProperties(this.#p,{bbox:Qe.#N(this.#i.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#g&&(e.setAttribute("aria-label",this.#g),e.setAttribute("role","mark")),this.#u?e.classList.add("free"):this.div.addEventListener("keydown",this.#E.bind(this),{signal:this._uiManager._signal});const t=this.#d=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#n;const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),Ga(this,this.#d,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#E(e){Qe._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#j(!0);break;case 1:case 3:this.#j(!1);break}}#j(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#o,this.#l)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#j(!1))}get _mustFixPosition(){return!this.#u}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!e}}))}#T(){return this.#u?this.rotation:0}#M(){if(this.#u)return null;const[e,t]=this.pageDimensions,[i,r]=this.pageTranslation,l=this.#s,c=new Float32Array(l.length*8);let d=0;for(const{x:f,y:p,width:m,height:x}of l){const b=f*e+i,w=(1-p)*t+r;c[d]=c[d+4]=b,c[d+1]=c[d+3]=w,c[d+2]=c[d+6]=b+m*e,c[d+5]=c[d+7]=w-x*t,d+=8}return c}#I(e){return this.#c.serialize(e,this.#T())}static startHighlighting(e,t,{target:i,x:r,y:l}){const{x:c,y:d,width:f,height:p}=i.getBoundingClientRect(),m=new AbortController,x=e.combinedSignal(m),b=w=>{m.abort(),this.#b(e,w)};window.addEventListener("blur",b,{signal:x}),window.addEventListener("pointerup",b,{signal:x}),window.addEventListener("pointerdown",$t,{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",os,{signal:x}),i.addEventListener("pointermove",this.#_.bind(this,e),{signal:x}),this._freeHighlight=new Tc({x:r,y:l},[c,d,f,p],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#_(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#b(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,i){let r=null;if(e instanceof _p){const{data:{quadPoints:y,rect:N,rotation:_,id:j,color:S,opacity:P,popupRef:k},parent:{page:{pageNumber:L}}}=e;r=e={annotationType:ke.HIGHLIGHT,color:Array.from(S),opacity:P,quadPoints:y,boxes:null,pageIndex:L-1,rect:N.slice(0),rotation:_,id:j,deleted:!1,popupRef:k}}else if(e instanceof Yc){const{data:{inkLists:y,rect:N,rotation:_,id:j,color:S,borderStyle:{rawWidth:P},popupRef:k},parent:{page:{pageNumber:L}}}=e;r=e={annotationType:ke.HIGHLIGHT,color:Array.from(S),thickness:P,inkLists:y,boxes:null,pageIndex:L-1,rect:N.slice(0),rotation:_,id:j,deleted:!1,popupRef:k}}const{color:l,quadPoints:c,inkLists:d,opacity:f}=e,p=await super.deserialize(e,t,i);p.color=ge.makeHexColor(...l),p.#a=f||1,d&&(p.#m=e.thickness),p.annotationElementId=e.id||null,p._initialData=r;const[m,x]=p.pageDimensions,[b,w]=p.pageTranslation;if(c){const y=p.#s=[];for(let N=0;N<c.length;N+=8)y.push({x:(c[N]-b)/m,y:1-(c[N+1]-w)/x,width:(c[N+2]-c[N])/m,height:(c[N+1]-c[N+5])/x});p.#y(),p.#C(),p.rotate(p.rotation)}else if(d){p.#u=!0;const y=d[0],N={x:y[0]-b,y:x-(y[1]-w)},_=new Tc(N,[0,0,m,x],1,p.#m/2,!0,.001);for(let P=0,k=y.length;P<k;P+=2)N.x=y[P]-b,N.y=x-(y[P+1]-w),_.add(N);const{id:j,clipPathId:S}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:p.color,"fill-opacity":p._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:_.toSVGPath()}},!0,!0);p.#v({highlightOutlines:_.getOutlines(),highlightId:j,clipPathId:S}),p.#C()}return p}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=this.getRect(0,0),i=Ne._colorManager.convert(this.color),r={annotationType:ke.HIGHLIGHT,color:i,opacity:this.#a,thickness:this.#m,quadPoints:this.#M(),outlines:this.#I(t),pageIndex:this.pageIndex,rect:t,rotation:this.#T(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#L(r)?null:(r.id=this.annotationElementId,r)}#L(e){const{color:t}=this._initialData;return e.color.some((i,r)=>i!==t[r])}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class bb{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))this.updateProperty(t,i)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){Fe("Not implemented")}}class we extends Ne{#e=null;#t;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#s=null;static#n=null;static#r=null;static#i=NaN;static#o=null;static#l=null;static#d=NaN;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,e.drawOutlines&&(this.#c(e),this.#f())}#c({drawOutlines:e,drawId:t,drawingOptions:i}){this.#e=e,this._drawingOptions||=i,t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#h(e,this.parent),this.#g(e.box)}#h(e,t){const{id:i}=t.drawLayer.draw(we._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(e,t){const i=new Set(Object.keys(e));for(const[r,l]of Object.entries(t))i.has(r)?Object.assign(e[r],l):e[r]=l;return e}static getDefaultDrawingOptions(e){Fe("Not implemented")}static get typesMap(){Fe("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const i=this.typesMap.get(e);i&&this._defaultDrawingOptions.updateProperty(i,t),this._currentParent&&(we.#s.updateProperty(i,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const i=this.constructor.typesMap.get(e);i&&this._updateProperty(e,i,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)e.push([i,t[r]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[i,r]of this.constructor.typesMap)e.push([i,t[r]]);return e}_updateProperty(e,t,i){const r=this._drawingOptions,l=r[t],c=d=>{r.updateProperty(t,d);const f=this.#e.updateProperty(t,d);f&&this.#g(f),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:c.bind(this,i),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,we._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#p()),{bbox:this.#m()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,we._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#p()),{bbox:this.#m()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#m(e,t)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,we._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#m()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#g(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#u()):e&&(this._uiManager.addShouldRescale(this),this.#f(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#h(this.#e,e)}}#a([e,t,i,r]){const{parentDimensions:[l,c],rotation:d}=this;switch(d){case 90:return[t,1-e,i*(c/l),r*(l/c)];case 180:return[1-e,1-t,i,r];case 270:return[1-t,e,i*(c/l),r*(l/c)];default:return[e,t,i,r]}}#p(){const{x:e,y:t,width:i,height:r,parentDimensions:[l,c],rotation:d}=this;switch(d){case 90:return[1-t,e,i*(l/c),r*(c/l)];case 180:return[1-e,1-t,i,r];case 270:return[t,1-e,i*(l/c),r*(c/l)];default:return[e,t,i,r]}}#g(e){if([this.x,this.y,this.width,this.height]=this.#a(e),this.div){this.fixAndSetPosition();const[t,i]=this.parentDimensions;this.setDims(this.width*t,this.height*i)}this._onResized()}#m(){const{x:e,y:t,width:i,height:r,rotation:l,parentRotation:c,parentDimensions:[d,f]}=this;switch((l*4+c)/90){case 1:return[1-t-r,e,r,i];case 2:return[1-e-i,1-t-r,i,r];case 3:return[t,1-e-i,r,i];case 4:return[e,t-i*(d/f),r*(f/d),i*(d/f)];case 5:return[1-t,e,i*(d/f),r*(f/d)];case 6:return[1-e-r*(f/d),1-t,r*(f/d),i*(d/f)];case 7:return[t-i*(d/f),1-e-r*(f/d),i*(d/f),r*(f/d)];case 8:return[e-i,t-r,i,r];case 9:return[1-t,e-i,r,i];case 10:return[1-e,1-t,i,r];case 11:return[t-r,1-e,r,i];case 12:return[e-r*(f/d),t,r*(f/d),i*(d/f)];case 13:return[1-t-i*(d/f),e-r*(f/d),i*(d/f),r*(f/d)];case 14:return[1-e,1-t-i*(d/f),r*(f/d),i*(d/f)];case 15:return[t,1-e,i*(d/f),r*(f/d)];default:return[e,t,i,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,we._mergeSVGProperties({bbox:this.#m()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#g(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const e=super.render();e.classList.add("draw");const t=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal";const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),e}static createDrawerInstance(e,t,i,r,l){Fe("Not implemented")}static startDrawing(e,t,i,r){const{target:l,offsetX:c,offsetY:d,pointerId:f,pointerType:p}=r;if(we.#o&&we.#o!==p)return;const{viewport:{rotation:m}}=e,{width:x,height:b}=l.getBoundingClientRect(),w=we.#n=new AbortController,y=e.combinedSignal(w);if(we.#i||=f,we.#o??=p,window.addEventListener("pointerup",N=>{we.#i===N.pointerId?this._endDraw(N):we.#l?.delete(N.pointerId)},{signal:y}),window.addEventListener("pointercancel",N=>{we.#i===N.pointerId?this._currentParent.endDrawingSession():we.#l?.delete(N.pointerId)},{signal:y}),window.addEventListener("pointerdown",N=>{we.#o===N.pointerType&&((we.#l||=new Set).add(N.pointerId),we.#s.isCancellable()&&(we.#s.removeLastElement(),we.#s.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",os,{signal:y}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:y}),l.addEventListener("touchmove",N=>{N.timeStamp===we.#d&&$t(N)},{signal:y}),e.toggleDrawing(),t._editorUndoBar?.hide(),we.#s){e.drawLayer.updateProperties(this._currentDrawId,we.#s.startNew(c,d,x,b,m));return}t.updateUIForDefaultProperties(this),we.#s=this.createDrawerInstance(c,d,x,b,m),we.#r=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(we.#r.toSVGProperties(),we.#s.defaultSVGProperties),!0,!1)}static _drawMove(e){if(we.#d=-1,!we.#s)return;const{offsetX:t,offsetY:i,pointerId:r}=e;if(we.#i===r){if(we.#l?.size>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,we.#s.add(t,i)),we.#d=e.timeStamp,$t(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,we.#s=null,we.#r=null,we.#o=null,we.#d=NaN),we.#n&&(we.#n.abort(),we.#n=null,we.#i=NaN,we.#l=null)}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e&&t.drawLayer.updateProperties(this._currentDrawId,we.#s.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const i=we.#s,r=this._currentDrawId,l=i.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(r,i.setLastElement(l))},undo:()=>{t.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:Te.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(Te.DRAW_STEP),!we.#s.isEmpty()){const{pageDimensions:[i,r],scale:l}=t,c=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:we.#s.getOutlines(i*l,r*l,l,this._INNER_MARGIN),drawingOptions:we.#r,mustBeCommitted:!e});return this._cleanup(!0),c}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,i,r,l,c){Fe("Not implemented")}static async deserialize(e,t,i){const{rawDims:{pageWidth:r,pageHeight:l,pageX:c,pageY:d}}=t.viewport,f=this.deserializeDraw(c,d,r,l,this._INNER_MARGIN,e),p=await super.deserialize(e,t,i);return p.createDrawingOptions(e),p.#c({drawOutlines:f}),p.#f(),p.onScaleChanging(),p.rotate(),p}serializeDraw(e){const[t,i]=this.pageTranslation,[r,l]=this.pageDimensions;return this.#e.serialize([t,i,r,l],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class yb{#e=new Float64Array(6);#t;#s;#n;#r;#i;#o="";#l=0;#d=new ll;#c;#h;constructor(e,t,i,r,l,c){this.#c=i,this.#h=r,this.#n=l,this.#r=c,[e,t]=this.#u(e,t);const d=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#i=[e,t],this.#s=[{line:d,points:this.#i}],this.#e.set(d,0)}updateProperty(e,t){e==="stroke-width"&&(this.#r=t)}#u(e,t){return ue._normalizePoint(e,t,this.#c,this.#h,this.#n)}isEmpty(){return!this.#s||this.#s.length===0}isCancellable(){return this.#i.length<=10}add(e,t){[e,t]=this.#u(e,t);const[i,r,l,c]=this.#e.subarray(2,6),d=e-l,f=t-c;return Math.hypot(this.#c*d,this.#h*f)<=2?null:(this.#i.push(e,t),isNaN(i)?(this.#e.set([l,c,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([i,r,l,c,e,t],0),this.#t.push(...ue.createBezierPoints(i,r,l,c,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(this.#i.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,r,l){this.#c=i,this.#h=r,this.#n=l,[e,t]=this.#u(e,t);const c=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#i=[e,t];const d=this.#s.at(-1);return d&&(d.line=new Float32Array(d.line),d.points=new Float32Array(d.points)),this.#s.push({line:c,points:this.#i}),this.#e.set(c,0),this.#l=0,this.toSVGPath(),null}getLastElement(){return this.#s.at(-1)}setLastElement(e){return this.#s?(this.#s.push(e),this.#t=e.line,this.#i=e.points,this.#l=0,{path:{d:this.toSVGPath()}}):this.#d.setLastElement(e)}removeLastElement(){if(!this.#s)return this.#d.removeLastElement();this.#s.pop(),this.#o="";for(let e=0,t=this.#s.length;e<t;e++){const{line:i,points:r}=this.#s[e];this.#t=i,this.#i=r,this.#l=0,this.toSVGPath()}return{path:{d:this.#o}}}toSVGPath(){const e=ue.svgRound(this.#t[4]),t=ue.svgRound(this.#t[5]);if(this.#i.length===2)return this.#o=`${this.#o} M ${e} ${t} Z`,this.#o;if(this.#i.length<=6){const r=this.#o.lastIndexOf("M");this.#o=`${this.#o.slice(0,r)} M ${e} ${t}`,this.#l=6}if(this.#i.length===4){const r=ue.svgRound(this.#t[10]),l=ue.svgRound(this.#t[11]);return this.#o=`${this.#o} L ${r} ${l}`,this.#l=12,this.#o}const i=[];this.#l===0&&(i.push(`M ${e} ${t}`),this.#l=6);for(let r=this.#l,l=this.#t.length;r<l;r+=6){const[c,d,f,p,m,x]=this.#t.slice(r,r+6).map(ue.svgRound);i.push(`C${c} ${d} ${f} ${p} ${m} ${x}`)}return this.#o+=i.join(" "),this.#l=this.#t.length,this.#o}getOutlines(e,t,i,r){const l=this.#s.at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),this.#d.build(this.#s,e,t,i,this.#n,this.#r,r),this.#e=null,this.#t=null,this.#s=null,this.#o=null,this.#d}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class ll extends ue{#e;#t=0;#s;#n;#r;#i;#o;#l;#d;build(e,t,i,r,l,c,d){this.#r=t,this.#i=i,this.#o=r,this.#l=l,this.#d=c,this.#s=d??0,this.#n=e,this.#u()}setLastElement(e){return this.#n.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#n){if(e.push(`M${ue.svgRound(t[4])} ${ue.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12){e.push(`L${ue.svgRound(t[10])} ${ue.svgRound(t[11])}`);continue}for(let i=6,r=t.length;i<r;i+=6){const[l,c,d,f,p,m]=t.subarray(i,i+6).map(ue.svgRound);e.push(`C${l} ${c} ${d} ${f} ${p} ${m}`)}}return e.join("")}serialize([e,t,i,r],l){const c=[],d=[],[f,p,m,x]=this.#h();let b,w,y,N,_,j,S,P,k;switch(this.#l){case 0:k=ue._rescale,b=e,w=t+r,y=i,N=-r,_=e+f*i,j=t+(1-p-x)*r,S=e+(f+m)*i,P=t+(1-p)*r;break;case 90:k=ue._rescaleAndSwap,b=e,w=t,y=i,N=r,_=e+p*i,j=t+f*r,S=e+(p+x)*i,P=t+(f+m)*r;break;case 180:k=ue._rescale,b=e+i,w=t,y=-i,N=r,_=e+(1-f-m)*i,j=t+p*r,S=e+(1-f)*i,P=t+(p+x)*r;break;case 270:k=ue._rescaleAndSwap,b=e+i,w=t+r,y=-i,N=-r,_=e+(1-p-x)*i,j=t+(1-f-m)*r,S=e+(1-p)*i,P=t+(1-f)*r;break}for(const{line:L,points:T}of this.#n)c.push(k(L,b,w,y,N,l?new Array(L.length):null)),d.push(k(T,b,w,y,N,l?new Array(T.length):null));return{lines:c,points:d,rect:[_,j,S,P]}}static deserialize(e,t,i,r,l,{paths:{lines:c,points:d},rotation:f,thickness:p}){const m=[];let x,b,w,y,N;switch(f){case 0:N=ue._rescale,x=-e/i,b=t/r+1,w=1/i,y=-1/r;break;case 90:N=ue._rescaleAndSwap,x=-t/r,b=-e/i,w=1/r,y=1/i;break;case 180:N=ue._rescale,x=e/i+1,b=-t/r,w=-1/i,y=1/r;break;case 270:N=ue._rescaleAndSwap,x=t/r+1,b=e/i+1,w=-1/r,y=-1/i;break}if(!c){c=[];for(const j of d){const S=j.length;if(S===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,j[0],j[1]]));continue}if(S===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,j[0],j[1],NaN,NaN,NaN,NaN,j[2],j[3]]));continue}const P=new Float32Array(3*(S-2));c.push(P);let[k,L,T,I]=j.subarray(0,4);P.set([NaN,NaN,NaN,NaN,k,L],0);for(let $=4;$<S;$+=2){const te=j[$],oe=j[$+1];P.set(ue.createBezierPoints(k,L,T,I,te,oe),($-2)*3),[k,L,T,I]=[T,I,te,oe]}}}for(let j=0,S=c.length;j<S;j++)m.push({line:N(c[j].map(P=>P??NaN),x,b,w,y),points:N(d[j].map(P=>P??NaN),x,b,w,y)});const _=new ll;return _.build(m,i,r,1,f,p,l),_}#c(e=this.#d){const t=this.#s+e/2*this.#o;return this.#l%180===0?[t/this.#r,t/this.#i]:[t/this.#i,t/this.#r]}#h(){const[e,t,i,r]=this.#e,[l,c]=this.#c(0);return[e+l,t+c,i-2*l,r-2*c]}#u(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#n){if(r.length<=12){for(let d=4,f=r.length;d<f;d+=6){const[p,m]=r.subarray(d,d+2);e[0]=Math.min(e[0],p),e[1]=Math.min(e[1],m),e[2]=Math.max(e[2],p),e[3]=Math.max(e[3],m)}continue}let l=r[4],c=r[5];for(let d=6,f=r.length;d<f;d+=6){const[p,m,x,b,w,y]=r.subarray(d,d+6);ge.bezierBoundingBox(l,c,p,m,x,b,w,y,e),l=w,c=y}}const[t,i]=this.#c();e[0]=Math.min(1,Math.max(0,e[0]-t)),e[1]=Math.min(1,Math.max(0,e[1]-i)),e[2]=Math.min(1,Math.max(0,e[2]+t)),e[3]=Math.min(1,Math.max(0,e[3]+i)),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,i]=this.#c();this.#d=e;const[r,l]=this.#c(),[c,d]=[r-t,l-i],f=this.#e;return f[0]-=c,f[1]-=d,f[2]+=2*c,f[3]+=2*d,f}updateParentDimensions([e,t],i){const[r,l]=this.#c();this.#r=e,this.#i=t,this.#o=i;const[c,d]=this.#c(),f=c-r,p=d-l,m=this.#e;return m[0]-=f,m[1]-=p,m[2]+=2*f,m[3]+=2*p,m}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(ue.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ue.svgRound(e)} ${ue.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let i=0,r=0,l=0,c=0,d=0,f=0;switch(this.#t){case 90:r=t/e,l=-e/t,d=e;break;case 180:i=-1,c=-1,d=e,f=t;break;case 270:r=-t/e,l=e/t,f=t;break;default:return""}return`matrix(${i} ${r} ${l} ${c} ${ue.svgRound(d)} ${ue.svgRound(f)})`}getPathResizingSVGProperties([e,t,i,r]){const[l,c]=this.#c(),[d,f,p,m]=this.#e;if(Math.abs(p-l)<=ue.PRECISION||Math.abs(m-c)<=ue.PRECISION){const N=e+i/2-(d+p/2),_=t+r/2-(f+m/2);return{path:{"transform-origin":`${ue.svgRound(e)} ${ue.svgRound(t)}`,transform:`${this.rotationTransform} translate(${N} ${_})`}}}const x=(i-2*l)/(p-2*l),b=(r-2*c)/(m-2*c),w=p/i,y=m/r;return{path:{"transform-origin":`${ue.svgRound(d)} ${ue.svgRound(f)}`,transform:`${this.rotationTransform} scale(${w} ${y}) translate(${ue.svgRound(l)} ${ue.svgRound(c)}) scale(${x} ${b}) translate(${ue.svgRound(-l)} ${ue.svgRound(-c)})`}}}getPathResizedSVGProperties([e,t,i,r]){const[l,c]=this.#c(),d=this.#e,[f,p,m,x]=d;if(d[0]=e,d[1]=t,d[2]=i,d[3]=r,Math.abs(m-l)<=ue.PRECISION||Math.abs(x-c)<=ue.PRECISION){const _=e+i/2-(f+m/2),j=t+r/2-(p+x/2);for(const{line:S,points:P}of this.#n)ue._translate(S,_,j,S),ue._translate(P,_,j,P);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ue.svgRound(e)} ${ue.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const b=(i-2*l)/(m-2*l),w=(r-2*c)/(x-2*c),y=-b*(f+l)+e+l,N=-w*(p+c)+t+c;if(b!==1||w!==1||y!==0||N!==0)for(const{line:_,points:j}of this.#n)ue._rescale(_,y,N,b,w,_),ue._rescale(j,y,N,b,w,j);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ue.svgRound(e)} ${ue.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],i){const[r,l]=i,c=this.#e,d=e-c[0],f=t-c[1];if(this.#r===r&&this.#i===l)for(const{line:p,points:m}of this.#n)ue._translate(p,d,f,p),ue._translate(m,d,f,m);else{const p=this.#r/r,m=this.#i/l;this.#r=r,this.#i=l;for(const{line:x,points:b}of this.#n)ue._rescale(x,d,f,p,m,x),ue._rescale(b,d,f,p,m,b);c[2]*=p,c[3]*=m}return c[0]=e,c[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ue.svgRound(e)} ${ue.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ue.svgRound(e[0])} ${ue.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class Kc extends bb{#e;constructor(e){super(),this.#e=e,super.updateProperties({fill:"none",stroke:Ne._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this.#e.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Kc(this.#e);return e.updateAll(this),e}}class Qc extends we{static _type="ink";static _editorType=ke.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0}static initialize(e,t){Ne.initialize(e,t),this._defaultDrawingOptions=new Kc(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return Pe(this,"typesMap",new Map([[Te.INK_THICKNESS,"stroke-width"],[Te.INK_COLOR,"stroke"],[Te.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,i,r,l){return new yb(e,t,i,r,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,i,r,l,c){return ll.deserialize(e,t,i,r,l,c)}static async deserialize(e,t,i){let r=null;if(e instanceof Yc){const{data:{inkLists:c,rect:d,rotation:f,id:p,color:m,opacity:x,borderStyle:{rawWidth:b},popupRef:w},parent:{page:{pageNumber:y}}}=e;r=e={annotationType:ke.INK,color:Array.from(m),thickness:b,opacity:x,paths:{points:c},boxes:null,pageIndex:y-1,rect:d.slice(0),rotation:f,id:p,deleted:!1,popupRef:w}}const l=await super.deserialize(e,t,i);return l.annotationElementId=e.id||null,l._initialData=r,l}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:i}=this;t.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:i}){this._drawingOptions=Qc.getDefaultDrawingOptions({stroke:ge.makeHexColor(...e),"stroke-width":t,"stroke-opacity":i})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:i,rect:r}=this.serializeDraw(e),{_drawingOptions:{stroke:l,"stroke-opacity":c,"stroke-width":d}}=this,f={annotationType:ke.INK,color:Ne._colorManager.convert(l),opacity:c,thickness:d,paths:{lines:t,points:i},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?f:this.annotationElementId&&!this.#e(f)?null:(f.id=this.annotationElementId,f)}#e(e){const{color:t,thickness:i,opacity:r,pageIndex:l}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((c,d)=>c!==t[d])||e.thickness!==i||e.opacity!==r||e.pageIndex!==l}renderAnnotationElement(e){const{points:t,rect:i}=this.serializeDraw(!1);return e.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:t}),null}}class Jc extends Ne{#e=null;#t=null;#s=null;#n=null;#r=null;#i="";#o=null;#l=null;#d=!1;#c=!1;static _type="stamp";static _editorType=ke.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#n=e.bitmapUrl,this.#r=e.bitmapFile}static initialize(e,t){Ne.initialize(e,t)}static get supportedTypes(){return Pe(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return Pe(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(ke.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#h(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#d=e.isSvg),e.file&&(this.#i=e.file.name),this.#a()}#u(){if(this.#s=null,this._uiManager.enableWaiting(!1),!!this.#o){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:l,height:c}=e||this.copyCanvas(null,null,!0).imageData,d=await i.guess({name:"altText",request:{data:r,width:l,height:c,channels:r.length/(l*c)}});if(!d)throw new Error("No response from the AI service.");if(d.error)throw new Error("Error from the AI service.");if(d.cancel)return null;if(!d.output)throw new Error("No valid response from the AI service.");const f=d.output;return await this.setGuessedAltText(f),t&&!this.hasAltTextData()&&(this.altTextData={alt:f,decorative:!1}),f}#f(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(i=>this.#h(i,!0)).finally(()=>this.#u());return}if(this.#n){const i=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromUrl(i).then(r=>this.#h(r)).finally(()=>this.#u());return}if(this.#r){const i=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromFile(i).then(r=>this.#h(r)).finally(()=>this.#u());return}const e=document.createElement("input");e.type="file",e.accept=Jc.supportedTypesStr;const t=this._uiManager._signal;this.#s=new Promise(i=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(r)}i()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),i()},{signal:t})}).finally(()=>this.#u()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#o?.remove(),this.#o=null,this.#l&&(clearTimeout(this.#l),this.#l=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#f();return}super.rebuild(),this.div!==null&&(this.#t&&this.#o===null&&this.#f(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#s||this.#e||this.#n||this.#r||this.#t)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#e?this.#a():this.#f(),this.width&&!this.annotationElementId){const[i,r]=this.parentDimensions;this.setAt(e*i,t*r,this.width*i,this.height*r)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#l!==null&&clearTimeout(this.#l);const e=200;this.#l=setTimeout(()=>{this.#l=null,this.#g()},e)}#a(){const{div:e}=this;let{width:t,height:i}=this.#e;const[r,l]=this.pageDimensions,c=.75;if(this.width)t=this.width*r,i=this.height*l;else if(t>c*r||i>c*l){const m=Math.min(c*r/t,c*l/i);t*=m,i*=m}const[d,f]=this.parentDimensions;this.setDims(t*d/r,i*f/l),this._uiManager.enableWaiting(!1);const p=this.#o=document.createElement("canvas");p.setAttribute("role","img"),this.addContainer(p),this.width=t/r,this.height=i/l,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#g(),this.#c||(this.parent.addUndoableEditor(this),this.#c=!0),this._reportTelemetry({action:"inserted_image"}),this.#i&&p.setAttribute("aria-label",this.#i)}copyCanvas(e,t,i=!1){e||(e=224);const{width:r,height:l}=this.#e,c=new jc;let d=this.#e,f=r,p=l,m=null;if(t){if(r>t||l>t){const T=Math.min(t/r,t/l);f=Math.floor(r*T),p=Math.floor(l*T)}m=document.createElement("canvas");const b=m.width=Math.ceil(f*c.sx),w=m.height=Math.ceil(p*c.sy);this.#d||(d=this.#p(b,w));const y=m.getContext("2d");y.filter=this._uiManager.hcmFilter;let N="white",_="#cfcfd8";this._uiManager.hcmFilter!=="none"?_="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(N="#8f8f9d",_="#42414d");const j=15,S=j*c.sx,P=j*c.sy,k=new OffscreenCanvas(S*2,P*2),L=k.getContext("2d");L.fillStyle=N,L.fillRect(0,0,S*2,P*2),L.fillStyle=_,L.fillRect(0,0,S,P),L.fillRect(S,P,S,P),y.fillStyle=y.createPattern(k,"repeat"),y.fillRect(0,0,b,w),y.drawImage(d,0,0,d.width,d.height,0,0,b,w)}let x=null;if(i){let b,w;if(c.symmetric&&d.width<e&&d.height<e)b=d.width,w=d.height;else if(d=this.#e,r>e||l>e){const _=Math.min(e/r,e/l);b=Math.floor(r*_),w=Math.floor(l*_),this.#d||(d=this.#p(b,w))}const N=new OffscreenCanvas(b,w).getContext("2d",{willReadFrequently:!0});N.drawImage(d,0,0,d.width,d.height,0,0,b,w),x={width:b,height:w,data:N.getImageData(0,0,b,w).data}}return{canvas:m,width:f,height:p,imageData:x}}#p(e,t){const{width:i,height:r}=this.#e;let l=i,c=r,d=this.#e;for(;l>2*e||c>2*t;){const f=l,p=c;l>2*e&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*t&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const m=new OffscreenCanvas(l,c);m.getContext("2d").drawImage(d,0,0,f,p,0,0,l,c),d=m.transferToImageBitmap()}return d}#g(){const[e,t]=this.parentDimensions,{width:i,height:r}=this,l=new jc,c=Math.ceil(i*e*l.sx),d=Math.ceil(r*t*l.sy),f=this.#o;if(!f||f.width===c&&f.height===d)return;f.width=c,f.height=d;const p=this.#d?this.#e:this.#p(c,d),m=f.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(p,0,0,p.width,p.height,0,0,c,d)}getImageForAltText(){return this.#o}#m(e){if(e){if(this.#d){const r=this._uiManager.imageManager.getSvgUrl(this.#t);if(r)return r}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#d){const[t,i]=this.pageDimensions,r=Math.round(this.width*t*li.PDF_TO_CSS_UNITS),l=Math.round(this.height*i*li.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(r,l);return c.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,r,l),c.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,i){let r=null;if(e instanceof Sp){const{data:{rect:y,rotation:N,id:_,structParent:j,popupRef:S},container:P,parent:{page:{pageNumber:k}}}=e,L=P.querySelector("canvas"),T=i.imageManager.getFromCanvas(P.id,L);L.remove();const I=(await t._structTree.getAriaAttributes(`${Fc}${_}`))?.get("aria-label")||"";r=e={annotationType:ke.STAMP,bitmapId:T.id,bitmap:T.bitmap,pageIndex:k-1,rect:y.slice(0),rotation:N,id:_,deleted:!1,accessibilityData:{decorative:!1,altText:I},isSvg:!1,structParent:j,popupRef:S}}const l=await super.deserialize(e,t,i),{rect:c,bitmap:d,bitmapUrl:f,bitmapId:p,isSvg:m,accessibilityData:x}=e;p&&i.imageManager.isValidId(p)?(l.#t=p,d&&(l.#e=d)):l.#n=f,l.#d=m;const[b,w]=l.pageDimensions;return l.width=(c[2]-c[0])/b,l.height=(c[3]-c[1])/w,l.annotationElementId=e.id||null,x&&(l.altTextData=x),l._initialData=r,l.#c=!!r,l}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:ke.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#d,structTreeParentId:this._structTreeParentId};if(e)return i.bitmapUrl=this.#m(!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:r,altText:l}=this.serializeAltText(!1);if(!r&&l&&(i.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const d=this.#x(i);if(d.isSame)return null;d.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,t===null)return i;t.stamps||=new Map;const c=this.#d?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:c,serialized:i}),i.bitmap=this.#m(!1);else if(this.#d){const d=t.stamps.get(this.#t);c>d.area&&(d.area=c,d.serialized.bitmap.close(),d.serialized.bitmap=this.#m(!1))}return i}#x(e){const{pageIndex:t,accessibilityData:{altText:i}}=this._initialData,r=e.pageIndex===t,l=(e.accessibilityData?.alt||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&l,isSameAltText:l}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}class Es{#e;#t=!1;#s=null;#n=null;#r=null;#i=new Map;#o=!1;#l=!1;#d=!1;#c=null;#h=null;#u=null;#f=null;#a;static _initialized=!1;static#p=new Map([rt,Qc,Jc,Qe].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:r,accessibilityManager:l,annotationLayer:c,drawLayer:d,textLayer:f,viewport:p,l10n:m}){const x=[...Es.#p.values()];if(!Es._initialized){Es._initialized=!0;for(const b of x)b.initialize(m,e)}e.registerEditorTypes(x),this.#a=e,this.pageIndex=t,this.div=i,this.#e=l,this.#s=c,this.viewport=p,this.#u=f,this.drawLayer=d,this._structTree=r,this.#a.addLayer(this)}get isEmpty(){return this.#i.size===0}get isInvisible(){return this.isEmpty&&this.#a.getMode()===ke.NONE}updateToolbar(e){this.#a.updateToolbar(e)}updateMode(e=this.#a.getMode()){switch(this.#v(),e){case ke.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ke.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ke.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const i of Es.#p.values())t.toggle(`${i._type}Editing`,e===i._editorType);this.div.hidden=!1}hasTextLayer(e){return e===this.#u?.div}setEditingState(e){this.#a.setEditingState(e)}addCommands(e){this.#a.addCommands(e)}cleanUndoStack(e){this.#a.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#s?.div.classList.toggle("disabled",!e)}async enable(){this.#d=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const i of this.#i.values())i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#a.removeChangedExistingAnnotation(i),e.add(i.annotationElementId));if(!this.#s){this.#d=!1;return}const t=this.#s.getEditableAnnotations();for(const i of t){if(i.hide(),this.#a.isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const r=await this.deserialize(i);r&&(this.addOrRebuild(r),r.enableEditing())}this.#d=!1}disable(){this.#l=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of this.#i.values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);this.getEditableAnnotation(r.annotationElementId)?.show(),r.remove()}if(this.#s){const r=this.#s.getEditableAnnotations();for(const l of r){const{id:c}=l.data;if(this.#a.isDeletedAnnotationElement(c))continue;let d=t.get(c);if(d){d.resetAnnotationElement(l),d.show(!1),l.show();continue}d=e.get(c),d&&(this.#a.addChangedExistingAnnotation(d),d.renderAnnotationElement(l)&&d.show(!1)),l.show()}}this.#v(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of Es.#p.values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#l=!1}getEditableAnnotation(e){return this.#s?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#a.getActive()!==e&&this.#a.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#f){this.#f=new AbortController;const e=this.#a.combinedSignal(this.#f);this.#u.div.addEventListener("pointerdown",this.#g.bind(this),{signal:e}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#u.div.classList.remove("highlighting"))}#g(e){this.#a.unselectAll();const{target:t}=e;if(t===this.#u.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#u.div.contains(t)){const{isMac:i}=kt.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#a.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),Qe.startHighlighting(this,this.#a.direction==="ltr",{target:this.#u.div,x:e.x,y:e.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#a._signal}),e.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const e=this.#a.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#n?.abort(),this.#n=null}attach(e){this.#i.set(e.id,e);const{annotationElementId:t}=e;t&&this.#a.isDeletedAnnotationElement(t)&&this.#a.removeDeletedAnnotationElement(e)}detach(e){this.#i.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#l&&e.annotationElementId&&this.#a.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#a.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#a.addDeletedAnnotationElement(e.annotationElementId),Ne.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#a.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#d),this.#a.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#r&&(e._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#a._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getNextId(){return this.#a.getId()}get#m(){return Es.#p.get(this.#a.getMode())}combinedSignal(e){return this.#a.combinedSignal(e)}#x(e){const t=this.#m;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#m?.canCreateNewEmptyEditor()}pasteEditor(e,t){this.#a.updateToolbar(e),this.#a.updateMode(e);const{offsetX:i,offsetY:r}=this.#y(),l=this.getNextId(),c=this.#x({parent:this,id:l,x:i,y:r,uiManager:this.#a,isCentered:!0,...t});c&&this.add(c)}async deserialize(e){return await Es.#p.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#a)||null}createAndAddNewEditor(e,t,i={}){const r=this.getNextId(),l=this.#x({parent:this,id:r,x:e.offsetX,y:e.offsetY,uiManager:this.#a,isCentered:t,...i});return l&&this.add(l),l}#y(){const{x:e,y:t,width:i,height:r}=this.div.getBoundingClientRect(),l=Math.max(0,e),c=Math.max(0,t),d=Math.min(window.innerWidth,e+i),f=Math.min(window.innerHeight,t+r),p=(l+d)/2-e,m=(c+f)/2-t,[x,b]=this.viewport.rotation%180===0?[p,m]:[m,p];return{offsetX:x,offsetY:b}}addNewEditor(){this.createAndAddNewEditor(this.#y(),!0)}setSelected(e){this.#a.setSelected(e)}toggleSelected(e){this.#a.toggleSelected(e)}unselect(e){this.#a.unselect(e)}pointerup(e){const{isMac:t}=kt.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&this.#o&&(this.#o=!1,!(this.#m?.isDrawer&&this.#m.supportMultipleDrawings))){if(!this.#t){this.#t=!0;return}if(this.#a.getMode()===ke.STAMP){this.#a.unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){if(this.#a.getMode()===ke.HIGHLIGHT&&this.enableTextSelection(),this.#o){this.#o=!1;return}const{isMac:t}=kt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#o=!0,this.#m?.isDrawer){this.startDrawingSession(e);return}const i=this.#a.getActive();this.#t=!i||i.isEmpty()}startDrawingSession(e){if(this.div.focus(),this.#c){this.#m.startDrawing(this,this.#a,!1,e);return}this.#a.setCurrentDrawingSession(this),this.#c=new AbortController;const t=this.#a.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#h=null,this.commitOrRemove())},{signal:t}),this.#m.startDrawing(this,this.#a,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#h=t);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(e=!1){return this.#c?(this.#a.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#h=null,this.#m.endDrawing(e)):null}findNewParent(e,t,i){const r=this.#a.findParent(t,i);return r===null||r===this?!1:(r.changeParent(e),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#m.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const e of this.#i.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#i.clear(),this.#a.removeLayer(this)}#v(){for(const e of this.#i.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,Sn(this.div,e);for(const t of this.#a.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#a.commitOrRemove(),this.#v();const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,Sn(this.div,{rotation:i}),t!==i)for(const r of this.#i.values())r.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#a.viewParameters.realScale}}class St{#e=null;#t=0;#s=new Map;#n=new Map;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#s.size>0)for(const t of this.#s.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return Pe(this,"_svgFactory",new Xc)}static#r(e,[t,i,r,l]){const{style:c}=e;c.top=`${100*i}%`,c.left=`${100*t}%`,c.width=`${100*r}%`,c.height=`${100*l}%`}#i(){const e=St._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#o(e,t){const i=St._svgFactory.createElement("clipPath");e.append(i);const r=`clip_${t}`;i.setAttribute("id",r),i.setAttribute("clipPathUnits","objectBoundingBox");const l=St._svgFactory.createElement("use");return i.append(l),l.setAttribute("href",`#${t}`),l.classList.add("clip"),r}#l(e,t){for(const[i,r]of Object.entries(t))r===null?e.removeAttribute(i):e.setAttribute(i,r)}draw(e,t=!1,i=!1){const r=this.#t++,l=this.#i(),c=St._svgFactory.createElement("defs");l.append(c);const d=St._svgFactory.createElement("path");c.append(d);const f=`path_p${this.pageIndex}_${r}`;d.setAttribute("id",f),d.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#n.set(r,d);const p=i?this.#o(c,f):null,m=St._svgFactory.createElement("use");return l.append(m),m.setAttribute("href",`#${f}`),this.updateProperties(l,e),this.#s.set(r,l),{id:r,clipPathId:`url(#${p})`}}drawOutline(e,t){const i=this.#t++,r=this.#i(),l=St._svgFactory.createElement("defs");r.append(l);const c=St._svgFactory.createElement("path");l.append(c);const d=`path_p${this.pageIndex}_${i}`;c.setAttribute("id",d),c.setAttribute("vector-effect","non-scaling-stroke");let f;if(t){const x=St._svgFactory.createElement("mask");l.append(x),f=`mask_p${this.pageIndex}_${i}`,x.setAttribute("id",f),x.setAttribute("maskUnits","objectBoundingBox");const b=St._svgFactory.createElement("rect");x.append(b),b.setAttribute("width","1"),b.setAttribute("height","1"),b.setAttribute("fill","white");const w=St._svgFactory.createElement("use");x.append(w),w.setAttribute("href",`#${d}`),w.setAttribute("stroke","none"),w.setAttribute("fill","black"),w.setAttribute("fill-rule","nonzero"),w.classList.add("mask")}const p=St._svgFactory.createElement("use");r.append(p),p.setAttribute("href",`#${d}`),f&&p.setAttribute("mask",`url(#${f})`);const m=p.cloneNode();return r.append(m),p.classList.add("mainOutline"),m.classList.add("secondaryOutline"),this.updateProperties(r,e),this.#s.set(i,r),i}finalizeDraw(e,t){this.#n.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:i,bbox:r,rootClass:l,path:c}=t,d=typeof e=="number"?this.#s.get(e):e;if(d){if(i&&this.#l(d,i),r&&St.#r(d,r),l){const{classList:f}=d;for(const[p,m]of Object.entries(l))f.toggle(p,m)}if(c){const p=d.firstChild.firstChild;this.#l(p,c)}}}updateParent(e,t){if(t===this)return;const i=this.#s.get(e);i&&(t.#e.append(i),this.#s.delete(e),t.#s.set(e,i))}remove(e){this.#n.delete(e),this.#e!==null&&(this.#s.get(e).remove(),this.#s.delete(e))}destroy(){this.#e=null;for(const e of this.#s.values())e.remove();this.#s.clear(),this.#n.clear()}}globalThis.pdfjsTestingUtils={HighlightOutliner:Pc};_e.AbortException;_e.AnnotationEditorLayer;_e.AnnotationEditorParamsType;_e.AnnotationEditorType;_e.AnnotationEditorUIManager;_e.AnnotationLayer;_e.AnnotationMode;_e.ColorPicker;_e.DOMSVGFactory;_e.DrawLayer;_e.FeatureTest;var wb=_e.GlobalWorkerOptions;_e.ImageKind;_e.InvalidPDFException;_e.MissingPDFException;_e.OPS;_e.OutputScale;_e.PDFDataRangeTransport;_e.PDFDateString;_e.PDFWorker;_e.PasswordResponses;_e.PermissionFlag;_e.PixelsPerInch;_e.RenderingCancelledException;_e.TextLayer;_e.TouchManager;_e.UnexpectedResponseException;_e.Util;_e.VerbosityLevel;_e.XfaLayer;_e.build;_e.createValidAbsoluteUrl;_e.fetchData;var Nb=_e.getDocument;_e.getFilenameFromUrl;_e.getPdfFilenameFromUrl;_e.getXfaPageViewport;_e.isDataScheme;_e.isPdfFile;_e.noContextMenu;_e.normalizeUnicode;_e.setLayerDimensions;_e.shadow;_e.stopEvent;_e.version;const Ab="/assets/pdf.worker.min-yatZIOMy.mjs";typeof window<"u"&&(wb.workerSrc=Ab);const _b="data:audio/mp3;base64,//uQxAAAAAANIAAAAAExBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7kMQAD8AAADSAAAAANIAAADSAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==";let lr=null;function Tf(){try{lr||(lr=new Audio(_b),lr.volume=.25),lr.currentTime=0,lr.play().catch(()=>{})}catch{}}function Sb({pdfUrl:u,currentPage:e,onRequestPrev:t,onRequestNext:i,onTotalPagesChange:r,onPageChange:l,zoom:c=100,title:d,className:f="",flipPhase:p,flipDirection:m,onFlipAnimationEnd:x,isFlipping:b}){const w=E.useRef(null),[y,N]=E.useState(null),[_,j]=E.useState(0),[S,P]=E.useState(!0),[k,L]=E.useState(null),[T,I]=E.useState(!1),$=E.useRef(!1),[te,oe]=E.useState(!1),[ae,ne]=E.useState(""),[se,xe]=E.useState([]),[Se,X]=E.useState(0),[Z,q]=E.useState(!1),re=E.useRef(null);E.useEffect(()=>{if(!u)return;let B=!0;return P(!0),L(null),Nb(u).promise.then(K=>{B&&(N(K),j(K.numPages),r(K.numPages),P(!1))}).catch(K=>{B&&(K.name==="AbortException"||K.name==="RenderingCancelledException"||(console.error("PdfJsFlipbook: Error loading PDF:",K),L(K.message||"Erreur inconnue lors du chargement"),P(!1)))}),()=>{B=!1}},[u,r]),E.useEffect(()=>{if(!y||!w.current||$.current||b&&p!=="in")return;const ee=setTimeout(async()=>{$.current=!0,I(!0),console.log(`[PdfJs] Rendering page ${e}`);try{const K=await y.getPage(e),fe=w.current,Ve=fe.getContext("2d"),dt=K.getViewport({scale:2*(c/100)});fe.width=dt.width,fe.height=dt.height,Ve.clearRect(0,0,fe.width,fe.height),Ve.fillStyle="#ffffff",Ve.fillRect(0,0,fe.width,fe.height),await K.render({canvasContext:Ve,viewport:dt}).promise,Q(Ve,fe.width,fe.height),console.log(`[PdfJs] Page ${e} rendered`)}catch(K){console.error("[PdfJs] Page render error:",K)}finally{I(!1),$.current=!1}},b?50:0);return()=>clearTimeout(ee)},[y,e,c,b,p]);const Q=(B,ee,K)=>{const fe="Tarikh.ma";B.save(),B.font="24px serif",B.fillStyle="rgba(100, 100, 100, 0.08)";const Ve=B.measureText(fe).width,wt=Math.max(400,Ve+200),dt=300;B.rotate(-25*Math.PI/180);for(let Nt=-K;Nt<K*2;Nt+=dt)for(let Ht=-ee;Ht<ee*2;Ht+=wt){const an=Nt/dt%2===0?0:wt/2;B.fillText(fe,Ht+an,Nt)}B.restore()};E.useEffect(()=>{const B=ee=>{(ee.ctrlKey||ee.metaKey)&&ee.key==="f"&&(ee.preventDefault(),oe(!0),setTimeout(()=>re.current?.focus(),100)),ee.key==="Escape"&&te&&(oe(!1),ne(""),xe([]))};return window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[te]);const V=E.useCallback(async()=>{if(!y||!ae.trim()){xe([]);return}q(!0);const B=[],ee=ae.toLowerCase();console.log(`[PdfJs Search] Searching for: "${ee}" in ${y.numPages} pages`);try{for(let K=1;K<=y.numPages;K++){const wt=(await(await y.getPage(K)).getTextContent()).items.map(Ht=>Ht.str).join(" ").toLowerCase();K<=3&&console.log(`[PdfJs Search] Page ${K} text (first 200 chars):`,wt.slice(0,200)||"(empty - no text layer)");let dt=0,Nt=0;for(;(dt=wt.indexOf(ee,dt))!==-1;)B.push({pageNum:K,matchIndex:Nt}),Nt++,dt+=ee.length}console.log(`[PdfJs Search] Found ${B.length} results`),xe(B),X(0),B.length>0&&l&&l(B[0].pageNum)}catch(K){console.error("[PdfJs] Search error:",K)}finally{q(!1)}},[y,ae,l]);E.useEffect(()=>{if(!ae.trim()||ae.length<2){xe([]);return}const B=setTimeout(()=>{V()},300);return()=>clearTimeout(B)},[ae,V]);const z=E.useCallback(()=>{if(se.length===0)return;const B=(Se+1)%se.length;X(B),l&&l(se[B].pageNum)},[se,Se,l]),ce=E.useCallback(()=>{if(se.length===0)return;const B=(Se-1+se.length)%se.length;X(B),l&&l(se[B].pageNum)},[se,Se,l]);if(k)return a.jsxs("div",{className:`flex flex-col items-center justify-center bg-slate-100 rounded p-6 text-center ${f}`,style:{minHeight:280},children:[a.jsx("span",{className:"material-symbols-outlined text-4xl text-red-400 mb-2",children:"error"}),a.jsx("span",{className:"text-slate-600 text-sm font-medium mb-1",children:"Impossible de charger le PDF."}),a.jsx("span",{className:"text-slate-400 text-xs",children:k})]});const ve=()=>{Tf(),t()},U=()=>{Tf(),i()};return a.jsxs("div",{className:`cahier-viewer cahier-viewer-brochure relative w-full flex-1 flex items-center justify-center min-h-0 overflow-hidden ${b?"is-flipping":""} ${f}`,children:[te&&a.jsxs("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-30 flex items-center gap-2 bg-white/95 backdrop-blur-sm rounded-lg shadow-lg border border-slate-200 px-3 py-2",children:[a.jsx("span",{className:"material-symbols-outlined text-slate-400 text-xl",children:"search"}),a.jsx("input",{ref:re,type:"text",value:ae,onChange:B=>ne(B.target.value),onKeyDown:B=>{B.key==="Enter"&&(B.shiftKey?ce():se.length>0?z():V())},placeholder:"Rechercher dans le document...",className:"w-48 sm:w-64 bg-transparent text-sm text-slate-700 placeholder:text-slate-400 focus:outline-none",autoFocus:!0}),Z?a.jsx("span",{className:"text-xs text-slate-400 animate-pulse",children:"..."}):se.length>0?a.jsxs("span",{className:"text-xs text-slate-500 whitespace-nowrap",children:[Se+1," / ",se.length]}):ae&&!Z?a.jsx("span",{className:"text-xs text-slate-400",children:"0 rsultat"}):null,a.jsx("button",{type:"button",onClick:ce,disabled:se.length===0,className:"p-1 hover:bg-slate-100 rounded disabled:opacity-40 disabled:cursor-not-allowed",title:"Rsultat prcdent (Shift+Entre)",children:a.jsx("span",{className:"material-symbols-outlined text-lg text-slate-500",children:"expand_less"})}),a.jsx("button",{type:"button",onClick:z,disabled:se.length===0,className:"p-1 hover:bg-slate-100 rounded disabled:opacity-40 disabled:cursor-not-allowed",title:"Rsultat suivant (Entre)",children:a.jsx("span",{className:"material-symbols-outlined text-lg text-slate-500",children:"expand_more"})}),a.jsx("button",{type:"button",onClick:()=>{oe(!1),ne(""),xe([])},className:"p-1 hover:bg-slate-100 rounded",title:"Fermer (chap)",children:a.jsx("span",{className:"material-symbols-outlined text-lg text-slate-500",children:"close"})})]}),!te&&a.jsx("button",{type:"button",onClick:()=>{oe(!0),setTimeout(()=>re.current?.focus(),100)},className:"absolute top-4 right-4 z-20 w-10 h-10 flex items-center justify-center rounded-full bg-white/90 shadow-md border border-slate-200/80 text-slate-600 hover:bg-white hover:text-slate-900 transition-all hover:scale-105",title:"Rechercher (Ctrl+F)",children:a.jsx("span",{className:"material-symbols-outlined text-xl",children:"search"})}),a.jsx("button",{type:"button",onClick:ve,disabled:e<=1||b||S,className:"absolute left-2 sm:left-4 top-1/2 -translate-y-1/2 z-20 w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center rounded-full bg-white/90 shadow-md border border-slate-200/80 text-slate-600 hover:bg-white hover:text-slate-900 disabled:opacity-40 disabled:pointer-events-none transition-all hover:scale-105","aria-label":"Page prcdente",children:a.jsx("span",{className:"material-symbols-outlined text-2xl sm:text-3xl font-light",children:"chevron_left"})}),a.jsx("button",{type:"button",onClick:U,disabled:e>=_||b||S,className:"absolute right-2 sm:right-4 top-1/2 -translate-y-1/2 z-20 w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center rounded-full bg-white/90 shadow-md border border-slate-200/80 text-slate-600 hover:bg-white hover:text-slate-900 disabled:opacity-40 disabled:pointer-events-none transition-all hover:scale-105","aria-label":"Page suivante",children:a.jsx("span",{className:"material-symbols-outlined text-2xl sm:text-3xl font-light",children:"chevron_right"})}),a.jsx("div",{role:"button",tabIndex:0,onClick:ve,onKeyDown:B=>B.key==="Enter"&&ve(),className:"cahier-zone-prev","aria-label":"Page prcdente (zone)","aria-disabled":b}),a.jsx("div",{role:"button",tabIndex:0,onClick:U,onKeyDown:B=>B.key==="Enter"&&U(),className:"cahier-zone-next","aria-label":"Page suivante (zone)","aria-disabled":b}),a.jsx("div",{className:`cahier-page relative w-full h-full flex items-center justify-center min-h-[50vh] sm:min-h-[60vh] max-h-[75vh] sm:max-h-[80vh] ${p&&m?`turn-${m}-${p}`:""}`,onAnimationEnd:x,children:a.jsxs("div",{className:"cahier-page-inner absolute inset-0 flex items-center justify-center rounded overflow-hidden bg-white shadow-[0_2px_16px_rgba(0,0,0,0.08),inset_0_0_0_1px_rgba(0,0,0,0.06)]",children:[S&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-50 z-10",children:a.jsx("span",{className:"text-slate-500 text-sm animate-pulse",children:"Chargement"})}),T&&!S&&a.jsx("div",{className:"absolute inset-x-0 bottom-4 flex items-center justify-center z-0 pointer-events-none",children:a.jsx("span",{className:"text-slate-400 text-[10px] uppercase tracking-widest bg-white/80 px-2 py-1 rounded",children:"Rendu..."})}),a.jsx("canvas",{ref:w,className:"max-w-full max-h-full object-contain select-none pointer-events-none",style:{userSelect:"none",WebkitUserSelect:"none"},onContextMenu:B=>B.preventDefault(),"aria-label":d}),a.jsx("div",{className:"paper-texture-overlay absolute inset-0 pointer-events-none mix-blend-multiply opacity-[0.03]"})]})})]})}function jb(u){return u==null?"":typeof u=="string"?u:String(u)}function kb(){const{id:u}=vr(),[e,t]=E.useState(null),[i,r]=E.useState([]),[l,c]=E.useState(!0),[d,f]=E.useState(100),[p,m]=E.useState(1),[x,b]=E.useState(null),[w,y]=E.useState(null),[N,_]=E.useState(null),j=E.useRef(null),S=e?.type==="pdf",P=x!==null,k=S&&e?.pages_status==="completed"&&(e?.pages_count??0)>0,L=S&&!k,T=k?e?.pages_count??1:0,[I,$]=E.useState(0);E.useEffect(()=>(e&&(window.document.title=`${e.title}  Tarikh.ma`),()=>{window.document.title="Tarikh.ma"}),[e?.title]),E.useEffect(()=>{u&&(m(1),_(null),b(null),y(null),Ha.get(u).then(U=>{t(U.document),r(U.similar??[])}).catch(()=>t(null)).finally(()=>c(!1)))},[u]),E.useEffect(()=>{if(!e||e.type!=="pdf"){_(null);return}const U=cc(String(e.id));_(null);let B=null,ee=!1;return fetch(U).then(K=>{if(!K.ok)throw new Error(K.statusText);return K.blob()}).then(K=>{if(ee)return;const fe=URL.createObjectURL(K);B=fe,_(fe)}).catch(()=>{}),()=>{ee=!0,B&&URL.revokeObjectURL(B),_(null)}},[e?.id,e?.type]);const te=500,oe=E.useRef(null),ae=U=>{if(U.target===U.currentTarget)if(console.log(`[Flip] Animation end Phase:${x} Page:${p}`),x==="out"){const B=w==="next"?p+1:p-1;console.log(`[Flip] Moving to page ${B}, phase -> IN`),m(B),b("in")}else x==="in"&&(console.log("[Flip] Phase IN finished -> NULL"),b(null),y(null))};E.useEffect(()=>{if(x===null){oe.current&&(clearTimeout(oe.current),oe.current=null);return}const U=x,B=w,ee=p;return oe.current=setTimeout(()=>{if(oe.current)if(console.warn(`[Flip] Fallback triggered for phase ${U}`),oe.current=null,U==="out"){const K=B==="next"?ee+1:ee-1;m(K),b("in")}else b(null),y(null)},te+200),()=>{oe.current&&(clearTimeout(oe.current),oe.current=null)}},[x,w,p]);const ne=()=>{const U=p>1&&!P;console.log(`[Nav] Prev clicked. Page:${p} isFlipping:${P} CanGo:${U}`),U&&(y("prev"),b("out"))},se=()=>{const U=k?T:I,B=p<U&&!P;console.log(`[Nav] Next clicked. Page:${p}/${U} isFlipping:${P} CanGo:${B}`),B&&(y("next"),b("out"))};E.useEffect(()=>{if(!S)return;const U=B=>{B.key==="ArrowLeft"?(B.preventDefault(),ne()):B.key==="ArrowRight"&&(B.preventDefault(),se())};return window.addEventListener("keydown",U),()=>window.removeEventListener("keydown",U)},[S,p,I,T,P]),E.useEffect(()=>{if(!e)return;const U=j.current;if(!U)return;const B=K=>{try{const fe=window.document.getSelection();(U.contains(window.document.activeElement)||fe?.anchorNode&&U.contains(fe.anchorNode))&&(K.preventDefault(),K.stopPropagation())}catch{K.preventDefault()}},ee=K=>{if(!U.contains(window.document.activeElement))return;(K.ctrlKey||K.metaKey)&&(K.key==="c"||K.key==="x"||K.key==="v"||K.key==="a")&&(K.preventDefault(),K.stopPropagation())};return window.document.addEventListener("copy",B,!0),window.document.addEventListener("cut",B,!0),window.document.addEventListener("paste",B,!0),window.document.addEventListener("keydown",ee,!0),()=>{window.document.removeEventListener("copy",B,!0),window.document.removeEventListener("cut",B,!0),window.document.removeEventListener("paste",B,!0),window.document.removeEventListener("keydown",ee,!0)}},[e]);const xe=e?.region?.name??"";if(l)return a.jsxs("div",{className:"flex flex-col flex-1 min-h-0 w-full",children:[a.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3 border-b border-slate-200 bg-white/95 backdrop-blur-md px-4 sm:px-6 py-3 z-50 shrink-0",children:[a.jsxs(ie,{to:"/",className:"flex items-center gap-2 sm:gap-3",children:[a.jsx("span",{className:"text-accent-gold material-symbols-outlined text-xl sm:text-2xl",children:"auto_stories"}),a.jsx("h2",{className:"text-lg sm:text-xl font-bold tracking-tight text-slate-900",children:"Tarikh.ma"})]}),a.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[a.jsxs("div",{className:"relative hidden sm:block",children:[a.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-lg",children:"search"}),a.jsx("input",{className:"bg-slate-100 border-none rounded-lg pl-9 pr-3 py-2 text-sm w-44 lg:w-64",placeholder:"Rechercher...",type:"text",readOnly:!0})]}),a.jsx(ie,{to:"/login",className:"bg-accent-gold text-white text-sm font-bold px-4 py-2 sm:px-5 rounded-lg hover:brightness-110 transition-all shadow-lg shadow-accent-gold/20 whitespace-nowrap",children:"Mon Compte"})]})]}),a.jsxs("main",{className:"flex flex-1 flex-col lg:flex-row overflow-hidden min-h-0",children:[a.jsx("div",{className:"flex-1 flex items-center justify-center bg-slate-100 min-h-[40vh]",children:a.jsx("span",{className:"text-slate-500",children:"Chargement"})}),a.jsx("aside",{className:"w-full lg:w-96 bg-white border-t lg:border-t-0 lg:border-l border-slate-200 hidden lg:block animate-pulse shrink-0"})]})]});if(!e)return a.jsxs("div",{className:"flex flex-col flex-1 min-h-0 w-full",children:[a.jsxs("header",{className:"flex items-center justify-between border-b border-slate-200 bg-white px-6 py-3 z-50 shrink-0",children:[a.jsxs(ie,{to:"/",className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-primary material-symbols-outlined text-2xl",children:"auto_stories"}),a.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Tarikh.ma"})]}),a.jsx(ie,{to:"/archives",className:"text-primary font-semibold",children:"Retour aux archives"})]}),a.jsx("main",{className:"flex flex-1 items-center justify-center p-12 min-h-0",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-slate-600",children:"Document introuvable."}),a.jsx(ie,{to:"/archives",className:"text-accent-gold font-semibold mt-4 inline-block hover:underline",children:"Retour aux archives"})]})})]});const Se=cc(String(e.id)),X=e.type==="image",Z=e.type==="video",q=e.type==="audio",re=S||X||Z||q,Q=U=>U.preventDefault(),V=U=>{U.preventDefault(),U.stopPropagation()},z=U=>{U.preventDefault(),U.stopPropagation()},ce=U=>{U.preventDefault(),U.stopPropagation()},ve=U=>{(U.ctrlKey||U.metaKey)&&(U.key==="c"||U.key==="x"||U.key==="v"||U.key==="a")&&(U.preventDefault(),U.stopPropagation())};return a.jsxs("div",{className:"flex flex-col flex-1 min-h-0 w-full",children:[a.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3 border-b border-slate-200 bg-white/95 backdrop-blur-md px-4 sm:px-6 py-3 z-50 shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-3 sm:gap-6 min-w-0 flex-1",children:[a.jsxs(ie,{to:"/",className:"flex items-center gap-2 sm:gap-3 shrink-0",children:[a.jsx("span",{className:"text-accent-gold",children:a.jsx("span",{className:"material-symbols-outlined text-xl sm:text-2xl",children:"auto_stories"})}),a.jsx("h2",{className:"text-lg sm:text-xl font-bold tracking-tight text-slate-900 truncate",children:"Tarikh.ma"})]}),a.jsxs("nav",{className:"hidden md:flex items-center gap-1 text-sm font-medium text-slate-500 min-w-0",children:[a.jsx(ie,{to:"/archives",className:"hover:text-accent-gold px-2 transition-colors shrink-0",children:"Archives"}),xe&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"material-symbols-outlined text-xs shrink-0",children:"chevron_right"}),a.jsx(ie,{to:"/archives",className:"hover:text-accent-gold px-2 transition-colors truncate max-w-[120px]",children:xe})]}),a.jsx("span",{className:"material-symbols-outlined text-xs shrink-0",children:"chevron_right"}),a.jsx("span",{className:"text-slate-900 truncate max-w-[140px] lg:max-w-[200px]",title:e.title,children:e.title})]})]}),a.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 shrink-0",children:[a.jsxs("div",{className:"relative hidden sm:block",children:[a.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-lg",children:"search"}),a.jsx("input",{className:"bg-slate-100 border-none rounded-lg pl-9 pr-3 py-2 text-sm w-44 lg:w-64 focus:ring-2 focus:ring-accent-gold/40 transition-all",placeholder:"Rechercher...",type:"text",readOnly:!0})]}),a.jsx(ie,{to:"/login",className:"bg-accent-gold text-white text-sm font-bold px-4 py-2 sm:px-5 rounded-lg hover:brightness-110 transition-all shadow-lg shadow-accent-gold/20 whitespace-nowrap",children:"Mon Compte"})]})]}),a.jsxs("main",{className:"flex flex-1 flex-col lg:flex-row overflow-auto lg:overflow-hidden relative min-h-0",children:[a.jsxs("div",{className:"flex-1 flex flex-col bg-[#fcfaf7] relative group min-w-0 min-h-[40vh] sm:min-h-[50vh] border-b border-slate-200 lg:border-b-0 lg:border-r border-slate-200",children:[a.jsxs("div",{className:"absolute top-3 left-4 z-20 flex items-center gap-2 px-3 py-1.5 rounded-md bg-white/95 shadow-sm border border-accent-gold/20",children:[a.jsx("span",{className:"material-symbols-outlined text-accent-gold text-lg",children:"visibility"}),a.jsx("span",{className:"text-slate-700 text-xs font-semibold uppercase tracking-wider",children:"Lecture en ligne uniquement"}),a.jsx("span",{className:"text-slate-400 text-[10px] hidden sm:inline",children:" Copier/coller dsactiv"})]}),a.jsxs("div",{className:"absolute top-3 left-1/2 -translate-x-1/2 flex items-center gap-0.5 bg-white/90 shadow-sm border border-slate-200/80 p-1 rounded-lg z-20 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity duration-300",children:[a.jsx("button",{type:"button",onClick:()=>f(U=>Math.min(200,U+10)),className:"p-2 hover:bg-slate-100 rounded text-slate-600 transition-colors","aria-label":"Zoom avant",children:a.jsx("span",{className:"material-symbols-outlined text-lg",children:"zoom_in"})}),a.jsx("button",{type:"button",onClick:()=>f(U=>Math.max(50,U-10)),className:"p-2 hover:bg-slate-100 rounded text-slate-600 transition-colors","aria-label":"Zoom arrire",children:a.jsx("span",{className:"material-symbols-outlined text-lg",children:"zoom_out"})}),a.jsx("div",{className:"w-px h-5 bg-slate-200 mx-0.5"}),a.jsx("button",{type:"button",onClick:()=>j.current?.requestFullscreen?.(),className:"p-2 hover:bg-slate-100 rounded text-slate-600 transition-colors","aria-label":"Plein cran",children:a.jsx("span",{className:"material-symbols-outlined text-lg",children:"fullscreen"})})]}),a.jsxs("div",{className:"flex-1 flex items-center justify-center p-4 sm:p-6 lg:p-8 overflow-auto custom-scrollbar relative min-h-0 select-none no-download no-copy bg-[#fcfaf7]",ref:j,onContextMenu:Q,onCopy:V,onCut:z,onPaste:ce,onKeyDown:ve,children:[a.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-30 bg-gradient-to-b from-transparent via-transparent to-slate-100/50 z-10","aria-hidden":!0}),a.jsxs("div",{className:"relative z-0 flex flex-col items-center justify-center w-full h-full",style:{userSelect:"none",pointerEvents:re?"auto":"none"},children:[k&&a.jsxs(a.Fragment,{children:[a.jsx(w0,{documentId:String(e.id),totalPages:T,currentPage:p,onRequestPrev:ne,onRequestNext:se,zoom:d,title:e.title,flipPhase:x,flipDirection:w,onFlipAnimationEnd:ae,isFlipping:P}),a.jsx("div",{className:"flex items-center justify-center py-3 px-4 border-t border-slate-200/80 bg-white/50 shrink-0",children:a.jsxs("span",{className:"text-slate-500 text-xs font-medium uppercase tracking-[0.2em]",children:[e.title.length>28?`${e.title.slice(0,26)}`:e.title,a.jsx("span",{className:"mx-2 text-slate-300",children:"|"}),a.jsx("span",{className:"text-slate-700 font-semibold tracking-normal",children:p}),T>0&&a.jsxs("span",{className:"text-slate-400 font-normal",children:[" / ",T]})]})})]}),L&&a.jsxs(a.Fragment,{children:[N?a.jsx(Sb,{pdfUrl:N,currentPage:p,onRequestPrev:ne,onRequestNext:se,onTotalPagesChange:$,onPageChange:m,zoom:d,title:e.title,flipPhase:x,flipDirection:w,onFlipAnimationEnd:ae,isFlipping:P}):a.jsx("div",{className:"flex-1 flex items-center justify-center bg-white shadow-sm rounded min-h-[50vh] w-full max-w-2xl",children:a.jsxs("div",{className:"flex flex-col items-center gap-3",children:[a.jsx("div",{className:"w-8 h-8 border-4 border-accent-gold/20 border-t-accent-gold rounded-full animate-spin"}),a.jsx("span",{className:"text-slate-500 text-sm animate-pulse",children:"Prparation du document scuris..."})]})}),a.jsx("div",{className:"flex items-center justify-center py-3 px-4 border-t border-slate-200/80 bg-white/50 shrink-0",children:a.jsxs("span",{className:"text-slate-500 text-xs font-medium uppercase tracking-[0.2em]",children:[e.title.length>28?`${e.title.slice(0,26)}`:e.title,a.jsx("span",{className:"mx-2 text-slate-300",children:"|"}),a.jsx("span",{className:"text-slate-700 font-semibold tracking-normal",children:p}),I>0&&a.jsxs("span",{className:"text-slate-400 font-normal",children:[" / ",I]})]})})]}),X&&a.jsxs("div",{className:"relative shadow-[0_0_100px_rgba(17,82,212,0.15)] rounded-sm border border-white/5 transition-transform duration-500",onContextMenu:Q,children:[a.jsx("img",{src:Se,alt:e.title,className:"max-h-[70vh] sm:max-h-[80vh] w-auto select-none pointer-events-none rounded-sm",style:{transform:`scale(${d/100})`},draggable:!1,loading:"lazy",onContextMenu:Q}),a.jsx("div",{className:"absolute -top-4 -left-4 w-8 h-8 border-t-2 border-l-2 border-accent-gold/40 rounded-tl"}),a.jsx("div",{className:"absolute -top-4 -right-4 w-8 h-8 border-t-2 border-r-2 border-accent-gold/40 rounded-tr"}),a.jsx("div",{className:"absolute -bottom-4 -left-4 w-8 h-8 border-b-2 border-l-2 border-accent-gold/40 rounded-bl"}),a.jsx("div",{className:"absolute -bottom-4 -right-4 w-8 h-8 border-b-2 border-r-2 border-accent-gold/40 rounded-br"})]}),Z&&a.jsx("video",{src:Se,controls:!0,className:"max-w-full max-h-[70vh] sm:max-h-[80vh] rounded",controlsList:"nodownload noremoteplayback",disablePictureInPicture:!0}),q&&a.jsx("div",{className:"w-full max-w-md px-4",children:a.jsx("audio",{src:Se,controls:!0,className:"w-full",controlsList:"nodownload noremoteplayback"})}),!re&&a.jsxs("div",{className:"text-center text-slate-500 px-4",children:[a.jsx("span",{className:"material-symbols-outlined text-5xl sm:text-6xl block mb-4 text-slate-400",children:"description"}),a.jsx("p",{className:"text-sm sm:text-base",children:"Aperu non disponible pour ce type. Consultation en lecture seule uniquement."})]})]})]}),i.length>0&&a.jsxs("div",{className:"bg-slate-100 border-t border-slate-200 p-3 sm:p-4 h-40 sm:h-48 overflow-hidden shrink-0",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3 px-1 sm:px-2",children:[a.jsx("h3",{className:"text-slate-600 text-[10px] sm:text-xs font-bold uppercase tracking-widest",children:"Documents similaires"}),a.jsxs("div",{className:"flex gap-1 sm:gap-2",children:[a.jsx("button",{type:"button",className:"text-slate-500 hover:text-primary transition-colors p-1","aria-label":"Prcdent",children:a.jsx("span",{className:"material-symbols-outlined text-base sm:text-lg",children:"arrow_back_ios"})}),a.jsx("button",{type:"button",className:"text-slate-500 hover:text-primary transition-colors p-1","aria-label":"Suivant",children:a.jsx("span",{className:"material-symbols-outlined text-base sm:text-lg",children:"arrow_forward_ios"})})]})]}),a.jsx("div",{className:"flex gap-3 sm:gap-4 overflow-x-auto custom-scrollbar pb-2 scrollbar-hide touch-scroll",children:i.map(U=>a.jsxs(ie,{to:`/documents/${U.id}`,className:"flex-shrink-0 w-24 sm:w-32 group/card cursor-pointer",children:[a.jsx("div",{className:"aspect-[3/4] rounded-md overflow-hidden bg-slate-200 border border-slate-200 group-hover/card:border-accent-gold/50 transition-all",children:U.type==="image"?a.jsx("img",{src:cc(String(U.id)),alt:"",className:"w-full h-full object-cover grayscale opacity-80 group-hover/card:grayscale-0 group-hover/card:opacity-100 transition-all duration-500"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:a.jsx("span",{className:"material-symbols-outlined text-slate-400 text-4xl",children:"description"})})}),a.jsx("p",{className:"text-[9px] sm:text-[10px] text-slate-600 mt-1 sm:mt-2 truncate group-hover/card:text-accent-gold transition-colors",children:U.title})]},U.id))})]})]}),a.jsx("aside",{className:"w-full lg:w-96 bg-white border-t lg:border-t-0 lg:border-l border-slate-200 flex flex-col z-30 custom-scrollbar overflow-y-auto shrink-0 lg:min-h-0",children:a.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a.jsxs("div",{className:"flex items-center gap-2 text-accent-gold mb-2",children:[a.jsx("span",{className:"material-symbols-outlined text-sm",children:"verified"}),a.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:"Document Certifi"})]}),a.jsx("h1",{className:"font-serif text-xl sm:text-2xl lg:text-3xl font-bold mb-3 sm:mb-4 leading-tight text-slate-900",children:e.title}),a.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 mb-6 sm:mb-8",children:[a.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-accent-gold/10 text-accent-gold text-xs font-semibold",children:[a.jsx("span",{className:"material-symbols-outlined text-sm",children:"visibility"}),a.jsxs("span",{children:[e.views_count||"1,284"," vues"]})]}),a.jsx("button",{type:"button",onClick:()=>navigator.clipboard.writeText(window.location.href),className:"text-slate-400 hover:text-accent-gold transition-colors","aria-label":"Partager",children:a.jsx("span",{className:"material-symbols-outlined",children:"share"})}),a.jsx("button",{type:"button",className:"text-slate-400 hover:text-red-500 transition-colors","aria-label":"Favoris",children:a.jsx("span",{className:"material-symbols-outlined",children:"favorite"})})]}),a.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-2 sm:mb-3",children:"Description"}),a.jsx("p",{className:"text-xs sm:text-sm text-slate-600 leading-relaxed italic line-clamp-4 sm:line-clamp-none",children:e.description??"Aucune description disponible."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[a.jsxs("div",{className:"p-3 sm:p-4 rounded-xl bg-slate-50 border border-slate-100",children:[a.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase mb-1",children:"Thme"}),a.jsx("p",{className:"text-sm font-medium text-slate-900",children:e.theme?.name??""})]}),a.jsxs("div",{className:"p-3 sm:p-4 rounded-xl bg-slate-50 border border-slate-100",children:[a.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase mb-1",children:"Rgion"}),a.jsx("p",{className:"text-sm font-medium text-slate-900",children:e.region?.name??""})]}),a.jsxs("div",{className:"p-3 sm:p-4 rounded-xl bg-slate-50 border border-slate-100",children:[a.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase mb-1",children:"Date"}),a.jsx("p",{className:"text-sm font-medium text-slate-900",children:jb(e.year)})]}),a.jsxs("div",{className:"p-3 sm:p-4 rounded-xl bg-slate-50 border border-slate-100",children:[a.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase mb-1",children:"Auteur"}),a.jsx("p",{className:"text-sm font-medium text-slate-900",children:e.author??""})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-4",children:"Actions de recherche"}),a.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 rounded-lg border border-slate-200 hover:bg-slate-50 transition-colors group",children:[a.jsx("span",{className:"text-sm font-medium text-slate-800",children:"Provenance & Histoire"}),a.jsx("span",{className:"material-symbols-outlined text-slate-400 group-hover:text-accent-gold transition-colors",children:"history"})]}),a.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 rounded-lg border border-slate-200 hover:bg-slate-50 transition-colors group",children:[a.jsx("span",{className:"text-sm font-medium text-slate-800",children:"Citer le document"}),a.jsx("span",{className:"material-symbols-outlined text-slate-400 group-hover:text-accent-gold transition-colors",children:"format_quote"})]}),a.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 rounded-lg border border-slate-200 hover:bg-slate-50 transition-colors group",children:[a.jsx("span",{className:"text-sm font-medium text-slate-800",children:"Signaler une erreur"}),a.jsx("span",{className:"material-symbols-outlined text-slate-400 group-hover:text-accent-gold transition-colors",children:"flag"})]})]})]}),a.jsxs("div",{className:"mt-8 sm:mt-12 p-4 sm:p-6 rounded-2xl bg-accent-gold/5 border border-accent-gold/10",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("span",{className:"material-symbols-outlined text-accent-gold",children:"lock"}),a.jsx("h5",{className:"text-sm font-bold text-slate-900",children:"Lecture Scurise"})]}),a.jsx("p",{className:"text-xs text-slate-500 leading-relaxed",children:"Ce document est protg par le droit d'auteur patrimonial. Le tlchargement est dsactiv pour garantir la prservation numrique."})]})]})})]})]})}const Eb="https://lh3.googleusercontent.com/aida-public/AB6AXuBn_NnEt4bFo_o0yfA9_SPDod599m_ZmfIICE430YfnJ7WmtU_XSKuJeUnmt7swSSF2z3Cshb4pXbT4Rbzr7IAHG0iUv3gXR44z3b661tiigmn68RyFLb_N4agFqwnJldQsRsK4dc2n9NsBuehsC4y-0ifwM761okYN0-Wd8L3Um_zKEk58uOysiQsQwwQdwnuOdF100esyYjhNnwsYn7Vy64ib7-5Ifhd7TD2-tMG7yjxOMNmC4fkf1artiNIhF0q4Qk7PZ61Z4n2X",Cb={pdf:"#13ec5b",image:"#3b82f6",photo:"#3b82f6",carte:"#64748b",video:"#f59e0b",audio:"#a855f7"};function Rf(u){return Cb[(u||"").toLowerCase()]??"#94a3b8"}function Pb(u){const e=(u||"").toLowerCase();return e==="pdf"?"picture_as_pdf":e==="image"||e==="photo"?"image":e==="video"?"video_file":e==="audio"?"audio_file":"description"}function Tb(u){const e=(u||"").toLowerCase();return e==="pdf"?"text-admin-primary":e==="image"||e==="photo"?"text-blue-500":e==="video"?"text-amber-500":e==="audio"?"text-purple-500":"text-slate-500"}function Rb(u){const e=(u||"").toLowerCase();return e==="pdf"?"border-admin-primary":e==="image"||e==="photo"?"border-blue-500":e==="video"?"border-amber-500":e==="audio"?"border-purple-500":"border-slate-400"}function Lb(){const[u,e]=E.useState(null),[t,i]=E.useState(!0),[r,l]=E.useState("30j");if(E.useEffect(()=>{i(!0),ct.stats({period:r}).then(e).catch(()=>e(null)).finally(()=>i(!1))},[r]),t||!u)return a.jsx("div",{className:"p-8 flex items-center justify-center min-h-[60vh]",children:a.jsx("div",{className:"text-slate-500",children:"Chargement des statistiques"})});const{stats:c,traffic_by_month:d,type_distribution:f,most_viewed:p}=u,m=c.views_total??0,x=c.documents_count??0,b=c.users_count??0,w=c.new_documents_in_period??x,y=c.new_documents_change_percent,N=d?.data??[],_=Math.max(1,...N),j=N.length,S=j>0&&`M ${N.map((I,$)=>{const te=j>1?$/(j-1)*100:50,oe=35-I/_*35;return`${te},${oe}`}).join(" L ")}`,P=S?`${S} V 40 H 0 Z`:"";return a.jsxs(a.Fragment,{children:[a.jsxs("header",{className:"sticky top-0 z-10 bg-white/80 backdrop-blur-md border-b border-slate-200 px-8 py-4 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold tracking-tight",children:"Analytiques des Consultations V1"}),a.jsx("p",{className:"text-sm text-slate-500",children:"Vue d'ensemble statistique du trafic documentaire."})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:[a.jsx("button",{type:"button",onClick:()=>l("30j"),className:`px-3 py-1.5 text-xs font-bold rounded shadow-sm transition-colors ${r==="30j"?"bg-white text-slate-900":"text-slate-500 hover:text-slate-700"}`,children:"30 derniers jours"}),a.jsx("button",{type:"button",onClick:()=>l("trimestre"),className:`px-3 py-1.5 text-xs font-medium rounded transition-colors ${r==="trimestre"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Trimestre"}),a.jsx("button",{type:"button",onClick:()=>l("annee"),className:`px-3 py-1.5 text-xs font-medium rounded transition-colors ${r==="annee"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Anne"})]}),a.jsxs("button",{type:"button",className:"flex items-center gap-2 bg-admin-primary text-white px-4 py-2 rounded-lg text-sm font-bold shadow-sm shadow-admin-primary/20 hover:opacity-90 transition-opacity",children:[a.jsx("span",{className:"material-symbols-outlined text-sm",children:"download"}),"Exporter Rapport"]})]})]}),a.jsxs("div",{className:"p-8 max-w-7xl mx-auto space-y-8",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[a.jsx("div",{className:"flex justify-between items-start mb-4",children:a.jsx("div",{className:"p-2 bg-admin-primary/10 rounded-lg text-admin-primary",children:a.jsx("span",{className:"material-symbols-outlined",children:"visibility"})})}),a.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Total Consultations"}),a.jsx("p",{className:"text-2xl font-bold mt-1",children:m.toLocaleString("fr-FR")})]}),a.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[a.jsx("div",{className:"flex justify-between items-start mb-4",children:a.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg text-blue-500",children:a.jsx("span",{className:"material-symbols-outlined",children:"groups"})})}),a.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Utilisateurs"}),a.jsx("p",{className:"text-2xl font-bold mt-1",children:b.toLocaleString("fr-FR")})]}),a.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[a.jsx("div",{className:"flex justify-between items-start mb-4",children:a.jsx("div",{className:"p-2 bg-amber-500/10 rounded-lg text-amber-500",children:a.jsx("span",{className:"material-symbols-outlined",children:"description"})})}),a.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Total Documents"}),a.jsx("p",{className:"text-2xl font-bold mt-1",children:x.toLocaleString("fr-FR")})]}),a.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsx("div",{className:"p-2 bg-purple-500/10 rounded-lg text-purple-500",children:a.jsx("span",{className:"material-symbols-outlined",children:"file_present"})}),y!=null&&a.jsxs("span",{className:`text-xs font-bold px-2 py-1 rounded ${y>=0?"text-green-500 bg-green-50":"text-red-500 bg-red-50"}`,children:[y>=0?"+":"",y,"%"]})]}),a.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Nouveaux (priode)"}),a.jsx("p",{className:"text-2xl font-bold mt-1",children:w.toLocaleString("fr-FR")})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2 bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[a.jsxs("div",{className:"flex items-center justify-between mb-8",children:[a.jsx("h3",{className:"text-lg font-bold",children:"Nouveaux documents par mois"}),a.jsxs("span",{className:"flex items-center gap-1 text-xs text-slate-500",children:[a.jsx("span",{className:"w-2 h-2 rounded-full bg-admin-primary"})," 12 derniers mois"]})]}),a.jsxs("div",{className:"relative h-64 w-full",children:[a.jsxs("svg",{className:"w-full h-full",preserveAspectRatio:"none",viewBox:"0 0 100 40",children:[P&&a.jsx("path",{d:P,fill:"url(#adminGrad1)",opacity:"0.2"}),S&&a.jsx("path",{d:S,fill:"none",stroke:"#13ec5b",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1"}),a.jsx("defs",{children:a.jsxs("linearGradient",{id:"adminGrad1",x1:"0%",x2:"0%",y1:"0%",y2:"100%",children:[a.jsx("stop",{offset:"0%",stopColor:"#13ec5b",stopOpacity:1}),a.jsx("stop",{offset:"100%",stopColor:"#13ec5b",stopOpacity:0})]})})]}),a.jsx("div",{className:"flex justify-between mt-4 px-2",children:(d?.labels??[]).map(k=>a.jsx("span",{className:"text-[10px] text-slate-400 font-bold uppercase truncate max-w-[12%]",children:k},k))})]})]}),a.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm flex flex-col",children:[a.jsx("h3",{className:"text-lg font-bold mb-6",children:"Type de Document"}),a.jsxs("div",{className:"relative flex-1 flex items-center justify-center min-h-[180px]",children:[a.jsxs("svg",{className:"w-48 h-48 transform -rotate-90",viewBox:"0 0 192 192",children:[a.jsx("circle",{cx:"96",cy:"96",fill:"none",r:"70",stroke:"#f1f5f9",strokeWidth:"20"}),(f??[]).length>0?(()=>{const k=2*Math.PI*70;let L=0;return f.map(T=>{const I=T.percentage/100*k,$=a.jsx("circle",{cx:"96",cy:"96",fill:"none",r:"70",stroke:Rf(T.type),strokeDasharray:`${I} ${k}`,strokeDashoffset:-L,strokeWidth:"20"},T.type);return L+=I,$})})():a.jsx("circle",{cx:"96",cy:"96",fill:"none",r:"70",stroke:"#e2e8f0",strokeWidth:"20"})]}),a.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none",children:[a.jsx("p",{className:"text-2xl font-black",children:x}),a.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold",children:"Total"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[(f??[]).map(k=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"w-3 h-3 rounded-full shrink-0",style:{backgroundColor:Rf(k.type)}}),a.jsxs("span",{className:"text-xs font-semibold truncate",children:[k.type," (",k.percentage,"%)"]})]},k.type)),(!f||f.length===0)&&a.jsx("p",{className:"text-xs text-slate-400 col-span-2",children:"Aucun document"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[a.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-lg font-bold",children:"Popularit par Rgion (Maroc)"}),a.jsxs("div",{className:"text-[10px] font-bold text-slate-400 flex items-center gap-1",children:[a.jsx("span",{className:"material-symbols-outlined text-sm",children:"location_on"})," TEMPS REL"]})]}),a.jsxs("div",{className:"rounded-lg overflow-hidden bg-slate-100 border border-slate-200",children:[a.jsxs("div",{className:"relative h-56 sm:h-64 flex items-center justify-center",children:[a.jsx("div",{className:"absolute inset-0 morocco-map-overlay opacity-30 pointer-events-none"}),a.jsx("div",{className:"relative z-[1] w-full h-full bg-center bg-no-repeat bg-contain",style:{backgroundImage:`url(${Eb})`},title:"Carte Maroc"}),a.jsx("div",{className:"absolute top-1/4 left-1/3 w-6 h-6 bg-admin-primary/30 rounded-full animate-ping pointer-events-none"}),a.jsx("div",{className:"absolute top-1/4 left-1/3 w-3 h-3 bg-admin-primary rounded-full shadow border-2 border-white pointer-events-none"}),a.jsx("div",{className:"absolute top-[45%] left-1/4 w-4 h-4 bg-admin-primary/30 rounded-full pointer-events-none"}),a.jsx("div",{className:"absolute top-[45%] left-1/4 w-2.5 h-2.5 bg-admin-primary rounded-full shadow border-2 border-white pointer-events-none"})]}),a.jsxs("div",{className:"px-4 py-3 bg-white border-t border-slate-200",children:[a.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-2",children:"Top 3 Rgions"}),a.jsxs("ul",{className:"flex flex-wrap gap-x-6 gap-y-1 text-sm",children:[a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-slate-700",children:"Casablanca-Settat"}),a.jsx("span",{className:"text-admin-primary font-bold",children:"42%"})]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-slate-700",children:"Rabat-Sal-Knitra"}),a.jsx("span",{className:"text-admin-primary font-bold",children:"28%"})]}),a.jsxs("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-slate-700",children:"Marrakech-Safi"}),a.jsx("span",{className:"text-admin-primary font-bold",children:"15%"})]})]})]})]})]}),a.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm flex flex-col",children:[a.jsx("h3",{className:"text-lg font-bold mb-6",children:"Consultations Rcentes"}),a.jsxs("div",{className:"space-y-4 overflow-y-auto pr-2 flex-1 min-h-0",children:[p.slice(0,4).map((k,L)=>{const T=["Casablanca","Marrakech","Fs","Rabat"],I=[2,14,25,60];return a.jsxs(ie,{to:`/documents/${k.id}`,className:`flex items-center gap-4 p-3 hover:bg-slate-50 rounded-lg transition-colors border-l-4 ${Rb(k.type)}`,children:[a.jsx("div",{className:`w-10 h-10 rounded flex items-center justify-center ${k.type==="pdf"?"bg-admin-primary/10 text-admin-primary":k.type==="image"?"bg-blue-500/10 text-blue-500":"bg-slate-100 text-slate-500"}`,children:a.jsx("span",{className:"material-symbols-outlined",children:Pb(k.type)})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-bold truncate",children:k.title}),a.jsxs("p",{className:"text-[10px] text-slate-500",children:["Consult depuis ",T[L%T.length],"  Il y a ",I[L]," min"]})]}),a.jsxs("span",{className:"text-xs font-bold text-slate-400",children:["#",k.id]})]},k.id)}),p.length===0&&a.jsx("p",{className:"text-sm text-slate-500 py-4",children:"Aucune consultation rcente."})]}),a.jsx(ie,{to:"/admin/documents",className:"mt-6 pt-4 text-sm font-bold text-admin-primary hover:underline text-center block",children:"Voir tout l'historique"})]})]}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[a.jsxs("div",{className:"p-6 border-b border-slate-100 flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-bold",children:"Documents les plus consults"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Rechercher un document...",className:"pl-10 pr-4 py-2 text-sm bg-slate-100 border-none rounded-lg focus:ring-2 focus:ring-admin-primary/50 w-64 outline-none"}),a.jsx("span",{className:"material-symbols-outlined absolute left-3 top-2.5 text-slate-400 text-sm",children:"search"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left",children:[a.jsx("thead",{className:"bg-slate-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Document"}),a.jsx("th",{className:"px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Type"}),a.jsx("th",{className:"px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Vues"}),a.jsx("th",{className:"px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Temps Moyen"}),a.jsx("th",{className:"px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Taux de Rebond"}),a.jsx("th",{className:"px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-100",children:p.slice(0,4).map((k,L)=>{const T=[12,45,18,62][L%4],I=["06:45","03:12","08:20","05:40"][L%4];return a.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:`material-symbols-outlined text-xl ${Tb(k.type)}`,children:"description"}),a.jsx(ie,{to:`/documents/${k.id}`,className:"text-sm font-semibold hover:text-admin-primary",children:k.title})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"px-2 py-1 bg-slate-100 rounded text-[10px] font-bold uppercase",children:k.type})}),a.jsx("td",{className:"px-6 py-4 text-sm font-bold",children:k.views_count.toLocaleString("fr-FR")}),a.jsx("td",{className:"px-6 py-4 text-sm",children:I}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"flex-1 h-1.5 bg-slate-100 rounded-full overflow-hidden max-w-[80px]",children:a.jsx("div",{className:"h-full bg-green-500",style:{width:`${Math.min(T,100)}%`}})}),a.jsxs("span",{className:"text-[10px] font-bold",children:[T,"%"]})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx(ie,{to:`/admin/documents/${k.id}/edit`,className:"text-slate-400 hover:text-admin-primary inline-flex",children:a.jsx("span",{className:"material-symbols-outlined text-xl",children:"more_vert"})})})]},k.id)})})]})}),a.jsxs("div",{className:"p-4 bg-slate-50 border-t border-slate-100 flex items-center justify-between",children:[a.jsxs("p",{className:"text-xs text-slate-500",children:["Affichage de 1-",Math.min(4,p.length)," sur ",x," documents"]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded border border-slate-200 bg-white text-slate-400 disabled:opacity-50",disabled:!0,children:a.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_left"})}),a.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded border border-admin-primary bg-admin-primary text-white text-xs font-bold",children:"1"}),a.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded border border-slate-200 bg-white text-xs font-bold hover:bg-slate-50",children:"2"}),a.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded border border-slate-200 bg-white text-slate-400 hover:bg-slate-50",children:a.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"})})]})]})]})]})]})}function Mb(){const u=Ut(f=>f.user),[e,t]=E.useState(null),[i,r]=E.useState(!0),[l,c]=E.useState(1);E.useEffect(()=>{u?.role!=="admin"&&u?.role!=="editor"||(r(!0),ct.documents.list({page:l,per_page:20}).then(t).catch(()=>t(null)).finally(()=>r(!1)))},[u?.role,l]);const d=(f,p)=>{window.confirm(`Supprimer  ${p}  ?`)&&ct.documents.delete(f).then(()=>t(m=>m?{...m,data:m.data.filter(x=>x.id!==f)}:null)).catch(m=>alert(m.message))};return u&&u.role!=="admin"&&u.role!=="editor"?a.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-16 text-center",children:[a.jsx("p",{className:"text-slate-500",children:"Accs rserv aux administrateurs et diteurs."}),a.jsx(ie,{to:"/",className:"text-primary font-semibold mt-4 inline-block",children:"Retour  l'accueil"})]}):u?a.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-10",children:[a.jsxs("div",{className:"flex items-center justify-between mb-8",children:[a.jsx("h1",{className:"text-3xl font-black text-slate-900 dark:text-white",children:"Documents"}),a.jsx(ie,{to:"/admin/documents/new",className:"px-4 py-2 rounded-lg bg-primary text-white font-bold hover:opacity-90 transition-opacity",children:"Ajouter un document"})]}),a.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 overflow-hidden",children:i?a.jsx("div",{className:"p-8 text-center text-slate-500",children:"Chargement"}):e&&e.data.length>0?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-200 dark:border-slate-800",children:[a.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Titre"}),a.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Type"}),a.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Anne"}),a.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Statut"}),a.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Vues"}),a.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Actions"})]})}),a.jsx("tbody",{children:e.data.map(f=>a.jsxs("tr",{className:"border-b border-slate-100 dark:border-slate-800",children:[a.jsx("td",{className:"p-4",children:a.jsx(ie,{to:`/documents/${f.id}`,className:"font-medium text-primary hover:underline",children:f.title})}),a.jsx("td",{className:"p-4 text-sm",children:f.type}),a.jsx("td",{className:"p-4 text-sm",children:f.year??""}),a.jsx("td",{className:"p-4 text-sm",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-bold ${f.status==="approved"?"bg-green-100 text-green-700":f.status==="rejected"?"bg-red-100 text-red-700":"bg-amber-100 text-amber-700"}`,children:f.status==="approved"?"Approuv":f.status==="rejected"?"Rejet":"En attente"})}),a.jsx("td",{className:"p-4 text-sm",children:f.views_count}),a.jsxs("td",{className:"p-4 flex gap-2",children:[a.jsx(ie,{to:`/admin/documents/${f.id}/edit`,className:"text-sm text-primary font-medium hover:underline",children:"Modifier"}),a.jsx("button",{type:"button",onClick:()=>d(f.id,f.title),className:"text-sm text-red-600 dark:text-red-400 font-medium hover:underline",children:"Supprimer"})]})]},f.id))})]})}):a.jsx("p",{className:"p-8 text-slate-500",children:"Aucun document."})}),e&&e.last_page>1&&a.jsxs("div",{className:"flex justify-center gap-2 mt-6",children:[a.jsx("button",{type:"button",onClick:()=>c(f=>Math.max(1,f-1)),disabled:l<=1,className:"px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 disabled:opacity-50",children:"Prcdent"}),a.jsxs("span",{className:"px-4 py-2 text-slate-600 dark:text-slate-400",children:["Page ",e.current_page," / ",e.last_page]}),a.jsx("button",{type:"button",onClick:()=>c(f=>Math.min(e.last_page,f+1)),disabled:l>=e.last_page,className:"px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 disabled:opacity-50",children:"Suivant"})]})]}):a.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-16 text-center",children:[a.jsx("p",{className:"text-slate-500",children:"Veuillez vous connecter."}),a.jsx(ie,{to:"/login",className:"text-primary font-semibold mt-4 inline-block",children:"Connexion"})]})}const Vb=["pdf","image","carte","video","audio"],Ib=".pdf,.jpg,.jpeg,.png",xc=50;function Lf(){const u=Ut(J=>J.user),e=cs(),{id:t}=vr(),i=t&&t!=="new",r=E.useRef(null),[l,c]=E.useState([]),[d,f]=E.useState([]),[p,m]=E.useState(!!i),[x,b]=E.useState(!1),[w,y]=E.useState(""),[N,_]=E.useState(1),[j,S]=E.useState(!0),[P,k]=E.useState("public"),[L,T]=E.useState(!1),[I,$]=E.useState(""),[te,oe]=E.useState(""),[ae,ne]=E.useState(""),[se,xe]=E.useState("pdf"),[Se,X]=E.useState(""),[Z,q]=E.useState(""),[re,Q]=E.useState(""),[V,z]=E.useState(""),[ce,ve]=E.useState(""),[U,B]=E.useState(null),[ee,K]=E.useState(null),[fe,Ve]=E.useState(null),[wt,dt]=E.useState(null),[Nt,Ht]=E.useState(!1),[an,ui]=E.useState(!1);E.useEffect(()=>{Jf.list().then(J=>c(J)).catch(()=>[]),Zx.list().then(J=>f(J)).catch(()=>[])},[]),E.useEffect(()=>{!i||!t||(y(""),ct.documents.get(Number(t)).then(J=>{$(J.title),oe(J.author??""),ne(J.description??""),xe(J.type),X(J.year??""),q(J.region_id??""),Q(J.theme_id??""),z(J.language??""),ve(J.keywords??""),ui(J.is_rare??!1),Ve({pages_status:J.pages_status??void 0,pages_count:J.pages_count??null,thumbnail_url:J.thumbnail_url??null}),J.pages_status==="processing"&&ct.documents.conversionProgress(Number(t)).then(Le=>dt(Le.progress??null)).catch(()=>{})}).catch(J=>{const Le=J?.message?.toLowerCase?.();Le==="failed to fetch"||Le?.includes("network")||Le?.includes("load")?y("Impossible de joindre le serveur. Vrifiez que l'API Laravel est dmarre (php artisan serve) et que le proxy pointe vers http://localhost:8000."):y(J?.message??"Document introuvable")}).finally(()=>m(!1)))},[t,i]),E.useEffect(()=>{if(!i||!t||se!=="pdf"||fe?.pages_status!=="processing")return;const J=setInterval(()=>{ct.documents.conversionProgress(Number(t)).then(Le=>{dt(Le.progress??null),Le.pages_status!=="processing"&&Ve(En=>En?{...En,pages_status:Le.pages_status,pages_count:Le.pages_count}:null)}).catch(()=>{})},2e3);return()=>clearInterval(J)},[t,i,se,fe?.pages_status]);const hi=()=>{!t||se!=="pdf"||(Ht(!0),ct.documents.regeneratePages(Number(t)).then(J=>{Ve({pages_status:J.document.pages_status??"pending",pages_count:J.document.pages_count??null}),dt(null)}).finally(()=>Ht(!1)))},fi=J=>{if(!J)return B(null);if(J.size>xc*1024*1024){y(`Fichier trop volumineux (max ${xc} MB).`);return}y(""),B(J)},pi=J=>{J.preventDefault(),T(!1);const Le=J.dataTransfer.files?.[0];Le&&fi(Le)},ln=J=>{J.preventDefault(),T(!0)},Ts=()=>T(!1),mi=J=>{if(J.preventDefault(),y(""),!i&&!U){y("Le fichier est obligatoire pour un nouveau document.");return}b(!0);const Le=new FormData;Le.append("title",I),Le.append("author",te),Le.append("description",ae),Le.append("type",se),Le.append("year",Se),Le.append("region_id",Z===""?"":String(Z)),Le.append("theme_id",re===""?"":String(re)),Le.append("language",V),Le.append("keywords",ce),Le.append("is_rare",an?"1":"0"),U&&Le.append("file",U),ee&&Le.append("thumbnail",ee),i&&Le.append("_method","PUT"),(i?ct.documents.update(Number(t),Le):ct.documents.create(Le)).then(()=>e("/admin/documents")).catch(Nr=>{y(Nr.message),b(!1)})};return u&&u.role!=="admin"&&u.role!=="editor"?a.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-16 text-center",children:[a.jsx("p",{className:"text-slate-500",children:"Accs rserv."}),a.jsx(ie,{to:"/",className:"text-admin-primary font-semibold mt-4 inline-block",children:"Accueil"})]}):u?p&&i?a.jsx("div",{className:"max-w-4xl mx-auto px-8 py-20",children:a.jsx("div",{className:"h-64 bg-slate-100 rounded-xl animate-pulse"})}):a.jsxs("div",{className:"px-8 py-10 max-w-4xl mx-auto",children:[a.jsxs("header",{className:"mb-10",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 mb-2",children:[a.jsx(ie,{to:"/admin/documents",className:"hover:underline",children:"Documents"}),a.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"chevron_right"}),a.jsx("span",{className:"text-slate-900 font-medium",children:i?"Modifier":"Nouveau Document"})]}),a.jsx("h2",{className:"text-3xl font-black text-slate-900 tracking-tight",children:i?"Modifier le document":"Ajouter un Document Historique"}),a.jsx("p",{className:"text-slate-500 mt-2",children:i?"Mettez  jour les mtadonnes du document.":"Intgrez une nouvelle pice  la base de donnes de Tarikh.ma."})]}),a.jsxs("form",{onSubmit:mi,className:"flex flex-col",children:[w&&a.jsx("div",{className:"mb-6 p-4 rounded-lg bg-red-50 text-red-700 text-sm border border-red-100",children:w}),a.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:[a.jsxs("div",{className:"flex border-b border-slate-200",children:[a.jsxs("button",{type:"button",onClick:()=>_(1),className:`flex-1 py-4 px-6 flex items-center gap-3 ${N===1?"step-active":"text-slate-500 border-b-2 border-transparent"}`,children:[a.jsx("span",{className:`w-7 h-7 rounded-full flex items-center justify-center font-bold text-xs ${N===1?"bg-admin-primary text-white":"bg-slate-100 text-slate-500"}`,children:"1"}),a.jsx("span",{className:"text-sm font-bold",children:"Fichier"})]}),a.jsxs("button",{type:"button",onClick:()=>_(2),className:`flex-1 py-4 px-6 flex items-center gap-3 ${N===2?"step-active":"text-slate-500 border-b-2 border-transparent"}`,children:[a.jsx("span",{className:`w-7 h-7 rounded-full flex items-center justify-center font-bold text-xs ${N===2?"bg-admin-primary text-white":"bg-slate-100 text-slate-500"}`,children:"2"}),a.jsx("span",{className:"text-sm font-semibold",children:"Dtails (Mtadonnes)"})]}),a.jsxs("button",{type:"button",onClick:()=>_(3),className:`flex-1 py-4 px-6 flex items-center gap-3 ${N===3?"step-active":"text-slate-500 border-b-2 border-transparent"}`,children:[a.jsx("span",{className:`w-7 h-7 rounded-full flex items-center justify-center font-bold text-xs ${N===3?"bg-admin-primary text-white":"bg-slate-100 text-slate-500"}`,children:"3"}),a.jsx("span",{className:"text-sm font-semibold",children:"Scurit"})]})]}),a.jsxs("div",{className:"p-8",children:[N===1&&a.jsxs("div",{className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"tape 1 : Tlchargement du fichier"}),a.jsxs("div",{onDrop:pi,onDragOver:ln,onDragLeave:Ts,onClick:()=>r.current?.click(),className:`flex flex-col items-center justify-center gap-6 rounded-xl border-2 border-dashed px-10 py-16 cursor-pointer transition-colors ${L?"border-admin-primary bg-admin-primary/5":"border-slate-200 bg-slate-50/50 hover:border-admin-primary/50"}`,children:[a.jsx("input",{ref:r,type:"file",accept:Ib,className:"hidden",onChange:J=>fi(J.target.files?.[0]??null)}),a.jsx("div",{className:"w-16 h-16 rounded-full bg-admin-primary/10 flex items-center justify-center text-admin-primary",children:a.jsx("span",{className:"material-symbols-outlined text-[40px]",children:"upload_file"})}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-slate-900 text-lg font-bold",children:"Glissez-dposez le document ici"}),a.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["PDF, JPG, PNG supports (Max ",xc," MB)"]}),U&&a.jsx("p",{className:"text-admin-primary text-sm font-semibold mt-2",children:U.name})]}),a.jsx("button",{type:"button",onClick:J=>{J.stopPropagation(),r.current?.click()},className:"px-6 py-2.5 bg-white border border-slate-200 rounded-lg text-sm font-bold text-slate-900 shadow-sm hover:bg-slate-50",children:"Parcourir les fichiers"})]}),a.jsxs("div",{className:"space-y-4 pt-6 border-t border-slate-200",children:[a.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Image miniature (Preview)"}),a.jsxs("div",{className:"flex items-center gap-6",children:[a.jsx("div",{className:"w-32 h-32 rounded-lg bg-slate-100 border border-slate-200 flex items-center justify-center overflow-hidden",children:ee?a.jsx("img",{src:URL.createObjectURL(ee),alt:"Aperu",className:"w-full h-full object-cover"}):fe?.thumbnail_url?a.jsx("img",{src:fe.thumbnail_url,alt:"Aperu actuel",className:"w-full h-full object-cover"}):a.jsx("span",{className:"material-symbols-outlined text-slate-300 text-3xl",children:"image"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-xs text-slate-500 mb-3",children:"Tlchargez une image (JPG/PNG) pour l'aperu dans la liste des archives."}),a.jsx("input",{type:"file",accept:"image/*",onChange:J=>K(J.target.files?.[0]??null),className:"text-xs text-slate-600 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-admin-primary/10 file:text-admin-primary hover:file:bg-admin-primary/20"})]})]})]}),a.jsxs("div",{className:"flex gap-4 p-4 rounded-lg bg-blue-50 border border-blue-100",children:[a.jsx("span",{className:"material-symbols-outlined text-blue-600 shrink-0",children:"verified_user"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-bold text-blue-900",children:"Avis de scurit"}),a.jsx("p",{className:"text-sm text-blue-800 mt-1",children:"Tous les fichiers tlchargs sont automatiquement chiffrs. Notre systme analyse le document pour s'assurer qu'il respecte les normes de conservation numrique."})]})]})]}),N===2&&a.jsxs("div",{className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-6",children:"Dtails du document"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"sm:col-span-2 flex flex-col gap-2",children:[a.jsxs("label",{className:"text-sm font-bold text-slate-900",children:["Titre du document ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"text",value:I,onChange:J=>$(J.target.value),required:!0,placeholder:"Ex: Dahir royal de 1912",className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary focus:border-admin-primary outline-none"})]}),a.jsxs("div",{className:"sm:col-span-2 flex flex-col gap-2",children:[a.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Auteur / Source"}),a.jsx("input",{type:"text",value:te,onChange:J=>oe(J.target.value),placeholder:"Ex: Ibn Khaldoun, Ministre de la Culture",className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary focus:border-admin-primary outline-none"})]}),a.jsxs("div",{className:"sm:col-span-2 flex flex-col gap-2",children:[a.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Description historique"}),a.jsx("textarea",{value:ae,onChange:J=>ne(J.target.value),placeholder:"Dcrivez le contexte et l'importance de ce document...",rows:4,className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary focus:border-admin-primary outline-none"})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsxs("label",{className:"text-sm font-bold text-slate-900",children:["Type de document ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("select",{value:se,onChange:J=>xe(J.target.value),required:!0,className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary focus:border-admin-primary outline-none",children:Vb.map(J=>a.jsx("option",{value:J,children:J},J))})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Anne / Priode"}),a.jsx("input",{type:"text",value:Se,onChange:J=>X(J.target.value),placeholder:"Ex: 1912",className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary focus:border-admin-primary outline-none"})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Priode / Thmatique"}),a.jsxs("select",{value:re,onChange:J=>Q(J.target.value?Number(J.target.value):""),className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary focus:border-admin-primary outline-none",children:[a.jsx("option",{value:"",children:""}),l.map(J=>a.jsx("option",{value:J.id,children:J.name},J.id))]})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Rgion du Maroc"}),a.jsxs("select",{value:Z,onChange:J=>q(J.target.value?Number(J.target.value):""),className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary focus:border-admin-primary outline-none",children:[a.jsx("option",{value:"",children:""}),d.map(J=>a.jsx("option",{value:J.id,children:J.name},J.id))]})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Langue"}),a.jsx("input",{type:"text",value:V,onChange:J=>z(J.target.value),className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary outline-none"})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Mots-cls"}),a.jsx("input",{type:"text",value:ce,onChange:J=>ve(J.target.value),placeholder:"spars par des virgules",className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary outline-none"})]})]})]}),N===3&&a.jsxs("div",{className:"space-y-6",children:[a.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-6",children:"Scurit et accs"}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"material-symbols-outlined text-admin-primary",children:"branding_watermark"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-bold",children:"Activer le filigrane Tarikh.ma"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Ajoute un logo semi-transparent sur les images"})]})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:j,onChange:J=>S(J.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-admin-primary"})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 bg-amber-50/50 border border-amber-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"material-symbols-outlined text-amber-600",children:"star"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-bold",children:'Marquer comme "Document Rare"'}),a.jsx("p",{className:"text-xs text-slate-500",children:"S'affichera dans la section spciale de la page d'accueil"})]})]}),a.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:an,onChange:J=>ui(J.target.checked),className:"sr-only peer"}),a.jsx("div",{className:"w-11 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-amber-500"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Niveau d'accs au document"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[a.jsxs("label",{className:`relative flex flex-col p-4 border-2 rounded-xl cursor-pointer transition-colors ${P==="public"?"border-admin-primary bg-admin-primary/5":"border-slate-200 hover:bg-slate-50"}`,children:[a.jsx("input",{type:"radio",name:"access",value:"public",checked:P==="public",onChange:()=>k("public"),className:"sr-only"}),a.jsx("span",{className:`material-symbols-outlined mb-1 ${P==="public"?"text-admin-primary":"text-slate-500"}`,children:"public"}),a.jsx("span",{className:"text-xs font-bold uppercase tracking-wide",children:"Public"}),a.jsx("span",{className:"text-[10px] text-slate-500 mt-1",children:"Visible par tous"}),P==="public"&&a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("span",{className:"material-symbols-outlined text-admin-primary text-[18px]",children:"check_circle"})})]}),a.jsxs("label",{className:`relative flex flex-col p-4 border-2 rounded-xl cursor-pointer transition-colors ${P==="restricted"?"border-admin-primary bg-admin-primary/5":"border-slate-200 hover:bg-slate-50"}`,children:[a.jsx("input",{type:"radio",name:"access",value:"restricted",checked:P==="restricted",onChange:()=>k("restricted"),className:"sr-only"}),a.jsx("span",{className:`material-symbols-outlined mb-1 ${P==="restricted"?"text-admin-primary":"text-slate-500"}`,children:"lock_open"}),a.jsx("span",{className:"text-xs font-bold uppercase tracking-wide",children:"Inscrit"}),a.jsx("span",{className:"text-[10px] text-slate-500 mt-1",children:"Utilisateurs connects"}),P==="restricted"&&a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("span",{className:"material-symbols-outlined text-admin-primary text-[18px]",children:"check_circle"})})]}),a.jsxs("label",{className:`relative flex flex-col p-4 border-2 rounded-xl cursor-pointer transition-colors ${P==="private"?"border-admin-primary bg-admin-primary/5":"border-slate-200 hover:bg-slate-50"}`,children:[a.jsx("input",{type:"radio",name:"access",value:"private",checked:P==="private",onChange:()=>k("private"),className:"sr-only"}),a.jsx("span",{className:`material-symbols-outlined mb-1 ${P==="private"?"text-admin-primary":"text-slate-500"}`,children:"lock"}),a.jsx("span",{className:"text-xs font-bold uppercase tracking-wide",children:"Priv"}),a.jsx("span",{className:"text-[10px] text-slate-500 mt-1",children:"Admin uniquement"}),P==="private"&&a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("span",{className:"material-symbols-outlined text-admin-primary text-[18px]",children:"check_circle"})})]})]})]}),i&&se==="pdf"&&a.jsxs("div",{className:"space-y-3 pt-4 border-t border-slate-200",children:[a.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Conversion PDF  pages (flipbook)"}),a.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 rounded-xl bg-slate-50 border border-slate-200",children:[a.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase",children:"Statut"}),a.jsxs("span",{className:`text-sm font-semibold ${fe?.pages_status==="completed"?"text-green-600":fe?.pages_status==="failed"?"text-red-600":"text-amber-600"}`,children:[fe?.pages_status==="completed"&&`${fe?.pages_count??0} page(s)`,fe?.pages_status==="processing"&&"Conversion en cours",fe?.pages_status==="pending"&&"En attente",fe?.pages_status==="failed"&&"chec",!fe?.pages_status&&""]}),fe?.pages_status==="processing"&&wt&&a.jsxs("span",{className:"text-xs text-slate-500",children:[wt.current," / ",wt.total]}),a.jsxs("button",{type:"button",onClick:hi,disabled:Nt||fe?.pages_status==="processing",className:"ml-auto px-4 py-2 rounded-lg text-sm font-bold bg-white border border-slate-200 hover:bg-slate-50 disabled:opacity-50 flex items-center gap-2",children:[a.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"refresh"}),Nt?"Regnration":"Regnrer les pages"]})]})]})]})]})]}),a.jsxs("div",{className:"px-8 py-5 bg-slate-50/80 border-t border-slate-200 flex flex-wrap items-center justify-between gap-4",children:[a.jsxs(ie,{to:"/admin/documents",className:"flex items-center gap-2 px-5 py-2.5 rounded-lg text-sm font-bold text-slate-500 hover:bg-slate-200 transition-colors",children:[a.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"arrow_back"}),"Annuler"]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{type:"submit",disabled:x,className:"px-6 py-2.5 rounded-lg text-sm font-bold text-slate-900 bg-white border border-slate-200 shadow-sm hover:bg-slate-50 disabled:opacity-50",children:x?"Enregistrement":"Enregistrer en brouillon"}),a.jsxs("button",{type:"submit",disabled:x,className:"px-10 py-2.5 bg-admin-primary hover:bg-admin-primary/90 text-white rounded-lg text-sm font-black transition-all shadow-md flex items-center gap-2 disabled:opacity-50",children:[x?"Enregistrement":i?"Enregistrer":"Publier le Document",a.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"send"})]})]})]})]})]}),a.jsxs("footer",{className:"mt-8 flex flex-wrap items-center justify-between gap-4 text-slate-500 text-xs",children:[a.jsxs("p",{children:[" ",new Date().getFullYear()," Tarikh.ma - Systme de Management de Contenu Historique"]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx("a",{href:"#support",className:"hover:underline",children:"Support technique"}),a.jsx("a",{href:"#logs",className:"hover:underline",children:"Logs d'activit"})]})]})]}):a.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-16 text-center",children:[a.jsx("p",{className:"text-slate-500",children:"Veuillez vous connecter."}),a.jsx(ie,{to:"/login",className:"text-admin-primary font-semibold mt-4 inline-block",children:"Connexion"})]})}const vc={admin:"Administrateur",editor:"diteur",reader:"Lecteur"},Mf={admin:"bg-admin-primary/10 text-admin-primary border-admin-primary/20",editor:"bg-blue-500/10 text-blue-600 border-blue-500/20",reader:"bg-slate-500/10 text-slate-500 border-slate-500/20"},bc=[{key:"edit_content",label:"dition de contenu",desc:"Modifier les articles et documents existants.",default:!0},{key:"publish_direct",label:"Publication directe",desc:"Publier sans validation d'un admin.",default:!1},{key:"access_stats",label:"Accs aux statistiques",desc:"Consulter les chiffres d'audience.",default:!0},{key:"delete_right",label:"Droit de suppression",desc:"Supprimer dfinitivement du contenu.",default:!1},{key:"technical_mgmt",label:"Gestion technique",desc:"Accs aux paramtres du serveur API.",default:!1}],Db={admin:"Le rle d'administrateur dispose de tous les droits : gestion des utilisateurs, du contenu et des paramtres techniques.",editor:"Le rle d'diteur permet de crer, modifier et publier du contenu historique. Il ne possde pas de droits de suppression globale.",reader:"Le rle de lecteur permet uniquement de consulter le contenu et les statistiques, sans droit de modification."};function Vf(u){return u.split(/\s+/).map(e=>e[0]).join("").toUpperCase().slice(0,2)}function Fb(u){return Mf[u]??Mf.reader}function Ob(){const u=Ut(T=>T.user),[e,t]=E.useState(null),[i,r]=E.useState(!0),[l,c]=E.useState(1),[d,f]=E.useState(""),[p,m]=E.useState(!0),[x,b]=E.useState("editor"),[w,y]=E.useState(Object.fromEntries(bc.map(T=>[T.key,T.default]))),[N,_]=E.useState(null);E.useEffect(()=>{u?.role==="admin"&&(r(!0),ct.users.list({page:l,per_page:10}).then(T=>t({...T,total:T.total??T.data.length})).catch(()=>t(null)).finally(()=>r(!1)))},[u?.role,l]);const j=(T,I)=>{window.confirm(`Supprimer l'utilisateur  ${I}  ?`)&&ct.users.delete(T).then(()=>t($=>$?{...$,data:$.data.filter(te=>te.id!==T)}:null)).catch($=>alert($.message))},S=e?.data.filter(T=>!d||T.name.toLowerCase().includes(d.toLowerCase())||T.email.toLowerCase().includes(d.toLowerCase())||(vc[T.role]??T.role).toLowerCase().includes(d.toLowerCase()))??[],P=T=>{y(I=>({...I,[T]:!I[T]}))},k=()=>{y(Object.fromEntries(bc.map(T=>[T.key,T.default])))},L=e?.data.filter(T=>T.role===x).length??0;return u&&u.role!=="admin"?a.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-16 text-center bg-white",children:[a.jsx("p",{className:"text-slate-500",children:"Accs rserv aux administrateurs."}),a.jsx(ie,{to:"/",className:"text-admin-primary font-semibold mt-4 inline-block",children:"Retour  l'accueil"})]}):u?a.jsxs("div",{className:"flex flex-1 overflow-hidden bg-white",children:[a.jsx("main",{className:"flex-1 flex flex-col overflow-hidden min-w-0",children:a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 sm:p-8",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 mb-2",children:[a.jsx(ie,{to:"/admin",className:"hover:text-slate-700",children:"Accueil"}),a.jsx("span",{className:"material-symbols-outlined text-xs",children:"chevron_right"}),a.jsx("span",{children:"Administration"}),a.jsx("span",{className:"material-symbols-outlined text-xs",children:"chevron_right"}),a.jsx("span",{className:"text-admin-primary font-semibold",children:"Utilisateurs"})]}),a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900 tracking-tight",children:"Gestion des Utilisateurs"}),a.jsx("p",{className:"text-slate-500 mt-1 text-sm",children:"Contrlez les accs et dfinissez les permissions de votre quipe ditoriale."})]}),a.jsxs(ie,{to:"/admin/users/new",className:"flex items-center justify-center gap-2 px-5 py-2.5 bg-admin-primary text-white font-bold rounded-lg hover:shadow-lg hover:brightness-110 transition-all shrink-0",children:[a.jsx("span",{className:"material-symbols-outlined text-lg",children:"person_add"}),"Ajouter un utilisateur"]})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[a.jsxs("div",{className:"relative w-full max-w-md",children:[a.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-xl",children:"search"}),a.jsx("input",{type:"text",value:d,onChange:T=>f(T.target.value),placeholder:"Rechercher par nom, email ou rle...",className:"w-full bg-slate-50 border border-slate-200 rounded-lg pl-10 pr-4 py-2.5 text-slate-900 placeholder:text-slate-400 focus:ring-2 focus:ring-admin-primary/50 focus:border-admin-primary"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("button",{type:"button",onClick:()=>m(!0),className:"lg:hidden flex items-center gap-2 px-4 py-2.5 bg-admin-primary/10 border border-admin-primary/20 text-admin-primary rounded-lg hover:bg-admin-primary/20 transition-all text-sm font-medium",children:[a.jsx("span",{className:"material-symbols-outlined text-lg",children:"admin_panel_settings"}),"Rles"]}),a.jsxs("button",{type:"button",className:"flex items-center gap-2 px-4 py-2.5 bg-white border border-slate-200 text-slate-600 rounded-lg hover:bg-slate-50 transition-all text-sm font-medium",children:[a.jsx("span",{className:"material-symbols-outlined text-lg",children:"filter_list"}),"Filtrer"]}),a.jsxs("button",{type:"button",className:"flex items-center gap-2 px-4 py-2.5 bg-white border border-slate-200 text-slate-600 rounded-lg hover:bg-slate-50 transition-all text-sm font-medium",children:[a.jsx("span",{className:"material-symbols-outlined text-lg",children:"download"}),"Exporter"]})]})]}),a.jsx("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:i?a.jsx("div",{className:"p-12 text-center text-slate-500",children:"Chargement"}):S.length>0?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-slate-50 text-slate-500 text-xs font-bold uppercase tracking-wider",children:[a.jsx("th",{className:"px-6 py-4 border-b border-slate-200",children:"Utilisateur"}),a.jsx("th",{className:"px-6 py-4 border-b border-slate-200",children:"Rle"}),a.jsx("th",{className:"px-6 py-4 border-b border-slate-200",children:"Statut du compte"}),a.jsx("th",{className:"px-6 py-4 border-b border-slate-200",children:"Dernire connexion"}),a.jsx("th",{className:"px-6 py-4 border-b border-slate-200 text-right",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-100",children:S.map((T,I)=>a.jsxs("tr",{className:"group hover:bg-slate-50/80 transition-colors",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"size-10 rounded-full bg-admin-primary/10 flex items-center justify-center border border-admin-primary/20 text-admin-primary font-bold text-sm shrink-0",children:Vf(T.name)}),a.jsxs("div",{children:[a.jsx("p",{className:"text-slate-900 font-bold text-sm",children:T.name}),a.jsx("p",{className:"text-slate-500 text-xs",children:T.email})]})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`px-3 py-1 text-[11px] font-bold rounded-full border uppercase tracking-tighter ${Fb(T.role)}`,children:vc[T.role]??T.role})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"size-2 rounded-full bg-emerald-500"}),a.jsx("span",{className:"text-sm text-slate-700",children:"Actif"})]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-slate-500",children:I===0?"Il y a 2 heures":I===1?"Hier  14:30":I===2?"Il y a 5 jours":"En ligne"}),a.jsx("td",{className:"px-6 py-4 text-right",children:a.jsxs("div",{className:"flex items-center justify-end gap-1 relative",children:[a.jsx(ie,{to:`/admin/users/${T.id}/edit`,className:"p-2 text-slate-400 hover:text-admin-primary transition-colors rounded-lg","aria-label":"Modifier",children:a.jsx("span",{className:"material-symbols-outlined",children:"edit_square"})}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{type:"button",onClick:()=>_(N===T.id?null:T.id),className:"p-2 text-slate-400 hover:text-slate-600 transition-colors rounded-lg","aria-label":"Menu actions",children:a.jsx("span",{className:"material-symbols-outlined",children:"more_vert"})}),N===T.id&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10","aria-hidden":!0,onClick:()=>_(null)}),a.jsxs("div",{className:"absolute right-0 top-full mt-1 py-1 bg-white border border-slate-200 rounded-lg shadow-lg z-20 min-w-[140px]",children:[a.jsxs(ie,{to:`/admin/users/${T.id}/edit`,className:"flex items-center gap-2 px-4 py-2 text-sm text-slate-700 hover:bg-slate-50",onClick:()=>_(null),children:[a.jsx("span",{className:"material-symbols-outlined text-lg",children:"edit"}),"Modifier"]}),a.jsxs("button",{type:"button",onClick:()=>{_(null),j(T.id,T.name)},className:"flex items-center gap-2 w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:[a.jsx("span",{className:"material-symbols-outlined text-lg",children:"delete"}),"Supprimer"]})]})]})]})]})})]},T.id))})]})}):a.jsx("p",{className:"p-8 text-slate-500 text-center",children:"Aucun utilisateur trouv."})}),e&&e.data.length>0&&a.jsxs("div",{className:"mt-6 flex flex-wrap items-center justify-between gap-4",children:[a.jsxs("p",{className:"text-slate-500 text-sm",children:["Affichage de ",a.jsxs("span",{className:"text-slate-900 font-bold",children:["1  ",S.length]})," sur"," ",e.total??e.data.length," utilisateurs"]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",onClick:()=>c(T=>Math.max(1,T-1)),disabled:l<=1,className:"px-3 py-1.5 rounded-lg bg-white border border-slate-200 text-slate-600 disabled:opacity-50 text-sm font-medium",children:"Prcdent"}),a.jsx("button",{type:"button",className:"px-3 py-1.5 rounded-lg bg-admin-primary/20 text-admin-primary border border-admin-primary/30 text-sm font-bold",children:l}),e.last_page>1&&a.jsx("button",{type:"button",onClick:()=>c(T=>Math.min(e.last_page,T+1)),disabled:l>=e.last_page,className:"px-3 py-1.5 rounded-lg bg-white border border-slate-200 text-slate-600 hover:bg-slate-50 disabled:opacity-50 text-sm font-medium",children:"Suivant"})]})]})]})}),a.jsxs("aside",{className:`w-full lg:w-96 flex-shrink-0 bg-white border-l border-slate-200 flex flex-col shadow-xl z-20 transition-transform duration-300
          ${p?"flex fixed lg:relative inset-y-0 right-0 lg:inset-auto":"hidden lg:flex"}`,children:[a.jsxs("div",{className:"p-6 border-b border-slate-200 flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-slate-900 tracking-tight",children:"Gestion des Rles"}),a.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Configuration :"," ",a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-bold bg-blue-500/10 text-blue-600 border border-blue-500/20",children:x==="admin"?"Administrateur":x==="editor"?"diteur":"Lecteur"})]})]}),a.jsx("button",{type:"button",onClick:()=>m(!1),className:"size-8 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 hover:bg-slate-200 hover:text-slate-700 transition-colors lg:hidden","aria-label":"Fermer",children:a.jsx("span",{className:"material-symbols-outlined text-lg",children:"close"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-2 block",children:"Rle  configurer"}),a.jsx("div",{className:"flex gap-2 flex-wrap",children:["admin","editor","reader"].map(T=>a.jsx("button",{type:"button",onClick:()=>b(T),className:`px-3 py-1.5 rounded-full text-xs font-bold border ${x===T?"bg-admin-primary/20 text-admin-primary border-admin-primary/30":"bg-slate-50 text-slate-600 border-slate-200 hover:bg-slate-100"}`,children:vc[T]},T))})]}),a.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("span",{className:"material-symbols-outlined text-blue-500 text-xl",children:"shield_with_heart"}),a.jsx("h3",{className:"font-bold text-slate-900",children:"Niveau de privilges"})]}),a.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:Db[x]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4",children:"Permissions du rle"}),a.jsx("div",{className:"space-y-4",children:bc.map(T=>a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-bold text-slate-900",children:T.label}),a.jsx("p",{className:"text-xs text-slate-500",children:T.desc})]}),a.jsx("button",{type:"button",role:"switch","aria-checked":w[T.key],onClick:()=>P(T.key),className:`relative inline-flex h-5 w-10 shrink-0 rounded-full border-2 transition-colors focus:outline-none focus:ring-2 focus:ring-admin-primary/50 ${w[T.key]?"bg-admin-primary border-admin-primary":"bg-slate-200 border-slate-200"}`,children:a.jsx("span",{className:`inline-block h-4 w-4 rounded-full bg-white shadow transition-transform ${w[T.key]?"translate-x-5":"translate-x-0.5"}`,style:{marginTop:2}})})]},T.key))})]}),a.jsxs("div",{className:"space-y-3 pt-2",children:[a.jsx("button",{type:"button",className:"w-full py-3 bg-admin-primary/10 border border-admin-primary/30 text-admin-primary font-bold rounded-lg hover:bg-admin-primary/20 transition-all text-sm",children:"Sauvegarder les permissions"}),a.jsx("button",{type:"button",onClick:k,className:"w-full py-2 text-slate-500 text-sm hover:text-slate-700 transition-colors",children:"Rinitialiser par dfaut"})]})]}),a.jsxs("div",{className:"p-6 bg-slate-50 border-t border-slate-200",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("span",{className:"text-xs text-slate-500",children:"Utilisateurs avec ce rle"}),a.jsxs("span",{className:"text-xs font-bold text-slate-900",children:[L," membre",L!==1?"s":""]})]}),a.jsxs("div",{className:"flex -space-x-2",children:[S.filter(T=>T.role===x).slice(0,5).map(T=>a.jsx("div",{className:"size-8 rounded-full border-2 border-white bg-admin-primary/20 flex items-center justify-center text-xs font-bold text-slate-700",title:T.name,children:Vf(T.name).slice(0,1)},T.id)),L>5&&a.jsxs("div",{className:"size-8 rounded-full border-2 border-white bg-slate-300 flex items-center justify-center text-[10px] font-bold text-slate-600",children:["+",L-5]})]})]})]})]}):a.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-16 text-center bg-white",children:[a.jsx("p",{className:"text-slate-500",children:"Veuillez vous connecter."}),a.jsx(ie,{to:"/login",className:"text-admin-primary font-semibold mt-4 inline-block",children:"Connexion"})]})}const zb=[{value:"admin",label:"Administrateur"},{value:"editor",label:"diteur"},{value:"reader",label:"Lecteur"}];function If(){const u=Ut(L=>L.user),e=cs(),{id:t}=vr(),i=t&&t!=="new",[r,l]=E.useState(!!i),[c,d]=E.useState(!1),[f,p]=E.useState(""),[m,x]=E.useState(""),[b,w]=E.useState(""),[y,N]=E.useState("reader"),[_,j]=E.useState(""),[S,P]=E.useState("");E.useEffect(()=>{i&&ct.users.get(Number(t)).then(L=>{x(L.name),w(L.email),N(L.role)}).catch(()=>p("Utilisateur introuvable")).finally(()=>l(!1))},[t,i]);const k=L=>{if(L.preventDefault(),p(""),d(!0),!i&&_!==S){p("Les mots de passe ne correspondent pas."),d(!1);return}if(!i&&_.length<8){p("Le mot de passe doit contenir au moins 8 caractres."),d(!1);return}(i?ct.users.update(Number(t),{name:m,email:b,role:y,..._?{password:_,password_confirmation:S}:{}}):ct.users.create({name:m,email:b,password:_,password_confirmation:S,role:y})).then(()=>e("/admin/users")).catch(I=>{p(I.message),d(!1)})};return u&&u.role!=="admin"?a.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-16 text-center",children:[a.jsx("p",{className:"text-slate-500",children:"Accs rserv aux administrateurs."}),a.jsx(ie,{to:"/",className:"text-primary font-semibold mt-4 inline-block",children:"Accueil"})]}):u?r&&i?a.jsx("div",{className:"max-w-2xl mx-auto px-6 py-20",children:a.jsx("div",{className:"h-64 bg-slate-100 dark:bg-slate-800 rounded-xl animate-pulse"})}):a.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-10",children:[a.jsx(ie,{to:"/admin/users",className:"text-primary font-medium hover:underline mb-6 inline-block",children:" Retour aux utilisateurs"}),a.jsx("h1",{className:"text-2xl font-black text-slate-900 dark:text-white mb-6",children:i?"Modifier l'utilisateur":"Ajouter un utilisateur"}),a.jsxs("form",{onSubmit:k,className:"space-y-6",children:[f&&a.jsx("div",{className:"p-4 rounded-lg bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 text-sm",children:f}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-slate-600 dark:text-slate-400 mb-1",children:"Nom *"}),a.jsx("input",{type:"text",value:m,onChange:L=>x(L.target.value),required:!0,className:"w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-4 py-2.5 focus:ring-2 focus:ring-primary outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-slate-600 dark:text-slate-400 mb-1",children:"Email *"}),a.jsx("input",{type:"email",value:b,onChange:L=>w(L.target.value),required:!0,className:"w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-4 py-2.5 focus:ring-2 focus:ring-primary outline-none"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-slate-600 dark:text-slate-400 mb-1",children:"Rle *"}),a.jsx("select",{value:y,onChange:L=>N(L.target.value),className:"w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-4 py-2.5 focus:ring-2 focus:ring-primary outline-none",children:zb.map(L=>a.jsx("option",{value:L.value,children:L.label},L.value))})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-bold text-slate-600 dark:text-slate-400 mb-1",children:["Mot de passe ",i?"(laisser vide pour ne pas changer)":"*"]}),a.jsx("input",{type:"password",value:_,onChange:L=>j(L.target.value),minLength:i?0:8,className:"w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-4 py-2.5 focus:ring-2 focus:ring-primary outline-none"})]}),!i&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-slate-600 dark:text-slate-400 mb-1",children:"Confirmer le mot de passe *"}),a.jsx("input",{type:"password",value:S,onChange:L=>P(L.target.value),className:"w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-4 py-2.5 focus:ring-2 focus:ring-primary outline-none"})]}),a.jsxs("div",{className:"flex gap-4 pt-4",children:[a.jsx("button",{type:"submit",disabled:c,className:"px-6 py-2.5 rounded-lg bg-primary text-white font-bold hover:opacity-90 disabled:opacity-50",children:c?"Enregistrement":i?"Enregistrer":"Crer"}),a.jsx(ie,{to:"/admin/users",className:"px-6 py-2.5 rounded-lg border border-slate-200 dark:border-slate-700 font-bold hover:bg-slate-50 dark:hover:bg-slate-800",children:"Annuler"})]})]})]}):a.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-16 text-center",children:[a.jsx("p",{className:"text-slate-500",children:"Veuillez vous connecter."}),a.jsx(ie,{to:"/login",className:"text-primary font-semibold mt-4 inline-block",children:"Connexion"})]})}function Bb(){return Ut(e=>e.user)?a.jsx("div",{className:"flex flex-col flex-1 bg-white",children:a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 sm:p-8",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 mb-2",children:[a.jsx(ie,{to:"/admin",className:"hover:text-slate-700",children:"Accueil"}),a.jsx("span",{className:"material-symbols-outlined text-xs",children:"chevron_right"}),a.jsx("span",{children:"Administration"}),a.jsx("span",{className:"material-symbols-outlined text-xs",children:"chevron_right"}),a.jsx("span",{className:"text-admin-primary font-semibold",children:"Paramtres"})]}),a.jsx("h1",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900 tracking-tight",children:"Paramtres"}),a.jsx("p",{className:"text-slate-500 mt-1 text-sm",children:"Configuration gnrale de la plateforme et options d'administration."})]}),a.jsxs("div",{className:"max-w-3xl space-y-8",children:[a.jsxs("section",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-100 bg-slate-50/80",children:a.jsxs("h2",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[a.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"tune"}),"Gnral"]})}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Nom de la plateforme"}),a.jsx("input",{type:"text",defaultValue:"Tarikh.ma",className:"w-full bg-slate-50 border border-slate-200 rounded-lg px-4 py-2.5 text-slate-900 focus:ring-2 focus:ring-admin-primary/50 focus:border-admin-primary",readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Email de contact"}),a.jsx("input",{type:"email",placeholder:"contact@tarikh.ma",className:"w-full bg-slate-50 border border-slate-200 rounded-lg px-4 py-2.5 text-slate-900 placeholder:text-slate-400 focus:ring-2 focus:ring-admin-primary/50 focus:border-admin-primary"})]}),a.jsx("button",{type:"button",className:"px-4 py-2.5 bg-admin-primary text-white font-bold rounded-lg hover:brightness-110 transition-all text-sm",children:"Enregistrer"})]})]}),a.jsxs("section",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-100 bg-slate-50/80",children:a.jsxs("h2",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[a.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"lock"}),"Scurit"]})}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-slate-900",children:"Authentification  deux facteurs"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Recommand pour les comptes administrateur."})]}),a.jsx("button",{type:"button",role:"switch","aria-checked":!1,className:"relative inline-flex h-5 w-10 shrink-0 rounded-full border-2 border-slate-200 bg-slate-200 transition-colors",children:a.jsx("span",{className:"inline-block h-4 w-4 rounded-full bg-white shadow translate-x-0.5",style:{marginTop:2}})})]}),a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-slate-900",children:"Expiration des sessions"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Dconnexion automatique aprs inactivit."})]}),a.jsxs("select",{className:"bg-slate-50 border border-slate-200 rounded-lg px-3 py-2 text-sm text-slate-900 focus:ring-2 focus:ring-admin-primary/50",children:[a.jsx("option",{value:"60",children:"1 heure"}),a.jsx("option",{value:"480",children:"8 heures"}),a.jsx("option",{value:"1440",children:"24 heures"})]})]})]})]}),a.jsxs("section",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-100 bg-slate-50/80",children:a.jsxs("h2",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[a.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"notifications"}),"Notifications"]})}),a.jsx("div",{className:"p-6 space-y-4",children:a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-slate-900",children:"Alertes par email"}),a.jsx("p",{className:"text-xs text-slate-500",children:"Nouveaux documents, signalements, etc."})]}),a.jsx("button",{type:"button",role:"switch","aria-checked":!0,className:"relative inline-flex h-5 w-10 shrink-0 rounded-full border-2 bg-admin-primary border-admin-primary transition-colors",children:a.jsx("span",{className:"inline-block h-4 w-4 rounded-full bg-white shadow translate-x-5",style:{marginTop:2}})})]})})]}),a.jsxs("section",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-100 bg-slate-50/80",children:a.jsxs("h2",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[a.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"help"}),"Support & Admin"]})}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsx("p",{className:"text-sm text-slate-600",children:"Pour toute question technique ou demande d'accs, contactez l'quipe Tarikh.ma."}),a.jsxs("div",{className:"flex flex-wrap gap-3",children:[a.jsxs("a",{href:"mailto:admin@tarikh.ma",className:"inline-flex items-center gap-2 px-4 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-colors text-sm font-medium",children:[a.jsx("span",{className:"material-symbols-outlined text-lg",children:"mail"}),"Contacter l'admin"]}),a.jsxs(ie,{to:"/admin",className:"inline-flex items-center gap-2 px-4 py-2 bg-admin-primary/10 text-admin-primary rounded-lg hover:bg-admin-primary/20 transition-colors text-sm font-medium",children:[a.jsx("span",{className:"material-symbols-outlined text-lg",children:"dashboard"}),"Retour au tableau de bord"]})]})]})]})]})]})}):null}function $b(){const[u,e]=E.useState([]),[t,i]=E.useState(!0),[r,l]=E.useState(!1),[c,d]=E.useState(!1),[f,p]=E.useState(""),[m,x]=E.useState(""),[b,w]=E.useState(null),[y,N]=E.useState(!0),[_,j]=E.useState(0),S=async()=>{i(!0);try{const I=await ct.banners.list();e(I)}catch(I){console.error("Erreur bannires:",I)}finally{i(!1)}};E.useEffect(()=>{S()},[]);const P=async I=>{I.preventDefault(),d(!0);const $=new FormData;$.append("title",f),b&&$.append("image",b),m&&$.append("link_url",m),$.append("is_active",y?"1":"0"),$.append("order",String(_));try{await ct.banners.create($),l(!1),T(),S()}catch(te){alert(te.message||"Erreur lors de la cration")}finally{d(!1)}},k=async I=>{const $=new FormData;$.append("is_active",I.is_active?"0":"1");try{await ct.banners.update(I.id,$),S()}catch{alert("Erreur lors de la mise  jour")}},L=async I=>{if(confirm("Voulez-vous vraiment supprimer cette bannire ?"))try{await ct.banners.delete(I),S()}catch{alert("Erreur lors de la suppression")}},T=()=>{p(""),x(""),w(null),N(!0),j(0)};return a.jsxs("div",{className:"p-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-8",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Gestion des Bannires"}),a.jsx("p",{className:"text-slate-500",children:"Grez les publicits affiches sur la page d'accueil"})]}),a.jsxs("button",{onClick:()=>l(!0),className:"bg-primary text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-primary/90 transition-colors",children:[a.jsx("span",{className:"material-symbols-outlined",children:"add"}),"Nouvelle Bannire"]})]}),t?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(I=>a.jsx("div",{className:"h-48 bg-slate-100 animate-pulse rounded-xl"},I))}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[u.map(I=>a.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"h-32 bg-slate-100 relative",children:[a.jsx("img",{src:I.image_url,alt:I.title,className:"w-full h-full object-cover"}),a.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[a.jsx("button",{onClick:()=>k(I),className:`p-1.5 rounded-full backdrop-blur-md ${I.is_active?"bg-green-500/80 text-white":"bg-slate-500/80 text-white"}`,title:I.is_active?"Dsactiver":"Activer",children:a.jsx("span",{className:"material-symbols-outlined text-sm",children:I.is_active?"visibility":"visibility_off"})}),a.jsx("button",{onClick:()=>L(I.id),className:"p-1.5 bg-red-500/80 text-white rounded-full backdrop-blur-md",title:"Supprimer",children:a.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]}),a.jsxs("div",{className:"p-4",children:[a.jsx("h3",{className:"font-bold text-slate-800 truncate",children:I.title}),a.jsx("p",{className:"text-xs text-slate-500 truncate mb-3",children:I.link_url||"Aucun lien"}),a.jsxs("div",{className:"flex justify-between items-center text-xs",children:[a.jsxs("span",{className:"bg-slate-100 px-2 py-1 rounded text-slate-600",children:["Ordre: ",I.order]}),a.jsx("span",{className:I.is_active?"text-green-600 font-bold":"text-slate-400",children:I.is_active?"Active":"Inactive"})]})]})]},I.id)),u.length===0&&a.jsxs("div",{className:"col-span-full py-12 text-center bg-slate-50 rounded-xl border-2 border-dashed border-slate-200",children:[a.jsx("span",{className:"material-symbols-outlined text-4xl text-slate-300 mb-2",children:"ads_click"}),a.jsx("p",{className:"text-slate-500",children:"Aucune bannire configure"})]})]}),r&&a.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md overflow-hidden shadow-2xl",children:[a.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center",children:[a.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Ajouter une bannire"}),a.jsx("button",{onClick:()=>l(!1),className:"text-slate-400 hover:text-slate-600",children:a.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),a.jsxs("form",{onSubmit:P,className:"p-6 space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Titre"}),a.jsx("input",{type:"text",required:!0,value:f,onChange:I=>p(I.target.value),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary/20 outline-none",placeholder:"Ex: Exposition 2024"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Image (Recommand: 1200x300)"}),a.jsx("input",{type:"file",required:!0,accept:"image/*",onChange:I=>w(I.target.files?.[0]||null),className:"w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-primary/10 file:text-primary hover:file:bg-primary/20"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Lien de redirection (URL)"}),a.jsx("input",{type:"url",value:m,onChange:I=>x(I.target.value),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary/20 outline-none",placeholder:"https://..."})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Ordre"}),a.jsx("input",{type:"number",value:_,onChange:I=>j(Number(I.target.value)),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary/20 outline-none"})]}),a.jsx("div",{className:"flex flex-col justify-end",children:a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer py-2",children:[a.jsx("input",{type:"checkbox",checked:y,onChange:I=>N(I.target.checked),className:"w-4 h-4 text-primary rounded border-slate-300 focus:ring-primary"}),a.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Activer"})]})})]}),a.jsxs("div",{className:"pt-4 flex gap-3",children:[a.jsx("button",{type:"button",onClick:()=>l(!1),className:"flex-1 px-4 py-2 border border-slate-200 text-slate-600 rounded-lg hover:bg-slate-50 transition-colors",children:"Annuler"}),a.jsx("button",{type:"submit",disabled:c,className:"flex-1 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50",children:c?"Envoi...":"Enregistrer"})]})]})]})})]})}function Ub(){const[u,e]=E.useState([]),[t,i]=E.useState(!0),[r,l]=E.useState(1),[c,d]=E.useState(1),[f,p]=E.useState("pending_review"),[m,x]=E.useState({total:0,draft:0,pending:0,approved:0,rejected:0});E.useEffect(()=>{wn.stats().then(x).catch(()=>{})},[]),E.useEffect(()=>{i(!0),wn.list({page:r,per_page:10,status:f||void 0}).then(_=>{e(_.data),d(_.last_page)}).catch(()=>e([])).finally(()=>i(!1))},[r,f]);const b=async _=>{if(window.confirm("Approuver et publier cet article ?"))try{const j=await wn.approve(_);e(S=>S.map(P=>P.id===_?j.article:P)),x(S=>({...S,pending:S.pending-1,approved:S.approved+1}))}catch(j){alert(j instanceof Error?j.message:"Erreur")}},w=async _=>{const j=window.prompt("Motif du rejet :");if(j)try{const S=await wn.reject(_,j);e(P=>P.map(k=>k.id===_?S.article:k)),x(P=>({...P,pending:P.pending-1,rejected:P.rejected+1}))}catch(S){alert(S instanceof Error?S.message:"Erreur")}},y={draft:"bg-slate-100 text-slate-600",pending_review:"bg-amber-100 text-amber-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700"},N={draft:"Brouillon",pending_review:"En attente",approved:"Publi",rejected:"Rejet"};return a.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-10",children:[a.jsx("div",{className:"flex items-center justify-between mb-8",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-black text-slate-900 dark:text-white",children:"Articles"}),a.jsx("p",{className:"text-slate-500 mt-1",children:"Modrez les articles soumis par les contributeurs."})]})}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[a.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-4",children:[a.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:m.pending}),a.jsx("p",{className:"text-sm text-amber-600",children:"En attente"})]}),a.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-4",children:[a.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:m.approved}),a.jsx("p",{className:"text-sm text-green-600",children:"Publis"})]}),a.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-4",children:[a.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:m.rejected}),a.jsx("p",{className:"text-sm text-red-600",children:"Rejets"})]}),a.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 p-4",children:[a.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:m.total}),a.jsx("p",{className:"text-sm text-slate-500",children:"Total"})]})]}),a.jsx("div",{className:"flex gap-2 mb-6",children:["","pending_review","approved","rejected","draft"].map(_=>a.jsx("button",{type:"button",onClick:()=>{p(_),l(1)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${f===_?"bg-primary text-white":"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800"}`,children:_===""?"Tous":N[_]},_))}),a.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 overflow-hidden",children:t?a.jsx("div",{className:"p-8 text-center text-slate-500",children:"Chargement..."}):u.length===0?a.jsx("div",{className:"p-8 text-center text-slate-500",children:"Aucun article trouv."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-left",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-200 dark:border-slate-800",children:[a.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Titre"}),a.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Auteur"}),a.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Catgorie"}),a.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Statut"}),a.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Date"}),a.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Actions"})]})}),a.jsx("tbody",{children:u.map(_=>a.jsxs("tr",{className:"border-b border-slate-100 dark:border-slate-800 hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[a.jsx("td",{className:"p-4",children:a.jsx(ie,{to:`/admin/articles/${_.id}/review`,className:"font-medium text-primary hover:underline",children:_.title})}),a.jsx("td",{className:"p-4 text-sm text-slate-600 dark:text-slate-400",children:_.user?.name||"Inconnu"}),a.jsx("td",{className:"p-4 text-sm",children:_.category?.name||""}),a.jsx("td",{className:"p-4",children:a.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-bold ${y[_.status]}`,children:N[_.status]})}),a.jsx("td",{className:"p-4 text-sm text-slate-500",children:new Date(_.created_at).toLocaleDateString("fr-FR")}),a.jsx("td",{className:"p-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ie,{to:`/admin/articles/${_.id}/review`,className:"px-3 py-1.5 text-xs font-medium bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors",children:"Voir"}),_.status==="pending_review"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",onClick:()=>b(_.id),className:"px-3 py-1.5 text-xs font-medium bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors",children:"Approuver"}),a.jsx("button",{type:"button",onClick:()=>w(_.id),className:"px-3 py-1.5 text-xs font-medium bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors",children:"Rejeter"})]})]})})]},_.id))})]})})}),c>1&&a.jsxs("div",{className:"flex justify-center gap-2 mt-6",children:[a.jsx("button",{type:"button",onClick:()=>l(_=>Math.max(1,_-1)),disabled:r<=1,className:"px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 disabled:opacity-50",children:"Prcdent"}),a.jsxs("span",{className:"px-4 py-2 text-slate-600 dark:text-slate-400",children:["Page ",r," / ",c]}),a.jsx("button",{type:"button",onClick:()=>l(_=>Math.min(c,_+1)),disabled:r>=c,className:"px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 disabled:opacity-50",children:"Suivant"})]})]})}function Hb(){const{id:u}=vr(),e=cs(),[t,i]=E.useState(null),[r,l]=E.useState(!0),[c,d]=E.useState(!1);E.useEffect(()=>{u&&(l(!0),wn.show(parseInt(u,10)).then(i).catch(()=>e("/admin/articles")).finally(()=>l(!1)))},[u,e]);const f=async()=>{if(!(!t||!window.confirm("Approuver et publier cet article ?"))){d(!0);try{await wn.approve(t.id),alert("Article approuv et publi !"),e("/admin/articles")}catch(b){alert(b instanceof Error?b.message:"Erreur")}finally{d(!1)}}},p=async()=>{if(!t)return;const b=window.prompt("Motif du rejet :");if(b){d(!0);try{await wn.reject(t.id,b),alert("Article rejet."),e("/admin/articles")}catch(w){alert(w instanceof Error?w.message:"Erreur")}finally{d(!1)}}},m={draft:"bg-slate-100 text-slate-600",pending_review:"bg-amber-100 text-amber-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700"},x={draft:"Brouillon",pending_review:"En attente de validation",approved:"Publi",rejected:"Rejet"};return r?a.jsx("div",{className:"max-w-4xl mx-auto px-6 py-16 text-center text-slate-500",children:"Chargement..."}):t?a.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-10",children:[a.jsx("div",{className:"mb-6",children:a.jsxs(ie,{to:"/admin/articles",className:"text-primary font-medium hover:underline flex items-center gap-1",children:[a.jsx("span",{className:"material-symbols-outlined text-lg",children:"arrow_back"}),"Retour aux articles"]})}),a.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-black text-slate-900 dark:text-white mb-2",children:t.title}),a.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-500",children:[a.jsxs("span",{children:["Par ",a.jsx("strong",{children:t.user?.name||"Inconnu"})]}),a.jsx("span",{children:""}),a.jsx("span",{children:t.category?.name||"Sans catgorie"}),a.jsx("span",{children:""}),a.jsx("span",{children:new Date(t.created_at).toLocaleDateString("fr-FR")})]})]}),a.jsx("span",{className:`px-3 py-1.5 rounded-full text-sm font-bold ${m[t.status]}`,children:x[t.status]})]})}),t.cover_image_url&&a.jsx("div",{className:"border-b border-slate-100 dark:border-slate-800",children:a.jsx("img",{src:t.cover_image_url,alt:"Couverture",className:"w-full h-64 object-cover"})}),a.jsx("div",{className:"p-6",children:a.jsx("div",{className:"prose prose-slate dark:prose-invert max-w-none whitespace-pre-wrap",children:t.content})}),t.tags&&t.tags.length>0&&a.jsxs("div",{className:"px-6 pb-4",children:[a.jsx("p",{className:"text-sm font-bold text-slate-700 dark:text-slate-300 mb-2",children:"Mots-cls"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map((b,w)=>a.jsx("span",{className:"px-3 py-1 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 rounded-full text-sm",children:b},w))})]}),t.sources&&a.jsxs("div",{className:"px-6 pb-6",children:[a.jsx("p",{className:"text-sm font-bold text-slate-700 dark:text-slate-300 mb-2",children:"Sources"}),a.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 whitespace-pre-wrap",children:t.sources})]}),t.status==="rejected"&&t.admin_comment&&a.jsx("div",{className:"px-6 pb-6",children:a.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4",children:[a.jsx("p",{className:"font-bold text-red-700 dark:text-red-400 mb-1",children:"Motif du rejet"}),a.jsx("p",{className:"text-red-600 dark:text-red-300",children:t.admin_comment})]})}),t.status==="pending_review"&&a.jsxs("div",{className:"p-6 bg-slate-50 dark:bg-slate-800/50 border-t border-slate-100 dark:border-slate-800 flex items-center justify-end gap-4",children:[a.jsx("button",{type:"button",onClick:p,disabled:c,className:"px-6 py-3 rounded-xl bg-red-100 text-red-700 font-bold hover:bg-red-200 transition-colors disabled:opacity-50",children:"Rejeter"}),a.jsx("button",{type:"button",onClick:f,disabled:c,className:"px-6 py-3 rounded-xl bg-green-600 text-white font-bold hover:bg-green-700 transition-colors disabled:opacity-50",children:"Approuver et Publier"})]})]})]}):a.jsx("div",{className:"max-w-4xl mx-auto px-6 py-16 text-center text-slate-500",children:"Article non trouv."})}function Wb(){const[u,e]=E.useState([]),[t,i]=E.useState(!0);E.useEffect(()=>{Cs.myArticles({per_page:5}).then(d=>e(d.data)).catch(()=>e([])).finally(()=>i(!1))},[]);const r={draft:u.filter(d=>d.status==="draft").length,pending:u.filter(d=>d.status==="pending_review").length,approved:u.filter(d=>d.status==="approved").length,rejected:u.filter(d=>d.status==="rejected").length},l={draft:"bg-slate-100 text-slate-600",pending_review:"bg-amber-100 text-amber-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700"},c={draft:"Brouillon",pending_review:"En attente",approved:"Publi",rejected:"Rejet"};return a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-black text-slate-900 mb-2",children:"Tableau de bord"}),a.jsx("p",{className:"text-slate-500",children:"Grez vos articles et suivez leur statut de publication."})]}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:[a.jsx("div",{className:"flex items-center gap-3 mb-3",children:a.jsx("div",{className:"w-10 h-10 rounded-xl bg-slate-100 flex items-center justify-center",children:a.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"edit_note"})})}),a.jsx("p",{className:"text-2xl font-black text-slate-900",children:r.draft}),a.jsx("p",{className:"text-sm text-slate-500",children:"Brouillons"})]}),a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:[a.jsx("div",{className:"flex items-center gap-3 mb-3",children:a.jsx("div",{className:"w-10 h-10 rounded-xl bg-amber-100 flex items-center justify-center",children:a.jsx("span",{className:"material-symbols-outlined text-amber-600",children:"hourglass_top"})})}),a.jsx("p",{className:"text-2xl font-black text-slate-900",children:r.pending}),a.jsx("p",{className:"text-sm text-slate-500",children:"En attente"})]}),a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:[a.jsx("div",{className:"flex items-center gap-3 mb-3",children:a.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-100 flex items-center justify-center",children:a.jsx("span",{className:"material-symbols-outlined text-green-600",children:"check_circle"})})}),a.jsx("p",{className:"text-2xl font-black text-slate-900",children:r.approved}),a.jsx("p",{className:"text-sm text-slate-500",children:"Publis"})]}),a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6",children:[a.jsx("div",{className:"flex items-center gap-3 mb-3",children:a.jsx("div",{className:"w-10 h-10 rounded-xl bg-red-100 flex items-center justify-center",children:a.jsx("span",{className:"material-symbols-outlined text-red-600",children:"cancel"})})}),a.jsx("p",{className:"text-2xl font-black text-slate-900",children:r.rejected}),a.jsx("p",{className:"text-sm text-slate-500",children:"Rejets"})]})]}),a.jsx("div",{className:"bg-gradient-to-r from-accent-gold/10 to-accent-gold/5 rounded-2xl p-8 border border-accent-gold/20",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"Partagez votre savoir"}),a.jsx("p",{className:"text-slate-600",children:"Rdigez un article et contribuez  la prservation de notre histoire."})]}),a.jsxs(ie,{to:"/dashboard/articles/new",className:"bg-accent-gold text-white px-6 py-3 rounded-xl font-bold hover:bg-accent-gold/90 transition-colors flex items-center gap-2",children:[a.jsx("span",{className:"material-symbols-outlined",children:"add"}),"Nouvel article"]})]})}),a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 overflow-hidden",children:[a.jsxs("div",{className:"p-6 border-b border-slate-100 flex items-center justify-between",children:[a.jsx("h3",{className:"font-bold text-slate-900",children:"Mes derniers articles"}),a.jsx(ie,{to:"/dashboard/articles",className:"text-sm text-accent-gold font-medium hover:underline",children:"Voir tout"})]}),t?a.jsx("div",{className:"p-8 text-center text-slate-500",children:"Chargement..."}):u.length===0?a.jsxs("div",{className:"p-8 text-center text-slate-500",children:[a.jsx("p",{children:"Vous n'avez pas encore d'articles."}),a.jsx(ie,{to:"/dashboard/articles/new",className:"text-accent-gold font-medium hover:underline mt-2 inline-block",children:"Crer votre premier article"})]}):a.jsx("div",{className:"divide-y divide-slate-100",children:u.slice(0,5).map(d=>a.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-slate-50 transition-colors",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-slate-900 truncate",children:d.title}),a.jsx("p",{className:"text-sm text-slate-500",children:new Date(d.created_at).toLocaleDateString("fr-FR")})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${l[d.status]}`,children:c[d.status]}),a.jsx(ie,{to:`/dashboard/articles/${d.id}/edit`,className:"text-slate-400 hover:text-accent-gold transition-colors",children:a.jsx("span",{className:"material-symbols-outlined",children:"edit"})})]})]},d.id))})]})]})}function Gb(){const[u,e]=E.useState([]),[t,i]=E.useState(!0),[r,l]=E.useState(1),[c,d]=E.useState(1),[f,p]=E.useState("");E.useEffect(()=>{i(!0),Cs.myArticles({page:r,per_page:10,status:f||void 0}).then(y=>{e(y.data),d(y.last_page)}).catch(()=>e([])).finally(()=>i(!1))},[r,f]);const m=async(y,N)=>{if(window.confirm(`Supprimer  ${N}  ?`))try{await Cs.delete(y),e(_=>_.filter(j=>j.id!==y))}catch(_){alert(_ instanceof Error?_.message:"Erreur lors de la suppression")}},x=async y=>{if(window.confirm("Soumettre cet article pour validation ?"))try{const N=await Cs.submit(y);e(_=>_.map(j=>j.id===y?N.article:j))}catch(N){alert(N instanceof Error?N.message:"Erreur lors de la soumission")}},b={draft:"bg-slate-100 text-slate-600",pending_review:"bg-amber-100 text-amber-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700"},w={draft:"Brouillon",pending_review:"En attente",approved:"Publi",rejected:"Rejet"};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-black text-slate-900 mb-1",children:"Mes articles"}),a.jsx("p",{className:"text-slate-500 text-sm",children:"Grez et suivez vos contributions."})]}),a.jsxs(ie,{to:"/dashboard/articles/new",className:"bg-accent-gold text-white px-5 py-2.5 rounded-xl font-bold hover:bg-accent-gold/90 transition-colors flex items-center gap-2",children:[a.jsx("span",{className:"material-symbols-outlined text-lg",children:"add"}),"Nouvel article"]})]}),a.jsx("div",{className:"flex gap-2",children:["","draft","pending_review","approved","rejected"].map(y=>a.jsx("button",{type:"button",onClick:()=>{p(y),l(1)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${f===y?"bg-accent-gold text-white":"bg-white border border-slate-200 text-slate-600 hover:bg-slate-50"}`,children:y===""?"Tous":w[y]},y))}),a.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 overflow-hidden",children:t?a.jsx("div",{className:"p-8 text-center text-slate-500",children:"Chargement..."}):u.length===0?a.jsx("div",{className:"p-8 text-center text-slate-500",children:a.jsx("p",{children:"Aucun article trouv."})}):a.jsx("div",{className:"divide-y divide-slate-100",children:u.map(y=>a.jsxs("div",{className:"p-5 flex items-start gap-4 hover:bg-slate-50 transition-colors",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[a.jsx("h4",{className:"font-bold text-slate-900 truncate",children:y.title}),a.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-bold ${b[y.status]}`,children:w[y.status]})]}),a.jsxs("p",{className:"text-sm text-slate-500 mb-2",children:[y.category?.name||"Sans catgorie","  ",new Date(y.created_at).toLocaleDateString("fr-FR")]}),y.status==="rejected"&&y.admin_comment&&a.jsxs("div",{className:"bg-red-50 border border-red-100 rounded-lg p-3 text-sm text-red-700",children:[a.jsx("strong",{children:"Motif du rejet :"})," ",y.admin_comment]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[y.status==="draft"&&a.jsx("button",{type:"button",onClick:()=>x(y.id),className:"px-3 py-1.5 bg-accent-gold/10 text-accent-gold rounded-lg text-sm font-medium hover:bg-accent-gold/20 transition-colors",children:"Soumettre"}),(y.status==="draft"||y.status==="rejected")&&a.jsx(ie,{to:`/dashboard/articles/${y.id}/edit`,className:"p-2 text-slate-400 hover:text-accent-gold transition-colors",children:a.jsx("span",{className:"material-symbols-outlined",children:"edit"})}),y.status==="draft"&&a.jsx("button",{type:"button",onClick:()=>m(y.id,y.title),className:"p-2 text-slate-400 hover:text-red-500 transition-colors",children:a.jsx("span",{className:"material-symbols-outlined",children:"delete"})}),y.status==="approved"&&a.jsx(ie,{to:`/articles/${y.slug}`,className:"p-2 text-slate-400 hover:text-accent-gold transition-colors",title:"Voir l'article publi",children:a.jsx("span",{className:"material-symbols-outlined",children:"visibility"})})]})]},y.id))})}),c>1&&a.jsxs("div",{className:"flex justify-center gap-2",children:[a.jsx("button",{type:"button",onClick:()=>l(y=>Math.max(1,y-1)),disabled:r<=1,className:"px-4 py-2 rounded-lg border border-slate-200 disabled:opacity-50",children:"Prcdent"}),a.jsxs("span",{className:"px-4 py-2 text-slate-600",children:["Page ",r," / ",c]}),a.jsx("button",{type:"button",onClick:()=>l(y=>Math.min(c,y+1)),disabled:r>=c,className:"px-4 py-2 rounded-lg border border-slate-200 disabled:opacity-50",children:"Suivant"})]})]})}function Df(){const{id:u}=vr(),e=cs(),t=!!u,[i,r]=E.useState(t),[l,c]=E.useState(!1),[d,f]=E.useState([]),[p,m]=E.useState(""),[x,b]=E.useState(""),[w,y]=E.useState(""),[N,_]=E.useState(""),[j,S]=E.useState(""),[P,k]=E.useState(null),[L,T]=E.useState(null),[I,$]=E.useState(null);E.useEffect(()=>{Cs.categories().then(f).catch(()=>{})},[]),E.useEffect(()=>{t&&u&&(r(!0),Cs.show(parseInt(u,10)).then(ne=>{$(ne),m(ne.title),b(ne.content),y(ne.category_id||""),_(ne.tags?.join(", ")||""),S(ne.sources||""),T(ne.cover_image_url)}).catch(()=>e("/dashboard/articles")).finally(()=>r(!1)))},[u,t,e]);const te=E.useCallback(ne=>{const se=ne.target.files?.[0];se&&(k(se),T(URL.createObjectURL(se)))},[]),oe=async(ne=!1)=>{if(!p.trim()||!x.trim()){alert("Le titre et le contenu sont requis.");return}c(!0);try{const se=new FormData;se.append("title",p),se.append("content",x),w&&se.append("category_id",String(w)),N.trim()&&N.split(",").map(Se=>Se.trim()).filter(Boolean).forEach((Se,X)=>{se.append(`tags[${X}]`,Se)}),j&&se.append("sources",j),P&&se.append("cover",P);let xe;t&&u?xe=await Cs.update(parseInt(u,10),se):xe=await Cs.create(se),ne?(await Cs.submit(xe.id),alert("Article soumis pour validation !")):alert(t?"Article mis  jour !":"Brouillon enregistr !"),e("/dashboard/articles")}catch(se){alert(se instanceof Error?se.message:"Erreur lors de la sauvegarde")}finally{c(!1)}};if(i)return a.jsx("div",{className:"text-center py-12 text-slate-500",children:"Chargement..."});const ae=!t||I?.status==="draft"||I?.status==="rejected";return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-black text-slate-900 mb-1",children:t?"Modifier l'article":"Nouvel article"}),a.jsx("p",{className:"text-slate-500 text-sm",children:t?"Modifiez et mettez  jour votre article.":"Rdigez un nouvel article historique."})]})}),I?.status==="rejected"&&I.admin_comment&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:[a.jsx("p",{className:"font-bold text-red-700 mb-1",children:"Motif du rejet"}),a.jsx("p",{className:"text-red-600",children:I.admin_comment})]}),a.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"title",className:"block text-sm font-bold text-slate-700 mb-2",children:"Titre *"}),a.jsx("input",{id:"title",type:"text",value:p,onChange:ne=>m(ne.target.value),disabled:!ae,placeholder:"Ex: Les dynasties marocaines au Moyen ge",className:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-accent-gold focus:ring-2 focus:ring-accent-gold/20 outline-none disabled:bg-slate-100"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"category",className:"block text-sm font-bold text-slate-700 mb-2",children:"Catgorie"}),a.jsxs("select",{id:"category",value:w,onChange:ne=>y(ne.target.value?parseInt(ne.target.value,10):""),disabled:!ae,className:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-accent-gold focus:ring-2 focus:ring-accent-gold/20 outline-none disabled:bg-slate-100",children:[a.jsx("option",{value:"",children:"Slectionner une catgorie"}),d.map(ne=>a.jsx("option",{value:ne.id,children:ne.name},ne.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"content",className:"block text-sm font-bold text-slate-700 mb-2",children:"Contenu *"}),a.jsx("textarea",{id:"content",value:x,onChange:ne=>b(ne.target.value),disabled:!ae,rows:15,placeholder:"Rdigez votre article ici. Vous pouvez utiliser le format Markdown pour la mise en forme.",className:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-accent-gold focus:ring-2 focus:ring-accent-gold/20 outline-none disabled:bg-slate-100 font-mono text-sm"}),a.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Astuce : utilisez **gras**, *italique*, # titre, - liste pour formater votre texte."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"Image de couverture"}),a.jsxs("div",{className:"flex items-start gap-4",children:[L&&a.jsx("img",{src:L,alt:"Aperu",className:"w-32 h-20 object-cover rounded-lg border border-slate-200"}),a.jsx("input",{type:"file",accept:"image/*",onChange:te,disabled:!ae,className:"text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-accent-gold/10 file:text-accent-gold file:font-medium hover:file:bg-accent-gold/20 file:cursor-pointer"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"tags",className:"block text-sm font-bold text-slate-700 mb-2",children:"Mots-cls"}),a.jsx("input",{id:"tags",type:"text",value:N,onChange:ne=>_(ne.target.value),disabled:!ae,placeholder:"Ex: Marrakech, Almohades, Architecture (spars par des virgules)",className:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-accent-gold focus:ring-2 focus:ring-accent-gold/20 outline-none disabled:bg-slate-100"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"sources",className:"block text-sm font-bold text-slate-700 mb-2",children:"Rfrences / Sources"}),a.jsx("textarea",{id:"sources",value:j,onChange:ne=>S(ne.target.value),disabled:!ae,rows:3,placeholder:"Listez vos sources et rfrences bibliographiques...",className:"w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-accent-gold focus:ring-2 focus:ring-accent-gold/20 outline-none disabled:bg-slate-100"})]})]}),ae&&a.jsxs("div",{className:"flex items-center justify-end gap-4",children:[a.jsx("button",{type:"button",onClick:()=>e("/dashboard/articles"),className:"px-6 py-3 rounded-xl border border-slate-200 text-slate-600 font-medium hover:bg-slate-50 transition-colors",children:"Annuler"}),a.jsx("button",{type:"button",onClick:()=>oe(!1),disabled:l,className:"px-6 py-3 rounded-xl border border-accent-gold/30 bg-accent-gold/10 text-accent-gold font-bold hover:bg-accent-gold/20 transition-colors disabled:opacity-50",children:l?"Sauvegarde...":"Sauvegarder brouillon"}),a.jsx("button",{type:"button",onClick:()=>oe(!0),disabled:l,className:"px-6 py-3 rounded-xl bg-accent-gold text-white font-bold hover:bg-accent-gold/90 transition-colors disabled:opacity-50",children:l?"Envoi...":"Soumettre pour validation"})]})]})}function qb(){const u=Ut(e=>e.loadUser);return E.useEffect(()=>{u()},[u]),a.jsxs(jx,{children:[a.jsx(De,{path:"/documents/:id",element:a.jsx(r0,{}),children:a.jsx(De,{index:!0,element:a.jsx(kb,{})})}),a.jsxs(De,{path:"/dashboard",element:a.jsx(l0,{}),children:[a.jsx(De,{index:!0,element:a.jsx(Wb,{})}),a.jsx(De,{path:"articles",element:a.jsx(Gb,{})}),a.jsx(De,{path:"articles/new",element:a.jsx(Df,{})}),a.jsx(De,{path:"articles/:id/edit",element:a.jsx(Df,{})})]}),a.jsxs(De,{path:"/admin",element:a.jsx(a0,{}),children:[a.jsx(De,{index:!0,element:a.jsx(Lb,{})}),a.jsx(De,{path:"documents",element:a.jsx(Mb,{})}),a.jsx(De,{path:"documents/new",element:a.jsx(Lf,{})}),a.jsx(De,{path:"documents/:id/edit",element:a.jsx(Lf,{})}),a.jsx(De,{path:"articles",element:a.jsx(Ub,{})}),a.jsx(De,{path:"articles/:id/review",element:a.jsx(Hb,{})}),a.jsx(De,{path:"users",element:a.jsx(Ob,{})}),a.jsx(De,{path:"users/new",element:a.jsx(If,{})}),a.jsx(De,{path:"users/:id/edit",element:a.jsx(If,{})}),a.jsx(De,{path:"banners",element:a.jsx($b,{})}),a.jsx(De,{path:"parametres",element:a.jsx(Bb,{})})]}),a.jsxs(De,{path:"/",element:a.jsx(i0,{}),children:[a.jsx(De,{index:!0,element:a.jsx(d0,{})}),a.jsx(De,{path:"a-propos",element:a.jsx(u0,{})}),a.jsx(De,{path:"contribuer",element:a.jsx(h0,{})}),a.jsx(De,{path:"archives",element:a.jsx(m0,{})}),a.jsx(De,{path:"login",element:a.jsx(f0,{})}),a.jsx(De,{path:"register",element:a.jsx(p0,{})})]}),a.jsx(De,{path:"*",element:a.jsx(_x,{to:"/",replace:!0})})]})}Lg.createRoot(document.getElementById("root")).render(a.jsx(Lc.StrictMode,{children:a.jsx(Mx,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:a.jsx(qb,{})})}));
