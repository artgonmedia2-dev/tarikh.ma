var Dh=u=>{throw TypeError(u)};var Xl=(u,e,t)=>e.has(u)||Dh("Cannot "+t);var rs=(u,e,t)=>(Xl(u,e,"read from private field"),t?t.call(u):e.get(u)),Qn=(u,e,t)=>e.has(u)?Dh("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(u):e.set(u,t),Ji=(u,e,t,i)=>(Xl(u,e,"write to private field"),i?i.call(u,t):e.set(u,t),t),ja=(u,e,t)=>(Xl(u,e,"access private method"),t);var Fh=(u,e,t,i)=>({set _(r){Ji(u,e,r,t)},get _(){return rs(u,e,i)}});function yg(u,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in u)){const a=Object.getOwnPropertyDescriptor(i,r);a&&Object.defineProperty(u,r,a.get?a:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();function jc(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var Yl={exports:{}},Zi={},Kl={exports:{}},je={};var Oh;function wg(){if(Oh)return je;Oh=1;var u=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.iterator;function b(V){return V===null||typeof V!="object"?null:(V=x&&V[x]||V["@@iterator"],typeof V=="function"?V:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,w={};function S(V,z,ie){this.props=V,this.context=z,this.refs=w,this.updater=ie||y}S.prototype.isReactComponent={},S.prototype.setState=function(V,z){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,z,"setState")},S.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function N(){}N.prototype=S.prototype;function C(V,z,ie){this.props=V,this.context=z,this.refs=w,this.updater=ie||y}var R=C.prototype=new N;R.constructor=C,A(R,S.prototype),R.isPureReactComponent=!0;var E=Array.isArray,L=Object.prototype.hasOwnProperty,T={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function $(V,z,ie){var ge,U={},B=null,ee=null;if(z!=null)for(ge in z.ref!==void 0&&(ee=z.ref),z.key!==void 0&&(B=""+z.key),z)L.call(z,ge)&&!I.hasOwnProperty(ge)&&(U[ge]=z[ge]);var K=arguments.length-2;if(K===1)U.children=ie;else if(1<K){for(var ce=Array(K),Me=0;Me<K;Me++)ce[Me]=arguments[Me+2];U.children=ce}if(V&&V.defaultProps)for(ge in K=V.defaultProps,K)U[ge]===void 0&&(U[ge]=K[ge]);return{$$typeof:u,type:V,key:B,ref:ee,props:U,_owner:T.current}}function te(V,z){return{$$typeof:u,type:V.type,key:z,ref:V.ref,props:V.props,_owner:V._owner}}function ae(V){return typeof V=="object"&&V!==null&&V.$$typeof===u}function de(V){var z={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(ie){return z[ie]})}var Ae=/\/+/g;function pe(V,z){return typeof V=="object"&&V!==null&&V.key!=null?de(""+V.key):z.toString(36)}function be(V,z,ie,ge,U){var B=typeof V;(B==="undefined"||B==="boolean")&&(V=null);var ee=!1;if(V===null)ee=!0;else switch(B){case"string":case"number":ee=!0;break;case"object":switch(V.$$typeof){case u:case e:ee=!0}}if(ee)return ee=V,U=U(ee),V=ge===""?"."+pe(ee,0):ge,E(U)?(ie="",V!=null&&(ie=V.replace(Ae,"$&/")+"/"),be(U,z,ie,"",function(Me){return Me})):U!=null&&(ae(U)&&(U=te(U,ie+(!U.key||ee&&ee.key===U.key?"":(""+U.key).replace(Ae,"$&/")+"/")+V)),z.push(U)),1;if(ee=0,ge=ge===""?".":ge+":",E(V))for(var K=0;K<V.length;K++){B=V[K];var ce=ge+pe(B,K);ee+=be(B,z,ie,ce,U)}else if(ce=b(V),typeof ce=="function")for(V=ce.call(V),K=0;!(B=V.next()).done;)B=B.value,ce=ge+pe(B,K++),ee+=be(B,z,ie,ce,U);else if(B==="object")throw z=String(V),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.");return ee}function ke(V,z,ie){if(V==null)return V;var ge=[],U=0;return be(V,ge,"","",function(B){return z.call(ie,B,U++)}),ge}function X(V){if(V._status===-1){var z=V._result;z=z(),z.then(function(ie){(V._status===0||V._status===-1)&&(V._status=1,V._result=ie)},function(ie){(V._status===0||V._status===-1)&&(V._status=2,V._result=ie)}),V._status===-1&&(V._status=0,V._result=z)}if(V._status===1)return V._result.default;throw V._result}var Z={current:null},q={transition:null},se={ReactCurrentDispatcher:Z,ReactCurrentBatchConfig:q,ReactCurrentOwner:T};function Q(){throw Error("act(...) is not supported in production builds of React.")}return je.Children={map:ke,forEach:function(V,z,ie){ke(V,function(){z.apply(this,arguments)},ie)},count:function(V){var z=0;return ke(V,function(){z++}),z},toArray:function(V){return ke(V,function(z){return z})||[]},only:function(V){if(!ae(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},je.Component=S,je.Fragment=t,je.Profiler=r,je.PureComponent=C,je.StrictMode=i,je.Suspense=f,je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=se,je.act=Q,je.cloneElement=function(V,z,ie){if(V==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+V+".");var ge=A({},V.props),U=V.key,B=V.ref,ee=V._owner;if(z!=null){if(z.ref!==void 0&&(B=z.ref,ee=T.current),z.key!==void 0&&(U=""+z.key),V.type&&V.type.defaultProps)var K=V.type.defaultProps;for(ce in z)L.call(z,ce)&&!I.hasOwnProperty(ce)&&(ge[ce]=z[ce]===void 0&&K!==void 0?K[ce]:z[ce])}var ce=arguments.length-2;if(ce===1)ge.children=ie;else if(1<ce){K=Array(ce);for(var Me=0;Me<ce;Me++)K[Me]=arguments[Me+2];ge.children=K}return{$$typeof:u,type:V.type,key:U,ref:B,props:ge,_owner:ee}},je.createContext=function(V){return V={$$typeof:c,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},V.Provider={$$typeof:a,_context:V},V.Consumer=V},je.createElement=$,je.createFactory=function(V){var z=$.bind(null,V);return z.type=V,z},je.createRef=function(){return{current:null}},je.forwardRef=function(V){return{$$typeof:d,render:V}},je.isValidElement=ae,je.lazy=function(V){return{$$typeof:m,_payload:{_status:-1,_result:V},_init:X}},je.memo=function(V,z){return{$$typeof:p,type:V,compare:z===void 0?null:z}},je.startTransition=function(V){var z=q.transition;q.transition={};try{V()}finally{q.transition=z}},je.unstable_act=Q,je.useCallback=function(V,z){return Z.current.useCallback(V,z)},je.useContext=function(V){return Z.current.useContext(V)},je.useDebugValue=function(){},je.useDeferredValue=function(V){return Z.current.useDeferredValue(V)},je.useEffect=function(V,z){return Z.current.useEffect(V,z)},je.useId=function(){return Z.current.useId()},je.useImperativeHandle=function(V,z,ie){return Z.current.useImperativeHandle(V,z,ie)},je.useInsertionEffect=function(V,z){return Z.current.useInsertionEffect(V,z)},je.useLayoutEffect=function(V,z){return Z.current.useLayoutEffect(V,z)},je.useMemo=function(V,z){return Z.current.useMemo(V,z)},je.useReducer=function(V,z,ie){return Z.current.useReducer(V,z,ie)},je.useRef=function(V){return Z.current.useRef(V)},je.useState=function(V){return Z.current.useState(V)},je.useSyncExternalStore=function(V,z,ie){return Z.current.useSyncExternalStore(V,z,ie)},je.useTransition=function(){return Z.current.useTransition()},je.version="18.3.1",je}var zh;function mr(){return zh||(zh=1,Kl.exports=wg()),Kl.exports}var Bh;function Ag(){if(Bh)return Zi;Bh=1;var u=mr(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function c(d,f,p){var m,x={},b=null,y=null;p!==void 0&&(b=""+p),f.key!==void 0&&(b=""+f.key),f.ref!==void 0&&(y=f.ref);for(m in f)i.call(f,m)&&!a.hasOwnProperty(m)&&(x[m]=f[m]);if(d&&d.defaultProps)for(m in f=d.defaultProps,f)x[m]===void 0&&(x[m]=f[m]);return{$$typeof:e,type:d,key:b,ref:y,props:x,_owner:r.current}}return Zi.Fragment=t,Zi.jsx=c,Zi.jsxs=c,Zi}var Uh;function _g(){return Uh||(Uh=1,Yl.exports=Ag()),Yl.exports}var l=_g(),j=mr();const Cc=jc(j),Sg=yg({__proto__:null,default:Cc},[j]);var Ca={},Ql={exports:{}},Rt={},Jl={exports:{}},Zl={};var Hh;function Ng(){return Hh||(Hh=1,(function(u){function e(q,se){var Q=q.length;q.push(se);e:for(;0<Q;){var V=Q-1>>>1,z=q[V];if(0<r(z,se))q[V]=se,q[Q]=z,Q=V;else break e}}function t(q){return q.length===0?null:q[0]}function i(q){if(q.length===0)return null;var se=q[0],Q=q.pop();if(Q!==se){q[0]=Q;e:for(var V=0,z=q.length,ie=z>>>1;V<ie;){var ge=2*(V+1)-1,U=q[ge],B=ge+1,ee=q[B];if(0>r(U,Q))B<z&&0>r(ee,U)?(q[V]=ee,q[B]=Q,V=B):(q[V]=U,q[ge]=Q,V=ge);else if(B<z&&0>r(ee,Q))q[V]=ee,q[B]=Q,V=B;else break e}}return se}function r(q,se){var Q=q.sortIndex-se.sortIndex;return Q!==0?Q:q.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;u.unstable_now=function(){return a.now()}}else{var c=Date,d=c.now();u.unstable_now=function(){return c.now()-d}}var f=[],p=[],m=1,x=null,b=3,y=!1,A=!1,w=!1,S=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(q){for(var se=t(p);se!==null;){if(se.callback===null)i(p);else if(se.startTime<=q)i(p),se.sortIndex=se.expirationTime,e(f,se);else break;se=t(p)}}function E(q){if(w=!1,R(q),!A)if(t(f)!==null)A=!0,X(L);else{var se=t(p);se!==null&&Z(E,se.startTime-q)}}function L(q,se){A=!1,w&&(w=!1,N($),$=-1),y=!0;var Q=b;try{for(R(se),x=t(f);x!==null&&(!(x.expirationTime>se)||q&&!de());){var V=x.callback;if(typeof V=="function"){x.callback=null,b=x.priorityLevel;var z=V(x.expirationTime<=se);se=u.unstable_now(),typeof z=="function"?x.callback=z:x===t(f)&&i(f),R(se)}else i(f);x=t(f)}if(x!==null)var ie=!0;else{var ge=t(p);ge!==null&&Z(E,ge.startTime-se),ie=!1}return ie}finally{x=null,b=Q,y=!1}}var T=!1,I=null,$=-1,te=5,ae=-1;function de(){return!(u.unstable_now()-ae<te)}function Ae(){if(I!==null){var q=u.unstable_now();ae=q;var se=!0;try{se=I(!0,q)}finally{se?pe():(T=!1,I=null)}}else T=!1}var pe;if(typeof C=="function")pe=function(){C(Ae)};else if(typeof MessageChannel<"u"){var be=new MessageChannel,ke=be.port2;be.port1.onmessage=Ae,pe=function(){ke.postMessage(null)}}else pe=function(){S(Ae,0)};function X(q){I=q,T||(T=!0,pe())}function Z(q,se){$=S(function(){q(u.unstable_now())},se)}u.unstable_IdlePriority=5,u.unstable_ImmediatePriority=1,u.unstable_LowPriority=4,u.unstable_NormalPriority=3,u.unstable_Profiling=null,u.unstable_UserBlockingPriority=2,u.unstable_cancelCallback=function(q){q.callback=null},u.unstable_continueExecution=function(){A||y||(A=!0,X(L))},u.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):te=0<q?Math.floor(1e3/q):5},u.unstable_getCurrentPriorityLevel=function(){return b},u.unstable_getFirstCallbackNode=function(){return t(f)},u.unstable_next=function(q){switch(b){case 1:case 2:case 3:var se=3;break;default:se=b}var Q=b;b=se;try{return q()}finally{b=Q}},u.unstable_pauseExecution=function(){},u.unstable_requestPaint=function(){},u.unstable_runWithPriority=function(q,se){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var Q=b;b=q;try{return se()}finally{b=Q}},u.unstable_scheduleCallback=function(q,se,Q){var V=u.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?V+Q:V):Q=V,q){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=Q+z,q={id:m++,callback:se,priorityLevel:q,startTime:Q,expirationTime:z,sortIndex:-1},Q>V?(q.sortIndex=Q,e(p,q),t(f)===null&&q===t(p)&&(w?(N($),$=-1):w=!0,Z(E,Q-V))):(q.sortIndex=z,e(f,q),A||y||(A=!0,X(L))),q},u.unstable_shouldYield=de,u.unstable_wrapCallback=function(q){var se=b;return function(){var Q=b;b=se;try{return q.apply(this,arguments)}finally{b=Q}}}})(Zl)),Zl}var $h;function Eg(){return $h||($h=1,Jl.exports=Ng()),Jl.exports}var Gh;function kg(){if(Gh)return Rt;Gh=1;var u=mr(),e=Eg();function t(s){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+s,o=1;o<arguments.length;o++)n+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+s+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function a(s,n){c(s,n),c(s+"Capture",n)}function c(s,n){for(r[s]=n,s=0;s<n.length;s++)i.add(n[s])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},x={};function b(s){return f.call(x,s)?!0:f.call(m,s)?!1:p.test(s)?x[s]=!0:(m[s]=!0,!1)}function y(s,n,o,h){if(o!==null&&o.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return h?!1:o!==null?!o.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function A(s,n,o,h){if(n===null||typeof n>"u"||y(s,n,o,h))return!0;if(h)return!1;if(o!==null)switch(o.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function w(s,n,o,h,g,v,_){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=h,this.attributeNamespace=g,this.mustUseProperty=o,this.propertyName=s,this.type=n,this.sanitizeURL=v,this.removeEmptyString=_}var S={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){S[s]=new w(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var n=s[0];S[n]=new w(n,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){S[s]=new w(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){S[s]=new w(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){S[s]=new w(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){S[s]=new w(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){S[s]=new w(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){S[s]=new w(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){S[s]=new w(s,5,!1,s.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function C(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var n=s.replace(N,C);S[n]=new w(n,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var n=s.replace(N,C);S[n]=new w(n,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var n=s.replace(N,C);S[n]=new w(n,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){S[s]=new w(s,1,!1,s.toLowerCase(),null,!1,!1)}),S.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){S[s]=new w(s,1,!1,s.toLowerCase(),null,!0,!0)});function R(s,n,o,h){var g=S.hasOwnProperty(n)?S[n]:null;(g!==null?g.type!==0:h||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(A(n,o,g,h)&&(o=null),h||g===null?b(n)&&(o===null?s.removeAttribute(n):s.setAttribute(n,""+o)):g.mustUseProperty?s[g.propertyName]=o===null?g.type===3?!1:"":o:(n=g.attributeName,h=g.attributeNamespace,o===null?s.removeAttribute(n):(g=g.type,o=g===3||g===4&&o===!0?"":""+o,h?s.setAttributeNS(h,n,o):s.setAttribute(n,o))))}var E=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,L=Symbol.for("react.element"),T=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),$=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),ae=Symbol.for("react.provider"),de=Symbol.for("react.context"),Ae=Symbol.for("react.forward_ref"),pe=Symbol.for("react.suspense"),be=Symbol.for("react.suspense_list"),ke=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),Z=Symbol.for("react.offscreen"),q=Symbol.iterator;function se(s){return s===null||typeof s!="object"?null:(s=q&&s[q]||s["@@iterator"],typeof s=="function"?s:null)}var Q=Object.assign,V;function z(s){if(V===void 0)try{throw Error()}catch(o){var n=o.stack.trim().match(/\n( *(at )?)/);V=n&&n[1]||""}return`
`+V+s}var ie=!1;function ge(s,n){if(!s||ie)return"";ie=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(O){var h=O}Reflect.construct(s,[],n)}else{try{n.call()}catch(O){h=O}s.call(n.prototype)}else{try{throw Error()}catch(O){h=O}s()}}catch(O){if(O&&h&&typeof O.stack=="string"){for(var g=O.stack.split(`
`),v=h.stack.split(`
`),_=g.length-1,k=v.length-1;1<=_&&0<=k&&g[_]!==v[k];)k--;for(;1<=_&&0<=k;_--,k--)if(g[_]!==v[k]){if(_!==1||k!==1)do if(_--,k--,0>k||g[_]!==v[k]){var P=`
`+g[_].replace(" at new "," at ");return s.displayName&&P.includes("<anonymous>")&&(P=P.replace("<anonymous>",s.displayName)),P}while(1<=_&&0<=k);break}}}finally{ie=!1,Error.prepareStackTrace=o}return(s=s?s.displayName||s.name:"")?z(s):""}function U(s){switch(s.tag){case 5:return z(s.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return s=ge(s.type,!1),s;case 11:return s=ge(s.type.render,!1),s;case 1:return s=ge(s.type,!0),s;default:return""}}function B(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case I:return"Fragment";case T:return"Portal";case te:return"Profiler";case $:return"StrictMode";case pe:return"Suspense";case be:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case de:return(s.displayName||"Context")+".Consumer";case ae:return(s._context.displayName||"Context")+".Provider";case Ae:var n=s.render;return s=s.displayName,s||(s=n.displayName||n.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case ke:return n=s.displayName||null,n!==null?n:B(s.type)||"Memo";case X:n=s._payload,s=s._init;try{return B(s(n))}catch{}}return null}function ee(s){var n=s.type;switch(s.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=n.render,s=s.displayName||s.name||"",n.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(n);case 8:return n===$?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function K(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ce(s){var n=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function Me(s){var n=ce(s)?"checked":"value",o=Object.getOwnPropertyDescriptor(s.constructor.prototype,n),h=""+s[n];if(!s.hasOwnProperty(n)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var g=o.get,v=o.set;return Object.defineProperty(s,n,{configurable:!0,get:function(){return g.call(this)},set:function(_){h=""+_,v.call(this,_)}}),Object.defineProperty(s,n,{enumerable:o.enumerable}),{getValue:function(){return h},setValue:function(_){h=""+_},stopTracking:function(){s._valueTracker=null,delete s[n]}}}}function yt(s){s._valueTracker||(s._valueTracker=Me(s))}function dt(s){if(!s)return!1;var n=s._valueTracker;if(!n)return!0;var o=n.getValue(),h="";return s&&(h=ce(s)?s.checked?"true":"false":s.value),s=h,s!==o?(n.setValue(s),!0):!1}function wt(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Ut(s,n){var o=n.checked;return Q({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??s._wrapperState.initialChecked})}function rn(s,n){var o=n.defaultValue==null?"":n.defaultValue,h=n.checked!=null?n.checked:n.defaultChecked;o=K(n.value!=null?n.value:o),s._wrapperState={initialChecked:h,initialValue:o,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function ci(s,n){n=n.checked,n!=null&&R(s,"checked",n,!1)}function di(s,n){ci(s,n);var o=K(n.value),h=n.type;if(o!=null)h==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+o):s.value!==""+o&&(s.value=""+o);else if(h==="submit"||h==="reset"){s.removeAttribute("value");return}n.hasOwnProperty("value")?hi(s,n.type,o):n.hasOwnProperty("defaultValue")&&hi(s,n.type,K(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(s.defaultChecked=!!n.defaultChecked)}function ui(s,n,o){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var h=n.type;if(!(h!=="submit"&&h!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+s._wrapperState.initialValue,o||n===s.value||(s.value=n),s.defaultValue=n}o=s.name,o!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,o!==""&&(s.name=o)}function hi(s,n,o){(n!=="number"||wt(s.ownerDocument)!==s)&&(o==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+o&&(s.defaultValue=""+o))}var an=Array.isArray;function Cs(s,n,o,h){if(s=s.options,n){n={};for(var g=0;g<o.length;g++)n["$"+o[g]]=!0;for(o=0;o<s.length;o++)g=n.hasOwnProperty("$"+s[o].value),s[o].selected!==g&&(s[o].selected=g),g&&h&&(s[o].defaultSelected=!0)}else{for(o=""+K(o),n=null,g=0;g<s.length;g++){if(s[g].value===o){s[g].selected=!0,h&&(s[g].defaultSelected=!0);return}n!==null||s[g].disabled||(n=s[g])}n!==null&&(n.selected=!0)}}function fi(s,n){if(n.dangerouslySetInnerHTML!=null)throw Error(t(91));return Q({},n,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function J(s,n){var o=n.value;if(o==null){if(o=n.children,n=n.defaultValue,o!=null){if(n!=null)throw Error(t(92));if(an(o)){if(1<o.length)throw Error(t(93));o=o[0]}n=o}n==null&&(n=""),o=n}s._wrapperState={initialValue:K(o)}}function Re(s,n){var o=K(n.value),h=K(n.defaultValue);o!=null&&(o=""+o,o!==s.value&&(s.value=o),n.defaultValue==null&&s.defaultValue!==o&&(s.defaultValue=o)),h!=null&&(s.defaultValue=""+h)}function En(s){var n=s.textContent;n===s._wrapperState.initialValue&&n!==""&&n!==null&&(s.value=n)}function br(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function io(s,n){return s==null||s==="http://www.w3.org/1999/xhtml"?br(n):s==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var yr,Qc=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,o,h,g){MSApp.execUnsafeLocalFunction(function(){return s(n,o,h,g)})}:s})(function(s,n){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=n;else{for(yr=yr||document.createElement("div"),yr.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=yr.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;n.firstChild;)s.appendChild(n.firstChild)}});function pi(s,n){if(n){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=n;return}}s.textContent=n}var mi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sp=["Webkit","ms","Moz","O"];Object.keys(mi).forEach(function(s){Sp.forEach(function(n){n=n+s.charAt(0).toUpperCase()+s.substring(1),mi[n]=mi[s]})});function Jc(s,n,o){return n==null||typeof n=="boolean"||n===""?"":o||typeof n!="number"||n===0||mi.hasOwnProperty(s)&&mi[s]?(""+n).trim():n+"px"}function Zc(s,n){s=s.style;for(var o in n)if(n.hasOwnProperty(o)){var h=o.indexOf("--")===0,g=Jc(o,n[o],h);o==="float"&&(o="cssFloat"),h?s.setProperty(o,g):s[o]=g}}var Np=Q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ro(s,n){if(n){if(Np[s]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(t(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(t(61))}if(n.style!=null&&typeof n.style!="object")throw Error(t(62))}}function ao(s,n){if(s.indexOf("-")===-1)return typeof n.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var oo=null;function lo(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var co=null,kn=null,jn=null;function ed(s){if(s=Di(s)){if(typeof co!="function")throw Error(t(280));var n=s.stateNode;n&&(n=Hr(n),co(s.stateNode,s.type,n))}}function td(s){kn?jn?jn.push(s):jn=[s]:kn=s}function sd(){if(kn){var s=kn,n=jn;if(jn=kn=null,ed(s),n)for(s=0;s<n.length;s++)ed(n[s])}}function nd(s,n){return s(n)}function id(){}var uo=!1;function rd(s,n,o){if(uo)return s(n,o);uo=!0;try{return nd(s,n,o)}finally{uo=!1,(kn!==null||jn!==null)&&(id(),sd())}}function gi(s,n){var o=s.stateNode;if(o===null)return null;var h=Hr(o);if(h===null)return null;o=h[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(t(231,n,typeof o));return o}var ho=!1;if(d)try{var xi={};Object.defineProperty(xi,"passive",{get:function(){ho=!0}}),window.addEventListener("test",xi,xi),window.removeEventListener("test",xi,xi)}catch{ho=!1}function Ep(s,n,o,h,g,v,_,k,P){var O=Array.prototype.slice.call(arguments,3);try{n.apply(o,O)}catch(G){this.onError(G)}}var vi=!1,wr=null,Ar=!1,fo=null,kp={onError:function(s){vi=!0,wr=s}};function jp(s,n,o,h,g,v,_,k,P){vi=!1,wr=null,Ep.apply(kp,arguments)}function Cp(s,n,o,h,g,v,_,k,P){if(jp.apply(this,arguments),vi){if(vi){var O=wr;vi=!1,wr=null}else throw Error(t(198));Ar||(Ar=!0,fo=O)}}function on(s){var n=s,o=s;if(s.alternate)for(;n.return;)n=n.return;else{s=n;do n=s,(n.flags&4098)!==0&&(o=n.return),s=n.return;while(s)}return n.tag===3?o:null}function ad(s){if(s.tag===13){var n=s.memoizedState;if(n===null&&(s=s.alternate,s!==null&&(n=s.memoizedState)),n!==null)return n.dehydrated}return null}function od(s){if(on(s)!==s)throw Error(t(188))}function Tp(s){var n=s.alternate;if(!n){if(n=on(s),n===null)throw Error(t(188));return n!==s?null:s}for(var o=s,h=n;;){var g=o.return;if(g===null)break;var v=g.alternate;if(v===null){if(h=g.return,h!==null){o=h;continue}break}if(g.child===v.child){for(v=g.child;v;){if(v===o)return od(g),s;if(v===h)return od(g),n;v=v.sibling}throw Error(t(188))}if(o.return!==h.return)o=g,h=v;else{for(var _=!1,k=g.child;k;){if(k===o){_=!0,o=g,h=v;break}if(k===h){_=!0,h=g,o=v;break}k=k.sibling}if(!_){for(k=v.child;k;){if(k===o){_=!0,o=v,h=g;break}if(k===h){_=!0,h=v,o=g;break}k=k.sibling}if(!_)throw Error(t(189))}}if(o.alternate!==h)throw Error(t(190))}if(o.tag!==3)throw Error(t(188));return o.stateNode.current===o?s:n}function ld(s){return s=Tp(s),s!==null?cd(s):null}function cd(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var n=cd(s);if(n!==null)return n;s=s.sibling}return null}var dd=e.unstable_scheduleCallback,ud=e.unstable_cancelCallback,Pp=e.unstable_shouldYield,Rp=e.unstable_requestPaint,Xe=e.unstable_now,Lp=e.unstable_getCurrentPriorityLevel,po=e.unstable_ImmediatePriority,hd=e.unstable_UserBlockingPriority,_r=e.unstable_NormalPriority,Mp=e.unstable_LowPriority,fd=e.unstable_IdlePriority,Sr=null,cs=null;function Vp(s){if(cs&&typeof cs.onCommitFiberRoot=="function")try{cs.onCommitFiberRoot(Sr,s,void 0,(s.current.flags&128)===128)}catch{}}var Jt=Math.clz32?Math.clz32:Fp,Ip=Math.log,Dp=Math.LN2;function Fp(s){return s>>>=0,s===0?32:31-(Ip(s)/Dp|0)|0}var Nr=64,Er=4194304;function bi(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function kr(s,n){var o=s.pendingLanes;if(o===0)return 0;var h=0,g=s.suspendedLanes,v=s.pingedLanes,_=o&268435455;if(_!==0){var k=_&~g;k!==0?h=bi(k):(v&=_,v!==0&&(h=bi(v)))}else _=o&~g,_!==0?h=bi(_):v!==0&&(h=bi(v));if(h===0)return 0;if(n!==0&&n!==h&&(n&g)===0&&(g=h&-h,v=n&-n,g>=v||g===16&&(v&4194240)!==0))return n;if((h&4)!==0&&(h|=o&16),n=s.entangledLanes,n!==0)for(s=s.entanglements,n&=h;0<n;)o=31-Jt(n),g=1<<o,h|=s[o],n&=~g;return h}function Op(s,n){switch(s){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zp(s,n){for(var o=s.suspendedLanes,h=s.pingedLanes,g=s.expirationTimes,v=s.pendingLanes;0<v;){var _=31-Jt(v),k=1<<_,P=g[_];P===-1?((k&o)===0||(k&h)!==0)&&(g[_]=Op(k,n)):P<=n&&(s.expiredLanes|=k),v&=~k}}function mo(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function pd(){var s=Nr;return Nr<<=1,(Nr&4194240)===0&&(Nr=64),s}function go(s){for(var n=[],o=0;31>o;o++)n.push(s);return n}function yi(s,n,o){s.pendingLanes|=n,n!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,n=31-Jt(n),s[n]=o}function Bp(s,n){var o=s.pendingLanes&~n;s.pendingLanes=n,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=n,s.mutableReadLanes&=n,s.entangledLanes&=n,n=s.entanglements;var h=s.eventTimes;for(s=s.expirationTimes;0<o;){var g=31-Jt(o),v=1<<g;n[g]=0,h[g]=-1,s[g]=-1,o&=~v}}function xo(s,n){var o=s.entangledLanes|=n;for(s=s.entanglements;o;){var h=31-Jt(o),g=1<<h;g&n|s[h]&n&&(s[h]|=n),o&=~g}}var Ve=0;function md(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var gd,vo,xd,vd,bd,bo=!1,jr=[],Ts=null,Ps=null,Rs=null,wi=new Map,Ai=new Map,Ls=[],Up="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function yd(s,n){switch(s){case"focusin":case"focusout":Ts=null;break;case"dragenter":case"dragleave":Ps=null;break;case"mouseover":case"mouseout":Rs=null;break;case"pointerover":case"pointerout":wi.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ai.delete(n.pointerId)}}function _i(s,n,o,h,g,v){return s===null||s.nativeEvent!==v?(s={blockedOn:n,domEventName:o,eventSystemFlags:h,nativeEvent:v,targetContainers:[g]},n!==null&&(n=Di(n),n!==null&&vo(n)),s):(s.eventSystemFlags|=h,n=s.targetContainers,g!==null&&n.indexOf(g)===-1&&n.push(g),s)}function Hp(s,n,o,h,g){switch(n){case"focusin":return Ts=_i(Ts,s,n,o,h,g),!0;case"dragenter":return Ps=_i(Ps,s,n,o,h,g),!0;case"mouseover":return Rs=_i(Rs,s,n,o,h,g),!0;case"pointerover":var v=g.pointerId;return wi.set(v,_i(wi.get(v)||null,s,n,o,h,g)),!0;case"gotpointercapture":return v=g.pointerId,Ai.set(v,_i(Ai.get(v)||null,s,n,o,h,g)),!0}return!1}function wd(s){var n=ln(s.target);if(n!==null){var o=on(n);if(o!==null){if(n=o.tag,n===13){if(n=ad(o),n!==null){s.blockedOn=n,bd(s.priority,function(){xd(o)});return}}else if(n===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Cr(s){if(s.blockedOn!==null)return!1;for(var n=s.targetContainers;0<n.length;){var o=wo(s.domEventName,s.eventSystemFlags,n[0],s.nativeEvent);if(o===null){o=s.nativeEvent;var h=new o.constructor(o.type,o);oo=h,o.target.dispatchEvent(h),oo=null}else return n=Di(o),n!==null&&vo(n),s.blockedOn=o,!1;n.shift()}return!0}function Ad(s,n,o){Cr(s)&&o.delete(n)}function $p(){bo=!1,Ts!==null&&Cr(Ts)&&(Ts=null),Ps!==null&&Cr(Ps)&&(Ps=null),Rs!==null&&Cr(Rs)&&(Rs=null),wi.forEach(Ad),Ai.forEach(Ad)}function Si(s,n){s.blockedOn===n&&(s.blockedOn=null,bo||(bo=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,$p)))}function Ni(s){function n(g){return Si(g,s)}if(0<jr.length){Si(jr[0],s);for(var o=1;o<jr.length;o++){var h=jr[o];h.blockedOn===s&&(h.blockedOn=null)}}for(Ts!==null&&Si(Ts,s),Ps!==null&&Si(Ps,s),Rs!==null&&Si(Rs,s),wi.forEach(n),Ai.forEach(n),o=0;o<Ls.length;o++)h=Ls[o],h.blockedOn===s&&(h.blockedOn=null);for(;0<Ls.length&&(o=Ls[0],o.blockedOn===null);)wd(o),o.blockedOn===null&&Ls.shift()}var Cn=E.ReactCurrentBatchConfig,Tr=!0;function Gp(s,n,o,h){var g=Ve,v=Cn.transition;Cn.transition=null;try{Ve=1,yo(s,n,o,h)}finally{Ve=g,Cn.transition=v}}function Wp(s,n,o,h){var g=Ve,v=Cn.transition;Cn.transition=null;try{Ve=4,yo(s,n,o,h)}finally{Ve=g,Cn.transition=v}}function yo(s,n,o,h){if(Tr){var g=wo(s,n,o,h);if(g===null)Fo(s,n,h,Pr,o),yd(s,h);else if(Hp(g,s,n,o,h))h.stopPropagation();else if(yd(s,h),n&4&&-1<Up.indexOf(s)){for(;g!==null;){var v=Di(g);if(v!==null&&gd(v),v=wo(s,n,o,h),v===null&&Fo(s,n,h,Pr,o),v===g)break;g=v}g!==null&&h.stopPropagation()}else Fo(s,n,h,null,o)}}var Pr=null;function wo(s,n,o,h){if(Pr=null,s=lo(h),s=ln(s),s!==null)if(n=on(s),n===null)s=null;else if(o=n.tag,o===13){if(s=ad(n),s!==null)return s;s=null}else if(o===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;s=null}else n!==s&&(s=null);return Pr=s,null}function _d(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Lp()){case po:return 1;case hd:return 4;case _r:case Mp:return 16;case fd:return 536870912;default:return 16}default:return 16}}var Ms=null,Ao=null,Rr=null;function Sd(){if(Rr)return Rr;var s,n=Ao,o=n.length,h,g="value"in Ms?Ms.value:Ms.textContent,v=g.length;for(s=0;s<o&&n[s]===g[s];s++);var _=o-s;for(h=1;h<=_&&n[o-h]===g[v-h];h++);return Rr=g.slice(s,1<h?1-h:void 0)}function Lr(s){var n=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&n===13&&(s=13)):s=n,s===10&&(s=13),32<=s||s===13?s:0}function Mr(){return!0}function Nd(){return!1}function It(s){function n(o,h,g,v,_){this._reactName=o,this._targetInst=g,this.type=h,this.nativeEvent=v,this.target=_,this.currentTarget=null;for(var k in s)s.hasOwnProperty(k)&&(o=s[k],this[k]=o?o(v):v[k]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Mr:Nd,this.isPropagationStopped=Nd,this}return Q(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Mr)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Mr)},persist:function(){},isPersistent:Mr}),n}var Tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_o=It(Tn),Ei=Q({},Tn,{view:0,detail:0}),qp=It(Ei),So,No,ki,Vr=Q({},Ei,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ko,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ki&&(ki&&s.type==="mousemove"?(So=s.screenX-ki.screenX,No=s.screenY-ki.screenY):No=So=0,ki=s),So)},movementY:function(s){return"movementY"in s?s.movementY:No}}),Ed=It(Vr),Xp=Q({},Vr,{dataTransfer:0}),Yp=It(Xp),Kp=Q({},Ei,{relatedTarget:0}),Eo=It(Kp),Qp=Q({},Tn,{animationName:0,elapsedTime:0,pseudoElement:0}),Jp=It(Qp),Zp=Q({},Tn,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),em=It(Zp),tm=Q({},Tn,{data:0}),kd=It(tm),sm={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},im={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rm(s){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(s):(s=im[s])?!!n[s]:!1}function ko(){return rm}var am=Q({},Ei,{key:function(s){if(s.key){var n=sm[s.key]||s.key;if(n!=="Unidentified")return n}return s.type==="keypress"?(s=Lr(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?nm[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ko,charCode:function(s){return s.type==="keypress"?Lr(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Lr(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),om=It(am),lm=Q({},Vr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jd=It(lm),cm=Q({},Ei,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ko}),dm=It(cm),um=Q({},Tn,{propertyName:0,elapsedTime:0,pseudoElement:0}),hm=It(um),fm=Q({},Vr,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),pm=It(fm),mm=[9,13,27,32],jo=d&&"CompositionEvent"in window,ji=null;d&&"documentMode"in document&&(ji=document.documentMode);var gm=d&&"TextEvent"in window&&!ji,Cd=d&&(!jo||ji&&8<ji&&11>=ji),Td=" ",Pd=!1;function Rd(s,n){switch(s){case"keyup":return mm.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ld(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Pn=!1;function xm(s,n){switch(s){case"compositionend":return Ld(n);case"keypress":return n.which!==32?null:(Pd=!0,Td);case"textInput":return s=n.data,s===Td&&Pd?null:s;default:return null}}function vm(s,n){if(Pn)return s==="compositionend"||!jo&&Rd(s,n)?(s=Sd(),Rr=Ao=Ms=null,Pn=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Cd&&n.locale!=="ko"?null:n.data;default:return null}}var bm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Md(s){var n=s&&s.nodeName&&s.nodeName.toLowerCase();return n==="input"?!!bm[s.type]:n==="textarea"}function Vd(s,n,o,h){td(h),n=zr(n,"onChange"),0<n.length&&(o=new _o("onChange","change",null,o,h),s.push({event:o,listeners:n}))}var Ci=null,Ti=null;function ym(s){Zd(s,0)}function Ir(s){var n=In(s);if(dt(n))return s}function wm(s,n){if(s==="change")return n}var Id=!1;if(d){var Co;if(d){var To="oninput"in document;if(!To){var Dd=document.createElement("div");Dd.setAttribute("oninput","return;"),To=typeof Dd.oninput=="function"}Co=To}else Co=!1;Id=Co&&(!document.documentMode||9<document.documentMode)}function Fd(){Ci&&(Ci.detachEvent("onpropertychange",Od),Ti=Ci=null)}function Od(s){if(s.propertyName==="value"&&Ir(Ti)){var n=[];Vd(n,Ti,s,lo(s)),rd(ym,n)}}function Am(s,n,o){s==="focusin"?(Fd(),Ci=n,Ti=o,Ci.attachEvent("onpropertychange",Od)):s==="focusout"&&Fd()}function _m(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Ir(Ti)}function Sm(s,n){if(s==="click")return Ir(n)}function Nm(s,n){if(s==="input"||s==="change")return Ir(n)}function Em(s,n){return s===n&&(s!==0||1/s===1/n)||s!==s&&n!==n}var Zt=typeof Object.is=="function"?Object.is:Em;function Pi(s,n){if(Zt(s,n))return!0;if(typeof s!="object"||s===null||typeof n!="object"||n===null)return!1;var o=Object.keys(s),h=Object.keys(n);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var g=o[h];if(!f.call(n,g)||!Zt(s[g],n[g]))return!1}return!0}function zd(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Bd(s,n){var o=zd(s);s=0;for(var h;o;){if(o.nodeType===3){if(h=s+o.textContent.length,s<=n&&h>=n)return{node:o,offset:n-s};s=h}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=zd(o)}}function Ud(s,n){return s&&n?s===n?!0:s&&s.nodeType===3?!1:n&&n.nodeType===3?Ud(s,n.parentNode):"contains"in s?s.contains(n):s.compareDocumentPosition?!!(s.compareDocumentPosition(n)&16):!1:!1}function Hd(){for(var s=window,n=wt();n instanceof s.HTMLIFrameElement;){try{var o=typeof n.contentWindow.location.href=="string"}catch{o=!1}if(o)s=n.contentWindow;else break;n=wt(s.document)}return n}function Po(s){var n=s&&s.nodeName&&s.nodeName.toLowerCase();return n&&(n==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||n==="textarea"||s.contentEditable==="true")}function km(s){var n=Hd(),o=s.focusedElem,h=s.selectionRange;if(n!==o&&o&&o.ownerDocument&&Ud(o.ownerDocument.documentElement,o)){if(h!==null&&Po(o)){if(n=h.start,s=h.end,s===void 0&&(s=n),"selectionStart"in o)o.selectionStart=n,o.selectionEnd=Math.min(s,o.value.length);else if(s=(n=o.ownerDocument||document)&&n.defaultView||window,s.getSelection){s=s.getSelection();var g=o.textContent.length,v=Math.min(h.start,g);h=h.end===void 0?v:Math.min(h.end,g),!s.extend&&v>h&&(g=h,h=v,v=g),g=Bd(o,v);var _=Bd(o,h);g&&_&&(s.rangeCount!==1||s.anchorNode!==g.node||s.anchorOffset!==g.offset||s.focusNode!==_.node||s.focusOffset!==_.offset)&&(n=n.createRange(),n.setStart(g.node,g.offset),s.removeAllRanges(),v>h?(s.addRange(n),s.extend(_.node,_.offset)):(n.setEnd(_.node,_.offset),s.addRange(n)))}}for(n=[],s=o;s=s.parentNode;)s.nodeType===1&&n.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<n.length;o++)s=n[o],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var jm=d&&"documentMode"in document&&11>=document.documentMode,Rn=null,Ro=null,Ri=null,Lo=!1;function $d(s,n,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Lo||Rn==null||Rn!==wt(h)||(h=Rn,"selectionStart"in h&&Po(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Ri&&Pi(Ri,h)||(Ri=h,h=zr(Ro,"onSelect"),0<h.length&&(n=new _o("onSelect","select",null,n,o),s.push({event:n,listeners:h}),n.target=Rn)))}function Dr(s,n){var o={};return o[s.toLowerCase()]=n.toLowerCase(),o["Webkit"+s]="webkit"+n,o["Moz"+s]="moz"+n,o}var Ln={animationend:Dr("Animation","AnimationEnd"),animationiteration:Dr("Animation","AnimationIteration"),animationstart:Dr("Animation","AnimationStart"),transitionend:Dr("Transition","TransitionEnd")},Mo={},Gd={};d&&(Gd=document.createElement("div").style,"AnimationEvent"in window||(delete Ln.animationend.animation,delete Ln.animationiteration.animation,delete Ln.animationstart.animation),"TransitionEvent"in window||delete Ln.transitionend.transition);function Fr(s){if(Mo[s])return Mo[s];if(!Ln[s])return s;var n=Ln[s],o;for(o in n)if(n.hasOwnProperty(o)&&o in Gd)return Mo[s]=n[o];return s}var Wd=Fr("animationend"),qd=Fr("animationiteration"),Xd=Fr("animationstart"),Yd=Fr("transitionend"),Kd=new Map,Qd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vs(s,n){Kd.set(s,n),a(n,[s])}for(var Vo=0;Vo<Qd.length;Vo++){var Io=Qd[Vo],Cm=Io.toLowerCase(),Tm=Io[0].toUpperCase()+Io.slice(1);Vs(Cm,"on"+Tm)}Vs(Wd,"onAnimationEnd"),Vs(qd,"onAnimationIteration"),Vs(Xd,"onAnimationStart"),Vs("dblclick","onDoubleClick"),Vs("focusin","onFocus"),Vs("focusout","onBlur"),Vs(Yd,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Li="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pm=new Set("cancel close invalid load scroll toggle".split(" ").concat(Li));function Jd(s,n,o){var h=s.type||"unknown-event";s.currentTarget=o,Cp(h,n,void 0,s),s.currentTarget=null}function Zd(s,n){n=(n&4)!==0;for(var o=0;o<s.length;o++){var h=s[o],g=h.event;h=h.listeners;e:{var v=void 0;if(n)for(var _=h.length-1;0<=_;_--){var k=h[_],P=k.instance,O=k.currentTarget;if(k=k.listener,P!==v&&g.isPropagationStopped())break e;Jd(g,k,O),v=P}else for(_=0;_<h.length;_++){if(k=h[_],P=k.instance,O=k.currentTarget,k=k.listener,P!==v&&g.isPropagationStopped())break e;Jd(g,k,O),v=P}}}if(Ar)throw s=fo,Ar=!1,fo=null,s}function Oe(s,n){var o=n[$o];o===void 0&&(o=n[$o]=new Set);var h=s+"__bubble";o.has(h)||(eu(n,s,2,!1),o.add(h))}function Do(s,n,o){var h=0;n&&(h|=4),eu(o,s,h,n)}var Or="_reactListening"+Math.random().toString(36).slice(2);function Mi(s){if(!s[Or]){s[Or]=!0,i.forEach(function(o){o!=="selectionchange"&&(Pm.has(o)||Do(o,!1,s),Do(o,!0,s))});var n=s.nodeType===9?s:s.ownerDocument;n===null||n[Or]||(n[Or]=!0,Do("selectionchange",!1,n))}}function eu(s,n,o,h){switch(_d(n)){case 1:var g=Gp;break;case 4:g=Wp;break;default:g=yo}o=g.bind(null,n,o,s),g=void 0,!ho||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(g=!0),h?g!==void 0?s.addEventListener(n,o,{capture:!0,passive:g}):s.addEventListener(n,o,!0):g!==void 0?s.addEventListener(n,o,{passive:g}):s.addEventListener(n,o,!1)}function Fo(s,n,o,h,g){var v=h;if((n&1)===0&&(n&2)===0&&h!==null)e:for(;;){if(h===null)return;var _=h.tag;if(_===3||_===4){var k=h.stateNode.containerInfo;if(k===g||k.nodeType===8&&k.parentNode===g)break;if(_===4)for(_=h.return;_!==null;){var P=_.tag;if((P===3||P===4)&&(P=_.stateNode.containerInfo,P===g||P.nodeType===8&&P.parentNode===g))return;_=_.return}for(;k!==null;){if(_=ln(k),_===null)return;if(P=_.tag,P===5||P===6){h=v=_;continue e}k=k.parentNode}}h=h.return}rd(function(){var O=v,G=lo(o),W=[];e:{var H=Kd.get(s);if(H!==void 0){var ne=_o,le=s;switch(s){case"keypress":if(Lr(o)===0)break e;case"keydown":case"keyup":ne=om;break;case"focusin":le="focus",ne=Eo;break;case"focusout":le="blur",ne=Eo;break;case"beforeblur":case"afterblur":ne=Eo;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ne=Ed;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ne=Yp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ne=dm;break;case Wd:case qd:case Xd:ne=Jp;break;case Yd:ne=hm;break;case"scroll":ne=qp;break;case"wheel":ne=pm;break;case"copy":case"cut":case"paste":ne=em;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ne=jd}var ue=(n&4)!==0,Ye=!ue&&s==="scroll",D=ue?H!==null?H+"Capture":null:H;ue=[];for(var M=O,F;M!==null;){F=M;var Y=F.stateNode;if(F.tag===5&&Y!==null&&(F=Y,D!==null&&(Y=gi(M,D),Y!=null&&ue.push(Vi(M,Y,F)))),Ye)break;M=M.return}0<ue.length&&(H=new ne(H,le,null,o,G),W.push({event:H,listeners:ue}))}}if((n&7)===0){e:{if(H=s==="mouseover"||s==="pointerover",ne=s==="mouseout"||s==="pointerout",H&&o!==oo&&(le=o.relatedTarget||o.fromElement)&&(ln(le)||le[vs]))break e;if((ne||H)&&(H=G.window===G?G:(H=G.ownerDocument)?H.defaultView||H.parentWindow:window,ne?(le=o.relatedTarget||o.toElement,ne=O,le=le?ln(le):null,le!==null&&(Ye=on(le),le!==Ye||le.tag!==5&&le.tag!==6)&&(le=null)):(ne=null,le=O),ne!==le)){if(ue=Ed,Y="onMouseLeave",D="onMouseEnter",M="mouse",(s==="pointerout"||s==="pointerover")&&(ue=jd,Y="onPointerLeave",D="onPointerEnter",M="pointer"),Ye=ne==null?H:In(ne),F=le==null?H:In(le),H=new ue(Y,M+"leave",ne,o,G),H.target=Ye,H.relatedTarget=F,Y=null,ln(G)===O&&(ue=new ue(D,M+"enter",le,o,G),ue.target=F,ue.relatedTarget=Ye,Y=ue),Ye=Y,ne&&le)t:{for(ue=ne,D=le,M=0,F=ue;F;F=Mn(F))M++;for(F=0,Y=D;Y;Y=Mn(Y))F++;for(;0<M-F;)ue=Mn(ue),M--;for(;0<F-M;)D=Mn(D),F--;for(;M--;){if(ue===D||D!==null&&ue===D.alternate)break t;ue=Mn(ue),D=Mn(D)}ue=null}else ue=null;ne!==null&&tu(W,H,ne,ue,!1),le!==null&&Ye!==null&&tu(W,Ye,le,ue,!0)}}e:{if(H=O?In(O):window,ne=H.nodeName&&H.nodeName.toLowerCase(),ne==="select"||ne==="input"&&H.type==="file")var fe=wm;else if(Md(H))if(Id)fe=Nm;else{fe=_m;var xe=Am}else(ne=H.nodeName)&&ne.toLowerCase()==="input"&&(H.type==="checkbox"||H.type==="radio")&&(fe=Sm);if(fe&&(fe=fe(s,O))){Vd(W,fe,o,G);break e}xe&&xe(s,H,O),s==="focusout"&&(xe=H._wrapperState)&&xe.controlled&&H.type==="number"&&hi(H,"number",H.value)}switch(xe=O?In(O):window,s){case"focusin":(Md(xe)||xe.contentEditable==="true")&&(Rn=xe,Ro=O,Ri=null);break;case"focusout":Ri=Ro=Rn=null;break;case"mousedown":Lo=!0;break;case"contextmenu":case"mouseup":case"dragend":Lo=!1,$d(W,o,G);break;case"selectionchange":if(jm)break;case"keydown":case"keyup":$d(W,o,G)}var ve;if(jo)e:{switch(s){case"compositionstart":var _e="onCompositionStart";break e;case"compositionend":_e="onCompositionEnd";break e;case"compositionupdate":_e="onCompositionUpdate";break e}_e=void 0}else Pn?Rd(s,o)&&(_e="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(_e="onCompositionStart");_e&&(Cd&&o.locale!=="ko"&&(Pn||_e!=="onCompositionStart"?_e==="onCompositionEnd"&&Pn&&(ve=Sd()):(Ms=G,Ao="value"in Ms?Ms.value:Ms.textContent,Pn=!0)),xe=zr(O,_e),0<xe.length&&(_e=new kd(_e,s,null,o,G),W.push({event:_e,listeners:xe}),ve?_e.data=ve:(ve=Ld(o),ve!==null&&(_e.data=ve)))),(ve=gm?xm(s,o):vm(s,o))&&(O=zr(O,"onBeforeInput"),0<O.length&&(G=new kd("onBeforeInput","beforeinput",null,o,G),W.push({event:G,listeners:O}),G.data=ve))}Zd(W,n)})}function Vi(s,n,o){return{instance:s,listener:n,currentTarget:o}}function zr(s,n){for(var o=n+"Capture",h=[];s!==null;){var g=s,v=g.stateNode;g.tag===5&&v!==null&&(g=v,v=gi(s,o),v!=null&&h.unshift(Vi(s,v,g)),v=gi(s,n),v!=null&&h.push(Vi(s,v,g))),s=s.return}return h}function Mn(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function tu(s,n,o,h,g){for(var v=n._reactName,_=[];o!==null&&o!==h;){var k=o,P=k.alternate,O=k.stateNode;if(P!==null&&P===h)break;k.tag===5&&O!==null&&(k=O,g?(P=gi(o,v),P!=null&&_.unshift(Vi(o,P,k))):g||(P=gi(o,v),P!=null&&_.push(Vi(o,P,k)))),o=o.return}_.length!==0&&s.push({event:n,listeners:_})}var Rm=/\r\n?/g,Lm=/\u0000|\uFFFD/g;function su(s){return(typeof s=="string"?s:""+s).replace(Rm,`
`).replace(Lm,"")}function Br(s,n,o){if(n=su(n),su(s)!==n&&o)throw Error(t(425))}function Ur(){}var Oo=null,zo=null;function Bo(s,n){return s==="textarea"||s==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Uo=typeof setTimeout=="function"?setTimeout:void 0,Mm=typeof clearTimeout=="function"?clearTimeout:void 0,nu=typeof Promise=="function"?Promise:void 0,Vm=typeof queueMicrotask=="function"?queueMicrotask:typeof nu<"u"?function(s){return nu.resolve(null).then(s).catch(Im)}:Uo;function Im(s){setTimeout(function(){throw s})}function Ho(s,n){var o=n,h=0;do{var g=o.nextSibling;if(s.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"){if(h===0){s.removeChild(g),Ni(n);return}h--}else o!=="$"&&o!=="$?"&&o!=="$!"||h++;o=g}while(o);Ni(n)}function Is(s){for(;s!=null;s=s.nextSibling){var n=s.nodeType;if(n===1||n===3)break;if(n===8){if(n=s.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return s}function iu(s){s=s.previousSibling;for(var n=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"){if(n===0)return s;n--}else o==="/$"&&n++}s=s.previousSibling}return null}var Vn=Math.random().toString(36).slice(2),ds="__reactFiber$"+Vn,Ii="__reactProps$"+Vn,vs="__reactContainer$"+Vn,$o="__reactEvents$"+Vn,Dm="__reactListeners$"+Vn,Fm="__reactHandles$"+Vn;function ln(s){var n=s[ds];if(n)return n;for(var o=s.parentNode;o;){if(n=o[vs]||o[ds]){if(o=n.alternate,n.child!==null||o!==null&&o.child!==null)for(s=iu(s);s!==null;){if(o=s[ds])return o;s=iu(s)}return n}s=o,o=s.parentNode}return null}function Di(s){return s=s[ds]||s[vs],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function In(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function Hr(s){return s[Ii]||null}var Go=[],Dn=-1;function Ds(s){return{current:s}}function ze(s){0>Dn||(s.current=Go[Dn],Go[Dn]=null,Dn--)}function Fe(s,n){Dn++,Go[Dn]=s.current,s.current=n}var Fs={},ft=Ds(Fs),kt=Ds(!1),cn=Fs;function Fn(s,n){var o=s.type.contextTypes;if(!o)return Fs;var h=s.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===n)return h.__reactInternalMemoizedMaskedChildContext;var g={},v;for(v in o)g[v]=n[v];return h&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=n,s.__reactInternalMemoizedMaskedChildContext=g),g}function jt(s){return s=s.childContextTypes,s!=null}function $r(){ze(kt),ze(ft)}function ru(s,n,o){if(ft.current!==Fs)throw Error(t(168));Fe(ft,n),Fe(kt,o)}function au(s,n,o){var h=s.stateNode;if(n=n.childContextTypes,typeof h.getChildContext!="function")return o;h=h.getChildContext();for(var g in h)if(!(g in n))throw Error(t(108,ee(s)||"Unknown",g));return Q({},o,h)}function Gr(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Fs,cn=ft.current,Fe(ft,s),Fe(kt,kt.current),!0}function ou(s,n,o){var h=s.stateNode;if(!h)throw Error(t(169));o?(s=au(s,n,cn),h.__reactInternalMemoizedMergedChildContext=s,ze(kt),ze(ft),Fe(ft,s)):ze(kt),Fe(kt,o)}var bs=null,Wr=!1,Wo=!1;function lu(s){bs===null?bs=[s]:bs.push(s)}function Om(s){Wr=!0,lu(s)}function Os(){if(!Wo&&bs!==null){Wo=!0;var s=0,n=Ve;try{var o=bs;for(Ve=1;s<o.length;s++){var h=o[s];do h=h(!0);while(h!==null)}bs=null,Wr=!1}catch(g){throw bs!==null&&(bs=bs.slice(s+1)),dd(po,Os),g}finally{Ve=n,Wo=!1}}return null}var On=[],zn=0,qr=null,Xr=0,Ht=[],$t=0,dn=null,ys=1,ws="";function un(s,n){On[zn++]=Xr,On[zn++]=qr,qr=s,Xr=n}function cu(s,n,o){Ht[$t++]=ys,Ht[$t++]=ws,Ht[$t++]=dn,dn=s;var h=ys;s=ws;var g=32-Jt(h)-1;h&=~(1<<g),o+=1;var v=32-Jt(n)+g;if(30<v){var _=g-g%5;v=(h&(1<<_)-1).toString(32),h>>=_,g-=_,ys=1<<32-Jt(n)+g|o<<g|h,ws=v+s}else ys=1<<v|o<<g|h,ws=s}function qo(s){s.return!==null&&(un(s,1),cu(s,1,0))}function Xo(s){for(;s===qr;)qr=On[--zn],On[zn]=null,Xr=On[--zn],On[zn]=null;for(;s===dn;)dn=Ht[--$t],Ht[$t]=null,ws=Ht[--$t],Ht[$t]=null,ys=Ht[--$t],Ht[$t]=null}var Dt=null,Ft=null,Be=!1,es=null;function du(s,n){var o=Xt(5,null,null,0);o.elementType="DELETED",o.stateNode=n,o.return=s,n=s.deletions,n===null?(s.deletions=[o],s.flags|=16):n.push(o)}function uu(s,n){switch(s.tag){case 5:var o=s.type;return n=n.nodeType!==1||o.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(s.stateNode=n,Dt=s,Ft=Is(n.firstChild),!0):!1;case 6:return n=s.pendingProps===""||n.nodeType!==3?null:n,n!==null?(s.stateNode=n,Dt=s,Ft=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(o=dn!==null?{id:ys,overflow:ws}:null,s.memoizedState={dehydrated:n,treeContext:o,retryLane:1073741824},o=Xt(18,null,null,0),o.stateNode=n,o.return=s,s.child=o,Dt=s,Ft=null,!0):!1;default:return!1}}function Yo(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Ko(s){if(Be){var n=Ft;if(n){var o=n;if(!uu(s,n)){if(Yo(s))throw Error(t(418));n=Is(o.nextSibling);var h=Dt;n&&uu(s,n)?du(h,o):(s.flags=s.flags&-4097|2,Be=!1,Dt=s)}}else{if(Yo(s))throw Error(t(418));s.flags=s.flags&-4097|2,Be=!1,Dt=s}}}function hu(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Dt=s}function Yr(s){if(s!==Dt)return!1;if(!Be)return hu(s),Be=!0,!1;var n;if((n=s.tag!==3)&&!(n=s.tag!==5)&&(n=s.type,n=n!=="head"&&n!=="body"&&!Bo(s.type,s.memoizedProps)),n&&(n=Ft)){if(Yo(s))throw fu(),Error(t(418));for(;n;)du(s,n),n=Is(n.nextSibling)}if(hu(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,n=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"){if(n===0){Ft=Is(s.nextSibling);break e}n--}else o!=="$"&&o!=="$!"&&o!=="$?"||n++}s=s.nextSibling}Ft=null}}else Ft=Dt?Is(s.stateNode.nextSibling):null;return!0}function fu(){for(var s=Ft;s;)s=Is(s.nextSibling)}function Bn(){Ft=Dt=null,Be=!1}function Qo(s){es===null?es=[s]:es.push(s)}var zm=E.ReactCurrentBatchConfig;function Fi(s,n,o){if(s=o.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(t(309));var h=o.stateNode}if(!h)throw Error(t(147,s));var g=h,v=""+s;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===v?n.ref:(n=function(_){var k=g.refs;_===null?delete k[v]:k[v]=_},n._stringRef=v,n)}if(typeof s!="string")throw Error(t(284));if(!o._owner)throw Error(t(290,s))}return s}function Kr(s,n){throw s=Object.prototype.toString.call(n),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":s))}function pu(s){var n=s._init;return n(s._payload)}function mu(s){function n(D,M){if(s){var F=D.deletions;F===null?(D.deletions=[M],D.flags|=16):F.push(M)}}function o(D,M){if(!s)return null;for(;M!==null;)n(D,M),M=M.sibling;return null}function h(D,M){for(D=new Map;M!==null;)M.key!==null?D.set(M.key,M):D.set(M.index,M),M=M.sibling;return D}function g(D,M){return D=qs(D,M),D.index=0,D.sibling=null,D}function v(D,M,F){return D.index=F,s?(F=D.alternate,F!==null?(F=F.index,F<M?(D.flags|=2,M):F):(D.flags|=2,M)):(D.flags|=1048576,M)}function _(D){return s&&D.alternate===null&&(D.flags|=2),D}function k(D,M,F,Y){return M===null||M.tag!==6?(M=Ul(F,D.mode,Y),M.return=D,M):(M=g(M,F),M.return=D,M)}function P(D,M,F,Y){var fe=F.type;return fe===I?G(D,M,F.props.children,Y,F.key):M!==null&&(M.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===X&&pu(fe)===M.type)?(Y=g(M,F.props),Y.ref=Fi(D,M,F),Y.return=D,Y):(Y=ya(F.type,F.key,F.props,null,D.mode,Y),Y.ref=Fi(D,M,F),Y.return=D,Y)}function O(D,M,F,Y){return M===null||M.tag!==4||M.stateNode.containerInfo!==F.containerInfo||M.stateNode.implementation!==F.implementation?(M=Hl(F,D.mode,Y),M.return=D,M):(M=g(M,F.children||[]),M.return=D,M)}function G(D,M,F,Y,fe){return M===null||M.tag!==7?(M=bn(F,D.mode,Y,fe),M.return=D,M):(M=g(M,F),M.return=D,M)}function W(D,M,F){if(typeof M=="string"&&M!==""||typeof M=="number")return M=Ul(""+M,D.mode,F),M.return=D,M;if(typeof M=="object"&&M!==null){switch(M.$$typeof){case L:return F=ya(M.type,M.key,M.props,null,D.mode,F),F.ref=Fi(D,null,M),F.return=D,F;case T:return M=Hl(M,D.mode,F),M.return=D,M;case X:var Y=M._init;return W(D,Y(M._payload),F)}if(an(M)||se(M))return M=bn(M,D.mode,F,null),M.return=D,M;Kr(D,M)}return null}function H(D,M,F,Y){var fe=M!==null?M.key:null;if(typeof F=="string"&&F!==""||typeof F=="number")return fe!==null?null:k(D,M,""+F,Y);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case L:return F.key===fe?P(D,M,F,Y):null;case T:return F.key===fe?O(D,M,F,Y):null;case X:return fe=F._init,H(D,M,fe(F._payload),Y)}if(an(F)||se(F))return fe!==null?null:G(D,M,F,Y,null);Kr(D,F)}return null}function ne(D,M,F,Y,fe){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return D=D.get(F)||null,k(M,D,""+Y,fe);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case L:return D=D.get(Y.key===null?F:Y.key)||null,P(M,D,Y,fe);case T:return D=D.get(Y.key===null?F:Y.key)||null,O(M,D,Y,fe);case X:var xe=Y._init;return ne(D,M,F,xe(Y._payload),fe)}if(an(Y)||se(Y))return D=D.get(F)||null,G(M,D,Y,fe,null);Kr(M,Y)}return null}function le(D,M,F,Y){for(var fe=null,xe=null,ve=M,_e=M=0,lt=null;ve!==null&&_e<F.length;_e++){ve.index>_e?(lt=ve,ve=null):lt=ve.sibling;var Le=H(D,ve,F[_e],Y);if(Le===null){ve===null&&(ve=lt);break}s&&ve&&Le.alternate===null&&n(D,ve),M=v(Le,M,_e),xe===null?fe=Le:xe.sibling=Le,xe=Le,ve=lt}if(_e===F.length)return o(D,ve),Be&&un(D,_e),fe;if(ve===null){for(;_e<F.length;_e++)ve=W(D,F[_e],Y),ve!==null&&(M=v(ve,M,_e),xe===null?fe=ve:xe.sibling=ve,xe=ve);return Be&&un(D,_e),fe}for(ve=h(D,ve);_e<F.length;_e++)lt=ne(ve,D,_e,F[_e],Y),lt!==null&&(s&&lt.alternate!==null&&ve.delete(lt.key===null?_e:lt.key),M=v(lt,M,_e),xe===null?fe=lt:xe.sibling=lt,xe=lt);return s&&ve.forEach(function(Xs){return n(D,Xs)}),Be&&un(D,_e),fe}function ue(D,M,F,Y){var fe=se(F);if(typeof fe!="function")throw Error(t(150));if(F=fe.call(F),F==null)throw Error(t(151));for(var xe=fe=null,ve=M,_e=M=0,lt=null,Le=F.next();ve!==null&&!Le.done;_e++,Le=F.next()){ve.index>_e?(lt=ve,ve=null):lt=ve.sibling;var Xs=H(D,ve,Le.value,Y);if(Xs===null){ve===null&&(ve=lt);break}s&&ve&&Xs.alternate===null&&n(D,ve),M=v(Xs,M,_e),xe===null?fe=Xs:xe.sibling=Xs,xe=Xs,ve=lt}if(Le.done)return o(D,ve),Be&&un(D,_e),fe;if(ve===null){for(;!Le.done;_e++,Le=F.next())Le=W(D,Le.value,Y),Le!==null&&(M=v(Le,M,_e),xe===null?fe=Le:xe.sibling=Le,xe=Le);return Be&&un(D,_e),fe}for(ve=h(D,ve);!Le.done;_e++,Le=F.next())Le=ne(ve,D,_e,Le.value,Y),Le!==null&&(s&&Le.alternate!==null&&ve.delete(Le.key===null?_e:Le.key),M=v(Le,M,_e),xe===null?fe=Le:xe.sibling=Le,xe=Le);return s&&ve.forEach(function(bg){return n(D,bg)}),Be&&un(D,_e),fe}function Ye(D,M,F,Y){if(typeof F=="object"&&F!==null&&F.type===I&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case L:e:{for(var fe=F.key,xe=M;xe!==null;){if(xe.key===fe){if(fe=F.type,fe===I){if(xe.tag===7){o(D,xe.sibling),M=g(xe,F.props.children),M.return=D,D=M;break e}}else if(xe.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===X&&pu(fe)===xe.type){o(D,xe.sibling),M=g(xe,F.props),M.ref=Fi(D,xe,F),M.return=D,D=M;break e}o(D,xe);break}else n(D,xe);xe=xe.sibling}F.type===I?(M=bn(F.props.children,D.mode,Y,F.key),M.return=D,D=M):(Y=ya(F.type,F.key,F.props,null,D.mode,Y),Y.ref=Fi(D,M,F),Y.return=D,D=Y)}return _(D);case T:e:{for(xe=F.key;M!==null;){if(M.key===xe)if(M.tag===4&&M.stateNode.containerInfo===F.containerInfo&&M.stateNode.implementation===F.implementation){o(D,M.sibling),M=g(M,F.children||[]),M.return=D,D=M;break e}else{o(D,M);break}else n(D,M);M=M.sibling}M=Hl(F,D.mode,Y),M.return=D,D=M}return _(D);case X:return xe=F._init,Ye(D,M,xe(F._payload),Y)}if(an(F))return le(D,M,F,Y);if(se(F))return ue(D,M,F,Y);Kr(D,F)}return typeof F=="string"&&F!==""||typeof F=="number"?(F=""+F,M!==null&&M.tag===6?(o(D,M.sibling),M=g(M,F),M.return=D,D=M):(o(D,M),M=Ul(F,D.mode,Y),M.return=D,D=M),_(D)):o(D,M)}return Ye}var Un=mu(!0),gu=mu(!1),Qr=Ds(null),Jr=null,Hn=null,Jo=null;function Zo(){Jo=Hn=Jr=null}function el(s){var n=Qr.current;ze(Qr),s._currentValue=n}function tl(s,n,o){for(;s!==null;){var h=s.alternate;if((s.childLanes&n)!==n?(s.childLanes|=n,h!==null&&(h.childLanes|=n)):h!==null&&(h.childLanes&n)!==n&&(h.childLanes|=n),s===o)break;s=s.return}}function $n(s,n){Jr=s,Jo=Hn=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&n)!==0&&(Ct=!0),s.firstContext=null)}function Gt(s){var n=s._currentValue;if(Jo!==s)if(s={context:s,memoizedValue:n,next:null},Hn===null){if(Jr===null)throw Error(t(308));Hn=s,Jr.dependencies={lanes:0,firstContext:s}}else Hn=Hn.next=s;return n}var hn=null;function sl(s){hn===null?hn=[s]:hn.push(s)}function xu(s,n,o,h){var g=n.interleaved;return g===null?(o.next=o,sl(n)):(o.next=g.next,g.next=o),n.interleaved=o,As(s,h)}function As(s,n){s.lanes|=n;var o=s.alternate;for(o!==null&&(o.lanes|=n),o=s,s=s.return;s!==null;)s.childLanes|=n,o=s.alternate,o!==null&&(o.childLanes|=n),o=s,s=s.return;return o.tag===3?o.stateNode:null}var zs=!1;function nl(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vu(s,n){s=s.updateQueue,n.updateQueue===s&&(n.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function _s(s,n){return{eventTime:s,lane:n,tag:0,payload:null,callback:null,next:null}}function Bs(s,n,o){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(Pe&2)!==0){var g=h.pending;return g===null?n.next=n:(n.next=g.next,g.next=n),h.pending=n,As(s,o)}return g=h.interleaved,g===null?(n.next=n,sl(h)):(n.next=g.next,g.next=n),h.interleaved=n,As(s,o)}function Zr(s,n,o){if(n=n.updateQueue,n!==null&&(n=n.shared,(o&4194240)!==0)){var h=n.lanes;h&=s.pendingLanes,o|=h,n.lanes=o,xo(s,o)}}function bu(s,n){var o=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var g=null,v=null;if(o=o.firstBaseUpdate,o!==null){do{var _={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};v===null?g=v=_:v=v.next=_,o=o.next}while(o!==null);v===null?g=v=n:v=v.next=n}else g=v=n;o={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:v,shared:h.shared,effects:h.effects},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=n:s.next=n,o.lastBaseUpdate=n}function ea(s,n,o,h){var g=s.updateQueue;zs=!1;var v=g.firstBaseUpdate,_=g.lastBaseUpdate,k=g.shared.pending;if(k!==null){g.shared.pending=null;var P=k,O=P.next;P.next=null,_===null?v=O:_.next=O,_=P;var G=s.alternate;G!==null&&(G=G.updateQueue,k=G.lastBaseUpdate,k!==_&&(k===null?G.firstBaseUpdate=O:k.next=O,G.lastBaseUpdate=P))}if(v!==null){var W=g.baseState;_=0,G=O=P=null,k=v;do{var H=k.lane,ne=k.eventTime;if((h&H)===H){G!==null&&(G=G.next={eventTime:ne,lane:0,tag:k.tag,payload:k.payload,callback:k.callback,next:null});e:{var le=s,ue=k;switch(H=n,ne=o,ue.tag){case 1:if(le=ue.payload,typeof le=="function"){W=le.call(ne,W,H);break e}W=le;break e;case 3:le.flags=le.flags&-65537|128;case 0:if(le=ue.payload,H=typeof le=="function"?le.call(ne,W,H):le,H==null)break e;W=Q({},W,H);break e;case 2:zs=!0}}k.callback!==null&&k.lane!==0&&(s.flags|=64,H=g.effects,H===null?g.effects=[k]:H.push(k))}else ne={eventTime:ne,lane:H,tag:k.tag,payload:k.payload,callback:k.callback,next:null},G===null?(O=G=ne,P=W):G=G.next=ne,_|=H;if(k=k.next,k===null){if(k=g.shared.pending,k===null)break;H=k,k=H.next,H.next=null,g.lastBaseUpdate=H,g.shared.pending=null}}while(!0);if(G===null&&(P=W),g.baseState=P,g.firstBaseUpdate=O,g.lastBaseUpdate=G,n=g.shared.interleaved,n!==null){g=n;do _|=g.lane,g=g.next;while(g!==n)}else v===null&&(g.shared.lanes=0);mn|=_,s.lanes=_,s.memoizedState=W}}function yu(s,n,o){if(s=n.effects,n.effects=null,s!==null)for(n=0;n<s.length;n++){var h=s[n],g=h.callback;if(g!==null){if(h.callback=null,h=o,typeof g!="function")throw Error(t(191,g));g.call(h)}}}var Oi={},us=Ds(Oi),zi=Ds(Oi),Bi=Ds(Oi);function fn(s){if(s===Oi)throw Error(t(174));return s}function il(s,n){switch(Fe(Bi,n),Fe(zi,s),Fe(us,Oi),s=n.nodeType,s){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:io(null,"");break;default:s=s===8?n.parentNode:n,n=s.namespaceURI||null,s=s.tagName,n=io(n,s)}ze(us),Fe(us,n)}function Gn(){ze(us),ze(zi),ze(Bi)}function wu(s){fn(Bi.current);var n=fn(us.current),o=io(n,s.type);n!==o&&(Fe(zi,s),Fe(us,o))}function rl(s){zi.current===s&&(ze(us),ze(zi))}var $e=Ds(0);function ta(s){for(var n=s;n!==null;){if(n.tag===13){var o=n.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break;for(;n.sibling===null;){if(n.return===null||n.return===s)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var al=[];function ol(){for(var s=0;s<al.length;s++)al[s]._workInProgressVersionPrimary=null;al.length=0}var sa=E.ReactCurrentDispatcher,ll=E.ReactCurrentBatchConfig,pn=0,Ge=null,st=null,at=null,na=!1,Ui=!1,Hi=0,Bm=0;function pt(){throw Error(t(321))}function cl(s,n){if(n===null)return!1;for(var o=0;o<n.length&&o<s.length;o++)if(!Zt(s[o],n[o]))return!1;return!0}function dl(s,n,o,h,g,v){if(pn=v,Ge=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,sa.current=s===null||s.memoizedState===null?Gm:Wm,s=o(h,g),Ui){v=0;do{if(Ui=!1,Hi=0,25<=v)throw Error(t(301));v+=1,at=st=null,n.updateQueue=null,sa.current=qm,s=o(h,g)}while(Ui)}if(sa.current=aa,n=st!==null&&st.next!==null,pn=0,at=st=Ge=null,na=!1,n)throw Error(t(300));return s}function ul(){var s=Hi!==0;return Hi=0,s}function hs(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return at===null?Ge.memoizedState=at=s:at=at.next=s,at}function Wt(){if(st===null){var s=Ge.alternate;s=s!==null?s.memoizedState:null}else s=st.next;var n=at===null?Ge.memoizedState:at.next;if(n!==null)at=n,st=s;else{if(s===null)throw Error(t(310));st=s,s={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},at===null?Ge.memoizedState=at=s:at=at.next=s}return at}function $i(s,n){return typeof n=="function"?n(s):n}function hl(s){var n=Wt(),o=n.queue;if(o===null)throw Error(t(311));o.lastRenderedReducer=s;var h=st,g=h.baseQueue,v=o.pending;if(v!==null){if(g!==null){var _=g.next;g.next=v.next,v.next=_}h.baseQueue=g=v,o.pending=null}if(g!==null){v=g.next,h=h.baseState;var k=_=null,P=null,O=v;do{var G=O.lane;if((pn&G)===G)P!==null&&(P=P.next={lane:0,action:O.action,hasEagerState:O.hasEagerState,eagerState:O.eagerState,next:null}),h=O.hasEagerState?O.eagerState:s(h,O.action);else{var W={lane:G,action:O.action,hasEagerState:O.hasEagerState,eagerState:O.eagerState,next:null};P===null?(k=P=W,_=h):P=P.next=W,Ge.lanes|=G,mn|=G}O=O.next}while(O!==null&&O!==v);P===null?_=h:P.next=k,Zt(h,n.memoizedState)||(Ct=!0),n.memoizedState=h,n.baseState=_,n.baseQueue=P,o.lastRenderedState=h}if(s=o.interleaved,s!==null){g=s;do v=g.lane,Ge.lanes|=v,mn|=v,g=g.next;while(g!==s)}else g===null&&(o.lanes=0);return[n.memoizedState,o.dispatch]}function fl(s){var n=Wt(),o=n.queue;if(o===null)throw Error(t(311));o.lastRenderedReducer=s;var h=o.dispatch,g=o.pending,v=n.memoizedState;if(g!==null){o.pending=null;var _=g=g.next;do v=s(v,_.action),_=_.next;while(_!==g);Zt(v,n.memoizedState)||(Ct=!0),n.memoizedState=v,n.baseQueue===null&&(n.baseState=v),o.lastRenderedState=v}return[v,h]}function Au(){}function _u(s,n){var o=Ge,h=Wt(),g=n(),v=!Zt(h.memoizedState,g);if(v&&(h.memoizedState=g,Ct=!0),h=h.queue,pl(Eu.bind(null,o,h,s),[s]),h.getSnapshot!==n||v||at!==null&&at.memoizedState.tag&1){if(o.flags|=2048,Gi(9,Nu.bind(null,o,h,g,n),void 0,null),ot===null)throw Error(t(349));(pn&30)!==0||Su(o,n,g)}return g}function Su(s,n,o){s.flags|=16384,s={getSnapshot:n,value:o},n=Ge.updateQueue,n===null?(n={lastEffect:null,stores:null},Ge.updateQueue=n,n.stores=[s]):(o=n.stores,o===null?n.stores=[s]:o.push(s))}function Nu(s,n,o,h){n.value=o,n.getSnapshot=h,ku(n)&&ju(s)}function Eu(s,n,o){return o(function(){ku(n)&&ju(s)})}function ku(s){var n=s.getSnapshot;s=s.value;try{var o=n();return!Zt(s,o)}catch{return!0}}function ju(s){var n=As(s,1);n!==null&&is(n,s,1,-1)}function Cu(s){var n=hs();return typeof s=="function"&&(s=s()),n.memoizedState=n.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$i,lastRenderedState:s},n.queue=s,s=s.dispatch=$m.bind(null,Ge,s),[n.memoizedState,s]}function Gi(s,n,o,h){return s={tag:s,create:n,destroy:o,deps:h,next:null},n=Ge.updateQueue,n===null?(n={lastEffect:null,stores:null},Ge.updateQueue=n,n.lastEffect=s.next=s):(o=n.lastEffect,o===null?n.lastEffect=s.next=s:(h=o.next,o.next=s,s.next=h,n.lastEffect=s)),s}function Tu(){return Wt().memoizedState}function ia(s,n,o,h){var g=hs();Ge.flags|=s,g.memoizedState=Gi(1|n,o,void 0,h===void 0?null:h)}function ra(s,n,o,h){var g=Wt();h=h===void 0?null:h;var v=void 0;if(st!==null){var _=st.memoizedState;if(v=_.destroy,h!==null&&cl(h,_.deps)){g.memoizedState=Gi(n,o,v,h);return}}Ge.flags|=s,g.memoizedState=Gi(1|n,o,v,h)}function Pu(s,n){return ia(8390656,8,s,n)}function pl(s,n){return ra(2048,8,s,n)}function Ru(s,n){return ra(4,2,s,n)}function Lu(s,n){return ra(4,4,s,n)}function Mu(s,n){if(typeof n=="function")return s=s(),n(s),function(){n(null)};if(n!=null)return s=s(),n.current=s,function(){n.current=null}}function Vu(s,n,o){return o=o!=null?o.concat([s]):null,ra(4,4,Mu.bind(null,n,s),o)}function ml(){}function Iu(s,n){var o=Wt();n=n===void 0?null:n;var h=o.memoizedState;return h!==null&&n!==null&&cl(n,h[1])?h[0]:(o.memoizedState=[s,n],s)}function Du(s,n){var o=Wt();n=n===void 0?null:n;var h=o.memoizedState;return h!==null&&n!==null&&cl(n,h[1])?h[0]:(s=s(),o.memoizedState=[s,n],s)}function Fu(s,n,o){return(pn&21)===0?(s.baseState&&(s.baseState=!1,Ct=!0),s.memoizedState=o):(Zt(o,n)||(o=pd(),Ge.lanes|=o,mn|=o,s.baseState=!0),n)}function Um(s,n){var o=Ve;Ve=o!==0&&4>o?o:4,s(!0);var h=ll.transition;ll.transition={};try{s(!1),n()}finally{Ve=o,ll.transition=h}}function Ou(){return Wt().memoizedState}function Hm(s,n,o){var h=Gs(s);if(o={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null},zu(s))Bu(n,o);else if(o=xu(s,n,o,h),o!==null){var g=_t();is(o,s,h,g),Uu(o,n,h)}}function $m(s,n,o){var h=Gs(s),g={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null};if(zu(s))Bu(n,g);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=n.lastRenderedReducer,v!==null))try{var _=n.lastRenderedState,k=v(_,o);if(g.hasEagerState=!0,g.eagerState=k,Zt(k,_)){var P=n.interleaved;P===null?(g.next=g,sl(n)):(g.next=P.next,P.next=g),n.interleaved=g;return}}catch{}o=xu(s,n,g,h),o!==null&&(g=_t(),is(o,s,h,g),Uu(o,n,h))}}function zu(s){var n=s.alternate;return s===Ge||n!==null&&n===Ge}function Bu(s,n){Ui=na=!0;var o=s.pending;o===null?n.next=n:(n.next=o.next,o.next=n),s.pending=n}function Uu(s,n,o){if((o&4194240)!==0){var h=n.lanes;h&=s.pendingLanes,o|=h,n.lanes=o,xo(s,o)}}var aa={readContext:Gt,useCallback:pt,useContext:pt,useEffect:pt,useImperativeHandle:pt,useInsertionEffect:pt,useLayoutEffect:pt,useMemo:pt,useReducer:pt,useRef:pt,useState:pt,useDebugValue:pt,useDeferredValue:pt,useTransition:pt,useMutableSource:pt,useSyncExternalStore:pt,useId:pt,unstable_isNewReconciler:!1},Gm={readContext:Gt,useCallback:function(s,n){return hs().memoizedState=[s,n===void 0?null:n],s},useContext:Gt,useEffect:Pu,useImperativeHandle:function(s,n,o){return o=o!=null?o.concat([s]):null,ia(4194308,4,Mu.bind(null,n,s),o)},useLayoutEffect:function(s,n){return ia(4194308,4,s,n)},useInsertionEffect:function(s,n){return ia(4,2,s,n)},useMemo:function(s,n){var o=hs();return n=n===void 0?null:n,s=s(),o.memoizedState=[s,n],s},useReducer:function(s,n,o){var h=hs();return n=o!==void 0?o(n):n,h.memoizedState=h.baseState=n,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:n},h.queue=s,s=s.dispatch=Hm.bind(null,Ge,s),[h.memoizedState,s]},useRef:function(s){var n=hs();return s={current:s},n.memoizedState=s},useState:Cu,useDebugValue:ml,useDeferredValue:function(s){return hs().memoizedState=s},useTransition:function(){var s=Cu(!1),n=s[0];return s=Um.bind(null,s[1]),hs().memoizedState=s,[n,s]},useMutableSource:function(){},useSyncExternalStore:function(s,n,o){var h=Ge,g=hs();if(Be){if(o===void 0)throw Error(t(407));o=o()}else{if(o=n(),ot===null)throw Error(t(349));(pn&30)!==0||Su(h,n,o)}g.memoizedState=o;var v={value:o,getSnapshot:n};return g.queue=v,Pu(Eu.bind(null,h,v,s),[s]),h.flags|=2048,Gi(9,Nu.bind(null,h,v,o,n),void 0,null),o},useId:function(){var s=hs(),n=ot.identifierPrefix;if(Be){var o=ws,h=ys;o=(h&~(1<<32-Jt(h)-1)).toString(32)+o,n=":"+n+"R"+o,o=Hi++,0<o&&(n+="H"+o.toString(32)),n+=":"}else o=Bm++,n=":"+n+"r"+o.toString(32)+":";return s.memoizedState=n},unstable_isNewReconciler:!1},Wm={readContext:Gt,useCallback:Iu,useContext:Gt,useEffect:pl,useImperativeHandle:Vu,useInsertionEffect:Ru,useLayoutEffect:Lu,useMemo:Du,useReducer:hl,useRef:Tu,useState:function(){return hl($i)},useDebugValue:ml,useDeferredValue:function(s){var n=Wt();return Fu(n,st.memoizedState,s)},useTransition:function(){var s=hl($i)[0],n=Wt().memoizedState;return[s,n]},useMutableSource:Au,useSyncExternalStore:_u,useId:Ou,unstable_isNewReconciler:!1},qm={readContext:Gt,useCallback:Iu,useContext:Gt,useEffect:pl,useImperativeHandle:Vu,useInsertionEffect:Ru,useLayoutEffect:Lu,useMemo:Du,useReducer:fl,useRef:Tu,useState:function(){return fl($i)},useDebugValue:ml,useDeferredValue:function(s){var n=Wt();return st===null?n.memoizedState=s:Fu(n,st.memoizedState,s)},useTransition:function(){var s=fl($i)[0],n=Wt().memoizedState;return[s,n]},useMutableSource:Au,useSyncExternalStore:_u,useId:Ou,unstable_isNewReconciler:!1};function ts(s,n){if(s&&s.defaultProps){n=Q({},n),s=s.defaultProps;for(var o in s)n[o]===void 0&&(n[o]=s[o]);return n}return n}function gl(s,n,o,h){n=s.memoizedState,o=o(h,n),o=o==null?n:Q({},n,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var oa={isMounted:function(s){return(s=s._reactInternals)?on(s)===s:!1},enqueueSetState:function(s,n,o){s=s._reactInternals;var h=_t(),g=Gs(s),v=_s(h,g);v.payload=n,o!=null&&(v.callback=o),n=Bs(s,v,g),n!==null&&(is(n,s,g,h),Zr(n,s,g))},enqueueReplaceState:function(s,n,o){s=s._reactInternals;var h=_t(),g=Gs(s),v=_s(h,g);v.tag=1,v.payload=n,o!=null&&(v.callback=o),n=Bs(s,v,g),n!==null&&(is(n,s,g,h),Zr(n,s,g))},enqueueForceUpdate:function(s,n){s=s._reactInternals;var o=_t(),h=Gs(s),g=_s(o,h);g.tag=2,n!=null&&(g.callback=n),n=Bs(s,g,h),n!==null&&(is(n,s,h,o),Zr(n,s,h))}};function Hu(s,n,o,h,g,v,_){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,v,_):n.prototype&&n.prototype.isPureReactComponent?!Pi(o,h)||!Pi(g,v):!0}function $u(s,n,o){var h=!1,g=Fs,v=n.contextType;return typeof v=="object"&&v!==null?v=Gt(v):(g=jt(n)?cn:ft.current,h=n.contextTypes,v=(h=h!=null)?Fn(s,g):Fs),n=new n(o,v),s.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=oa,s.stateNode=n,n._reactInternals=s,h&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=g,s.__reactInternalMemoizedMaskedChildContext=v),n}function Gu(s,n,o,h){s=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(o,h),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(o,h),n.state!==s&&oa.enqueueReplaceState(n,n.state,null)}function xl(s,n,o,h){var g=s.stateNode;g.props=o,g.state=s.memoizedState,g.refs={},nl(s);var v=n.contextType;typeof v=="object"&&v!==null?g.context=Gt(v):(v=jt(n)?cn:ft.current,g.context=Fn(s,v)),g.state=s.memoizedState,v=n.getDerivedStateFromProps,typeof v=="function"&&(gl(s,n,v,o),g.state=s.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(n=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),n!==g.state&&oa.enqueueReplaceState(g,g.state,null),ea(s,o,g,h),g.state=s.memoizedState),typeof g.componentDidMount=="function"&&(s.flags|=4194308)}function Wn(s,n){try{var o="",h=n;do o+=U(h),h=h.return;while(h);var g=o}catch(v){g=`
Error generating stack: `+v.message+`
`+v.stack}return{value:s,source:n,stack:g,digest:null}}function vl(s,n,o){return{value:s,source:null,stack:o??null,digest:n??null}}function bl(s,n){try{console.error(n.value)}catch(o){setTimeout(function(){throw o})}}var Xm=typeof WeakMap=="function"?WeakMap:Map;function Wu(s,n,o){o=_s(-1,o),o.tag=3,o.payload={element:null};var h=n.value;return o.callback=function(){pa||(pa=!0,Ml=h),bl(s,n)},o}function qu(s,n,o){o=_s(-1,o),o.tag=3;var h=s.type.getDerivedStateFromError;if(typeof h=="function"){var g=n.value;o.payload=function(){return h(g)},o.callback=function(){bl(s,n)}}var v=s.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(o.callback=function(){bl(s,n),typeof h!="function"&&(Hs===null?Hs=new Set([this]):Hs.add(this));var _=n.stack;this.componentDidCatch(n.value,{componentStack:_!==null?_:""})}),o}function Xu(s,n,o){var h=s.pingCache;if(h===null){h=s.pingCache=new Xm;var g=new Set;h.set(n,g)}else g=h.get(n),g===void 0&&(g=new Set,h.set(n,g));g.has(o)||(g.add(o),s=lg.bind(null,s,n,o),n.then(s,s))}function Yu(s){do{var n;if((n=s.tag===13)&&(n=s.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return s;s=s.return}while(s!==null);return null}function Ku(s,n,o,h,g){return(s.mode&1)===0?(s===n?s.flags|=65536:(s.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(n=_s(-1,1),n.tag=2,Bs(o,n,1))),o.lanes|=1),s):(s.flags|=65536,s.lanes=g,s)}var Ym=E.ReactCurrentOwner,Ct=!1;function At(s,n,o,h){n.child=s===null?gu(n,null,o,h):Un(n,s.child,o,h)}function Qu(s,n,o,h,g){o=o.render;var v=n.ref;return $n(n,g),h=dl(s,n,o,h,v,g),o=ul(),s!==null&&!Ct?(n.updateQueue=s.updateQueue,n.flags&=-2053,s.lanes&=~g,Ss(s,n,g)):(Be&&o&&qo(n),n.flags|=1,At(s,n,h,g),n.child)}function Ju(s,n,o,h,g){if(s===null){var v=o.type;return typeof v=="function"&&!Bl(v)&&v.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(n.tag=15,n.type=v,Zu(s,n,v,h,g)):(s=ya(o.type,null,h,n,n.mode,g),s.ref=n.ref,s.return=n,n.child=s)}if(v=s.child,(s.lanes&g)===0){var _=v.memoizedProps;if(o=o.compare,o=o!==null?o:Pi,o(_,h)&&s.ref===n.ref)return Ss(s,n,g)}return n.flags|=1,s=qs(v,h),s.ref=n.ref,s.return=n,n.child=s}function Zu(s,n,o,h,g){if(s!==null){var v=s.memoizedProps;if(Pi(v,h)&&s.ref===n.ref)if(Ct=!1,n.pendingProps=h=v,(s.lanes&g)!==0)(s.flags&131072)!==0&&(Ct=!0);else return n.lanes=s.lanes,Ss(s,n,g)}return yl(s,n,o,h,g)}function eh(s,n,o){var h=n.pendingProps,g=h.children,v=s!==null?s.memoizedState:null;if(h.mode==="hidden")if((n.mode&1)===0)n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fe(Xn,Ot),Ot|=o;else{if((o&1073741824)===0)return s=v!==null?v.baseLanes|o:o,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:s,cachePool:null,transitions:null},n.updateQueue=null,Fe(Xn,Ot),Ot|=s,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=v!==null?v.baseLanes:o,Fe(Xn,Ot),Ot|=h}else v!==null?(h=v.baseLanes|o,n.memoizedState=null):h=o,Fe(Xn,Ot),Ot|=h;return At(s,n,g,o),n.child}function th(s,n){var o=n.ref;(s===null&&o!==null||s!==null&&s.ref!==o)&&(n.flags|=512,n.flags|=2097152)}function yl(s,n,o,h,g){var v=jt(o)?cn:ft.current;return v=Fn(n,v),$n(n,g),o=dl(s,n,o,h,v,g),h=ul(),s!==null&&!Ct?(n.updateQueue=s.updateQueue,n.flags&=-2053,s.lanes&=~g,Ss(s,n,g)):(Be&&h&&qo(n),n.flags|=1,At(s,n,o,g),n.child)}function sh(s,n,o,h,g){if(jt(o)){var v=!0;Gr(n)}else v=!1;if($n(n,g),n.stateNode===null)ca(s,n),$u(n,o,h),xl(n,o,h,g),h=!0;else if(s===null){var _=n.stateNode,k=n.memoizedProps;_.props=k;var P=_.context,O=o.contextType;typeof O=="object"&&O!==null?O=Gt(O):(O=jt(o)?cn:ft.current,O=Fn(n,O));var G=o.getDerivedStateFromProps,W=typeof G=="function"||typeof _.getSnapshotBeforeUpdate=="function";W||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(k!==h||P!==O)&&Gu(n,_,h,O),zs=!1;var H=n.memoizedState;_.state=H,ea(n,h,_,g),P=n.memoizedState,k!==h||H!==P||kt.current||zs?(typeof G=="function"&&(gl(n,o,G,h),P=n.memoizedState),(k=zs||Hu(n,o,k,h,H,P,O))?(W||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(n.flags|=4194308)):(typeof _.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=h,n.memoizedState=P),_.props=h,_.state=P,_.context=O,h=k):(typeof _.componentDidMount=="function"&&(n.flags|=4194308),h=!1)}else{_=n.stateNode,vu(s,n),k=n.memoizedProps,O=n.type===n.elementType?k:ts(n.type,k),_.props=O,W=n.pendingProps,H=_.context,P=o.contextType,typeof P=="object"&&P!==null?P=Gt(P):(P=jt(o)?cn:ft.current,P=Fn(n,P));var ne=o.getDerivedStateFromProps;(G=typeof ne=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(k!==W||H!==P)&&Gu(n,_,h,P),zs=!1,H=n.memoizedState,_.state=H,ea(n,h,_,g);var le=n.memoizedState;k!==W||H!==le||kt.current||zs?(typeof ne=="function"&&(gl(n,o,ne,h),le=n.memoizedState),(O=zs||Hu(n,o,O,h,H,le,P)||!1)?(G||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(h,le,P),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(h,le,P)),typeof _.componentDidUpdate=="function"&&(n.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof _.componentDidUpdate!="function"||k===s.memoizedProps&&H===s.memoizedState||(n.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||k===s.memoizedProps&&H===s.memoizedState||(n.flags|=1024),n.memoizedProps=h,n.memoizedState=le),_.props=h,_.state=le,_.context=P,h=O):(typeof _.componentDidUpdate!="function"||k===s.memoizedProps&&H===s.memoizedState||(n.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||k===s.memoizedProps&&H===s.memoizedState||(n.flags|=1024),h=!1)}return wl(s,n,o,h,v,g)}function wl(s,n,o,h,g,v){th(s,n);var _=(n.flags&128)!==0;if(!h&&!_)return g&&ou(n,o,!1),Ss(s,n,v);h=n.stateNode,Ym.current=n;var k=_&&typeof o.getDerivedStateFromError!="function"?null:h.render();return n.flags|=1,s!==null&&_?(n.child=Un(n,s.child,null,v),n.child=Un(n,null,k,v)):At(s,n,k,v),n.memoizedState=h.state,g&&ou(n,o,!0),n.child}function nh(s){var n=s.stateNode;n.pendingContext?ru(s,n.pendingContext,n.pendingContext!==n.context):n.context&&ru(s,n.context,!1),il(s,n.containerInfo)}function ih(s,n,o,h,g){return Bn(),Qo(g),n.flags|=256,At(s,n,o,h),n.child}var Al={dehydrated:null,treeContext:null,retryLane:0};function _l(s){return{baseLanes:s,cachePool:null,transitions:null}}function rh(s,n,o){var h=n.pendingProps,g=$e.current,v=!1,_=(n.flags&128)!==0,k;if((k=_)||(k=s!==null&&s.memoizedState===null?!1:(g&2)!==0),k?(v=!0,n.flags&=-129):(s===null||s.memoizedState!==null)&&(g|=1),Fe($e,g&1),s===null)return Ko(n),s=n.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((n.mode&1)===0?n.lanes=1:s.data==="$!"?n.lanes=8:n.lanes=1073741824,null):(_=h.children,s=h.fallback,v?(h=n.mode,v=n.child,_={mode:"hidden",children:_},(h&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=_):v=wa(_,h,0,null),s=bn(s,h,o,null),v.return=n,s.return=n,v.sibling=s,n.child=v,n.child.memoizedState=_l(o),n.memoizedState=Al,s):Sl(n,_));if(g=s.memoizedState,g!==null&&(k=g.dehydrated,k!==null))return Km(s,n,_,h,k,g,o);if(v){v=h.fallback,_=n.mode,g=s.child,k=g.sibling;var P={mode:"hidden",children:h.children};return(_&1)===0&&n.child!==g?(h=n.child,h.childLanes=0,h.pendingProps=P,n.deletions=null):(h=qs(g,P),h.subtreeFlags=g.subtreeFlags&14680064),k!==null?v=qs(k,v):(v=bn(v,_,o,null),v.flags|=2),v.return=n,h.return=n,h.sibling=v,n.child=h,h=v,v=n.child,_=s.child.memoizedState,_=_===null?_l(o):{baseLanes:_.baseLanes|o,cachePool:null,transitions:_.transitions},v.memoizedState=_,v.childLanes=s.childLanes&~o,n.memoizedState=Al,h}return v=s.child,s=v.sibling,h=qs(v,{mode:"visible",children:h.children}),(n.mode&1)===0&&(h.lanes=o),h.return=n,h.sibling=null,s!==null&&(o=n.deletions,o===null?(n.deletions=[s],n.flags|=16):o.push(s)),n.child=h,n.memoizedState=null,h}function Sl(s,n){return n=wa({mode:"visible",children:n},s.mode,0,null),n.return=s,s.child=n}function la(s,n,o,h){return h!==null&&Qo(h),Un(n,s.child,null,o),s=Sl(n,n.pendingProps.children),s.flags|=2,n.memoizedState=null,s}function Km(s,n,o,h,g,v,_){if(o)return n.flags&256?(n.flags&=-257,h=vl(Error(t(422))),la(s,n,_,h)):n.memoizedState!==null?(n.child=s.child,n.flags|=128,null):(v=h.fallback,g=n.mode,h=wa({mode:"visible",children:h.children},g,0,null),v=bn(v,g,_,null),v.flags|=2,h.return=n,v.return=n,h.sibling=v,n.child=h,(n.mode&1)!==0&&Un(n,s.child,null,_),n.child.memoizedState=_l(_),n.memoizedState=Al,v);if((n.mode&1)===0)return la(s,n,_,null);if(g.data==="$!"){if(h=g.nextSibling&&g.nextSibling.dataset,h)var k=h.dgst;return h=k,v=Error(t(419)),h=vl(v,h,void 0),la(s,n,_,h)}if(k=(_&s.childLanes)!==0,Ct||k){if(h=ot,h!==null){switch(_&-_){case 4:g=2;break;case 16:g=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:g=32;break;case 536870912:g=268435456;break;default:g=0}g=(g&(h.suspendedLanes|_))!==0?0:g,g!==0&&g!==v.retryLane&&(v.retryLane=g,As(s,g),is(h,s,g,-1))}return zl(),h=vl(Error(t(421))),la(s,n,_,h)}return g.data==="$?"?(n.flags|=128,n.child=s.child,n=cg.bind(null,s),g._reactRetry=n,null):(s=v.treeContext,Ft=Is(g.nextSibling),Dt=n,Be=!0,es=null,s!==null&&(Ht[$t++]=ys,Ht[$t++]=ws,Ht[$t++]=dn,ys=s.id,ws=s.overflow,dn=n),n=Sl(n,h.children),n.flags|=4096,n)}function ah(s,n,o){s.lanes|=n;var h=s.alternate;h!==null&&(h.lanes|=n),tl(s.return,n,o)}function Nl(s,n,o,h,g){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:g}:(v.isBackwards=n,v.rendering=null,v.renderingStartTime=0,v.last=h,v.tail=o,v.tailMode=g)}function oh(s,n,o){var h=n.pendingProps,g=h.revealOrder,v=h.tail;if(At(s,n,h.children,o),h=$e.current,(h&2)!==0)h=h&1|2,n.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=n.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&ah(s,o,n);else if(s.tag===19)ah(s,o,n);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break e;for(;s.sibling===null;){if(s.return===null||s.return===n)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}h&=1}if(Fe($e,h),(n.mode&1)===0)n.memoizedState=null;else switch(g){case"forwards":for(o=n.child,g=null;o!==null;)s=o.alternate,s!==null&&ta(s)===null&&(g=o),o=o.sibling;o=g,o===null?(g=n.child,n.child=null):(g=o.sibling,o.sibling=null),Nl(n,!1,g,o,v);break;case"backwards":for(o=null,g=n.child,n.child=null;g!==null;){if(s=g.alternate,s!==null&&ta(s)===null){n.child=g;break}s=g.sibling,g.sibling=o,o=g,g=s}Nl(n,!0,o,null,v);break;case"together":Nl(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function ca(s,n){(n.mode&1)===0&&s!==null&&(s.alternate=null,n.alternate=null,n.flags|=2)}function Ss(s,n,o){if(s!==null&&(n.dependencies=s.dependencies),mn|=n.lanes,(o&n.childLanes)===0)return null;if(s!==null&&n.child!==s.child)throw Error(t(153));if(n.child!==null){for(s=n.child,o=qs(s,s.pendingProps),n.child=o,o.return=n;s.sibling!==null;)s=s.sibling,o=o.sibling=qs(s,s.pendingProps),o.return=n;o.sibling=null}return n.child}function Qm(s,n,o){switch(n.tag){case 3:nh(n),Bn();break;case 5:wu(n);break;case 1:jt(n.type)&&Gr(n);break;case 4:il(n,n.stateNode.containerInfo);break;case 10:var h=n.type._context,g=n.memoizedProps.value;Fe(Qr,h._currentValue),h._currentValue=g;break;case 13:if(h=n.memoizedState,h!==null)return h.dehydrated!==null?(Fe($e,$e.current&1),n.flags|=128,null):(o&n.child.childLanes)!==0?rh(s,n,o):(Fe($e,$e.current&1),s=Ss(s,n,o),s!==null?s.sibling:null);Fe($e,$e.current&1);break;case 19:if(h=(o&n.childLanes)!==0,(s.flags&128)!==0){if(h)return oh(s,n,o);n.flags|=128}if(g=n.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Fe($e,$e.current),h)break;return null;case 22:case 23:return n.lanes=0,eh(s,n,o)}return Ss(s,n,o)}var lh,El,ch,dh;lh=function(s,n){for(var o=n.child;o!==null;){if(o.tag===5||o.tag===6)s.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},El=function(){},ch=function(s,n,o,h){var g=s.memoizedProps;if(g!==h){s=n.stateNode,fn(us.current);var v=null;switch(o){case"input":g=Ut(s,g),h=Ut(s,h),v=[];break;case"select":g=Q({},g,{value:void 0}),h=Q({},h,{value:void 0}),v=[];break;case"textarea":g=fi(s,g),h=fi(s,h),v=[];break;default:typeof g.onClick!="function"&&typeof h.onClick=="function"&&(s.onclick=Ur)}ro(o,h);var _;o=null;for(O in g)if(!h.hasOwnProperty(O)&&g.hasOwnProperty(O)&&g[O]!=null)if(O==="style"){var k=g[O];for(_ in k)k.hasOwnProperty(_)&&(o||(o={}),o[_]="")}else O!=="dangerouslySetInnerHTML"&&O!=="children"&&O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&O!=="autoFocus"&&(r.hasOwnProperty(O)?v||(v=[]):(v=v||[]).push(O,null));for(O in h){var P=h[O];if(k=g?.[O],h.hasOwnProperty(O)&&P!==k&&(P!=null||k!=null))if(O==="style")if(k){for(_ in k)!k.hasOwnProperty(_)||P&&P.hasOwnProperty(_)||(o||(o={}),o[_]="");for(_ in P)P.hasOwnProperty(_)&&k[_]!==P[_]&&(o||(o={}),o[_]=P[_])}else o||(v||(v=[]),v.push(O,o)),o=P;else O==="dangerouslySetInnerHTML"?(P=P?P.__html:void 0,k=k?k.__html:void 0,P!=null&&k!==P&&(v=v||[]).push(O,P)):O==="children"?typeof P!="string"&&typeof P!="number"||(v=v||[]).push(O,""+P):O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&(r.hasOwnProperty(O)?(P!=null&&O==="onScroll"&&Oe("scroll",s),v||k===P||(v=[])):(v=v||[]).push(O,P))}o&&(v=v||[]).push("style",o);var O=v;(n.updateQueue=O)&&(n.flags|=4)}},dh=function(s,n,o,h){o!==h&&(n.flags|=4)};function Wi(s,n){if(!Be)switch(s.tailMode){case"hidden":n=s.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?n||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function mt(s){var n=s.alternate!==null&&s.alternate.child===s.child,o=0,h=0;if(n)for(var g=s.child;g!==null;)o|=g.lanes|g.childLanes,h|=g.subtreeFlags&14680064,h|=g.flags&14680064,g.return=s,g=g.sibling;else for(g=s.child;g!==null;)o|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=s,g=g.sibling;return s.subtreeFlags|=h,s.childLanes=o,n}function Jm(s,n,o){var h=n.pendingProps;switch(Xo(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mt(n),null;case 1:return jt(n.type)&&$r(),mt(n),null;case 3:return h=n.stateNode,Gn(),ze(kt),ze(ft),ol(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(Yr(n)?n.flags|=4:s===null||s.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,es!==null&&(Dl(es),es=null))),El(s,n),mt(n),null;case 5:rl(n);var g=fn(Bi.current);if(o=n.type,s!==null&&n.stateNode!=null)ch(s,n,o,h,g),s.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!h){if(n.stateNode===null)throw Error(t(166));return mt(n),null}if(s=fn(us.current),Yr(n)){h=n.stateNode,o=n.type;var v=n.memoizedProps;switch(h[ds]=n,h[Ii]=v,s=(n.mode&1)!==0,o){case"dialog":Oe("cancel",h),Oe("close",h);break;case"iframe":case"object":case"embed":Oe("load",h);break;case"video":case"audio":for(g=0;g<Li.length;g++)Oe(Li[g],h);break;case"source":Oe("error",h);break;case"img":case"image":case"link":Oe("error",h),Oe("load",h);break;case"details":Oe("toggle",h);break;case"input":rn(h,v),Oe("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!v.multiple},Oe("invalid",h);break;case"textarea":J(h,v),Oe("invalid",h)}ro(o,v),g=null;for(var _ in v)if(v.hasOwnProperty(_)){var k=v[_];_==="children"?typeof k=="string"?h.textContent!==k&&(v.suppressHydrationWarning!==!0&&Br(h.textContent,k,s),g=["children",k]):typeof k=="number"&&h.textContent!==""+k&&(v.suppressHydrationWarning!==!0&&Br(h.textContent,k,s),g=["children",""+k]):r.hasOwnProperty(_)&&k!=null&&_==="onScroll"&&Oe("scroll",h)}switch(o){case"input":yt(h),ui(h,v,!0);break;case"textarea":yt(h),En(h);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(h.onclick=Ur)}h=g,n.updateQueue=h,h!==null&&(n.flags|=4)}else{_=g.nodeType===9?g:g.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=br(o)),s==="http://www.w3.org/1999/xhtml"?o==="script"?(s=_.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof h.is=="string"?s=_.createElement(o,{is:h.is}):(s=_.createElement(o),o==="select"&&(_=s,h.multiple?_.multiple=!0:h.size&&(_.size=h.size))):s=_.createElementNS(s,o),s[ds]=n,s[Ii]=h,lh(s,n,!1,!1),n.stateNode=s;e:{switch(_=ao(o,h),o){case"dialog":Oe("cancel",s),Oe("close",s),g=h;break;case"iframe":case"object":case"embed":Oe("load",s),g=h;break;case"video":case"audio":for(g=0;g<Li.length;g++)Oe(Li[g],s);g=h;break;case"source":Oe("error",s),g=h;break;case"img":case"image":case"link":Oe("error",s),Oe("load",s),g=h;break;case"details":Oe("toggle",s),g=h;break;case"input":rn(s,h),g=Ut(s,h),Oe("invalid",s);break;case"option":g=h;break;case"select":s._wrapperState={wasMultiple:!!h.multiple},g=Q({},h,{value:void 0}),Oe("invalid",s);break;case"textarea":J(s,h),g=fi(s,h),Oe("invalid",s);break;default:g=h}ro(o,g),k=g;for(v in k)if(k.hasOwnProperty(v)){var P=k[v];v==="style"?Zc(s,P):v==="dangerouslySetInnerHTML"?(P=P?P.__html:void 0,P!=null&&Qc(s,P)):v==="children"?typeof P=="string"?(o!=="textarea"||P!=="")&&pi(s,P):typeof P=="number"&&pi(s,""+P):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(r.hasOwnProperty(v)?P!=null&&v==="onScroll"&&Oe("scroll",s):P!=null&&R(s,v,P,_))}switch(o){case"input":yt(s),ui(s,h,!1);break;case"textarea":yt(s),En(s);break;case"option":h.value!=null&&s.setAttribute("value",""+K(h.value));break;case"select":s.multiple=!!h.multiple,v=h.value,v!=null?Cs(s,!!h.multiple,v,!1):h.defaultValue!=null&&Cs(s,!!h.multiple,h.defaultValue,!0);break;default:typeof g.onClick=="function"&&(s.onclick=Ur)}switch(o){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return mt(n),null;case 6:if(s&&n.stateNode!=null)dh(s,n,s.memoizedProps,h);else{if(typeof h!="string"&&n.stateNode===null)throw Error(t(166));if(o=fn(Bi.current),fn(us.current),Yr(n)){if(h=n.stateNode,o=n.memoizedProps,h[ds]=n,(v=h.nodeValue!==o)&&(s=Dt,s!==null))switch(s.tag){case 3:Br(h.nodeValue,o,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Br(h.nodeValue,o,(s.mode&1)!==0)}v&&(n.flags|=4)}else h=(o.nodeType===9?o:o.ownerDocument).createTextNode(h),h[ds]=n,n.stateNode=h}return mt(n),null;case 13:if(ze($e),h=n.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Be&&Ft!==null&&(n.mode&1)!==0&&(n.flags&128)===0)fu(),Bn(),n.flags|=98560,v=!1;else if(v=Yr(n),h!==null&&h.dehydrated!==null){if(s===null){if(!v)throw Error(t(318));if(v=n.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(t(317));v[ds]=n}else Bn(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;mt(n),v=!1}else es!==null&&(Dl(es),es=null),v=!0;if(!v)return n.flags&65536?n:null}return(n.flags&128)!==0?(n.lanes=o,n):(h=h!==null,h!==(s!==null&&s.memoizedState!==null)&&h&&(n.child.flags|=8192,(n.mode&1)!==0&&(s===null||($e.current&1)!==0?nt===0&&(nt=3):zl())),n.updateQueue!==null&&(n.flags|=4),mt(n),null);case 4:return Gn(),El(s,n),s===null&&Mi(n.stateNode.containerInfo),mt(n),null;case 10:return el(n.type._context),mt(n),null;case 17:return jt(n.type)&&$r(),mt(n),null;case 19:if(ze($e),v=n.memoizedState,v===null)return mt(n),null;if(h=(n.flags&128)!==0,_=v.rendering,_===null)if(h)Wi(v,!1);else{if(nt!==0||s!==null&&(s.flags&128)!==0)for(s=n.child;s!==null;){if(_=ta(s),_!==null){for(n.flags|=128,Wi(v,!1),h=_.updateQueue,h!==null&&(n.updateQueue=h,n.flags|=4),n.subtreeFlags=0,h=o,o=n.child;o!==null;)v=o,s=h,v.flags&=14680066,_=v.alternate,_===null?(v.childLanes=0,v.lanes=s,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=_.childLanes,v.lanes=_.lanes,v.child=_.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=_.memoizedProps,v.memoizedState=_.memoizedState,v.updateQueue=_.updateQueue,v.type=_.type,s=_.dependencies,v.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),o=o.sibling;return Fe($e,$e.current&1|2),n.child}s=s.sibling}v.tail!==null&&Xe()>Yn&&(n.flags|=128,h=!0,Wi(v,!1),n.lanes=4194304)}else{if(!h)if(s=ta(_),s!==null){if(n.flags|=128,h=!0,o=s.updateQueue,o!==null&&(n.updateQueue=o,n.flags|=4),Wi(v,!0),v.tail===null&&v.tailMode==="hidden"&&!_.alternate&&!Be)return mt(n),null}else 2*Xe()-v.renderingStartTime>Yn&&o!==1073741824&&(n.flags|=128,h=!0,Wi(v,!1),n.lanes=4194304);v.isBackwards?(_.sibling=n.child,n.child=_):(o=v.last,o!==null?o.sibling=_:n.child=_,v.last=_)}return v.tail!==null?(n=v.tail,v.rendering=n,v.tail=n.sibling,v.renderingStartTime=Xe(),n.sibling=null,o=$e.current,Fe($e,h?o&1|2:o&1),n):(mt(n),null);case 22:case 23:return Ol(),h=n.memoizedState!==null,s!==null&&s.memoizedState!==null!==h&&(n.flags|=8192),h&&(n.mode&1)!==0?(Ot&1073741824)!==0&&(mt(n),n.subtreeFlags&6&&(n.flags|=8192)):mt(n),null;case 24:return null;case 25:return null}throw Error(t(156,n.tag))}function Zm(s,n){switch(Xo(n),n.tag){case 1:return jt(n.type)&&$r(),s=n.flags,s&65536?(n.flags=s&-65537|128,n):null;case 3:return Gn(),ze(kt),ze(ft),ol(),s=n.flags,(s&65536)!==0&&(s&128)===0?(n.flags=s&-65537|128,n):null;case 5:return rl(n),null;case 13:if(ze($e),s=n.memoizedState,s!==null&&s.dehydrated!==null){if(n.alternate===null)throw Error(t(340));Bn()}return s=n.flags,s&65536?(n.flags=s&-65537|128,n):null;case 19:return ze($e),null;case 4:return Gn(),null;case 10:return el(n.type._context),null;case 22:case 23:return Ol(),null;case 24:return null;default:return null}}var da=!1,gt=!1,eg=typeof WeakSet=="function"?WeakSet:Set,re=null;function qn(s,n){var o=s.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(h){qe(s,n,h)}else o.current=null}function kl(s,n,o){try{o()}catch(h){qe(s,n,h)}}var uh=!1;function tg(s,n){if(Oo=Tr,s=Hd(),Po(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var g=h.anchorOffset,v=h.focusNode;h=h.focusOffset;try{o.nodeType,v.nodeType}catch{o=null;break e}var _=0,k=-1,P=-1,O=0,G=0,W=s,H=null;t:for(;;){for(var ne;W!==o||g!==0&&W.nodeType!==3||(k=_+g),W!==v||h!==0&&W.nodeType!==3||(P=_+h),W.nodeType===3&&(_+=W.nodeValue.length),(ne=W.firstChild)!==null;)H=W,W=ne;for(;;){if(W===s)break t;if(H===o&&++O===g&&(k=_),H===v&&++G===h&&(P=_),(ne=W.nextSibling)!==null)break;W=H,H=W.parentNode}W=ne}o=k===-1||P===-1?null:{start:k,end:P}}else o=null}o=o||{start:0,end:0}}else o=null;for(zo={focusedElem:s,selectionRange:o},Tr=!1,re=n;re!==null;)if(n=re,s=n.child,(n.subtreeFlags&1028)!==0&&s!==null)s.return=n,re=s;else for(;re!==null;){n=re;try{var le=n.alternate;if((n.flags&1024)!==0)switch(n.tag){case 0:case 11:case 15:break;case 1:if(le!==null){var ue=le.memoizedProps,Ye=le.memoizedState,D=n.stateNode,M=D.getSnapshotBeforeUpdate(n.elementType===n.type?ue:ts(n.type,ue),Ye);D.__reactInternalSnapshotBeforeUpdate=M}break;case 3:var F=n.stateNode.containerInfo;F.nodeType===1?F.textContent="":F.nodeType===9&&F.documentElement&&F.removeChild(F.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Y){qe(n,n.return,Y)}if(s=n.sibling,s!==null){s.return=n.return,re=s;break}re=n.return}return le=uh,uh=!1,le}function qi(s,n,o){var h=n.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var g=h=h.next;do{if((g.tag&s)===s){var v=g.destroy;g.destroy=void 0,v!==void 0&&kl(n,o,v)}g=g.next}while(g!==h)}}function ua(s,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var o=n=n.next;do{if((o.tag&s)===s){var h=o.create;o.destroy=h()}o=o.next}while(o!==n)}}function jl(s){var n=s.ref;if(n!==null){var o=s.stateNode;s.tag,s=o,typeof n=="function"?n(s):n.current=s}}function hh(s){var n=s.alternate;n!==null&&(s.alternate=null,hh(n)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(n=s.stateNode,n!==null&&(delete n[ds],delete n[Ii],delete n[$o],delete n[Dm],delete n[Fm])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function fh(s){return s.tag===5||s.tag===3||s.tag===4}function ph(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||fh(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Cl(s,n,o){var h=s.tag;if(h===5||h===6)s=s.stateNode,n?o.nodeType===8?o.parentNode.insertBefore(s,n):o.insertBefore(s,n):(o.nodeType===8?(n=o.parentNode,n.insertBefore(s,o)):(n=o,n.appendChild(s)),o=o._reactRootContainer,o!=null||n.onclick!==null||(n.onclick=Ur));else if(h!==4&&(s=s.child,s!==null))for(Cl(s,n,o),s=s.sibling;s!==null;)Cl(s,n,o),s=s.sibling}function Tl(s,n,o){var h=s.tag;if(h===5||h===6)s=s.stateNode,n?o.insertBefore(s,n):o.appendChild(s);else if(h!==4&&(s=s.child,s!==null))for(Tl(s,n,o),s=s.sibling;s!==null;)Tl(s,n,o),s=s.sibling}var ut=null,ss=!1;function Us(s,n,o){for(o=o.child;o!==null;)mh(s,n,o),o=o.sibling}function mh(s,n,o){if(cs&&typeof cs.onCommitFiberUnmount=="function")try{cs.onCommitFiberUnmount(Sr,o)}catch{}switch(o.tag){case 5:gt||qn(o,n);case 6:var h=ut,g=ss;ut=null,Us(s,n,o),ut=h,ss=g,ut!==null&&(ss?(s=ut,o=o.stateNode,s.nodeType===8?s.parentNode.removeChild(o):s.removeChild(o)):ut.removeChild(o.stateNode));break;case 18:ut!==null&&(ss?(s=ut,o=o.stateNode,s.nodeType===8?Ho(s.parentNode,o):s.nodeType===1&&Ho(s,o),Ni(s)):Ho(ut,o.stateNode));break;case 4:h=ut,g=ss,ut=o.stateNode.containerInfo,ss=!0,Us(s,n,o),ut=h,ss=g;break;case 0:case 11:case 14:case 15:if(!gt&&(h=o.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){g=h=h.next;do{var v=g,_=v.destroy;v=v.tag,_!==void 0&&((v&2)!==0||(v&4)!==0)&&kl(o,n,_),g=g.next}while(g!==h)}Us(s,n,o);break;case 1:if(!gt&&(qn(o,n),h=o.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=o.memoizedProps,h.state=o.memoizedState,h.componentWillUnmount()}catch(k){qe(o,n,k)}Us(s,n,o);break;case 21:Us(s,n,o);break;case 22:o.mode&1?(gt=(h=gt)||o.memoizedState!==null,Us(s,n,o),gt=h):Us(s,n,o);break;default:Us(s,n,o)}}function gh(s){var n=s.updateQueue;if(n!==null){s.updateQueue=null;var o=s.stateNode;o===null&&(o=s.stateNode=new eg),n.forEach(function(h){var g=dg.bind(null,s,h);o.has(h)||(o.add(h),h.then(g,g))})}}function ns(s,n){var o=n.deletions;if(o!==null)for(var h=0;h<o.length;h++){var g=o[h];try{var v=s,_=n,k=_;e:for(;k!==null;){switch(k.tag){case 5:ut=k.stateNode,ss=!1;break e;case 3:ut=k.stateNode.containerInfo,ss=!0;break e;case 4:ut=k.stateNode.containerInfo,ss=!0;break e}k=k.return}if(ut===null)throw Error(t(160));mh(v,_,g),ut=null,ss=!1;var P=g.alternate;P!==null&&(P.return=null),g.return=null}catch(O){qe(g,n,O)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)xh(n,s),n=n.sibling}function xh(s,n){var o=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(ns(n,s),fs(s),h&4){try{qi(3,s,s.return),ua(3,s)}catch(ue){qe(s,s.return,ue)}try{qi(5,s,s.return)}catch(ue){qe(s,s.return,ue)}}break;case 1:ns(n,s),fs(s),h&512&&o!==null&&qn(o,o.return);break;case 5:if(ns(n,s),fs(s),h&512&&o!==null&&qn(o,o.return),s.flags&32){var g=s.stateNode;try{pi(g,"")}catch(ue){qe(s,s.return,ue)}}if(h&4&&(g=s.stateNode,g!=null)){var v=s.memoizedProps,_=o!==null?o.memoizedProps:v,k=s.type,P=s.updateQueue;if(s.updateQueue=null,P!==null)try{k==="input"&&v.type==="radio"&&v.name!=null&&ci(g,v),ao(k,_);var O=ao(k,v);for(_=0;_<P.length;_+=2){var G=P[_],W=P[_+1];G==="style"?Zc(g,W):G==="dangerouslySetInnerHTML"?Qc(g,W):G==="children"?pi(g,W):R(g,G,W,O)}switch(k){case"input":di(g,v);break;case"textarea":Re(g,v);break;case"select":var H=g._wrapperState.wasMultiple;g._wrapperState.wasMultiple=!!v.multiple;var ne=v.value;ne!=null?Cs(g,!!v.multiple,ne,!1):H!==!!v.multiple&&(v.defaultValue!=null?Cs(g,!!v.multiple,v.defaultValue,!0):Cs(g,!!v.multiple,v.multiple?[]:"",!1))}g[Ii]=v}catch(ue){qe(s,s.return,ue)}}break;case 6:if(ns(n,s),fs(s),h&4){if(s.stateNode===null)throw Error(t(162));g=s.stateNode,v=s.memoizedProps;try{g.nodeValue=v}catch(ue){qe(s,s.return,ue)}}break;case 3:if(ns(n,s),fs(s),h&4&&o!==null&&o.memoizedState.isDehydrated)try{Ni(n.containerInfo)}catch(ue){qe(s,s.return,ue)}break;case 4:ns(n,s),fs(s);break;case 13:ns(n,s),fs(s),g=s.child,g.flags&8192&&(v=g.memoizedState!==null,g.stateNode.isHidden=v,!v||g.alternate!==null&&g.alternate.memoizedState!==null||(Ll=Xe())),h&4&&gh(s);break;case 22:if(G=o!==null&&o.memoizedState!==null,s.mode&1?(gt=(O=gt)||G,ns(n,s),gt=O):ns(n,s),fs(s),h&8192){if(O=s.memoizedState!==null,(s.stateNode.isHidden=O)&&!G&&(s.mode&1)!==0)for(re=s,G=s.child;G!==null;){for(W=re=G;re!==null;){switch(H=re,ne=H.child,H.tag){case 0:case 11:case 14:case 15:qi(4,H,H.return);break;case 1:qn(H,H.return);var le=H.stateNode;if(typeof le.componentWillUnmount=="function"){h=H,o=H.return;try{n=h,le.props=n.memoizedProps,le.state=n.memoizedState,le.componentWillUnmount()}catch(ue){qe(h,o,ue)}}break;case 5:qn(H,H.return);break;case 22:if(H.memoizedState!==null){yh(W);continue}}ne!==null?(ne.return=H,re=ne):yh(W)}G=G.sibling}e:for(G=null,W=s;;){if(W.tag===5){if(G===null){G=W;try{g=W.stateNode,O?(v=g.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(k=W.stateNode,P=W.memoizedProps.style,_=P!=null&&P.hasOwnProperty("display")?P.display:null,k.style.display=Jc("display",_))}catch(ue){qe(s,s.return,ue)}}}else if(W.tag===6){if(G===null)try{W.stateNode.nodeValue=O?"":W.memoizedProps}catch(ue){qe(s,s.return,ue)}}else if((W.tag!==22&&W.tag!==23||W.memoizedState===null||W===s)&&W.child!==null){W.child.return=W,W=W.child;continue}if(W===s)break e;for(;W.sibling===null;){if(W.return===null||W.return===s)break e;G===W&&(G=null),W=W.return}G===W&&(G=null),W.sibling.return=W.return,W=W.sibling}}break;case 19:ns(n,s),fs(s),h&4&&gh(s);break;case 21:break;default:ns(n,s),fs(s)}}function fs(s){var n=s.flags;if(n&2){try{e:{for(var o=s.return;o!==null;){if(fh(o)){var h=o;break e}o=o.return}throw Error(t(160))}switch(h.tag){case 5:var g=h.stateNode;h.flags&32&&(pi(g,""),h.flags&=-33);var v=ph(s);Tl(s,v,g);break;case 3:case 4:var _=h.stateNode.containerInfo,k=ph(s);Cl(s,k,_);break;default:throw Error(t(161))}}catch(P){qe(s,s.return,P)}s.flags&=-3}n&4096&&(s.flags&=-4097)}function sg(s,n,o){re=s,vh(s)}function vh(s,n,o){for(var h=(s.mode&1)!==0;re!==null;){var g=re,v=g.child;if(g.tag===22&&h){var _=g.memoizedState!==null||da;if(!_){var k=g.alternate,P=k!==null&&k.memoizedState!==null||gt;k=da;var O=gt;if(da=_,(gt=P)&&!O)for(re=g;re!==null;)_=re,P=_.child,_.tag===22&&_.memoizedState!==null?wh(g):P!==null?(P.return=_,re=P):wh(g);for(;v!==null;)re=v,vh(v),v=v.sibling;re=g,da=k,gt=O}bh(s)}else(g.subtreeFlags&8772)!==0&&v!==null?(v.return=g,re=v):bh(s)}}function bh(s){for(;re!==null;){var n=re;if((n.flags&8772)!==0){var o=n.alternate;try{if((n.flags&8772)!==0)switch(n.tag){case 0:case 11:case 15:gt||ua(5,n);break;case 1:var h=n.stateNode;if(n.flags&4&&!gt)if(o===null)h.componentDidMount();else{var g=n.elementType===n.type?o.memoizedProps:ts(n.type,o.memoizedProps);h.componentDidUpdate(g,o.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var v=n.updateQueue;v!==null&&yu(n,v,h);break;case 3:var _=n.updateQueue;if(_!==null){if(o=null,n.child!==null)switch(n.child.tag){case 5:o=n.child.stateNode;break;case 1:o=n.child.stateNode}yu(n,_,o)}break;case 5:var k=n.stateNode;if(o===null&&n.flags&4){o=k;var P=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":P.autoFocus&&o.focus();break;case"img":P.src&&(o.src=P.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var O=n.alternate;if(O!==null){var G=O.memoizedState;if(G!==null){var W=G.dehydrated;W!==null&&Ni(W)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}gt||n.flags&512&&jl(n)}catch(H){qe(n,n.return,H)}}if(n===s){re=null;break}if(o=n.sibling,o!==null){o.return=n.return,re=o;break}re=n.return}}function yh(s){for(;re!==null;){var n=re;if(n===s){re=null;break}var o=n.sibling;if(o!==null){o.return=n.return,re=o;break}re=n.return}}function wh(s){for(;re!==null;){var n=re;try{switch(n.tag){case 0:case 11:case 15:var o=n.return;try{ua(4,n)}catch(P){qe(n,o,P)}break;case 1:var h=n.stateNode;if(typeof h.componentDidMount=="function"){var g=n.return;try{h.componentDidMount()}catch(P){qe(n,g,P)}}var v=n.return;try{jl(n)}catch(P){qe(n,v,P)}break;case 5:var _=n.return;try{jl(n)}catch(P){qe(n,_,P)}}}catch(P){qe(n,n.return,P)}if(n===s){re=null;break}var k=n.sibling;if(k!==null){k.return=n.return,re=k;break}re=n.return}}var ng=Math.ceil,ha=E.ReactCurrentDispatcher,Pl=E.ReactCurrentOwner,qt=E.ReactCurrentBatchConfig,Pe=0,ot=null,Ze=null,ht=0,Ot=0,Xn=Ds(0),nt=0,Xi=null,mn=0,fa=0,Rl=0,Yi=null,Tt=null,Ll=0,Yn=1/0,Ns=null,pa=!1,Ml=null,Hs=null,ma=!1,$s=null,ga=0,Ki=0,Vl=null,xa=-1,va=0;function _t(){return(Pe&6)!==0?Xe():xa!==-1?xa:xa=Xe()}function Gs(s){return(s.mode&1)===0?1:(Pe&2)!==0&&ht!==0?ht&-ht:zm.transition!==null?(va===0&&(va=pd()),va):(s=Ve,s!==0||(s=window.event,s=s===void 0?16:_d(s.type)),s)}function is(s,n,o,h){if(50<Ki)throw Ki=0,Vl=null,Error(t(185));yi(s,o,h),((Pe&2)===0||s!==ot)&&(s===ot&&((Pe&2)===0&&(fa|=o),nt===4&&Ws(s,ht)),Pt(s,h),o===1&&Pe===0&&(n.mode&1)===0&&(Yn=Xe()+500,Wr&&Os()))}function Pt(s,n){var o=s.callbackNode;zp(s,n);var h=kr(s,s===ot?ht:0);if(h===0)o!==null&&ud(o),s.callbackNode=null,s.callbackPriority=0;else if(n=h&-h,s.callbackPriority!==n){if(o!=null&&ud(o),n===1)s.tag===0?Om(_h.bind(null,s)):lu(_h.bind(null,s)),Vm(function(){(Pe&6)===0&&Os()}),o=null;else{switch(md(h)){case 1:o=po;break;case 4:o=hd;break;case 16:o=_r;break;case 536870912:o=fd;break;default:o=_r}o=Ph(o,Ah.bind(null,s))}s.callbackPriority=n,s.callbackNode=o}}function Ah(s,n){if(xa=-1,va=0,(Pe&6)!==0)throw Error(t(327));var o=s.callbackNode;if(Kn()&&s.callbackNode!==o)return null;var h=kr(s,s===ot?ht:0);if(h===0)return null;if((h&30)!==0||(h&s.expiredLanes)!==0||n)n=ba(s,h);else{n=h;var g=Pe;Pe|=2;var v=Nh();(ot!==s||ht!==n)&&(Ns=null,Yn=Xe()+500,xn(s,n));do try{ag();break}catch(k){Sh(s,k)}while(!0);Zo(),ha.current=v,Pe=g,Ze!==null?n=0:(ot=null,ht=0,n=nt)}if(n!==0){if(n===2&&(g=mo(s),g!==0&&(h=g,n=Il(s,g))),n===1)throw o=Xi,xn(s,0),Ws(s,h),Pt(s,Xe()),o;if(n===6)Ws(s,h);else{if(g=s.current.alternate,(h&30)===0&&!ig(g)&&(n=ba(s,h),n===2&&(v=mo(s),v!==0&&(h=v,n=Il(s,v))),n===1))throw o=Xi,xn(s,0),Ws(s,h),Pt(s,Xe()),o;switch(s.finishedWork=g,s.finishedLanes=h,n){case 0:case 1:throw Error(t(345));case 2:vn(s,Tt,Ns);break;case 3:if(Ws(s,h),(h&130023424)===h&&(n=Ll+500-Xe(),10<n)){if(kr(s,0)!==0)break;if(g=s.suspendedLanes,(g&h)!==h){_t(),s.pingedLanes|=s.suspendedLanes&g;break}s.timeoutHandle=Uo(vn.bind(null,s,Tt,Ns),n);break}vn(s,Tt,Ns);break;case 4:if(Ws(s,h),(h&4194240)===h)break;for(n=s.eventTimes,g=-1;0<h;){var _=31-Jt(h);v=1<<_,_=n[_],_>g&&(g=_),h&=~v}if(h=g,h=Xe()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*ng(h/1960))-h,10<h){s.timeoutHandle=Uo(vn.bind(null,s,Tt,Ns),h);break}vn(s,Tt,Ns);break;case 5:vn(s,Tt,Ns);break;default:throw Error(t(329))}}}return Pt(s,Xe()),s.callbackNode===o?Ah.bind(null,s):null}function Il(s,n){var o=Yi;return s.current.memoizedState.isDehydrated&&(xn(s,n).flags|=256),s=ba(s,n),s!==2&&(n=Tt,Tt=o,n!==null&&Dl(n)),s}function Dl(s){Tt===null?Tt=s:Tt.push.apply(Tt,s)}function ig(s){for(var n=s;;){if(n.flags&16384){var o=n.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var h=0;h<o.length;h++){var g=o[h],v=g.getSnapshot;g=g.value;try{if(!Zt(v(),g))return!1}catch{return!1}}}if(o=n.child,n.subtreeFlags&16384&&o!==null)o.return=n,n=o;else{if(n===s)break;for(;n.sibling===null;){if(n.return===null||n.return===s)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Ws(s,n){for(n&=~Rl,n&=~fa,s.suspendedLanes|=n,s.pingedLanes&=~n,s=s.expirationTimes;0<n;){var o=31-Jt(n),h=1<<o;s[o]=-1,n&=~h}}function _h(s){if((Pe&6)!==0)throw Error(t(327));Kn();var n=kr(s,0);if((n&1)===0)return Pt(s,Xe()),null;var o=ba(s,n);if(s.tag!==0&&o===2){var h=mo(s);h!==0&&(n=h,o=Il(s,h))}if(o===1)throw o=Xi,xn(s,0),Ws(s,n),Pt(s,Xe()),o;if(o===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=n,vn(s,Tt,Ns),Pt(s,Xe()),null}function Fl(s,n){var o=Pe;Pe|=1;try{return s(n)}finally{Pe=o,Pe===0&&(Yn=Xe()+500,Wr&&Os())}}function gn(s){$s!==null&&$s.tag===0&&(Pe&6)===0&&Kn();var n=Pe;Pe|=1;var o=qt.transition,h=Ve;try{if(qt.transition=null,Ve=1,s)return s()}finally{Ve=h,qt.transition=o,Pe=n,(Pe&6)===0&&Os()}}function Ol(){Ot=Xn.current,ze(Xn)}function xn(s,n){s.finishedWork=null,s.finishedLanes=0;var o=s.timeoutHandle;if(o!==-1&&(s.timeoutHandle=-1,Mm(o)),Ze!==null)for(o=Ze.return;o!==null;){var h=o;switch(Xo(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&$r();break;case 3:Gn(),ze(kt),ze(ft),ol();break;case 5:rl(h);break;case 4:Gn();break;case 13:ze($e);break;case 19:ze($e);break;case 10:el(h.type._context);break;case 22:case 23:Ol()}o=o.return}if(ot=s,Ze=s=qs(s.current,null),ht=Ot=n,nt=0,Xi=null,Rl=fa=mn=0,Tt=Yi=null,hn!==null){for(n=0;n<hn.length;n++)if(o=hn[n],h=o.interleaved,h!==null){o.interleaved=null;var g=h.next,v=o.pending;if(v!==null){var _=v.next;v.next=g,h.next=_}o.pending=h}hn=null}return s}function Sh(s,n){do{var o=Ze;try{if(Zo(),sa.current=aa,na){for(var h=Ge.memoizedState;h!==null;){var g=h.queue;g!==null&&(g.pending=null),h=h.next}na=!1}if(pn=0,at=st=Ge=null,Ui=!1,Hi=0,Pl.current=null,o===null||o.return===null){nt=1,Xi=n,Ze=null;break}e:{var v=s,_=o.return,k=o,P=n;if(n=ht,k.flags|=32768,P!==null&&typeof P=="object"&&typeof P.then=="function"){var O=P,G=k,W=G.tag;if((G.mode&1)===0&&(W===0||W===11||W===15)){var H=G.alternate;H?(G.updateQueue=H.updateQueue,G.memoizedState=H.memoizedState,G.lanes=H.lanes):(G.updateQueue=null,G.memoizedState=null)}var ne=Yu(_);if(ne!==null){ne.flags&=-257,Ku(ne,_,k,v,n),ne.mode&1&&Xu(v,O,n),n=ne,P=O;var le=n.updateQueue;if(le===null){var ue=new Set;ue.add(P),n.updateQueue=ue}else le.add(P);break e}else{if((n&1)===0){Xu(v,O,n),zl();break e}P=Error(t(426))}}else if(Be&&k.mode&1){var Ye=Yu(_);if(Ye!==null){(Ye.flags&65536)===0&&(Ye.flags|=256),Ku(Ye,_,k,v,n),Qo(Wn(P,k));break e}}v=P=Wn(P,k),nt!==4&&(nt=2),Yi===null?Yi=[v]:Yi.push(v),v=_;do{switch(v.tag){case 3:v.flags|=65536,n&=-n,v.lanes|=n;var D=Wu(v,P,n);bu(v,D);break e;case 1:k=P;var M=v.type,F=v.stateNode;if((v.flags&128)===0&&(typeof M.getDerivedStateFromError=="function"||F!==null&&typeof F.componentDidCatch=="function"&&(Hs===null||!Hs.has(F)))){v.flags|=65536,n&=-n,v.lanes|=n;var Y=qu(v,k,n);bu(v,Y);break e}}v=v.return}while(v!==null)}kh(o)}catch(fe){n=fe,Ze===o&&o!==null&&(Ze=o=o.return);continue}break}while(!0)}function Nh(){var s=ha.current;return ha.current=aa,s===null?aa:s}function zl(){(nt===0||nt===3||nt===2)&&(nt=4),ot===null||(mn&268435455)===0&&(fa&268435455)===0||Ws(ot,ht)}function ba(s,n){var o=Pe;Pe|=2;var h=Nh();(ot!==s||ht!==n)&&(Ns=null,xn(s,n));do try{rg();break}catch(g){Sh(s,g)}while(!0);if(Zo(),Pe=o,ha.current=h,Ze!==null)throw Error(t(261));return ot=null,ht=0,nt}function rg(){for(;Ze!==null;)Eh(Ze)}function ag(){for(;Ze!==null&&!Pp();)Eh(Ze)}function Eh(s){var n=Th(s.alternate,s,Ot);s.memoizedProps=s.pendingProps,n===null?kh(s):Ze=n,Pl.current=null}function kh(s){var n=s;do{var o=n.alternate;if(s=n.return,(n.flags&32768)===0){if(o=Jm(o,n,Ot),o!==null){Ze=o;return}}else{if(o=Zm(o,n),o!==null){o.flags&=32767,Ze=o;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{nt=6,Ze=null;return}}if(n=n.sibling,n!==null){Ze=n;return}Ze=n=s}while(n!==null);nt===0&&(nt=5)}function vn(s,n,o){var h=Ve,g=qt.transition;try{qt.transition=null,Ve=1,og(s,n,o,h)}finally{qt.transition=g,Ve=h}return null}function og(s,n,o,h){do Kn();while($s!==null);if((Pe&6)!==0)throw Error(t(327));o=s.finishedWork;var g=s.finishedLanes;if(o===null)return null;if(s.finishedWork=null,s.finishedLanes=0,o===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var v=o.lanes|o.childLanes;if(Bp(s,v),s===ot&&(Ze=ot=null,ht=0),(o.subtreeFlags&2064)===0&&(o.flags&2064)===0||ma||(ma=!0,Ph(_r,function(){return Kn(),null})),v=(o.flags&15990)!==0,(o.subtreeFlags&15990)!==0||v){v=qt.transition,qt.transition=null;var _=Ve;Ve=1;var k=Pe;Pe|=4,Pl.current=null,tg(s,o),xh(o,s),km(zo),Tr=!!Oo,zo=Oo=null,s.current=o,sg(o),Rp(),Pe=k,Ve=_,qt.transition=v}else s.current=o;if(ma&&(ma=!1,$s=s,ga=g),v=s.pendingLanes,v===0&&(Hs=null),Vp(o.stateNode),Pt(s,Xe()),n!==null)for(h=s.onRecoverableError,o=0;o<n.length;o++)g=n[o],h(g.value,{componentStack:g.stack,digest:g.digest});if(pa)throw pa=!1,s=Ml,Ml=null,s;return(ga&1)!==0&&s.tag!==0&&Kn(),v=s.pendingLanes,(v&1)!==0?s===Vl?Ki++:(Ki=0,Vl=s):Ki=0,Os(),null}function Kn(){if($s!==null){var s=md(ga),n=qt.transition,o=Ve;try{if(qt.transition=null,Ve=16>s?16:s,$s===null)var h=!1;else{if(s=$s,$s=null,ga=0,(Pe&6)!==0)throw Error(t(331));var g=Pe;for(Pe|=4,re=s.current;re!==null;){var v=re,_=v.child;if((re.flags&16)!==0){var k=v.deletions;if(k!==null){for(var P=0;P<k.length;P++){var O=k[P];for(re=O;re!==null;){var G=re;switch(G.tag){case 0:case 11:case 15:qi(8,G,v)}var W=G.child;if(W!==null)W.return=G,re=W;else for(;re!==null;){G=re;var H=G.sibling,ne=G.return;if(hh(G),G===O){re=null;break}if(H!==null){H.return=ne,re=H;break}re=ne}}}var le=v.alternate;if(le!==null){var ue=le.child;if(ue!==null){le.child=null;do{var Ye=ue.sibling;ue.sibling=null,ue=Ye}while(ue!==null)}}re=v}}if((v.subtreeFlags&2064)!==0&&_!==null)_.return=v,re=_;else e:for(;re!==null;){if(v=re,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:qi(9,v,v.return)}var D=v.sibling;if(D!==null){D.return=v.return,re=D;break e}re=v.return}}var M=s.current;for(re=M;re!==null;){_=re;var F=_.child;if((_.subtreeFlags&2064)!==0&&F!==null)F.return=_,re=F;else e:for(_=M;re!==null;){if(k=re,(k.flags&2048)!==0)try{switch(k.tag){case 0:case 11:case 15:ua(9,k)}}catch(fe){qe(k,k.return,fe)}if(k===_){re=null;break e}var Y=k.sibling;if(Y!==null){Y.return=k.return,re=Y;break e}re=k.return}}if(Pe=g,Os(),cs&&typeof cs.onPostCommitFiberRoot=="function")try{cs.onPostCommitFiberRoot(Sr,s)}catch{}h=!0}return h}finally{Ve=o,qt.transition=n}}return!1}function jh(s,n,o){n=Wn(o,n),n=Wu(s,n,1),s=Bs(s,n,1),n=_t(),s!==null&&(yi(s,1,n),Pt(s,n))}function qe(s,n,o){if(s.tag===3)jh(s,s,o);else for(;n!==null;){if(n.tag===3){jh(n,s,o);break}else if(n.tag===1){var h=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Hs===null||!Hs.has(h))){s=Wn(o,s),s=qu(n,s,1),n=Bs(n,s,1),s=_t(),n!==null&&(yi(n,1,s),Pt(n,s));break}}n=n.return}}function lg(s,n,o){var h=s.pingCache;h!==null&&h.delete(n),n=_t(),s.pingedLanes|=s.suspendedLanes&o,ot===s&&(ht&o)===o&&(nt===4||nt===3&&(ht&130023424)===ht&&500>Xe()-Ll?xn(s,0):Rl|=o),Pt(s,n)}function Ch(s,n){n===0&&((s.mode&1)===0?n=1:(n=Er,Er<<=1,(Er&130023424)===0&&(Er=4194304)));var o=_t();s=As(s,n),s!==null&&(yi(s,n,o),Pt(s,o))}function cg(s){var n=s.memoizedState,o=0;n!==null&&(o=n.retryLane),Ch(s,o)}function dg(s,n){var o=0;switch(s.tag){case 13:var h=s.stateNode,g=s.memoizedState;g!==null&&(o=g.retryLane);break;case 19:h=s.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(n),Ch(s,o)}var Th;Th=function(s,n,o){if(s!==null)if(s.memoizedProps!==n.pendingProps||kt.current)Ct=!0;else{if((s.lanes&o)===0&&(n.flags&128)===0)return Ct=!1,Qm(s,n,o);Ct=(s.flags&131072)!==0}else Ct=!1,Be&&(n.flags&1048576)!==0&&cu(n,Xr,n.index);switch(n.lanes=0,n.tag){case 2:var h=n.type;ca(s,n),s=n.pendingProps;var g=Fn(n,ft.current);$n(n,o),g=dl(null,n,h,s,g,o);var v=ul();return n.flags|=1,typeof g=="object"&&g!==null&&typeof g.render=="function"&&g.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,jt(h)?(v=!0,Gr(n)):v=!1,n.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,nl(n),g.updater=oa,n.stateNode=g,g._reactInternals=n,xl(n,h,s,o),n=wl(null,n,h,!0,v,o)):(n.tag=0,Be&&v&&qo(n),At(null,n,g,o),n=n.child),n;case 16:h=n.elementType;e:{switch(ca(s,n),s=n.pendingProps,g=h._init,h=g(h._payload),n.type=h,g=n.tag=hg(h),s=ts(h,s),g){case 0:n=yl(null,n,h,s,o);break e;case 1:n=sh(null,n,h,s,o);break e;case 11:n=Qu(null,n,h,s,o);break e;case 14:n=Ju(null,n,h,ts(h.type,s),o);break e}throw Error(t(306,h,""))}return n;case 0:return h=n.type,g=n.pendingProps,g=n.elementType===h?g:ts(h,g),yl(s,n,h,g,o);case 1:return h=n.type,g=n.pendingProps,g=n.elementType===h?g:ts(h,g),sh(s,n,h,g,o);case 3:e:{if(nh(n),s===null)throw Error(t(387));h=n.pendingProps,v=n.memoizedState,g=v.element,vu(s,n),ea(n,h,null,o);var _=n.memoizedState;if(h=_.element,v.isDehydrated)if(v={element:h,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},n.updateQueue.baseState=v,n.memoizedState=v,n.flags&256){g=Wn(Error(t(423)),n),n=ih(s,n,h,o,g);break e}else if(h!==g){g=Wn(Error(t(424)),n),n=ih(s,n,h,o,g);break e}else for(Ft=Is(n.stateNode.containerInfo.firstChild),Dt=n,Be=!0,es=null,o=gu(n,null,h,o),n.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Bn(),h===g){n=Ss(s,n,o);break e}At(s,n,h,o)}n=n.child}return n;case 5:return wu(n),s===null&&Ko(n),h=n.type,g=n.pendingProps,v=s!==null?s.memoizedProps:null,_=g.children,Bo(h,g)?_=null:v!==null&&Bo(h,v)&&(n.flags|=32),th(s,n),At(s,n,_,o),n.child;case 6:return s===null&&Ko(n),null;case 13:return rh(s,n,o);case 4:return il(n,n.stateNode.containerInfo),h=n.pendingProps,s===null?n.child=Un(n,null,h,o):At(s,n,h,o),n.child;case 11:return h=n.type,g=n.pendingProps,g=n.elementType===h?g:ts(h,g),Qu(s,n,h,g,o);case 7:return At(s,n,n.pendingProps,o),n.child;case 8:return At(s,n,n.pendingProps.children,o),n.child;case 12:return At(s,n,n.pendingProps.children,o),n.child;case 10:e:{if(h=n.type._context,g=n.pendingProps,v=n.memoizedProps,_=g.value,Fe(Qr,h._currentValue),h._currentValue=_,v!==null)if(Zt(v.value,_)){if(v.children===g.children&&!kt.current){n=Ss(s,n,o);break e}}else for(v=n.child,v!==null&&(v.return=n);v!==null;){var k=v.dependencies;if(k!==null){_=v.child;for(var P=k.firstContext;P!==null;){if(P.context===h){if(v.tag===1){P=_s(-1,o&-o),P.tag=2;var O=v.updateQueue;if(O!==null){O=O.shared;var G=O.pending;G===null?P.next=P:(P.next=G.next,G.next=P),O.pending=P}}v.lanes|=o,P=v.alternate,P!==null&&(P.lanes|=o),tl(v.return,o,n),k.lanes|=o;break}P=P.next}}else if(v.tag===10)_=v.type===n.type?null:v.child;else if(v.tag===18){if(_=v.return,_===null)throw Error(t(341));_.lanes|=o,k=_.alternate,k!==null&&(k.lanes|=o),tl(_,o,n),_=v.sibling}else _=v.child;if(_!==null)_.return=v;else for(_=v;_!==null;){if(_===n){_=null;break}if(v=_.sibling,v!==null){v.return=_.return,_=v;break}_=_.return}v=_}At(s,n,g.children,o),n=n.child}return n;case 9:return g=n.type,h=n.pendingProps.children,$n(n,o),g=Gt(g),h=h(g),n.flags|=1,At(s,n,h,o),n.child;case 14:return h=n.type,g=ts(h,n.pendingProps),g=ts(h.type,g),Ju(s,n,h,g,o);case 15:return Zu(s,n,n.type,n.pendingProps,o);case 17:return h=n.type,g=n.pendingProps,g=n.elementType===h?g:ts(h,g),ca(s,n),n.tag=1,jt(h)?(s=!0,Gr(n)):s=!1,$n(n,o),$u(n,h,g),xl(n,h,g,o),wl(null,n,h,!0,s,o);case 19:return oh(s,n,o);case 22:return eh(s,n,o)}throw Error(t(156,n.tag))};function Ph(s,n){return dd(s,n)}function ug(s,n,o,h){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xt(s,n,o,h){return new ug(s,n,o,h)}function Bl(s){return s=s.prototype,!(!s||!s.isReactComponent)}function hg(s){if(typeof s=="function")return Bl(s)?1:0;if(s!=null){if(s=s.$$typeof,s===Ae)return 11;if(s===ke)return 14}return 2}function qs(s,n){var o=s.alternate;return o===null?(o=Xt(s.tag,n,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=n,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&14680064,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,n=s.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o}function ya(s,n,o,h,g,v){var _=2;if(h=s,typeof s=="function")Bl(s)&&(_=1);else if(typeof s=="string")_=5;else e:switch(s){case I:return bn(o.children,g,v,n);case $:_=8,g|=8;break;case te:return s=Xt(12,o,n,g|2),s.elementType=te,s.lanes=v,s;case pe:return s=Xt(13,o,n,g),s.elementType=pe,s.lanes=v,s;case be:return s=Xt(19,o,n,g),s.elementType=be,s.lanes=v,s;case Z:return wa(o,g,v,n);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case ae:_=10;break e;case de:_=9;break e;case Ae:_=11;break e;case ke:_=14;break e;case X:_=16,h=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return n=Xt(_,o,n,g),n.elementType=s,n.type=h,n.lanes=v,n}function bn(s,n,o,h){return s=Xt(7,s,h,n),s.lanes=o,s}function wa(s,n,o,h){return s=Xt(22,s,h,n),s.elementType=Z,s.lanes=o,s.stateNode={isHidden:!1},s}function Ul(s,n,o){return s=Xt(6,s,null,n),s.lanes=o,s}function Hl(s,n,o){return n=Xt(4,s.children!==null?s.children:[],s.key,n),n.lanes=o,n.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},n}function fg(s,n,o,h,g){this.tag=n,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=go(0),this.expirationTimes=go(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=go(0),this.identifierPrefix=h,this.onRecoverableError=g,this.mutableSourceEagerHydrationData=null}function $l(s,n,o,h,g,v,_,k,P){return s=new fg(s,n,o,k,P),n===1?(n=1,v===!0&&(n|=8)):n=0,v=Xt(3,null,null,n),s.current=v,v.stateNode=s,v.memoizedState={element:h,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},nl(v),s}function pg(s,n,o){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:T,key:h==null?null:""+h,children:s,containerInfo:n,implementation:o}}function Rh(s){if(!s)return Fs;s=s._reactInternals;e:{if(on(s)!==s||s.tag!==1)throw Error(t(170));var n=s;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(jt(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(t(171))}if(s.tag===1){var o=s.type;if(jt(o))return au(s,o,n)}return n}function Lh(s,n,o,h,g,v,_,k,P){return s=$l(o,h,!0,s,g,v,_,k,P),s.context=Rh(null),o=s.current,h=_t(),g=Gs(o),v=_s(h,g),v.callback=n??null,Bs(o,v,g),s.current.lanes=g,yi(s,g,h),Pt(s,h),s}function Aa(s,n,o,h){var g=n.current,v=_t(),_=Gs(g);return o=Rh(o),n.context===null?n.context=o:n.pendingContext=o,n=_s(v,_),n.payload={element:s},h=h===void 0?null:h,h!==null&&(n.callback=h),s=Bs(g,n,_),s!==null&&(is(s,g,_,v),Zr(s,g,_)),_}function _a(s){return s=s.current,s.child?(s.child.tag===5,s.child.stateNode):null}function Mh(s,n){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<n?o:n}}function Gl(s,n){Mh(s,n),(s=s.alternate)&&Mh(s,n)}function mg(){return null}var Vh=typeof reportError=="function"?reportError:function(s){console.error(s)};function Wl(s){this._internalRoot=s}Sa.prototype.render=Wl.prototype.render=function(s){var n=this._internalRoot;if(n===null)throw Error(t(409));Aa(s,n,null,null)},Sa.prototype.unmount=Wl.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var n=s.containerInfo;gn(function(){Aa(null,s,null,null)}),n[vs]=null}};function Sa(s){this._internalRoot=s}Sa.prototype.unstable_scheduleHydration=function(s){if(s){var n=vd();s={blockedOn:null,target:s,priority:n};for(var o=0;o<Ls.length&&n!==0&&n<Ls[o].priority;o++);Ls.splice(o,0,s),o===0&&wd(s)}};function ql(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Na(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function Ih(){}function gg(s,n,o,h,g){if(g){if(typeof h=="function"){var v=h;h=function(){var O=_a(_);v.call(O)}}var _=Lh(n,h,s,0,null,!1,!1,"",Ih);return s._reactRootContainer=_,s[vs]=_.current,Mi(s.nodeType===8?s.parentNode:s),gn(),_}for(;g=s.lastChild;)s.removeChild(g);if(typeof h=="function"){var k=h;h=function(){var O=_a(P);k.call(O)}}var P=$l(s,0,!1,null,null,!1,!1,"",Ih);return s._reactRootContainer=P,s[vs]=P.current,Mi(s.nodeType===8?s.parentNode:s),gn(function(){Aa(n,P,o,h)}),P}function Ea(s,n,o,h,g){var v=o._reactRootContainer;if(v){var _=v;if(typeof g=="function"){var k=g;g=function(){var P=_a(_);k.call(P)}}Aa(n,_,s,g)}else _=gg(o,n,s,g,h);return _a(_)}gd=function(s){switch(s.tag){case 3:var n=s.stateNode;if(n.current.memoizedState.isDehydrated){var o=bi(n.pendingLanes);o!==0&&(xo(n,o|1),Pt(n,Xe()),(Pe&6)===0&&(Yn=Xe()+500,Os()))}break;case 13:gn(function(){var h=As(s,1);if(h!==null){var g=_t();is(h,s,1,g)}}),Gl(s,1)}},vo=function(s){if(s.tag===13){var n=As(s,134217728);if(n!==null){var o=_t();is(n,s,134217728,o)}Gl(s,134217728)}},xd=function(s){if(s.tag===13){var n=Gs(s),o=As(s,n);if(o!==null){var h=_t();is(o,s,n,h)}Gl(s,n)}},vd=function(){return Ve},bd=function(s,n){var o=Ve;try{return Ve=s,n()}finally{Ve=o}},co=function(s,n,o){switch(n){case"input":if(di(s,o),n=o.name,o.type==="radio"&&n!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<o.length;n++){var h=o[n];if(h!==s&&h.form===s.form){var g=Hr(h);if(!g)throw Error(t(90));dt(h),di(h,g)}}}break;case"textarea":Re(s,o);break;case"select":n=o.value,n!=null&&Cs(s,!!o.multiple,n,!1)}},nd=Fl,id=gn;var xg={usingClientEntryPoint:!1,Events:[Di,In,Hr,td,sd,Fl]},Qi={findFiberByHostInstance:ln,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vg={bundleType:Qi.bundleType,version:Qi.version,rendererPackageName:Qi.rendererPackageName,rendererConfig:Qi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:E.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=ld(s),s===null?null:s.stateNode},findFiberByHostInstance:Qi.findFiberByHostInstance||mg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ka=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ka.isDisabled&&ka.supportsFiber)try{Sr=ka.inject(vg),cs=ka}catch{}}return Rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xg,Rt.createPortal=function(s,n){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ql(n))throw Error(t(200));return pg(s,n,null,o)},Rt.createRoot=function(s,n){if(!ql(s))throw Error(t(299));var o=!1,h="",g=Vh;return n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(h=n.identifierPrefix),n.onRecoverableError!==void 0&&(g=n.onRecoverableError)),n=$l(s,1,!1,null,null,o,!1,h,g),s[vs]=n.current,Mi(s.nodeType===8?s.parentNode:s),new Wl(n)},Rt.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var n=s._reactInternals;if(n===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=ld(n),s=s===null?null:s.stateNode,s},Rt.flushSync=function(s){return gn(s)},Rt.hydrate=function(s,n,o){if(!Na(n))throw Error(t(200));return Ea(null,s,n,!0,o)},Rt.hydrateRoot=function(s,n,o){if(!ql(s))throw Error(t(405));var h=o!=null&&o.hydratedSources||null,g=!1,v="",_=Vh;if(o!=null&&(o.unstable_strictMode===!0&&(g=!0),o.identifierPrefix!==void 0&&(v=o.identifierPrefix),o.onRecoverableError!==void 0&&(_=o.onRecoverableError)),n=Lh(n,null,s,1,o??null,g,!1,v,_),s[vs]=n.current,Mi(s),h)for(s=0;s<h.length;s++)o=h[s],g=o._getVersion,g=g(o._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[o,g]:n.mutableSourceEagerHydrationData.push(o,g);return new Sa(n)},Rt.render=function(s,n,o){if(!Na(n))throw Error(t(200));return Ea(null,s,n,!1,o)},Rt.unmountComponentAtNode=function(s){if(!Na(s))throw Error(t(40));return s._reactRootContainer?(gn(function(){Ea(null,null,s,!1,function(){s._reactRootContainer=null,s[vs]=null})}),!0):!1},Rt.unstable_batchedUpdates=Fl,Rt.unstable_renderSubtreeIntoContainer=function(s,n,o,h){if(!Na(o))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Ea(s,n,o,!1,h)},Rt.version="18.3.1-next-f1338f8080-20240426",Rt}var Wh;function Vf(){if(Wh)return Ql.exports;Wh=1;function u(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(u)}catch(e){console.error(e)}}return u(),Ql.exports=kg(),Ql.exports}var qh;function jg(){if(qh)return Ca;qh=1;var u=Vf();return Ca.createRoot=u.createRoot,Ca.hydrateRoot=u.hydrateRoot,Ca}var Cg=jg();const Tg=jc(Cg);Vf();function ur(){return ur=Object.assign?Object.assign.bind():function(u){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(u[i]=t[i])}return u},ur.apply(this,arguments)}var Qs;(function(u){u.Pop="POP",u.Push="PUSH",u.Replace="REPLACE"})(Qs||(Qs={}));const Xh="popstate";function Pg(u){u===void 0&&(u={});function e(i,r){let{pathname:a,search:c,hash:d}=i.location;return gc("",{pathname:a,search:c,hash:d},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(i,r){return typeof r=="string"?r:Fa(r)}return Lg(e,t,null,u)}function We(u,e){if(u===!1||u===null||typeof u>"u")throw new Error(e)}function Tc(u,e){if(!u){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Rg(){return Math.random().toString(36).substr(2,8)}function Yh(u,e){return{usr:u.state,key:u.key,idx:e}}function gc(u,e,t,i){return t===void 0&&(t=null),ur({pathname:typeof u=="string"?u:u.pathname,search:"",hash:""},typeof e=="string"?ai(e):e,{state:t,key:e&&e.key||i||Rg()})}function Fa(u){let{pathname:e="/",search:t="",hash:i=""}=u;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function ai(u){let e={};if(u){let t=u.indexOf("#");t>=0&&(e.hash=u.substr(t),u=u.substr(0,t));let i=u.indexOf("?");i>=0&&(e.search=u.substr(i),u=u.substr(0,i)),u&&(e.pathname=u)}return e}function Lg(u,e,t,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:a=!1}=i,c=r.history,d=Qs.Pop,f=null,p=m();p==null&&(p=0,c.replaceState(ur({},c.state,{idx:p}),""));function m(){return(c.state||{idx:null}).idx}function x(){d=Qs.Pop;let S=m(),N=S==null?null:S-p;p=S,f&&f({action:d,location:w.location,delta:N})}function b(S,N){d=Qs.Push;let C=gc(w.location,S,N);p=m()+1;let R=Yh(C,p),E=w.createHref(C);try{c.pushState(R,"",E)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;r.location.assign(E)}a&&f&&f({action:d,location:w.location,delta:1})}function y(S,N){d=Qs.Replace;let C=gc(w.location,S,N);p=m();let R=Yh(C,p),E=w.createHref(C);c.replaceState(R,"",E),a&&f&&f({action:d,location:w.location,delta:0})}function A(S){let N=r.location.origin!=="null"?r.location.origin:r.location.href,C=typeof S=="string"?S:Fa(S);return C=C.replace(/ $/,"%20"),We(N,"No window.location.(origin|href) available to create URL for href: "+C),new URL(C,N)}let w={get action(){return d},get location(){return u(r,c)},listen(S){if(f)throw new Error("A history only accepts one active listener");return r.addEventListener(Xh,x),f=S,()=>{r.removeEventListener(Xh,x),f=null}},createHref(S){return e(r,S)},createURL:A,encodeLocation(S){let N=A(S);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:b,replace:y,go(S){return c.go(S)}};return w}var Kh;(function(u){u.data="data",u.deferred="deferred",u.redirect="redirect",u.error="error"})(Kh||(Kh={}));function Mg(u,e,t){return t===void 0&&(t="/"),Vg(u,e,t)}function Vg(u,e,t,i){let r=typeof e=="string"?ai(e):e,a=ii(r.pathname||"/",t);if(a==null)return null;let c=If(u);Ig(c);let d=null;for(let f=0;d==null&&f<c.length;++f){let p=qg(a);d=Gg(c[f],p)}return d}function If(u,e,t,i){e===void 0&&(e=[]),t===void 0&&(t=[]),i===void 0&&(i="");let r=(a,c,d)=>{let f={relativePath:d===void 0?a.path||"":d,caseSensitive:a.caseSensitive===!0,childrenIndex:c,route:a};f.relativePath.startsWith("/")&&(We(f.relativePath.startsWith(i),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(i.length));let p=Js([i,f.relativePath]),m=t.concat(f);a.children&&a.children.length>0&&(We(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+p+'".')),If(a.children,e,m,p)),!(a.path==null&&!a.index)&&e.push({path:p,score:Hg(p,a.index),routesMeta:m})};return u.forEach((a,c)=>{var d;if(a.path===""||!((d=a.path)!=null&&d.includes("?")))r(a,c);else for(let f of Df(a.path))r(a,c,f)}),e}function Df(u){let e=u.split("/");if(e.length===0)return[];let[t,...i]=e,r=t.endsWith("?"),a=t.replace(/\?$/,"");if(i.length===0)return r?[a,""]:[a];let c=Df(i.join("/")),d=[];return d.push(...c.map(f=>f===""?a:[a,f].join("/"))),r&&d.push(...c),d.map(f=>u.startsWith("/")&&f===""?"/":f)}function Ig(u){u.sort((e,t)=>e.score!==t.score?t.score-e.score:$g(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}const Dg=/^:[\w-]+$/,Fg=3,Og=2,zg=1,Bg=10,Ug=-2,Qh=u=>u==="*";function Hg(u,e){let t=u.split("/"),i=t.length;return t.some(Qh)&&(i+=Ug),e&&(i+=Og),t.filter(r=>!Qh(r)).reduce((r,a)=>r+(Dg.test(a)?Fg:a===""?zg:Bg),i)}function $g(u,e){return u.length===e.length&&u.slice(0,-1).every((i,r)=>i===e[r])?u[u.length-1]-e[e.length-1]:0}function Gg(u,e,t){let{routesMeta:i}=u,r={},a="/",c=[];for(let d=0;d<i.length;++d){let f=i[d],p=d===i.length-1,m=a==="/"?e:e.slice(a.length)||"/",x=xc({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},m),b=f.route;if(!x)return null;Object.assign(r,x.params),c.push({params:r,pathname:Js([a,x.pathname]),pathnameBase:Jg(Js([a,x.pathnameBase])),route:b}),x.pathnameBase!=="/"&&(a=Js([a,x.pathnameBase]))}return c}function xc(u,e){typeof u=="string"&&(u={path:u,caseSensitive:!1,end:!0});let[t,i]=Wg(u.path,u.caseSensitive,u.end),r=e.match(t);if(!r)return null;let a=r[0],c=a.replace(/(.)\/+$/,"$1"),d=r.slice(1);return{params:i.reduce((p,m,x)=>{let{paramName:b,isOptional:y}=m;if(b==="*"){let w=d[x]||"";c=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const A=d[x];return y&&!A?p[b]=void 0:p[b]=(A||"").replace(/%2F/g,"/"),p},{}),pathname:a,pathnameBase:c,pattern:u}}function Wg(u,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Tc(u==="*"||!u.endsWith("*")||u.endsWith("/*"),'Route path "'+u+'" will be treated as if it were '+('"'+u.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+u.replace(/\*$/,"/*")+'".'));let i=[],r="^"+u.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,f)=>(i.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return u.endsWith("*")?(i.push({paramName:"*"}),r+=u==="*"||u==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":u!==""&&u!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function qg(u){try{return u.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Tc(!1,'The URL path "'+u+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),u}}function ii(u,e){if(e==="/")return u;if(!u.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=u.charAt(t);return i&&i!=="/"?null:u.slice(t)||"/"}const Xg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Yg=u=>Xg.test(u);function Kg(u,e){e===void 0&&(e="/");let{pathname:t,search:i="",hash:r=""}=typeof u=="string"?ai(u):u,a;if(t)if(Yg(t))a=t;else{if(t.includes("//")){let c=t;t=t.replace(/\/\/+/g,"/"),Tc(!1,"Pathnames cannot have embedded double slashes - normalizing "+(c+" -> "+t))}t.startsWith("/")?a=Jh(t.substring(1),"/"):a=Jh(t,e)}else a=e;return{pathname:a,search:Zg(i),hash:ex(r)}}function Jh(u,e){let t=e.replace(/\/+$/,"").split("/");return u.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function ec(u,e,t,i){return"Cannot include a '"+u+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Qg(u){return u.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Pc(u,e){let t=Qg(u);return e?t.map((i,r)=>r===t.length-1?i.pathname:i.pathnameBase):t.map(i=>i.pathnameBase)}function Rc(u,e,t,i){i===void 0&&(i=!1);let r;typeof u=="string"?r=ai(u):(r=ur({},u),We(!r.pathname||!r.pathname.includes("?"),ec("?","pathname","search",r)),We(!r.pathname||!r.pathname.includes("#"),ec("#","pathname","hash",r)),We(!r.search||!r.search.includes("#"),ec("#","search","hash",r)));let a=u===""||r.pathname==="",c=a?"/":r.pathname,d;if(c==null)d=t;else{let x=e.length-1;if(!i&&c.startsWith("..")){let b=c.split("/");for(;b[0]==="..";)b.shift(),x-=1;r.pathname=b.join("/")}d=x>=0?e[x]:"/"}let f=Kg(r,d),p=c&&c!=="/"&&c.endsWith("/"),m=(a||c===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(p||m)&&(f.pathname+="/"),f}const Js=u=>u.join("/").replace(/\/\/+/g,"/"),Jg=u=>u.replace(/\/+$/,"").replace(/^\/*/,"/"),Zg=u=>!u||u==="?"?"":u.startsWith("?")?u:"?"+u,ex=u=>!u||u==="#"?"":u.startsWith("#")?u:"#"+u;function tx(u){return u!=null&&typeof u.status=="number"&&typeof u.statusText=="string"&&typeof u.internal=="boolean"&&"data"in u}const Ff=["post","put","patch","delete"];new Set(Ff);const sx=["get",...Ff];new Set(sx);function hr(){return hr=Object.assign?Object.assign.bind():function(u){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(u[i]=t[i])}return u},hr.apply(this,arguments)}const Ga=j.createContext(null),Of=j.createContext(null),js=j.createContext(null),Wa=j.createContext(null),xs=j.createContext({outlet:null,matches:[],isDataRoute:!1}),zf=j.createContext(null);function nx(u,e){let{relative:t}=e===void 0?{}:e;oi()||We(!1);let{basename:i,navigator:r}=j.useContext(js),{hash:a,pathname:c,search:d}=qa(u,{relative:t}),f=c;return i!=="/"&&(f=c==="/"?i:Js([i,c])),r.createHref({pathname:f,search:d,hash:a})}function oi(){return j.useContext(Wa)!=null}function li(){return oi()||We(!1),j.useContext(Wa).location}function Bf(u){j.useContext(js).static||j.useLayoutEffect(u)}function sn(){let{isDataRoute:u}=j.useContext(xs);return u?vx():ix()}function ix(){oi()||We(!1);let u=j.useContext(Ga),{basename:e,future:t,navigator:i}=j.useContext(js),{matches:r}=j.useContext(xs),{pathname:a}=li(),c=JSON.stringify(Pc(r,t.v7_relativeSplatPath)),d=j.useRef(!1);return Bf(()=>{d.current=!0}),j.useCallback(function(p,m){if(m===void 0&&(m={}),!d.current)return;if(typeof p=="number"){i.go(p);return}let x=Rc(p,JSON.parse(c),a,m.relative==="path");u==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:Js([e,x.pathname])),(m.replace?i.replace:i.push)(x,m.state,m)},[e,i,c,a,u])}const rx=j.createContext(null);function ax(u){let e=j.useContext(xs).outlet;return e&&j.createElement(rx.Provider,{value:u},e)}function Lc(){let{matches:u}=j.useContext(xs),e=u[u.length-1];return e?e.params:{}}function qa(u,e){let{relative:t}=e===void 0?{}:e,{future:i}=j.useContext(js),{matches:r}=j.useContext(xs),{pathname:a}=li(),c=JSON.stringify(Pc(r,i.v7_relativeSplatPath));return j.useMemo(()=>Rc(u,JSON.parse(c),a,t==="path"),[u,c,a,t])}function ox(u,e){return lx(u,e)}function lx(u,e,t,i){oi()||We(!1);let{navigator:r}=j.useContext(js),{matches:a}=j.useContext(xs),c=a[a.length-1],d=c?c.params:{};c&&c.pathname;let f=c?c.pathnameBase:"/";c&&c.route;let p=li(),m;if(e){var x;let S=typeof e=="string"?ai(e):e;f==="/"||(x=S.pathname)!=null&&x.startsWith(f)||We(!1),m=S}else m=p;let b=m.pathname||"/",y=b;if(f!=="/"){let S=f.replace(/^\//,"").split("/");y="/"+b.replace(/^\//,"").split("/").slice(S.length).join("/")}let A=Mg(u,{pathname:y}),w=fx(A&&A.map(S=>Object.assign({},S,{params:Object.assign({},d,S.params),pathname:Js([f,r.encodeLocation?r.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?f:Js([f,r.encodeLocation?r.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),a,t,i);return e&&w?j.createElement(Wa.Provider,{value:{location:hr({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:Qs.Pop}},w):w}function cx(){let u=xx(),e=tx(u)?u.status+" "+u.statusText:u instanceof Error?u.message:JSON.stringify(u),t=u instanceof Error?u.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),t?j.createElement("pre",{style:r},t):null,null)}const dx=j.createElement(cx,null);class ux extends j.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?j.createElement(xs.Provider,{value:this.props.routeContext},j.createElement(zf.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function hx(u){let{routeContext:e,match:t,children:i}=u,r=j.useContext(Ga);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),j.createElement(xs.Provider,{value:e},i)}function fx(u,e,t,i){var r;if(e===void 0&&(e=[]),t===void 0&&(t=null),i===void 0&&(i=null),u==null){var a;if(!t)return null;if(t.errors)u=t.matches;else if((a=i)!=null&&a.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)u=t.matches;else return null}let c=u,d=(r=t)==null?void 0:r.errors;if(d!=null){let m=c.findIndex(x=>x.route.id&&d?.[x.route.id]!==void 0);m>=0||We(!1),c=c.slice(0,Math.min(c.length,m+1))}let f=!1,p=-1;if(t&&i&&i.v7_partialHydration)for(let m=0;m<c.length;m++){let x=c[m];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(p=m),x.route.id){let{loaderData:b,errors:y}=t,A=x.route.loader&&b[x.route.id]===void 0&&(!y||y[x.route.id]===void 0);if(x.route.lazy||A){f=!0,p>=0?c=c.slice(0,p+1):c=[c[0]];break}}}return c.reduceRight((m,x,b)=>{let y,A=!1,w=null,S=null;t&&(y=d&&x.route.id?d[x.route.id]:void 0,w=x.route.errorElement||dx,f&&(p<0&&b===0?(bx("route-fallback"),A=!0,S=null):p===b&&(A=!0,S=x.route.hydrateFallbackElement||null)));let N=e.concat(c.slice(0,b+1)),C=()=>{let R;return y?R=w:A?R=S:x.route.Component?R=j.createElement(x.route.Component,null):x.route.element?R=x.route.element:R=m,j.createElement(hx,{match:x,routeContext:{outlet:m,matches:N,isDataRoute:t!=null},children:R})};return t&&(x.route.ErrorBoundary||x.route.errorElement||b===0)?j.createElement(ux,{location:t.location,revalidation:t.revalidation,component:w,error:y,children:C(),routeContext:{outlet:null,matches:N,isDataRoute:!0}}):C()},null)}var Uf=(function(u){return u.UseBlocker="useBlocker",u.UseRevalidator="useRevalidator",u.UseNavigateStable="useNavigate",u})(Uf||{}),Hf=(function(u){return u.UseBlocker="useBlocker",u.UseLoaderData="useLoaderData",u.UseActionData="useActionData",u.UseRouteError="useRouteError",u.UseNavigation="useNavigation",u.UseRouteLoaderData="useRouteLoaderData",u.UseMatches="useMatches",u.UseRevalidator="useRevalidator",u.UseNavigateStable="useNavigate",u.UseRouteId="useRouteId",u})(Hf||{});function px(u){let e=j.useContext(Ga);return e||We(!1),e}function mx(u){let e=j.useContext(Of);return e||We(!1),e}function gx(u){let e=j.useContext(xs);return e||We(!1),e}function $f(u){let e=gx(),t=e.matches[e.matches.length-1];return t.route.id||We(!1),t.route.id}function xx(){var u;let e=j.useContext(zf),t=mx(),i=$f();return e!==void 0?e:(u=t.errors)==null?void 0:u[i]}function vx(){let{router:u}=px(Uf.UseNavigateStable),e=$f(Hf.UseNavigateStable),t=j.useRef(!1);return Bf(()=>{t.current=!0}),j.useCallback(function(r,a){a===void 0&&(a={}),t.current&&(typeof r=="number"?u.navigate(r):u.navigate(r,hr({fromRouteId:e},a)))},[u,e])}const Zh={};function bx(u,e,t){Zh[u]||(Zh[u]=!0)}function yx(u,e){u?.v7_startTransition,u?.v7_relativeSplatPath}function wx(u){let{to:e,replace:t,state:i,relative:r}=u;oi()||We(!1);let{future:a,static:c}=j.useContext(js),{matches:d}=j.useContext(xs),{pathname:f}=li(),p=sn(),m=Rc(e,Pc(d,a.v7_relativeSplatPath),f,r==="path"),x=JSON.stringify(m);return j.useEffect(()=>p(JSON.parse(x),{replace:t,state:i,relative:r}),[p,x,r,t,i]),null}function Mc(u){return ax(u.context)}function Ke(u){We(!1)}function Ax(u){let{basename:e="/",children:t=null,location:i,navigationType:r=Qs.Pop,navigator:a,static:c=!1,future:d}=u;oi()&&We(!1);let f=e.replace(/^\/*/,"/"),p=j.useMemo(()=>({basename:f,navigator:a,static:c,future:hr({v7_relativeSplatPath:!1},d)}),[f,d,a,c]);typeof i=="string"&&(i=ai(i));let{pathname:m="/",search:x="",hash:b="",state:y=null,key:A="default"}=i,w=j.useMemo(()=>{let S=ii(m,f);return S==null?null:{location:{pathname:S,search:x,hash:b,state:y,key:A},navigationType:r}},[f,m,x,b,y,A,r]);return w==null?null:j.createElement(js.Provider,{value:p},j.createElement(Wa.Provider,{children:t,value:w}))}function _x(u){let{children:e,location:t}=u;return ox(vc(e),t)}new Promise(()=>{});function vc(u,e){e===void 0&&(e=[]);let t=[];return j.Children.forEach(u,(i,r)=>{if(!j.isValidElement(i))return;let a=[...e,r];if(i.type===j.Fragment){t.push.apply(t,vc(i.props.children,a));return}i.type!==Ke&&We(!1),!i.props.index||!i.props.children||We(!1);let c={id:i.props.id||a.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=vc(i.props.children,a)),t.push(c)}),t}function Oa(){return Oa=Object.assign?Object.assign.bind():function(u){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(u[i]=t[i])}return u},Oa.apply(this,arguments)}function Gf(u,e){if(u==null)return{};var t={},i=Object.keys(u),r,a;for(a=0;a<i.length;a++)r=i[a],!(e.indexOf(r)>=0)&&(t[r]=u[r]);return t}function Sx(u){return!!(u.metaKey||u.altKey||u.ctrlKey||u.shiftKey)}function Nx(u,e){return u.button===0&&(!e||e==="_self")&&!Sx(u)}const Ex=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],kx=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],jx="6";try{window.__reactRouterVersion=jx}catch{}const Cx=j.createContext({isTransitioning:!1}),Tx="startTransition",ef=Sg[Tx];function Px(u){let{basename:e,children:t,future:i,window:r}=u,a=j.useRef();a.current==null&&(a.current=Pg({window:r,v5Compat:!0}));let c=a.current,[d,f]=j.useState({action:c.action,location:c.location}),{v7_startTransition:p}=i||{},m=j.useCallback(x=>{p&&ef?ef(()=>f(x)):f(x)},[f,p]);return j.useLayoutEffect(()=>c.listen(m),[c,m]),j.useEffect(()=>yx(i),[i]),j.createElement(Ax,{basename:e,children:t,location:d.location,navigationType:d.action,navigator:c,future:i})}const Rx=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Lx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,he=j.forwardRef(function(e,t){let{onClick:i,relative:r,reloadDocument:a,replace:c,state:d,target:f,to:p,preventScrollReset:m,viewTransition:x}=e,b=Gf(e,Ex),{basename:y}=j.useContext(js),A,w=!1;if(typeof p=="string"&&Lx.test(p)&&(A=p,Rx))try{let R=new URL(window.location.href),E=p.startsWith("//")?new URL(R.protocol+p):new URL(p),L=ii(E.pathname,y);E.origin===R.origin&&L!=null?p=L+E.search+E.hash:w=!0}catch{}let S=nx(p,{relative:r}),N=Vx(p,{replace:c,state:d,target:f,preventScrollReset:m,relative:r,viewTransition:x});function C(R){i&&i(R),R.defaultPrevented||N(R)}return j.createElement("a",Oa({},b,{href:A||S,onClick:w||a?i:C,ref:t,target:f}))}),Qt=j.forwardRef(function(e,t){let{"aria-current":i="page",caseSensitive:r=!1,className:a="",end:c=!1,style:d,to:f,viewTransition:p,children:m}=e,x=Gf(e,kx),b=qa(f,{relative:x.relative}),y=li(),A=j.useContext(Of),{navigator:w,basename:S}=j.useContext(js),N=A!=null&&Ix(b)&&p===!0,C=w.encodeLocation?w.encodeLocation(b).pathname:b.pathname,R=y.pathname,E=A&&A.navigation&&A.navigation.location?A.navigation.location.pathname:null;r||(R=R.toLowerCase(),E=E?E.toLowerCase():null,C=C.toLowerCase()),E&&S&&(E=ii(E,S)||E);const L=C!=="/"&&C.endsWith("/")?C.length-1:C.length;let T=R===C||!c&&R.startsWith(C)&&R.charAt(L)==="/",I=E!=null&&(E===C||!c&&E.startsWith(C)&&E.charAt(C.length)==="/"),$={isActive:T,isPending:I,isTransitioning:N},te=T?i:void 0,ae;typeof a=="function"?ae=a($):ae=[a,T?"active":null,I?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let de=typeof d=="function"?d($):d;return j.createElement(he,Oa({},x,{"aria-current":te,className:ae,ref:t,style:de,to:f,viewTransition:p}),typeof m=="function"?m($):m)});var bc;(function(u){u.UseScrollRestoration="useScrollRestoration",u.UseSubmit="useSubmit",u.UseSubmitFetcher="useSubmitFetcher",u.UseFetcher="useFetcher",u.useViewTransitionState="useViewTransitionState"})(bc||(bc={}));var tf;(function(u){u.UseFetcher="useFetcher",u.UseFetchers="useFetchers",u.UseScrollRestoration="useScrollRestoration"})(tf||(tf={}));function Mx(u){let e=j.useContext(Ga);return e||We(!1),e}function Vx(u,e){let{target:t,replace:i,state:r,preventScrollReset:a,relative:c,viewTransition:d}=e===void 0?{}:e,f=sn(),p=li(),m=qa(u,{relative:c});return j.useCallback(x=>{if(Nx(x,t)){x.preventDefault();let b=i!==void 0?i:Fa(p)===Fa(m);f(u,{replace:b,state:r,preventScrollReset:a,relative:c,viewTransition:d})}},[p,f,m,i,r,t,u,a,c,d])}function Ix(u,e){e===void 0&&(e={});let t=j.useContext(Cx);t==null&&We(!1);let{basename:i}=Mx(bc.useViewTransitionState),r=qa(u,{relative:e.relative});if(!t.isTransitioning)return!1;let a=ii(t.currentLocation.pathname,i)||t.currentLocation.pathname,c=ii(t.nextLocation.pathname,i)||t.nextLocation.pathname;return xc(r.pathname,c)!=null||xc(r.pathname,a)!=null}const Dx={},sf=u=>{let e;const t=new Set,i=(m,x)=>{const b=typeof m=="function"?m(e):m;if(!Object.is(b,e)){const y=e;e=x??(typeof b!="object"||b===null)?b:Object.assign({},e,b),t.forEach(A=>A(e,y))}},r=()=>e,f={setState:i,getState:r,getInitialState:()=>p,subscribe:m=>(t.add(m),()=>t.delete(m)),destroy:()=>{(Dx?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},p=e=u(i,r,f);return f},Fx=u=>u?sf(u):sf;var tc={exports:{}},sc={},nc={exports:{}},ic={};var nf;function Ox(){if(nf)return ic;nf=1;var u=mr();function e(x,b){return x===b&&(x!==0||1/x===1/b)||x!==x&&b!==b}var t=typeof Object.is=="function"?Object.is:e,i=u.useState,r=u.useEffect,a=u.useLayoutEffect,c=u.useDebugValue;function d(x,b){var y=b(),A=i({inst:{value:y,getSnapshot:b}}),w=A[0].inst,S=A[1];return a(function(){w.value=y,w.getSnapshot=b,f(w)&&S({inst:w})},[x,y,b]),r(function(){return f(w)&&S({inst:w}),x(function(){f(w)&&S({inst:w})})},[x]),c(y),y}function f(x){var b=x.getSnapshot;x=x.value;try{var y=b();return!t(x,y)}catch{return!0}}function p(x,b){return b()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:d;return ic.useSyncExternalStore=u.useSyncExternalStore!==void 0?u.useSyncExternalStore:m,ic}var rf;function zx(){return rf||(rf=1,nc.exports=Ox()),nc.exports}var af;function Bx(){if(af)return sc;af=1;var u=mr(),e=zx();function t(p,m){return p===m&&(p!==0||1/p===1/m)||p!==p&&m!==m}var i=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,a=u.useRef,c=u.useEffect,d=u.useMemo,f=u.useDebugValue;return sc.useSyncExternalStoreWithSelector=function(p,m,x,b,y){var A=a(null);if(A.current===null){var w={hasValue:!1,value:null};A.current=w}else w=A.current;A=d(function(){function N(T){if(!C){if(C=!0,R=T,T=b(T),y!==void 0&&w.hasValue){var I=w.value;if(y(I,T))return E=I}return E=T}if(I=E,i(R,T))return I;var $=b(T);return y!==void 0&&y(I,$)?(R=T,I):(R=T,E=$)}var C=!1,R,E,L=x===void 0?null:x;return[function(){return N(m())},L===null?void 0:function(){return N(L())}]},[m,x,b,y]);var S=r(p,A[0],A[1]);return c(function(){w.hasValue=!0,w.value=S},[S]),f(S),S},sc}var of;function Ux(){return of||(of=1,tc.exports=Bx()),tc.exports}var Hx=Ux();const $x=jc(Hx),Wf={},{useDebugValue:Gx}=Cc,{useSyncExternalStoreWithSelector:Wx}=$x;let lf=!1;const qx=u=>u;function Xx(u,e=qx,t){(Wf?"production":void 0)!=="production"&&t&&!lf&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),lf=!0);const i=Wx(u.subscribe,u.getState,u.getServerState||u.getInitialState,e,t);return Gx(i),i}const cf=u=>{(Wf?"production":void 0)!=="production"&&typeof u!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof u=="function"?Fx(u):u,t=(i,r)=>Xx(e,i,r);return Object.assign(t,e),t},Yx=u=>u?cf(u):cf,qf="/api".replace(/\/$/,"")||"/api";function Xf(){return localStorage.getItem("tarikh_token")}async function Ie(u,e={}){const{params:t,...i}=e,r=new URL(u.startsWith("http")?u:`${qf}${u}`,window.location.origin);t&&Object.entries(t).forEach(([f,p])=>{p!==void 0&&p!==""&&r.searchParams.set(f,String(p))});const a=Xf(),c={...i.method!=="GET"&&typeof i.body?.append!="function"?{"Content-Type":"application/json"}:{},...i.headers};a&&(c.Authorization=`Bearer ${a}`);const d=await fetch(r.toString(),{...i,headers:c});if(!d.ok){const f=await d.json().catch(()=>({message:d.statusText}));throw new Error(f.message??"Erreur API")}if(d.status!==204)return d.json()}function rc(u){const e=Xf(),t=`${qf}/documents/${u}/stream`;return e?`${t}?token=${encodeURIComponent(e)}`:t}const za={login:(u,e)=>Ie("/login",{method:"POST",body:JSON.stringify({email:u,password:e})}),register:(u,e,t,i)=>Ie("/register",{method:"POST",body:JSON.stringify({name:u,email:e,password:t,password_confirmation:i})}),user:()=>Ie("/user"),logout:()=>Ie("/logout",{method:"POST"})},Yf={list:()=>Ie("/themes")},Kx={list:()=>Ie("/regions")};function Qx(u,e){const t=e.slice(0,50).join(",");return Ie(`/documents/${u}/pages/urls`,{params:{pages:t}})}const Ba={list:u=>Ie("/documents",{params:u}),get:u=>Ie(`/documents/${u}`)},Jx={list:()=>Ie("/banners")},ct={stats:u=>Ie("/admin/stats",{params:u}),documents:{list:u=>Ie("/admin/documents",{params:u}),create:u=>Ie("/admin/documents",{method:"POST",body:u}),get:u=>Ie(`/admin/documents/${u}`),update:(u,e)=>Ie(`/admin/documents/${u}`,{method:"PUT",body:e}),delete:u=>Ie(`/admin/documents/${u}`,{method:"DELETE"}),conversionProgress:u=>Ie(`/admin/documents/${u}/conversion-progress`),regeneratePages:u=>Ie(`/admin/documents/${u}/regenerate-pages`,{method:"POST"})},users:{list:u=>Ie("/admin/users",{params:u}),get:u=>Ie(`/admin/users/${u}`),create:u=>Ie("/admin/users",{method:"POST",body:JSON.stringify(u)}),update:(u,e)=>Ie(`/admin/users/${u}`,{method:"PUT",body:JSON.stringify(e)}),delete:u=>Ie(`/admin/users/${u}`,{method:"DELETE"})},banners:{list:()=>Ie("/admin/banners"),create:u=>Ie("/admin/banners",{method:"POST",body:u}),get:u=>Ie(`/admin/banners/${u}`),update:(u,e)=>Ie(`/admin/banners/${u}`,{method:"POST",body:e,params:{_method:"PUT"}}),delete:u=>Ie(`/admin/banners/${u}`,{method:"DELETE"})}},er="tarikh_token",os=Yx(u=>({token:localStorage.getItem(er),user:null,setAuth:(e,t)=>{localStorage.setItem(er,e),u({token:e,user:t})},logout:async()=>{try{await za.logout()}catch{}localStorage.removeItem(er),u({token:null,user:null})},loadUser:async()=>{const e=localStorage.getItem(er);if(!e)return u({user:null});try{const t=await za.user();u({token:e,user:t})}catch{localStorage.removeItem(er),u({token:null,user:null})}}}));function Zx(){const{user:u,logout:e}=os(),[t,i]=j.useState(!1),r=()=>i(!t),a=()=>i(!1);return l.jsxs("header",{className:`fixed top-0 w-full z-50 transition-colors ${t?"bg-parchment":"glass-nav"} border-b border-accent-gold/20 px-6 lg:px-20 py-4`,children:[l.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[l.jsxs(he,{to:"/",className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-accent-gold",children:l.jsx("span",{className:"material-symbols-outlined text-3xl",children:"auto_stories"})}),l.jsxs("h2",{className:"text-slate-900 text-2xl font-black tracking-tighter italic",children:["Tarikh",l.jsx("span",{className:"text-accent-gold",children:".ma"})]})]}),l.jsxs("nav",{className:"hidden md:flex items-center gap-10",children:[l.jsx(Qt,{to:"/archives",className:({isActive:c})=>`text-sm font-medium transition-colors ${c?"text-accent-gold":"text-slate-600 hover:text-accent-gold"}`,children:"Collections"}),l.jsx(Qt,{to:"/epoques",className:({isActive:c})=>`text-sm font-medium transition-colors ${c?"text-accent-gold":"text-slate-600 hover:text-accent-gold"}`,children:"poques"}),l.jsx(he,{to:"/archives",className:"text-slate-600 hover:text-accent-gold text-sm font-medium transition-colors",children:"Archives"}),l.jsx(Qt,{to:"/a-propos",className:({isActive:c})=>`text-sm font-medium transition-colors ${c?"text-accent-gold":"text-slate-600 hover:text-accent-gold"}`,children:" propos"}),(u?.role==="admin"||u?.role==="editor")&&l.jsx(he,{to:"/admin",className:"text-sm font-medium text-accent-gold hover:text-accent-gold/80",children:"Admin"})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"hidden md:flex items-center gap-4",children:u?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"text-sm text-slate-500 hidden sm:inline",children:u.email}),l.jsx("button",{type:"button",onClick:()=>e(),className:"text-slate-600 hover:text-accent-gold text-sm font-medium transition-colors",children:"Dconnexion"})]}):l.jsxs(l.Fragment,{children:[l.jsxs("button",{type:"button",className:"hidden sm:flex text-slate-600 text-sm font-bold items-center gap-1 hover:text-accent-gold transition-colors","aria-label":"Langue FR / AR",children:[l.jsx("span",{className:"material-symbols-outlined text-lg",children:"language"}),"FR / AR"]}),l.jsx(he,{to:"/login",className:"bg-accent-gold hover:bg-accent-gold/90 text-white px-6 py-2 rounded-lg text-sm font-bold transition-all transform hover:scale-105 shadow-lg shadow-accent-gold/20",children:"Connexion"})]})}),l.jsx("button",{type:"button",onClick:r,className:"md:hidden p-2 text-slate-600 hover:text-accent-gold transition-colors","aria-label":"Toggle menu",children:l.jsx("span",{className:"material-symbols-outlined text-3xl",children:t?"close":"menu"})})]})]}),t&&l.jsxs("div",{className:"md:hidden fixed inset-0 top-[76px] bg-[#ffffff] z-[100] flex flex-col p-6 animate-fade-in shadow-2xl overflow-y-auto",children:[l.jsxs("nav",{className:"flex flex-col gap-6 mb-8",children:[l.jsx(Qt,{to:"/archives",onClick:a,className:({isActive:c})=>`text-lg font-semibold transition-colors ${c?"text-accent-gold":"text-slate-900 border-b border-slate-100 pb-2"}`,children:"Collections"}),l.jsx(Qt,{to:"/epoques",onClick:a,className:({isActive:c})=>`text-lg font-semibold transition-colors ${c?"text-accent-gold":"text-slate-900 border-b border-slate-100 pb-2"}`,children:"poques"}),l.jsx(he,{to:"/archives",onClick:a,className:"text-lg font-semibold text-slate-900 border-b border-slate-100 pb-2",children:"Archives"}),l.jsx(Qt,{to:"/a-propos",onClick:a,className:({isActive:c})=>`text-lg font-semibold transition-colors ${c?"text-accent-gold":"text-slate-900 border-b border-slate-100 pb-2"}`,children:" propos"}),(u?.role==="admin"||u?.role==="editor")&&l.jsx(he,{to:"/admin",onClick:a,className:"text-lg font-semibold text-accent-gold border-b border-slate-100 pb-2",children:"Admin Panel"})]}),l.jsx("div",{className:"mt-auto pt-6 border-t border-slate-100 flex flex-col gap-4",children:u?l.jsxs("div",{className:"flex flex-col gap-4",children:[l.jsx("span",{className:"text-sm text-slate-500 font-medium",children:u.email}),l.jsx("button",{type:"button",onClick:()=>{e(),a()},className:"w-full bg-slate-100 text-slate-900 py-3 rounded-xl font-bold hover:bg-slate-200 transition-colors",children:"Dconnexion"})]}):l.jsxs("div",{className:"flex flex-col gap-4",children:[l.jsxs("button",{type:"button",className:"flex items-center justify-center gap-2 text-slate-600 font-bold py-2",children:[l.jsx("span",{className:"material-symbols-outlined",children:"language"}),"FR / AR"]}),l.jsx(he,{to:"/login",onClick:a,className:"w-full bg-accent-gold text-white text-center py-4 rounded-xl font-bold text-lg shadow-lg shadow-accent-gold/20",children:"Connexion"})]})})]})]})}function e0(){return l.jsxs("footer",{className:"bg-white text-slate-800 pt-20 pb-10 border-t border-slate-200",children:[l.jsxs("div",{className:"max-w-7xl mx-auto px-6 grid grid-cols-1 md:grid-cols-4 gap-12 mb-16",children:[l.jsxs("div",{className:"col-span-1 md:col-span-1",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[l.jsx("span",{className:"material-symbols-outlined text-accent-gold text-2xl",children:"auto_stories"}),l.jsx("h2",{className:"text-slate-900 text-2xl font-black italic",children:"Tarikh.ma"})]}),l.jsx("p",{className:"text-slate-500 text-sm leading-relaxed mb-6",children:"La plateforme numrique de rfrence ddie  la sauvegarde et  la diffusion du patrimoine documentaire du Royaume du Maroc."}),l.jsxs("div",{className:"flex gap-4",children:[l.jsx("a",{href:"#",className:"w-10 h-10 rounded-lg bg-slate-100 flex items-center justify-center hover:bg-accent-gold hover:text-white text-slate-600 transition-colors","aria-label":"Partager",children:l.jsx("span",{className:"material-symbols-outlined text-xl",children:"share"})}),l.jsx("a",{href:"mailto:contact@tarikh.ma",className:"w-10 h-10 rounded-lg bg-slate-100 flex items-center justify-center hover:bg-accent-gold hover:text-white text-slate-600 transition-colors","aria-label":"Email",children:l.jsx("span",{className:"material-symbols-outlined text-xl",children:"mail"})})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-bold mb-6 text-accent-gold uppercase tracking-widest text-xs",children:"Explorer"}),l.jsxs("ul",{className:"space-y-4 text-sm text-slate-600",children:[l.jsx("li",{children:l.jsx(he,{to:"/archives?type=manuscrit",className:"hover:text-slate-900 transition-colors",children:"Manuscrits Rares"})}),l.jsx("li",{children:l.jsx(he,{to:"/archives?type=carte",className:"hover:text-slate-900 transition-colors",children:"Cartes Historiques"})}),l.jsx("li",{children:l.jsx(he,{to:"/archives?type=photo",className:"hover:text-slate-900 transition-colors",children:"Photothque"})}),l.jsx("li",{children:l.jsx("a",{href:"#",className:"hover:text-slate-900 transition-colors",children:"Gnalogies"})})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-bold mb-6 text-accent-gold uppercase tracking-widest text-xs",children:"l'Hritage de platforme"}),l.jsxs("ul",{className:"space-y-4 text-sm text-slate-600",children:[l.jsx("li",{children:l.jsx("a",{href:"#epoques",className:"hover:text-slate-900 transition-colors",children:"re Idriside"})}),l.jsx("li",{children:l.jsx("a",{href:"#epoques",className:"hover:text-slate-900 transition-colors",children:"Dynastie Almohade"})}),l.jsx("li",{children:l.jsx("a",{href:"#epoques",className:"hover:text-slate-900 transition-colors",children:"Rgne Saadien"})}),l.jsx("li",{children:l.jsx("a",{href:"#epoques",className:"hover:text-slate-900 transition-colors",children:"Archives Alaouites"})})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-bold mb-6 text-accent-gold uppercase tracking-widest text-xs",children:"Newsletter"}),l.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Recevez les nouveaux trsors numriss directement par email."}),l.jsxs("form",{className:"flex gap-2",onSubmit:u=>u.preventDefault(),children:[l.jsx("input",{type:"email",placeholder:"votre@email.com",className:"flex-1 bg-slate-50 border border-slate-200 rounded-lg text-xs text-slate-800 placeholder:text-slate-400 px-3 py-2 focus:ring-accent-gold focus:border-accent-gold outline-none"}),l.jsx("button",{type:"submit",className:"bg-accent-gold px-4 py-2 rounded-lg text-xs font-bold text-white hover:brightness-110 transition-all",children:"Ok"})]})]})]}),l.jsxs("div",{className:"max-w-7xl mx-auto px-6 pt-10 border-t border-slate-200 flex flex-col md:flex-row justify-between items-center gap-4",children:[l.jsxs("p",{className:"text-[10px] text-slate-400 uppercase tracking-widest text-center md:text-left",children:[" ",new Date().getFullYear()," Tarikh.ma - Tous droits rserv. Developped by ArtgonMEDIA"]}),l.jsxs("div",{className:"flex gap-8 text-[10px] text-slate-400 uppercase tracking-widest",children:[l.jsx("a",{href:"#",className:"hover:text-accent-gold transition-colors",children:"Mentions Lgales"}),l.jsx("a",{href:"#",className:"hover:text-accent-gold transition-colors",children:"Confidentialit"}),l.jsx("a",{href:"#",className:"hover:text-accent-gold transition-colors",children:"Partenariats"})]})]})]})}function t0(){return l.jsxs("div",{className:"min-h-screen flex flex-col",children:[l.jsx(Zx,{}),l.jsx("main",{className:"flex-1 bg-white",children:l.jsx(Mc,{})}),l.jsx(e0,{})]})}function s0(){return l.jsx("div",{className:"min-h-screen h-screen bg-white font-display text-slate-900 flex flex-col overflow-hidden",children:l.jsx("div",{className:"flex-1 flex flex-col min-h-0 w-full",children:l.jsx(Mc,{})})})}function n0(){const u=os(a=>a.user),e=os(a=>a.logout),t=sn();if(j.useEffect(()=>{u?u.role!=="admin"&&u.role!=="editor"&&t("/",{replace:!0}):t("/login",{replace:!0})},[u,t]),!u||u.role!=="admin"&&u.role!=="editor")return null;const i=u.name?.split(/\s+/).map(a=>a[0]).join(". ")||u.email?.slice(0,2).toUpperCase()||"Admin",r=u.role==="admin"?"Super Admin":"diteur";return l.jsxs("div",{className:"flex h-screen overflow-hidden bg-admin-bg text-slate-900",children:[l.jsxs("aside",{className:"w-64 flex-shrink-0 border-r border-slate-200 bg-white hidden lg:flex flex-col",children:[l.jsxs("div",{className:"p-6 flex items-center gap-3",children:[l.jsx("div",{className:"bg-admin-primary rounded-lg p-2 text-white",children:l.jsx("span",{className:"material-symbols-outlined",children:"history_edu"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-sm font-bold leading-tight",children:"Tarikh.ma Admin"}),l.jsx("p",{className:"text-[11px] text-slate-500 uppercase tracking-wider font-semibold",children:"Portail Analytique"})]})]}),l.jsxs("nav",{className:"flex-1 px-4 space-y-2 mt-4",children:[l.jsxs(Qt,{to:"/admin",end:!0,className:({isActive:a})=>`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${a?"bg-admin-primary/10 text-admin-primary":"text-slate-600 hover:bg-slate-100"}`,children:[l.jsx("span",{className:"material-symbols-outlined",children:"dashboard"}),l.jsx("span",{className:"text-sm font-medium",children:"Tableau de bord"})]}),l.jsxs(Qt,{to:"/admin",end:!0,className:({isActive:a})=>`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${a?"bg-admin-primary/10 text-admin-primary":"text-slate-600 hover:bg-slate-100"}`,children:[l.jsx("span",{className:"material-symbols-outlined",style:{fontVariationSettings:'"FILL" 1'},children:"monitoring"}),l.jsx("span",{className:"text-sm font-semibold",children:"Analytiques"})]}),l.jsxs(Qt,{to:"/admin/documents",className:({isActive:a})=>`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${a?"bg-admin-primary/10 text-admin-primary":"text-slate-600 hover:bg-slate-100"}`,children:[l.jsx("span",{className:"material-symbols-outlined",children:"description"}),l.jsx("span",{className:"text-sm font-medium",children:"Documents"})]}),l.jsxs(Qt,{to:"/admin/banners",className:({isActive:a})=>`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${a?"bg-admin-primary/10 text-admin-primary":"text-slate-600 hover:bg-slate-100"}`,children:[l.jsx("span",{className:"material-symbols-outlined",children:"ads_click"}),l.jsx("span",{className:"text-sm font-medium",children:"Bannires"})]}),u.role==="admin"&&l.jsxs(Qt,{to:"/admin/users",className:({isActive:a})=>`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${a?"bg-admin-primary/10 text-admin-primary":"text-slate-600 hover:bg-slate-100"}`,children:[l.jsx("span",{className:"material-symbols-outlined",children:"group"}),l.jsx("span",{className:"text-sm font-medium",children:"Utilisateurs"})]}),l.jsxs("div",{className:"pt-4 border-t border-slate-100 mt-4",children:[l.jsx("p",{className:"px-3 text-[10px] font-bold text-slate-400 uppercase mb-2",children:"Support & Admin"}),l.jsxs(Qt,{to:"/admin/parametres",className:({isActive:a})=>`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${a?"bg-admin-primary/10 text-admin-primary":"text-slate-600 hover:bg-slate-100"}`,children:[l.jsx("span",{className:"material-symbols-outlined",children:"settings"}),l.jsx("span",{className:"text-sm font-medium",children:"Paramtres"})]})]})]}),l.jsxs("div",{className:"p-4 border-t border-slate-100",children:[l.jsxs("div",{className:"flex items-center gap-3 p-2 bg-slate-50 rounded-xl",children:[l.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-300 flex items-center justify-center text-slate-600 text-sm font-bold overflow-hidden",children:i.slice(0,2)}),l.jsxs("div",{className:"flex-1 overflow-hidden",children:[l.jsx("p",{className:"text-xs font-bold truncate",children:u.name||u.email}),l.jsx("p",{className:"text-[10px] text-admin-primary font-semibold truncate",children:r})]})]}),l.jsx("button",{type:"button",onClick:()=>e(),className:"mt-2 w-full text-xs text-slate-500 hover:text-slate-700",children:"Dconnexion"})]})]}),l.jsx("main",{className:"flex-1 overflow-y-auto scroll-smooth",children:l.jsx(Mc,{})})]})}const i0="https://lh3.googleusercontent.com/aida-public/AB6AXuBpIX9eFdB_PDh8VX_XwGjMSnshbOdlEt_5DyZZTzLhWCu14dvdgOfYRVHufwRim5HWN-y5zws2t_cehuoOgq8wbPGmbFt0MiSYdskfKDVjfyDnjHab714Df_83fOcvuf1-aFvJf3SF8i-LTMyjeRU9QNdkAz76uFM2RfX9-kCpBN2IZ2rc3bcaaum0R0-rYZtIJ2HZ0l4Fqzj5DJBkkYXeqxZN5cLU-zySzFI1G7niZ0Xs3-fUUUrMkBwjFTFdQY4XJrC_3-Wn6__B",r0=[{title:"Livres",description:"Ouvrages historiques et recueils littraires du patrimoine national.",icon:"library_books",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuBITFIPrXlrK_sX4lzqs74yHeyyg_ir4qWIb-0yMHo8UhqWcnpM4F_mWn1ZPWA5wMPRNvlfqGS_8u7IekgzfxGgdU5tYOx9LEXDSFzZesVBvxOrr34Cgzd7EStCxoqfZQ7CvqZ7yGKQBcoacGj09vrLW5hJ-x4SZnJBMzVfQJCcGkYFvtGiDGCMLcy4XBhDNT3YTEDBdPTwask6uOJFQQ_ioDkzV51u8Vygi0YlcHy2NDF3gU8ipR5OAXOJbwUti5X_JlUQf6MPBeHe",to:"/archives?type=livre"},{title:"Manuscrits",description:"Traits, dahirs et crits originaux  la plume.",icon:"menu_book",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuC7IYapK4EGetsL_RnTQwBUvwHL5a5B-qIjLOumYxyvWjE_JDl8rKzx0dljC3v_BkCs65Rw12yGxvrpqcboQPdZBp1UBYiBubcOz-u_hPBp5BH3_Wem9xWRsBv8U0oSLvoRsKfrvQuiiGJ-4F1EibEogb5Hz0KscEJNDk_XBa49-ZG0r32EVY6CaCk0QQ7m19zWjd1N3YWPOpVdHluSJUdvBh6OwEpxH29OtKX9Qp5cgNPFomhLOhMFF53VZ9nKHx_elUkIMOIKfj3x",to:"/archives?type=pdf"},{title:"Vidos",description:"Archives cinmatographiques et tmoignages visuels du pass.",icon:"videocam",image:"https://images.unsplash.com/photo-1485846234645-a62644f84728?auto=format&fit=crop&q=80&w=800",to:"/archives?type=video"},{title:"Cartes",description:"Plans anciens et cartographie de l'volution du Royaume.",icon:"map",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuBNl4A1QMa3XiOj2YLC-rPfz3YGjhDuA6IYuV5v53NFIlqTEWoPDZYS3lT2mHqFbLTApk3qZQbYlpCew2T6tfoDZrzBB5nw7_8M9_O3TQZOHBHt4nf6oy16c4rbNVxn6gslN5IJn-j5v9W6MT0YGi0tI6WIZPI0c8hi-mR5qplyULQ8vXlDJTv1BSR7Qqocc1Yh7lnq5ZOFU8MsH3fQlusRFJk2Iug6oEKsm0FACTJOL2hIC-3VG0CXpjTM5-lQOFZBJ3UpbHutM2OL",to:"/archives?type=carte"},{title:"Photos",description:"Clichs historiques et gravures d'poque.",icon:"photo_library",image:"https://lh3.googleusercontent.com/aida-public/AB6AXuAhELtUk_EWB0svCP1CPN5I7_GjmSkaruom8rn-0NGIC9XWgHPHbmHNweG07Eh_bDyo1_iHvXNb47cJWohcfMM5SFh0ZyaMQcG76trgeHe7vPXj-pBxlsLBmABAFgjS0Ut1E7Qj7aJqk-zn2jcDtK51e8vwc7BBAz6doa3krqxYLN_WawebcbKvsNVhyGNr_W0U9wqvmjuDtNbX9M4zPBPZcyEtYyKPsi-baMAJLyk2lY05y7BlU7xrLrkeBdAzRrj4oNa88HjxG8hO",to:"/archives?type=image"},{title:"Articles",description:"Presse d'poque et analyses historiques.",icon:"article",image:"https://images.unsplash.com/photo-1504711434969-e33886168f5c?auto=format&fit=crop&q=80&w=800",to:"/archives?type=article"}];function a0(){const u=sn(),[e,t]=j.useState(""),[i,r]=j.useState([]),[a,c]=j.useState(!0),[d,f]=j.useState([]),[p,m]=j.useState(!0),[x,b]=j.useState([]);j.useEffect(()=>{Ba.list({per_page:6,page:1}).then(w=>r(w.data)).catch(w=>console.error("Erreur chargement archives:",w)).finally(()=>c(!1)),Ba.list({per_page:4,is_rare:!0}).then(w=>f(w.data)).catch(w=>console.error("Erreur chargement documents rares:",w)).finally(()=>m(!1)),Jx.list().then(b).catch(w=>console.error("Erreur chargement bannires:",w))},[]);const y=j.useRef(null);j.useEffect(()=>{const w=setInterval(()=>{if(y.current){const{scrollLeft:S,offsetWidth:N,scrollWidth:C}=y.current;S+N>=C-10?y.current.scrollTo({left:0,behavior:"smooth"}):y.current.scrollBy({left:N/3,behavior:"smooth"})}},5e3);return()=>clearInterval(w)},[]);const A=w=>{w.preventDefault(),e.trim()?u(`/archives?q=${encodeURIComponent(e.trim())}`):u("/archives")};return l.jsxs(l.Fragment,{children:[l.jsxs("section",{className:"relative min-h-[95vh] md:min-h-screen flex items-center justify-center pt-24 pb-12 overflow-hidden",children:[l.jsxs("div",{className:"absolute inset-0 z-0",children:[l.jsx("div",{className:"absolute inset-0 hero-gradient z-10"}),l.jsx("img",{src:i0,alt:"Patrimoine manuscrit marocain",className:"w-full h-full object-cover"})]}),l.jsxs("div",{className:"relative z-20 max-w-5xl px-6 text-center",children:[l.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-accent-gold/20 border border-accent-gold/30 text-accent-gold text-[10px] md:text-xs font-bold uppercase tracking-[0.2em] mb-8 animate-fade-in",children:[l.jsx("span",{className:"material-symbols-outlined text-sm",children:"verified"}),"Patrimoine National Numris"]}),l.jsxs("h1",{className:"text-white text-6xl md:text-8xl lg:text-9xl font-black leading-[1.05] mb-8 tracking-tighter vintage-text-shadow serif",children:["Prserver l'Histoire, ",l.jsx("br",{}),l.jsx("span",{className:"text-accent-gold italic",children:"clairer l'Avenir"})]}),l.jsx("p",{className:"text-parchment/90 text-xl md:text-2xl font-light mb-12 max-w-3xl mx-auto leading-relaxed serif underline decoration-accent-gold/20 decoration-1 underline-offset-[12px]",children:"Explorez les archives impriales du Royaume. Une collection unique de manuscrits rares, traits sculaires et photographies d'poque."}),l.jsxs("div",{className:"relative max-w-2xl mx-auto",children:[l.jsxs("form",{onSubmit:A,className:"flex flex-col md:flex-row items-center bg-black/30 backdrop-blur-xl border border-white/10 p-2 rounded-xl gap-2 shadow-2xl",children:[l.jsxs("div",{className:"flex flex-1 items-center px-4 gap-3 w-full",children:[l.jsx("span",{className:"material-symbols-outlined text-accent-gold",children:"search"}),l.jsx("input",{type:"text",value:e,onChange:w=>t(w.target.value),placeholder:"Rechercher un manuscrit, une ville, une dynastie...",className:"w-full bg-transparent border-none text-white placeholder:text-white/40 focus:ring-0 text-base py-3 outline-none"})]}),l.jsx("button",{type:"submit",className:"w-full md:w-auto bg-accent-gold hover:bg-yellow-700 text-background-dark font-black px-8 py-3 rounded-lg transition-all flex items-center justify-center gap-2 uppercase tracking-tighter",children:"Explorer"})]}),l.jsxs("div",{className:"mt-4 flex flex-wrap justify-center gap-4 text-parchment/60 text-xs",children:[l.jsx("span",{children:"Tendances :"}),l.jsx(he,{to:"/archives?q=almohades",className:"hover:text-accent-gold transition-colors underline decoration-accent-gold/40",children:"Manuscrits Almohades"}),l.jsx(he,{to:"/archives?q=Fs",className:"hover:text-accent-gold transition-colors underline decoration-accent-gold/40",children:"Cartographie de Fs"}),l.jsx(he,{to:"/archives?q=traits",className:"hover:text-accent-gold transition-colors underline decoration-accent-gold/40",children:"Traits diplomatiques"})]})]})]}),l.jsx("div",{className:"absolute bottom-0 left-0 w-full h-32 bg-gradient-to-t from-background-dark to-transparent pointer-events-none"})]}),x.length>0&&l.jsx("section",{className:"bg-background-light py-8 px-6 border-b border-slate-100",children:l.jsx("div",{className:"max-w-7xl mx-auto",children:l.jsx("div",{className:"flex gap-6 overflow-x-auto scrollbar-hide snap-x snap-mandatory",children:x.map(w=>l.jsxs("a",{href:w.link_url||"#",target:w.link_url?"_blank":void 0,rel:"noopener noreferrer",className:"min-w-full md:min-w-[800px] lg:min-w-full h-32 md:h-48 rounded-2xl overflow-hidden snap-center block relative group border-2 border-accent-gold/5 hover:border-accent-gold/20 transition-all shadow-lg hover:shadow-xl",children:[l.jsx("img",{src:w.image_url,alt:w.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-1000"}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black/40 via-transparent to-transparent flex items-center p-8 md:p-12",children:l.jsx("div",{className:"max-w-xl",children:l.jsx("h3",{className:"text-white text-xl md:text-3xl font-black serif drop-shadow-lg group-hover:translate-x-2 transition-transform",children:w.title})})}),w.link_url&&l.jsxs("div",{className:"absolute bottom-4 right-8 bg-white/20 backdrop-blur-md px-4 py-2 rounded-full text-white text-xs font-bold flex items-center gap-2 group-hover:bg-white group-hover:text-primary transition-all",children:["En savoir plus ",l.jsx("span",{className:"material-symbols-outlined text-sm",children:"open_in_new"})]})]},w.id))})})}),l.jsx("section",{className:"py-24 px-6 bg-parchment paper-texture zellij-pattern",id:"categories",children:l.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end mb-12 gap-4",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl md:text-4xl font-black text-slate-900 mb-2 italic serif",children:"Explorer l'Hritage"}),l.jsx("div",{className:"h-1.5 w-24 bg-accent-gold rounded-full"})]}),l.jsxs(he,{to:"/archives",className:"text-accent-gold font-bold flex items-center gap-1 hover:gap-2 transition-all",children:["Consulter les manuscrits ",l.jsx("span",{className:"material-symbols-outlined",children:"arrow_forward"})]})]}),l.jsx("div",{ref:y,className:"flex gap-8 overflow-x-auto pb-4 scrollbar-hide snap-x snap-mandatory touch-scroll",children:r0.map(w=>l.jsxs(he,{to:w.to,className:"group relative overflow-hidden rounded-2xl aspect-[3/2] cursor-pointer block border-4 border-white shadow-xl shadow-accent-gold/10 flex-shrink-0 w-full sm:w-[calc(50%-1rem)] lg:w-[calc(33.333%-1.33rem)] snap-center",children:[l.jsx("img",{src:w.image,alt:"",className:"absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-100/95 via-slate-50/70 to-transparent opacity-100 transition-opacity duration-500 group-hover:from-slate-200/95"}),l.jsxs("div",{className:"absolute bottom-0 p-6",children:[l.jsx("span",{className:"material-symbols-outlined text-accent-gold text-3xl mb-2 block",children:w.icon}),l.jsx("h3",{className:"text-slate-900 text-xl font-bold mb-1 serif",children:w.title}),l.jsx("p",{className:"text-slate-600 text-xs leading-relaxed opacity-0 group-hover:opacity-100 transition-all duration-500 line-clamp-2",children:w.description})]}),l.jsx("div",{className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity",children:l.jsx("span",{className:"bg-white/20 backdrop-blur-md p-2 rounded-full text-white material-symbols-outlined text-sm",children:"north_east"})})]},w.title))})]})}),l.jsx("section",{className:"py-24 bg-white overflow-hidden border-t border-slate-100 relative",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-6 relative z-10",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end mb-12 gap-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-slate-900 text-3xl md:text-5xl font-black mb-3 italic serif",children:"Trsors Rcents"}),l.jsx("div",{className:"h-1.5 w-24 bg-accent-gold rounded-full mb-4"}),l.jsx("p",{className:"text-slate-500 serif",children:"Les dernires numrisations ajoutes aux Archives Nationales."})]}),l.jsxs(he,{to:"/archives",className:"text-accent-gold font-bold flex items-center gap-2 hover:gap-3 transition-all group",children:["Voir tout le catalogue ",l.jsx("span",{className:"material-symbols-outlined group-hover:translate-x-1 transition-transform",children:"arrow_forward"})]})]}),a?l.jsx("div",{className:"flex gap-6 overflow-hidden",children:[1,2,3].map(w=>l.jsx("div",{className:"min-w-[300px] md:min-w-[400px] h-80 bg-slate-100 animate-pulse rounded-2xl"},w))}):l.jsx("div",{className:"flex gap-6 overflow-x-auto pb-12 scrollbar-hide touch-scroll",children:i.map(w=>l.jsxs(he,{to:`/documents/${w.id}`,className:"min-w-[300px] md:min-w-[420px] bg-parchment/30 border border-accent-gold/10 rounded-2xl overflow-hidden hover:shadow-2xl hover:shadow-accent-gold/5 transition-all group flex-shrink-0 relative",children:[l.jsxs("div",{className:"h-64 overflow-hidden relative",children:[w.thumbnail_url?l.jsx("img",{src:w.thumbnail_url,alt:w.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700"}):l.jsx("div",{className:"w-full h-full bg-parchment flex items-center justify-center",children:l.jsx("span",{className:"material-symbols-outlined text-accent-gold/30 text-7xl",children:"folded_paper"})}),l.jsx("div",{className:"absolute top-4 right-4 bg-white/80 backdrop-blur-md px-3 py-1 rounded-full text-[10px] font-black text-accent-gold uppercase border border-accent-gold/10",children:w.type})]}),l.jsxs("div",{className:"p-8",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[l.jsx("span",{className:"text-accent-gold material-symbols-outlined text-sm",children:"calendar_today"}),l.jsx("span",{className:"text-slate-500 text-xs font-medium",children:w.year||"Anne inconnue"}),l.jsx("span",{className:"h-1 w-1 rounded-full bg-slate-300 mx-1"}),l.jsx("span",{className:"text-slate-500 text-xs font-medium",children:w.region?.name||"Royaume"})]}),l.jsx("h4",{className:"text-slate-900 text-xl font-bold mb-3 group-hover:text-accent-gold transition-colors serif line-clamp-2 leading-tight",children:w.title}),l.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-accent-gold/5 mt-auto",children:[l.jsxs("span",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest",children:[w.views_count," vues"]}),l.jsx("span",{className:"text-accent-gold material-symbols-outlined group-hover:translate-x-1 transition-transform",children:"visibility"})]})]})]},w.id))})]})}),l.jsx("section",{className:"py-24 px-6 bg-background-light border-t border-slate-100",id:"rare-documents",children:l.jsxs("div",{className:"max-w-7xl mx-auto",children:[l.jsxs("div",{className:"text-center mb-16",children:[l.jsxs("h2",{className:"text-slate-900 text-4xl md:text-6xl font-black mb-4 italic serif uppercase tracking-tighter",children:["Documents ",l.jsx("span",{className:"text-accent-gold",children:"Rare"})]}),l.jsx("div",{className:"h-1.5 w-32 bg-accent-gold mx-auto rounded-full mb-6"}),l.jsx("p",{className:"text-slate-500 max-w-2xl mx-auto text-lg serif italic",children:"Une slection exclusive des pices les plus prcieuses de notre patrimoine national."})]}),p?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[1,2,3,4].map(w=>l.jsx("div",{className:"aspect-[3/4] bg-slate-100 animate-pulse rounded-2xl"},w))}):d.length>0?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:d.map(w=>l.jsxs(he,{to:`/documents/${w.id}`,className:"group relative aspect-[3/4] rounded-2xl overflow-hidden border border-accent-gold/20 shadow-xl hover:shadow-2xl transition-all duration-500",children:[l.jsx("img",{src:w.thumbnail_url||"/placeholder-archive.jpg",alt:w.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700"}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent opacity-80 group-hover:opacity-90 transition-opacity"}),l.jsx("div",{className:"absolute inset-0 p-6 flex flex-col justify-end",children:l.jsxs("div",{className:"translate-y-4 group-hover:translate-y-0 transition-transform duration-500",children:[l.jsxs("span",{className:"text-accent-gold text-[10px] font-bold uppercase tracking-widest mb-2 block border-l-2 border-accent-gold pl-2",children:[w.type,"  ",w.year||"poque Royale"]}),l.jsx("h3",{className:"text-white text-xl font-bold serif mb-3 leading-tight leading-clamp-2",children:w.title}),l.jsxs("div",{className:"flex items-center gap-2 text-parchment/60 text-xs opacity-0 group-hover:opacity-100 transition-opacity duration-500 delay-100",children:[l.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"visibility"}),l.jsx("span",{children:"Consulter ce trsor"})]})]})}),l.jsx("div",{className:"absolute top-4 right-4 bg-accent-gold text-background-dark p-2 rounded-full shadow-lg scale-0 group-hover:scale-100 transition-transform duration-500",children:l.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"star"})})]},w.id))}):l.jsxs("div",{className:"text-center py-20 bg-parchment/30 rounded-3xl border-2 border-dashed border-accent-gold/10",children:[l.jsx("span",{className:"material-symbols-outlined text-accent-gold/20 text-6xl mb-4",children:"auto_stories"}),l.jsx("p",{className:"text-slate-400 serif italic",children:"Bientt, dcouvrez ici nos plus rares manuscrits..."})]})]})})]})}function o0(){return l.jsxs("div",{className:"relative flex flex-col overflow-x-hidden bg-white",children:[l.jsxs("section",{className:"relative h-[420px] sm:h-[500px] flex items-center justify-center overflow-hidden",children:[l.jsxs("div",{className:"absolute inset-0 z-0",children:[l.jsx("img",{alt:"Bibliothque historique",className:"w-full h-full object-cover opacity-20 grayscale brightness-75",src:"https://lh3.googleusercontent.com/aida-public/AB6AXuAMAiUkLX4Ef90560Doe2G93v3yek3cb0Ui2NXaou2ZmdA-JaRLKqN5iQj6K-JouT3lxAWl4qKtnZ3GwYkE2gjjn6fLtK2dH3DcTrf0fizOeK2eCS5zaJNyb5DBiCCJTGNHdxfoMHjh4eINssVYHRipFMpN4S6OJu6Kgl6gEqp2_NgSPr6RsgULGJdGlK3z240igcdNUF-FjAZow4CjH_efTaMRC6qffLZdfHnmZ0V0lgRG-JqWqCGxVHkpLE9bmeP3Mzm_dgybSmPu"}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent to-white"})]}),l.jsxs("div",{className:"relative z-10 max-w-4xl px-6 text-center",children:[l.jsx("span",{className:"inline-block px-4 py-1.5 rounded-full bg-accent-gold/10 text-accent-gold font-bold text-[10px] uppercase tracking-[0.2em] mb-6",children:"Institutionnel"}),l.jsxs("h1",{className:"text-4xl sm:text-5xl md:text-7xl font-black mb-6 leading-[1.1] tracking-tight text-slate-900",children:["Notre Mission : ",l.jsx("br",{}),l.jsx("span",{className:"text-accent-gold italic font-serif",children:"Porter l'Hritage"})]}),l.jsx("p",{className:"text-lg sm:text-xl text-slate-600 max-w-2xl mx-auto leading-relaxed",children:"Tarikh.ma est la sentinelle numrique du patrimoine marocain. Nous uvrons pour que chaque manuscrit, chaque carte et chaque rcit trouve sa place dans la mmoire du futur."})]})]}),l.jsx("section",{className:"max-w-7xl mx-auto px-6 sm:px-10 py-16 sm:py-24 bg-white",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 sm:gap-8",children:[l.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow group",children:[l.jsx("div",{className:"w-12 h-12 bg-accent-gold/10 rounded-lg flex items-center justify-center text-accent-gold mb-6 group-hover:bg-accent-gold group-hover:text-white transition-colors",children:l.jsx("span",{className:"material-symbols-outlined",children:"hub"})}),l.jsx("h3",{className:"font-bold text-xl mb-3 text-slate-900",children:"Centralisation"}),l.jsx("p",{className:"text-slate-500 text-sm leading-relaxed",children:"Unification des archives disperses pour crer un corpus national cohrent et accessible."})]}),l.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow group",children:[l.jsx("div",{className:"w-12 h-12 bg-accent-gold/10 rounded-lg flex items-center justify-center text-accent-gold mb-6 group-hover:bg-accent-gold group-hover:text-white transition-colors",children:l.jsx("span",{className:"material-symbols-outlined",children:"public"})}),l.jsx("h3",{className:"font-bold text-xl mb-3 text-slate-900",children:"Accessibilit"}),l.jsx("p",{className:"text-slate-500 text-sm leading-relaxed",children:"Dmocratisation du savoir historique pour les chercheurs, les tudiants et les curieux du monde entier."})]}),l.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow group",children:[l.jsx("div",{className:"w-12 h-12 bg-accent-gold/10 rounded-lg flex items-center justify-center text-accent-gold mb-6 group-hover:bg-accent-gold group-hover:text-white transition-colors",children:l.jsx("span",{className:"material-symbols-outlined",children:"devices"})}),l.jsx("h3",{className:"font-bold text-xl mb-3 text-slate-900",children:"Exprience Moderne"}),l.jsx("p",{className:"text-slate-500 text-sm leading-relaxed",children:"Interfaces intuitives et outils de visualisation avancs pour une exploration fluide de l'histoire."})]}),l.jsxs("div",{className:"bg-white p-6 sm:p-8 rounded-xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow group",children:[l.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center text-primary mb-6 group-hover:bg-primary group-hover:text-white transition-colors",children:l.jsx("span",{className:"material-symbols-outlined",children:"encrypted"})}),l.jsx("h3",{className:"font-bold text-xl mb-3 text-slate-900",children:"Scurit"}),l.jsx("p",{className:"text-slate-500 text-sm leading-relaxed",children:"Protection cryptographique et prennit numrique des documents sensibles et rares."})]})]})}),l.jsx("section",{className:"bg-parchment sm:bg-slate-50/80 py-16 sm:py-24 px-6 sm:px-10",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"text-center mb-14 sm:mb-20",children:[l.jsx("h2",{className:"text-3xl font-black mb-4 text-slate-900 italic serif",children:"Gense du Projet"}),l.jsx("div",{className:"w-16 h-1.5 bg-accent-gold mx-auto rounded-full"})]}),l.jsxs("div",{className:"relative space-y-12 sm:space-y-16",children:[l.jsx("div",{className:"absolute left-8 top-0 bottom-0 w-0.5 bg-slate-200 timeline-line"}),l.jsxs("div",{className:"relative flex items-start gap-8 sm:gap-12 group",children:[l.jsx("div",{className:"z-10 flex items-center justify-center w-16 h-16 rounded-full bg-accent-gold text-white shadow-lg ring-8 ring-white sm:ring-slate-50 transition-transform group-hover:scale-110",children:l.jsx("span",{className:"material-symbols-outlined text-2xl",children:"lightbulb"})}),l.jsxs("div",{className:"pt-2 min-w-0",children:[l.jsx("span",{className:"text-accent-gold font-black text-sm uppercase tracking-tighter",children:"2021  Phase d'tude"}),l.jsx("h4",{className:"text-xl font-bold mt-1 mb-3 text-slate-900",children:"closion de la vision"}),l.jsx("p",{className:"text-slate-600 leading-relaxed",children:"Une quipe pluridisciplinaire d'historiens, d'archivistes et d'ingnieurs se runit pour dfinir les standards de numrisation du patrimoine marocain."})]})]}),l.jsxs("div",{className:"relative flex items-start gap-8 sm:gap-12 group",children:[l.jsx("div",{className:"z-10 flex items-center justify-center w-16 h-16 rounded-full bg-white text-accent-gold border-4 border-accent-gold shadow-lg ring-8 ring-white sm:ring-slate-50 transition-transform group-hover:scale-110",children:l.jsx("span",{className:"material-symbols-outlined text-2xl",children:"handshake"})}),l.jsxs("div",{className:"pt-2 min-w-0",children:[l.jsx("span",{className:"text-accent-gold font-black text-sm uppercase tracking-tighter",children:"2022  Alliances Stratgiques"}),l.jsx("h4",{className:"text-xl font-bold mt-1 mb-3 text-slate-900",children:"Partenariats Institutionnels"}),l.jsx("p",{className:"text-slate-600 leading-relaxed",children:"Signature d'accords historiques avec les Archives Nationales et les bibliothques universitaires pour centraliser plus de 500000 documents rares."})]})]}),l.jsxs("div",{className:"relative flex items-start gap-8 sm:gap-12 group",children:[l.jsx("div",{className:"z-10 flex items-center justify-center w-16 h-16 rounded-full bg-primary text-white shadow-lg ring-8 ring-white sm:ring-parchment transition-transform group-hover:scale-110",children:l.jsx("span",{className:"material-symbols-outlined text-2xl",children:"rocket_launch"})}),l.jsxs("div",{className:"pt-2 min-w-0",children:[l.jsx("span",{className:"text-primary font-black text-sm uppercase tracking-tighter",children:"2023  Dploiement"}),l.jsx("h4",{className:"text-xl font-bold mt-1 mb-3 text-slate-900",children:"Lancement de la plateforme"}),l.jsx("p",{className:"text-slate-600 leading-relaxed",children:"Mise en ligne de Tarikh.ma avec son moteur de recherche smantique et ses outils de visualisation cartographique du Maroc  travers les ges."})]})]})]})]})}),l.jsxs("section",{className:"flex flex-col lg:flex-row min-h-[500px] sm:min-h-[600px] bg-white",children:[l.jsxs("div",{className:"lg:w-1/2 relative min-h-[320px] sm:min-h-[400px]",children:[l.jsx("img",{alt:"Manuscrit marocain",className:"absolute inset-0 w-full h-full object-cover grayscale",src:"https://lh3.googleusercontent.com/aida-public/AB6AXuAUi5BOTSw9nRYZNMewX2G9maChHwU9aq9HL0CWgvk_n4b2wMh3uLoz88z6dhm2WVwMoboRK19O6u9pdrFVZF9NsRnlHYsPVE-X2G_Fq71ltP3xQN1ARq2xoUACzOW8BPOFc-MriNGeID6QaFu7cSdrUGxQLYkLV0JYP6clwtNRSJ4QRKdE-ZOG21Vs7M7zzTvHdTSUEaZYwrUxZjVqZoveQg07siRWnIXI-EFulrrYpBXFo6F6JxmyVHqi44Ml8Bc6MPD1ahKYTfYp"}),l.jsx("div",{className:"absolute inset-0 bg-accent-gold/10 mix-blend-multiply"})]}),l.jsxs("div",{className:"lg:w-1/2 bg-slate-50 border-t lg:border-t-0 lg:border-l border-slate-200 flex flex-col justify-center p-8 sm:p-12 lg:p-24 space-y-6 sm:space-y-8",children:[l.jsx("h2",{className:"text-3xl sm:text-4xl font-black font-serif italic text-accent-gold",children:"Un devoir de mmoire"}),l.jsx("p",{className:"text-base sm:text-lg text-slate-600 leading-relaxed font-light italic",children:"La culture est ce qui reste quand on a tout oubli. En prservant les traces de notre pass, nous ne faisons pas que regarder en arrire, nous construisons les fondations d'un avenir plus conscient et plus fier de son identit plurielle."}),l.jsxs("div",{className:"pt-6 border-t border-slate-200",children:[l.jsx("p",{className:"font-bold text-slate-900 tracking-widest uppercase text-sm mb-1",children:"Dr. Ahmed El Mansouri"}),l.jsx("p",{className:"text-accent-gold text-xs font-semibold",children:"Conservateur en Chef, Projet Tarikh"})]})]})]}),l.jsx("section",{className:"py-16 sm:py-24 px-6 sm:px-10 text-center bg-white",children:l.jsxs("div",{className:"max-w-2xl mx-auto space-y-6 sm:space-y-8",children:[l.jsx("div",{className:"text-accent-gold",children:l.jsx("span",{className:"material-symbols-outlined text-5xl sm:text-6xl",children:"menu_book"})}),l.jsx("h2",{className:"text-2xl sm:text-3xl font-black text-slate-900",children:"Prt  explorer notre histoire ?"}),l.jsx("p",{className:"text-slate-500",children:"Plongez dans des sicles de savoir, de culture et de dcouvertes. Rejoignez les milliers de citoyens et chercheurs qui redcouvrent le Maroc chaque jour."}),l.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[l.jsx(he,{to:"/archives",className:"w-full sm:w-auto bg-accent-gold text-white px-10 py-5 rounded-xl font-bold hover:shadow-2xl hover:shadow-accent-gold/20 hover:brightness-110 transition-all text-center",children:"Explorer les archives"}),l.jsx(he,{to:"/archives",className:"w-full sm:w-auto border-2 border-slate-200 px-10 py-4 rounded-xl font-bold hover:bg-slate-50 transition-all text-center text-slate-800",children:"Devenir partenaire"})]})]})})]})}const l0=[{id:"antiquite",titre:"Antiquit",dates:"VIIIe s. av. J.-C.  Ve s. ap. J.-C.",icon:"museum",description:"Phniciens, Carthage, Rome et Maurtanie. Les ports de Lixus, Tingis et Volubilis tmoignent des changes mditerranens et de l'intgration du Maroc dans l'Empire romain."},{id:"idrissides",titre:"Islamisation & Idrissides",dates:"788  Xe sicle",icon:"mosque",description:"Fondation de Fs par Idriss Ier et Idriss II. mergence d'un tat musulman et d'un foyer de savoir (Qarawiyyin) au cur du Maghreb."},{id:"almoravides-almohades",titre:"Almoravides & Almohades",dates:"1040  1269",icon:"fort",description:"Empires berbres unificateurs. Marrakech comme capitale, expansion andalouse et diffusion du savoir (Averros, Ibn Tufayl). Architecture et manuscrits de cette re sont au cur de nos archives."},{id:"merinides",titre:"Mrinides & Wattasides",dates:"1244  1549",icon:"account_balance",description:"Fs redevient capitale. Mdersas, bibliothques et arts du livre. Une priode cl pour les fonds que Tarikh.ma prserve et numrise."},{id:"saadiens",titre:"Saadiens",dates:"1549  1659",icon:"military_tech",description:"ge d'or de Marrakech, bataille des Trois Rois, relations avec l'Europe et l'Afrique subsaharienne. Traits, cartes et rcits de voyage abondent dans les collections."},{id:"alaouites",titre:"Alaouites",dates:"1666   nos jours",icon:"diversity_3",description:"Dynastie rgnante. Construction du Maroc moderne, protectorat, indpendance. Archives diplomatiques, dahirs et documents d'tat forment une part essentielle du patrimoine numris."}];function c0(){return l.jsxs("div",{className:"relative flex flex-col overflow-x-hidden bg-white",children:[l.jsxs("section",{className:"relative h-[420px] sm:h-[500px] flex items-center justify-center overflow-hidden bg-background-dark",children:[l.jsxs("div",{className:"absolute inset-0 z-0",children:[l.jsx("img",{alt:"Patrimoine historique du Maroc",className:"w-full h-full object-cover opacity-40 grayscale sepia brightness-50",src:"https://lh3.googleusercontent.com/aida-public/AB6AXuAMAiUkLX4Ef90560Doe2G93v3yek3cb0Ui2NXaou2ZmdA-JaRLKqN5iQj6K-JouT3lxAWl4qKtnZ3GwYkE2gjjn6fLtK2dH3DcTrf0fizOeK2eCS5zaJNyb5DBiCCJTGNHdxfoMHjh4eINssVYHRipFMpN4S6OJu6Kgl6gEqp2_NgSPr6RsgULGJdGlK3z240igcdNUF-FjAZow4CjH_efTaMRC6qffLZdfHnmZ0V0lgRG-JqWqCGxVHkpLE9bmeP3Mzm_dgybSmPu"}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-parchment to-transparent"})]}),l.jsxs("div",{className:"relative z-10 max-w-4xl px-6 text-center",children:[l.jsx("span",{className:"inline-block px-4 py-1.5 rounded-full bg-accent-gold/20 text-accent-gold font-bold text-xs uppercase tracking-widest mb-6 border border-accent-gold/30",children:"Chronologie Royale"}),l.jsxs("h1",{className:"text-4xl sm:text-5xl md:text-7xl font-black mb-6 leading-[1.1] tracking-tight text-slate-900 vintage-text-shadow serif",children:["Les poques : ",l.jsx("br",{}),l.jsx("span",{className:"text-accent-gold italic",children:"Parcourir l'histoire"})]}),l.jsx("p",{className:"text-lg sm:text-xl text-slate-800 max-w-2xl mx-auto leading-relaxed serif",children:"Du littoral phnicien aux dynasties islamiques et au Maroc contemporain, explorez les grandes priodes qui ont faonn le Royaume. Tarikh.ma met  porte de clic les archives de chaque poque."})]})]}),l.jsx("section",{className:"max-w-4xl mx-auto px-6 sm:px-10 py-12 sm:py-16 text-center bg-white",children:l.jsx("p",{className:"text-slate-600 leading-relaxed text-base sm:text-lg",children:"La chronologie ci-dessous structure nos fonds par grandes poques. Chaque priode renvoie vers des documents numriss  manuscrits, cartes, traits, correspondances  pour une exploration thmatique et temporelle du patrimoine marocain."})}),l.jsx("section",{className:"max-w-7xl mx-auto px-6 sm:px-10 py-16 sm:py-24 bg-parchment paper-texture zellij-pattern relative",children:l.jsxs("div",{className:"relative z-10",children:[l.jsxs("div",{className:"text-center mb-12 sm:mb-16",children:[l.jsx("h2",{className:"text-3xl font-black mb-4 text-slate-900 serif italic",children:"Chronologie du Royaume"}),l.jsx("div",{className:"w-16 h-1 bg-accent-gold mx-auto rounded-full"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8",children:l0.map(u=>l.jsxs("div",{className:"bg-white/80 backdrop-blur-sm p-6 sm:p-8 rounded-xl border border-accent-gold/10 shadow-sm hover:shadow-xl transition-all hover:-translate-y-1 group",children:[l.jsx("div",{className:"w-12 h-12 bg-accent-gold/10 rounded-lg flex items-center justify-center text-accent-gold mb-6 group-hover:bg-accent-gold group-hover:text-white transition-colors",children:l.jsx("span",{className:"material-symbols-outlined",children:u.icon})}),l.jsx("span",{className:"text-accent-gold font-bold text-xs uppercase tracking-wider",children:u.dates}),l.jsx("h3",{className:"font-bold text-xl mb-3 text-slate-900 mt-1 serif",children:u.titre}),l.jsx("p",{className:"text-slate-600 text-sm leading-relaxed",children:u.description})]},u.id))})]})}),l.jsxs("section",{className:"flex flex-col lg:flex-row min-h-[400px] sm:min-h-[500px] bg-white",children:[l.jsxs("div",{className:"lg:w-1/2 relative min-h-[280px] sm:min-h-[360px] order-2 lg:order-1",children:[l.jsx("img",{alt:"Carte ou manuscrit historique",className:"absolute inset-0 w-full h-full object-cover grayscale",src:"https://lh3.googleusercontent.com/aida-public/AB6AXuD-HG_QfToneskngg-ELq5_XKEx5HwOrGeuqRxBd86g8l61RneEIOR4tzB3kpa0PtM7hxZBhIVz5B0UtSRSu-agnt8oV8cmaOXxdsy2y_j4HcTijyEWTFUo3A5rRjrsjtoU412bKr_A2QcDEnA2Ggzu8_bWy44atKHxiTTS7bmftqPnR7d_vA1q3XGnZNP-pbTHOz66u0pNoz5uIceZQ4RCi0vfMXIDrNCqiAw5ew-u26bfGDBqTLUlyslv6ksG2QdNwqlGEFVoL6OS"}),l.jsx("div",{className:"absolute inset-0 bg-accent-gold/10 mix-blend-multiply"})]}),l.jsxs("div",{className:"lg:w-1/2 bg-slate-50 border-t lg:border-t-0 lg:border-r border-slate-200 flex flex-col justify-center p-8 sm:p-12 lg:p-24 space-y-6 order-1 lg:order-2",children:[l.jsx("h2",{className:"text-3xl sm:text-4xl font-black font-serif italic text-accent-gold",children:"Une histoire en archives"}),l.jsx("p",{className:"text-base sm:text-lg text-slate-600 leading-relaxed font-light italic",children:"Chaque poque laisse des traces : parchemins, cartes, dcrets, lettres. Tarikh.ma ne se contente pas de les conserver  il les rend lisibles, interrogeables et partages, pour que chercheurs et citoyens puissent crire ensemble l'histoire du Maroc."}),l.jsxs("div",{className:"pt-6 border-t border-slate-200",children:[l.jsx("p",{className:"font-bold text-slate-900 tracking-widest uppercase text-sm mb-1",children:"Projet Tarikh.ma"}),l.jsx("p",{className:"text-accent-gold text-xs font-semibold",children:"Plateforme nationale du patrimoine numris"})]})]})]}),l.jsx("section",{className:"py-16 sm:py-24 px-6 sm:px-10 text-center bg-white",children:l.jsxs("div",{className:"max-w-2xl mx-auto space-y-6 sm:space-y-8",children:[l.jsx("div",{className:"text-accent-gold",children:l.jsx("span",{className:"material-symbols-outlined text-5xl sm:text-6xl",children:"history_edu"})}),l.jsx("h2",{className:"text-2xl sm:text-3xl font-black text-slate-900",children:"Explorer les archives par poque"}),l.jsx("p",{className:"text-slate-500",children:"Utilisez la chronologie dans les filtres des archives pour retrouver les documents par priode et thmatique."}),l.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[l.jsx(he,{to:"/archives",className:"w-full sm:w-auto bg-accent-gold text-white px-10 py-5 rounded-xl font-bold hover:shadow-2xl hover:shadow-accent-gold/20 hover:brightness-110 transition-all text-center",children:"Accder aux archives"}),l.jsx(he,{to:"/a-propos",className:"w-full sm:w-auto border-2 border-slate-200 px-10 py-4 rounded-xl font-bold hover:bg-slate-50 transition-all text-center text-slate-800",children:"Dcouvrir Tarikh.ma"})]})]})})]})}function d0(){const u=sn(),e=os(x=>x.setAuth),[t,i]=j.useState(""),[r,a]=j.useState(""),[c,d]=j.useState(""),[f,p]=j.useState(!1);async function m(x){x.preventDefault(),d(""),p(!0);try{const b=await za.login(t,r);e(b.token,{id:b.user.id,email:b.user.email,name:b.user.name,role:b.user.role}),u("/archives",{replace:!0})}catch(b){d(b instanceof Error?b.message:"Connexion impossible")}finally{p(!1)}}return l.jsxs("div",{className:"max-w-md mx-auto py-16 px-6",children:[l.jsx("h1",{className:"text-3xl font-black text-slate-900 dark:text-white mb-2",children:"Connexion"}),l.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-8",children:"Accdez  votre compte Tarikh.ma"}),l.jsxs("form",{onSubmit:m,className:"space-y-6",children:[c&&l.jsx("div",{className:"bg-red-500/10 border border-red-500/30 text-red-600 dark:text-red-400 rounded-lg px-4 py-3 text-sm",children:c}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Email"}),l.jsx("input",{id:"email",type:"email",value:t,onChange:x=>i(x.target.value),required:!0,className:"w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary focus:border-primary outline-none",placeholder:"vous@exemple.ma"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Mot de passe"}),l.jsx("input",{id:"password",type:"password",value:r,onChange:x=>a(x.target.value),required:!0,className:"w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary focus:border-primary outline-none"})]}),l.jsx("button",{type:"submit",disabled:f,className:"w-full bg-accent-gold text-white py-4 rounded-xl font-bold hover:brightness-110 transition-all disabled:opacity-50 shadow-lg shadow-accent-gold/20",children:f?"Connexion":"Se connecter"})]}),l.jsxs("p",{className:"mt-8 text-center text-sm text-slate-500 dark:text-slate-400",children:["Pas encore de compte ?"," ",l.jsx(he,{to:"/register",className:"text-accent-gold font-bold hover:underline",children:"S'inscrire"})]})]})}function u0(){const u=sn(),e=os(w=>w.setAuth),[t,i]=j.useState(""),[r,a]=j.useState(""),[c,d]=j.useState(""),[f,p]=j.useState(""),[m,x]=j.useState(""),[b,y]=j.useState(!1);async function A(w){w.preventDefault(),x(""),y(!0);try{const S=await za.register(f,t,r,c);e(S.token,{id:S.user.id,email:S.user.email,name:S.user.name,role:S.user.role}),u("/archives",{replace:!0})}catch(S){x(S instanceof Error?S.message:"Inscription impossible")}finally{y(!1)}}return l.jsxs("div",{className:"max-w-md mx-auto py-16 px-6",children:[l.jsx("h1",{className:"text-3xl font-black text-slate-900 dark:text-white mb-2",children:"Inscription"}),l.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-8",children:"Crez votre compte Tarikh.ma"}),l.jsxs("form",{onSubmit:A,className:"space-y-6",children:[m&&l.jsx("div",{className:"bg-red-500/10 border border-red-500/30 text-red-600 dark:text-red-400 rounded-lg px-4 py-3 text-sm",children:m}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"name",className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Nom *"}),l.jsx("input",{id:"name",type:"text",value:f,onChange:w=>p(w.target.value),required:!0,className:"w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary focus:border-primary outline-none",placeholder:"Votre nom"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Email"}),l.jsx("input",{id:"email",type:"email",value:t,onChange:w=>i(w.target.value),required:!0,className:"w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary focus:border-primary outline-none",placeholder:"vous@exemple.ma"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Mot de passe"}),l.jsx("input",{id:"password",type:"password",value:r,onChange:w=>a(w.target.value),required:!0,minLength:6,className:"w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary focus:border-primary outline-none"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"password_confirmation",className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Confirmer le mot de passe *"}),l.jsx("input",{id:"password_confirmation",type:"password",value:c,onChange:w=>d(w.target.value),required:!0,minLength:6,className:"w-full bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg px-4 py-3 focus:ring-2 focus:ring-primary focus:border-primary outline-none"})]}),l.jsx("button",{type:"submit",disabled:b,className:"w-full bg-accent-gold text-white py-4 rounded-xl font-bold hover:brightness-110 transition-all disabled:opacity-50 shadow-lg shadow-accent-gold/20",children:b?"Inscription":"S'inscrire"})]}),l.jsxs("p",{className:"mt-8 text-center text-sm text-slate-500 dark:text-slate-400",children:["Dj un compte ?"," ",l.jsx(he,{to:"/login",className:"text-accent-gold font-bold hover:underline",children:"Se connecter"})]})]})}function h0(){const[u,e]=j.useState(null),[t,i]=j.useState([]),[r,a]=j.useState(!0),[c,d]=j.useState(""),[f,p]=j.useState(1),[m,x]=j.useState([]),[b,y]=j.useState(""),[A,w]=j.useState([1500,2024]),[S,N]=j.useState("latest");j.useEffect(()=>{Yf.list().then(i).catch(()=>[])},[]),j.useEffect(()=>{a(!0),Ba.list({page:f,per_page:9,q:c||void 0,type:m.length>0?m:void 0,theme_id:b||void 0,year_min:A[0],year_max:A[1],sort_by:S}).then(E=>e(E)).catch(()=>e({data:[],current_page:1,last_page:1,total:0,per_page:9})).finally(()=>a(!1))},[f,c,m,b,A,S]);const C=E=>{x(L=>L.includes(E)?L.filter(T=>T!==E):[...L,E]),p(1)},R=()=>{d(""),x([]),y(""),w([1500,2024]),N("latest"),p(1)};return l.jsxs("div",{className:"min-h-screen bg-white text-slate-900 relative overflow-hidden paper-texture",children:[l.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-accent-gold/5 rounded-full blur-[120px] -translate-y-1/2 translate-x-1/2 pointer-events-none"}),l.jsx("div",{className:"absolute bottom-0 left-0 w-[400px] h-[400px] bg-primary/5 rounded-full blur-[100px] translate-y-1/2 -translate-x-1/2 pointer-events-none"}),l.jsxs("div",{className:"max-w-[1600px] mx-auto px-6 pt-28 pb-12 relative z-10",children:[l.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-between gap-8 mb-20",children:[l.jsxs("div",{className:"flex-1 w-full max-w-3xl relative group",children:[l.jsx("div",{className:"absolute inset-0 bg-accent-gold/5 blur-xl rounded-full opacity-0 group-focus-within:opacity-100 transition-opacity"}),l.jsx("span",{className:"absolute left-6 top-1/2 -translate-y-1/2 material-symbols-outlined text-accent-gold text-2xl group-focus-within:text-accent-gold transition-colors z-10",children:"search"}),l.jsx("input",{type:"text",placeholder:"Rechercher un manuscrit, une ville, une date...",value:c,onChange:E=>d(E.target.value),className:"w-full bg-white border-2 border-accent-gold/10 rounded-3xl pl-16 pr-8 py-6 text-slate-800 focus:outline-none focus:ring-4 focus:ring-accent-gold/5 focus:border-accent-gold/40 placeholder:text-slate-300 transition-all font-serif italic text-xl shadow-xl shadow-accent-gold/5 relative z-10"})]}),l.jsx("div",{className:"flex items-center gap-4 shrink-0",children:l.jsxs("button",{className:"px-10 py-5 rounded-3xl bg-accent-gold text-white font-bold text-sm hover:bg-accent-gold/90 hover:scale-105 transition-all shadow-2xl shadow-accent-gold/20 flex items-center gap-2",children:[l.jsx("span",{className:"material-symbols-outlined text-lg",children:"add_circle"}),"Contribuer"]})})]}),l.jsxs("div",{className:"flex flex-col lg:flex-row gap-16",children:[l.jsxs("aside",{className:"lg:w-80 flex-shrink-0 space-y-12",children:[l.jsxs("div",{className:"flex items-center justify-between px-2",children:[l.jsxs("h2",{className:"text-slate-900 text-2xl font-black italic serif tracking-tight",children:["Filtres ",l.jsx("span",{className:"text-accent-gold",children:"Avancs"})]}),l.jsx("button",{onClick:R,className:"text-[10px] uppercase tracking-widest font-black text-slate-400 hover:text-accent-gold transition-colors",children:"Rinitialiser"})]}),l.jsxs("div",{className:"space-y-6 bg-parchment/20 p-6 rounded-3xl border border-accent-gold/10",children:[l.jsx("label",{className:"block text-[10px] font-black text-slate-500 uppercase tracking-[0.2em] mb-4",children:"Priode Historique"}),l.jsxs("div",{className:"px-2",children:[l.jsx("input",{type:"range",min:"1500",max:"2024",value:A[1],onChange:E=>w([A[0],parseInt(E.target.value)]),className:"w-full h-1.5 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-accent-gold"}),l.jsxs("div",{className:"flex justify-between mt-6 text-[11px] font-bold font-mono",children:[l.jsx("span",{className:"text-slate-400",children:"1500"}),l.jsx("div",{className:"bg-white px-3 py-1 rounded-full border border-accent-gold/20 shadow-sm",children:l.jsxs("span",{className:"text-accent-gold",children:["Jusqu' ",A[1]]})}),l.jsx("span",{className:"text-slate-400",children:"2024"})]})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsx("label",{className:"block text-[10px] font-black text-slate-500 uppercase tracking-[0.2em]",children:"Nature des Archives"}),l.jsx("div",{className:"space-y-4",children:[{id:"livre",label:"Livres",icon:"auto_stories"},{id:"pdf",label:"Manuscrits",icon:"menu_book"},{id:"video",label:"Vidos",icon:"videocam"},{id:"carte",label:"Cartes",icon:"map"},{id:"image",label:"Photos",icon:"photo_library"},{id:"article",label:"Articles",icon:"article"}].map(E=>l.jsxs("label",{className:"flex items-center gap-4 cursor-pointer group",children:[l.jsx("div",{onClick:()=>C(E.id),className:`w-6 h-6 rounded-lg border flex items-center justify-center transition-all ${m.includes(E.id)?"bg-accent-gold border-accent-gold shadow-md shadow-accent-gold/20":"border-slate-200 bg-white group-hover:border-accent-gold/50"}`,children:m.includes(E.id)&&l.jsx("span",{className:"material-symbols-outlined text-white text-[16px] font-bold",children:"check"})}),l.jsx("span",{className:`text-sm transition-colors ${m.includes(E.id)?"text-slate-900 font-bold":"text-slate-500 group-hover:text-slate-700"}`,children:E.label})]},E.id))})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsx("label",{className:"block text-[10px] font-black text-slate-500 uppercase tracking-[0.2em]",children:"Thmatiques Populaires"}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("button",{onClick:()=>y(""),className:`px-5 py-2.5 rounded-full text-[11px] font-bold border transition-all ${b===""?"bg-accent-gold border-accent-gold text-white shadow-lg shadow-accent-gold/20":"bg-white border-slate-100 text-slate-500 hover:border-accent-gold/30 hover:text-accent-gold"}`,children:"Toutes"}),t.map(E=>l.jsx("button",{onClick:()=>y(E.id),className:`px-5 py-2.5 rounded-full text-[11px] font-bold border transition-all ${b===E.id?"bg-accent-gold border-accent-gold text-white shadow-lg shadow-accent-gold/20":"bg-white border-slate-100 text-slate-500 hover:border-accent-gold/30 hover:text-accent-gold"}`,children:E.name},E.id))]})]})]}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-12 pb-8 border-b border-slate-100",children:[l.jsxs("div",{children:[l.jsxs("h2",{className:"text-3xl font-black text-slate-900 italic serif tracking-tight",children:["Rsultats ",c&&l.jsxs("span",{children:["pour ",l.jsxs("span",{className:"text-accent-gold",children:['"',c,'"']})]})]}),l.jsxs("p",{className:"text-slate-400 text-sm mt-2 font-medium",children:[l.jsx("span",{className:"text-accent-gold font-bold",children:u?.total||0})," documents prcieux extraits de l'inventaire national."]})]}),l.jsxs("div",{className:"flex items-center gap-4 bg-slate-50 p-2 rounded-2xl border border-slate-100",children:[l.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest pl-4",children:"Trier par :"}),l.jsxs("select",{value:S,onChange:E=>N(E.target.value),className:"bg-white border border-slate-200 rounded-xl px-4 py-2 text-xs font-bold text-slate-700 outline-none focus:ring-2 focus:ring-accent-gold/30 cursor-pointer shadow-sm",children:[l.jsx("option",{value:"latest",children:"Dernires Acquisitions"}),l.jsx("option",{value:"oldest",children:"Trsors les plus anciens"}),l.jsx("option",{value:"views",children:"Les plus consults"}),l.jsx("option",{value:"title",children:"Ordre Alphabtique"}),l.jsx("option",{value:"year_asc",children:"Chronologie (Croissante)"}),l.jsx("option",{value:"year_desc",children:"Chronologie (Dcroissante)"})]})]})]}),r?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10",children:[1,2,3,4,5,6].map(E=>l.jsx("div",{className:"bg-slate-50 rounded-[2.5rem] h-[480px] animate-pulse border border-slate-100"},E))}):u&&u.data.length>0?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10",children:u.data.map(E=>l.jsxs(he,{to:`/documents/${E.id}`,className:"group bg-white rounded-[2.5rem] border border-slate-100 overflow-hidden shadow-[0_10px_30px_rgba(0,0,0,0.03)] hover:shadow-[0_30px_60px_rgba(126,96,80,0.12)] hover:border-accent-gold/20 hover:-translate-y-3 transition-all duration-700 flex flex-col h-full relative",children:[l.jsxs("div",{className:"h-64 relative overflow-hidden m-4 rounded-[2rem]",children:[E.thumbnail_url?l.jsx("img",{src:E.thumbnail_url,alt:"",className:"w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110"}):l.jsx("div",{className:"w-full h-full bg-parchment/30 flex items-center justify-center grayscale opacity-60",children:l.jsx("span",{className:"material-symbols-outlined text-7xl text-accent-gold/20",children:"auto_stories"})}),l.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"}),l.jsx("div",{className:"absolute top-6 left-6",children:l.jsx("div",{className:"w-12 h-12 rounded-2xl bg-white border border-accent-gold/10 flex items-center justify-center text-accent-gold shadow-lg group-hover:bg-accent-gold group-hover:text-white transition-all",children:l.jsx("span",{className:"material-symbols-outlined text-2xl",children:E.type==="pdf"?"menu_book":E.type==="image"?"image":E.type==="carte"?"map":"description"})})})]}),l.jsxs("div",{className:"p-8 pt-4 flex flex-col flex-1",children:[l.jsxs("div",{className:"flex items-center justify-between mb-5",children:[l.jsx("span",{className:"px-3 py-1 bg-accent-gold/5 text-[9px] font-black text-accent-gold rounded-full uppercase tracking-widest",children:E.region?.name||"Royaume"}),l.jsxs("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:[E.year||""," AP. J.-C."]})]}),l.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4 group-hover:text-accent-gold transition-colors line-clamp-2 serif leading-snug",children:E.title}),l.jsx("p",{className:"text-slate-500 text-sm leading-relaxed line-clamp-3 mb-8 font-medium italic serif",children:E.description||"Une pice historique d'une importance capitale pour la comprhension de l'volution structurelle et culturelle du Royaume."}),l.jsxs("div",{className:"mt-auto pt-6 border-t border-slate-50 flex items-center justify-between",children:[l.jsxs("span",{className:"text-[9px] font-black text-slate-300 uppercase tracking-widest font-mono",children:["ID: TK-",E.id.toString().padStart(5,"0")]}),l.jsxs("div",{className:"flex items-center gap-2 text-accent-gold text-xs font-black uppercase tracking-tighter opacity-0 group-hover:opacity-100 group-hover:translate-x-0 -translate-x-4 transition-all duration-500",children:["Explorer ",l.jsx("span",{className:"material-symbols-outlined text-sm",children:"arrow_forward"})]})]})]})]},E.id))}),u.last_page>1&&l.jsxs("div",{className:"mt-24 flex justify-center items-center gap-3",children:[l.jsx("button",{onClick:()=>p(E=>Math.max(1,E-1)),disabled:f<=1,className:"w-14 h-14 rounded-2xl flex items-center justify-center border border-slate-100 bg-white text-slate-400 hover:border-accent-gold hover:text-accent-gold hover:shadow-xl hover:shadow-accent-gold/10 transition-all disabled:opacity-20",children:l.jsx("span",{className:"material-symbols-outlined text-2xl",children:"chevron_left"})}),Array.from({length:Math.min(5,u.last_page)},(E,L)=>{const T=L+1;return l.jsx("button",{onClick:()=>p(T),className:`w-14 h-14 rounded-2xl font-black text-sm transition-all shadow-sm ${f===T?"bg-accent-gold text-white shadow-xl shadow-accent-gold/30 scale-110":"bg-white border border-slate-100 text-slate-500 hover:border-accent-gold hover:text-accent-gold"}`,children:T},T)}),u.last_page>5&&l.jsx("span",{className:"text-slate-300 px-2 font-black",children:"..."}),l.jsx("button",{onClick:()=>p(E=>Math.min(u.last_page,E+1)),disabled:f>=u.last_page,className:"w-14 h-14 rounded-2xl flex items-center justify-center border border-slate-100 bg-white text-slate-400 hover:border-accent-gold hover:text-accent-gold hover:shadow-xl hover:shadow-accent-gold/10 transition-all disabled:opacity-20",children:l.jsx("span",{className:"material-symbols-outlined text-2xl",children:"chevron_right"})})]})]}):l.jsxs("div",{className:"flex flex-col items-center justify-center py-48 bg-parchment/10 rounded-[4rem] border-4 border-dashed border-slate-100",children:[l.jsx("div",{className:"w-24 h-24 rounded-[2rem] bg-white shadow-2xl flex items-center justify-center text-accent-gold/30 mb-8 border border-accent-gold/5",children:l.jsx("span",{className:"material-symbols-outlined text-5xl",children:"history_edu"})}),l.jsx("h3",{className:"text-2xl font-black text-slate-800 mb-3 serif italic",children:"Le silence des manuscrits..."}),l.jsx("p",{className:"text-slate-400 text-base font-medium max-w-md text-center leading-relaxed",children:"Nous n'avons trouv aucune pice correspondant  vos critres dans nos registres actuels."}),l.jsx("button",{onClick:R,className:"mt-10 px-8 py-3 bg-white border border-accent-gold/20 text-accent-gold rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] hover:bg-accent-gold hover:text-white transition-all shadow-lg shadow-accent-gold/5",children:"Effacer tous les filtres"})]})]})]})]}),l.jsxs("footer",{className:"max-w-[1600px] mx-auto px-6 py-16 border-t border-slate-50 mt-24 flex flex-col md:flex-row items-center justify-between gap-8",children:[l.jsx("div",{className:"flex items-center gap-8 text-[10px] font-black text-slate-400 uppercase tracking-[0.3em]",children:l.jsx("span",{children:" 2026 Tarikh.ma - Tous droits rserv. Developped by ArtgonMEDIA"})}),l.jsxs("div",{className:"flex gap-10 text-[10px] font-black text-slate-500 uppercase tracking-widest",children:[l.jsx("a",{href:"#",className:"hover:text-primary transition-colors",children:"Portail Officiel"}),l.jsx("a",{href:"#",className:"hover:text-primary transition-colors",children:"Documentation"}),l.jsx("a",{href:"#",className:"hover:text-primary transition-colors",children:"Archives Numriques"})]})]})]})}const f0=2,p0=1,m0="data:audio/mp3;base64,//uQxAAAAAANIAAAAAExBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7kMQAD8AAADSAAAAANIAAADSAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==";let Ta=null;function g0(){return Ta||(Ta=new Audio(m0),Ta.volume=.25),Ta}function Ys(){try{const u=g0();u.currentTime=0,u.play().catch(()=>{})}catch{}}function x0(u,e){const t=[];for(let i=u;i<=e;i++)t.push(i);return t}function v0({documentId:u,totalPages:e,currentPage:t,onRequestPrev:i,onRequestNext:r,zoom:a=100,title:c,className:d="",flipPhase:f,flipDirection:p,onFlipAnimationEnd:m,isFlipping:x}){const[b,y]=j.useState({}),[A,w]=j.useState(!0),[S,N]=j.useState(!1),C=j.useRef(new Set),R=j.useCallback(async L=>{const T=L.filter(I=>I>=1&&I<=e&&!C.current.has(I));if(T.length!==0){T.forEach(I=>C.current.add(I));try{const I=await Qx(u,T);y($=>({...$,...I}))}catch{N(!0)}finally{w(!1)}}},[u,e]);j.useEffect(()=>{const L=Math.max(1,t-p0),T=Math.min(e,t+f0);R(x0(L,T))},[u,t,e,R]);const E=b[t];return j.useEffect(()=>{const L=T=>{T.key==="ArrowLeft"?(T.preventDefault(),Ys(),i()):T.key==="ArrowRight"&&(T.preventDefault(),Ys(),r())};return window.addEventListener("keydown",L),()=>window.removeEventListener("keydown",L)},[i,r]),S?l.jsx("div",{className:`flex items-center justify-center bg-slate-100 rounded ${d}`,style:{minHeight:280},children:l.jsx("span",{className:"text-slate-600 text-sm",children:"Impossible de charger les pages."})}):l.jsxs("div",{className:`cahier-viewer cahier-viewer-brochure relative w-full flex-1 flex items-center justify-center min-h-0 overflow-hidden ${x?"is-flipping":""} ${d}`,children:[l.jsx("button",{type:"button",onClick:()=>{Ys(),i()},disabled:t<=1||x,className:"absolute left-2 sm:left-4 top-1/2 -translate-y-1/2 z-10 w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center rounded-full bg-white/90 shadow-md border border-slate-200/80 text-slate-600 hover:bg-white hover:text-slate-900 disabled:opacity-40 disabled:pointer-events-none transition-all hover:scale-105","aria-label":"Page prcdente",children:l.jsx("span",{className:"material-symbols-outlined text-2xl sm:text-3xl font-light",children:"chevron_left"})}),l.jsx("button",{type:"button",onClick:()=>{Ys(),r()},disabled:t>=e||x,className:"absolute right-2 sm:right-4 top-1/2 -translate-y-1/2 z-10 w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center rounded-full bg-white/90 shadow-md border border-slate-200/80 text-slate-600 hover:bg-white hover:text-slate-900 disabled:opacity-40 disabled:pointer-events-none transition-all hover:scale-105","aria-label":"Page suivante",children:l.jsx("span",{className:"material-symbols-outlined text-2xl sm:text-3xl font-light",children:"chevron_right"})}),l.jsx("div",{role:"button",tabIndex:0,onClick:()=>{Ys(),i()},onKeyDown:L=>{L.key==="Enter"&&(Ys(),i())},className:"cahier-zone-prev","aria-label":"Page prcdente (zone)","aria-disabled":x}),l.jsx("div",{role:"button",tabIndex:0,onClick:()=>{Ys(),r()},onKeyDown:L=>{L.key==="Enter"&&(Ys(),r())},className:"cahier-zone-next","aria-label":"Page suivante (zone)","aria-disabled":x}),l.jsx("div",{className:`cahier-page relative w-full h-full flex items-center justify-center min-h-[50vh] sm:min-h-[60vh] max-h-[75vh] sm:max-h-[80vh] ${f&&p?`turn-${p}-${f}`:""}`,onAnimationEnd:m,children:l.jsxs("div",{className:"cahier-page-inner absolute inset-0 flex items-center justify-center rounded overflow-hidden bg-white shadow-[0_2px_16px_rgba(0,0,0,0.08),inset_0_0_0_1px_rgba(0,0,0,0.06)]",children:[A&&!E&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-50 rounded",children:l.jsx("span",{className:"text-slate-500 text-sm",children:"Chargement de la page"})}),E&&l.jsx("img",{src:E,alt:c?`Page ${t}  ${c}`:`Page ${t}`,className:"max-w-full max-h-full w-auto h-auto object-contain select-none",style:{transform:`scale(${a/100})`},draggable:!1,onContextMenu:L=>L.preventDefault()})]})}),[t+1,t+2].map(L=>L>e||!b[L]?null:l.jsx("link",{rel:"preload",as:"image",href:b[L]},L))]})}var lr={};lr.d=(u,e)=>{for(var t in e)lr.o(e,t)&&!lr.o(u,t)&&Object.defineProperty(u,t,{enumerable:!0,get:e[t]})};lr.o=(u,e)=>Object.prototype.hasOwnProperty.call(u,e);var Se=globalThis.pdfjsLib={};lr.d(Se,{AbortException:()=>en,AnnotationEditorLayer:()=>ks,AnnotationEditorParamsType:()=>Te,AnnotationEditorType:()=>Ne,AnnotationEditorUIManager:()=>tn,AnnotationLayer:()=>fb,AnnotationMode:()=>Ks,ColorPicker:()=>Kt,DOMSVGFactory:()=>Wc,DrawLayer:()=>St,FeatureTest:()=>Et,GlobalWorkerOptions:()=>dr,ImageKind:()=>Va,InvalidPDFException:()=>wc,MissingPDFException:()=>fr,OPS:()=>as,OutputScale:()=>Ac,PDFDataRangeTransport:()=>pp,PDFDateString:()=>Jf,PDFWorker:()=>ti,PasswordResponses:()=>A0,PermissionFlag:()=>w0,PixelsPerInch:()=>ri,RenderingCancelledException:()=>Dc,TextLayer:()=>Nt,TouchManager:()=>eo,UnexpectedResponseException:()=>Ua,Util:()=>me,VerbosityLevel:()=>Xa,XfaLayer:()=>gp,build:()=>qv,createValidAbsoluteUrl:()=>E0,fetchData:()=>Ja,getDocument:()=>Fv,getFilenameFromUrl:()=>V0,getPdfFilenameFromUrl:()=>I0,getXfaPageViewport:()=>D0,isDataScheme:()=>Za,isPdfFile:()=>Fc,noContextMenu:()=>ls,normalizeUnicode:()=>R0,setLayerDimensions:()=>_n,shadow:()=>Ce,stopEvent:()=>Bt,version:()=>Wv});const bt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Kf=[1,0,0,1,0,0],yc=[.001,0,0,.001,0,0],b0=1e7,ac=1.35,zt={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ks={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},y0="pdfjs_internal_editor_",Ne={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Te={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},w0={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},xt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Va={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},it={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},tr={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Xa={ERRORS:0,WARNINGS:1,INFOS:5},as={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},A0={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Ya=Xa.WARNINGS;function _0(u){Number.isInteger(u)&&(Ya=u)}function S0(){return Ya}function Ka(u){Ya>=Xa.INFOS&&console.log(`Info: ${u}`)}function Ee(u){Ya>=Xa.WARNINGS&&console.log(`Warning: ${u}`)}function De(u){throw new Error(u)}function tt(u,e){u||De(e)}function N0(u){switch(u?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function E0(u,e=null,t=null){if(!u)return null;try{if(t&&typeof u=="string"&&(t.addDefaultProtocol&&u.startsWith("www.")&&u.match(/\./g)?.length>=2&&(u=`http://${u}`),t.tryConvertEncoding))try{u=P0(u)}catch{}const i=e?new URL(u,e):new URL(u);if(N0(i))return i}catch{}return null}function Ce(u,e,t,i=!1){return Object.defineProperty(u,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const nn=(function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e})();class df extends nn{constructor(e,t){super(e,"PasswordException"),this.code=t}}class oc extends nn{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class wc extends nn{constructor(e){super(e,"InvalidPDFException")}}class fr extends nn{constructor(e){super(e,"MissingPDFException")}}class Ua extends nn{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class k0 extends nn{constructor(e){super(e,"FormatError")}}class en extends nn{constructor(e){super(e,"AbortException")}}function Qf(u){(typeof u!="object"||u?.length===void 0)&&De("Invalid argument for bytesToString");const e=u.length,t=8192;if(e<t)return String.fromCharCode.apply(null,u);const i=[];for(let r=0;r<e;r+=t){const a=Math.min(r+t,e),c=u.subarray(r,a);i.push(String.fromCharCode.apply(null,c))}return i.join("")}function Qa(u){typeof u!="string"&&De("Invalid argument for stringToBytes");const e=u.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=u.charCodeAt(i)&255;return t}function j0(u){return String.fromCharCode(u>>24&255,u>>16&255,u>>8&255,u&255)}function Vc(u){const e=Object.create(null);for(const[t,i]of u)e[t]=i;return e}function C0(){const u=new Uint8Array(4);return u[0]=1,new Uint32Array(u.buffer,0,1)[0]===1}function T0(){try{return new Function(""),!0}catch{return!1}}class Et{static get isLittleEndian(){return Ce(this,"isLittleEndian",C0())}static get isEvalSupported(){return Ce(this,"isEvalSupported",T0())}static get isOffscreenCanvasSupported(){return Ce(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ce(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?Ce(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):Ce(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return Ce(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const lc=Array.from(Array(256).keys(),u=>u.toString(16).padStart(2,"0"));class me{static makeHexColor(e,t,i){return`#${lc[e]}${lc[t]}${lc[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const i=e[0]*t[0]+e[1]*t[2]+t[4],r=e[0]*t[1]+e[1]*t[3]+t[5];return[i,r]}static applyInverseTransform(e,t){const i=t[0]*t[3]-t[1]*t[2],r=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/i,a=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/i;return[r,a]}static getAxialAlignedBoundingBox(e,t){const i=this.applyTransform(e,t),r=this.applyTransform(e.slice(2,4),t),a=this.applyTransform([e[0],e[3]],t),c=this.applyTransform([e[2],e[1]],t);return[Math.min(i[0],r[0],a[0],c[0]),Math.min(i[1],r[1],a[1],c[1]),Math.max(i[0],r[0],a[0],c[0]),Math.max(i[1],r[1],a[1],c[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],i=e[0]*t[0]+e[1]*t[2],r=e[0]*t[1]+e[1]*t[3],a=e[2]*t[0]+e[3]*t[2],c=e[2]*t[1]+e[3]*t[3],d=(i+c)/2,f=Math.sqrt((i+c)**2-4*(i*c-a*r))/2,p=d+f||1,m=d-f||1;return[Math.sqrt(p),Math.sqrt(m)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>r)return null;const a=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),c=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return a>c?null:[i,a,r,c]}static#e(e,t,i,r,a,c,d,f,p,m){if(p<=0||p>=1)return;const x=1-p,b=p*p,y=b*p,A=x*(x*(x*e+3*p*t)+3*b*i)+y*r,w=x*(x*(x*a+3*p*c)+3*b*d)+y*f;m[0]=Math.min(m[0],A),m[1]=Math.min(m[1],w),m[2]=Math.max(m[2],A),m[3]=Math.max(m[3],w)}static#t(e,t,i,r,a,c,d,f,p,m,x,b){if(Math.abs(p)<1e-12){Math.abs(m)>=1e-12&&this.#e(e,t,i,r,a,c,d,f,-x/m,b);return}const y=m**2-4*x*p;if(y<0)return;const A=Math.sqrt(y),w=2*p;this.#e(e,t,i,r,a,c,d,f,(-m+A)/w,b),this.#e(e,t,i,r,a,c,d,f,(-m-A)/w,b)}static bezierBoundingBox(e,t,i,r,a,c,d,f,p){return p?(p[0]=Math.min(p[0],e,d),p[1]=Math.min(p[1],t,f),p[2]=Math.max(p[2],e,d),p[3]=Math.max(p[3],t,f)):p=[Math.min(e,d),Math.min(t,f),Math.max(e,d),Math.max(t,f)],this.#t(e,i,a,d,t,r,c,f,3*(-e+3*(i-a)+d),6*(e-2*i+a),3*(i-e),p),this.#t(e,i,a,d,t,r,c,f,3*(-t+3*(r-c)+f),6*(t-2*r+c),3*(r-t),p),p}}function P0(u){return decodeURIComponent(escape(u))}let cc=null,uf=null;function R0(u){return cc||(cc=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,uf=new Map([["","t"]])),u.replaceAll(cc,(e,t,i)=>t?t.normalize("NFKC"):uf.get(i))}function L0(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const u=new Uint8Array(32);return crypto.getRandomValues(u),Qf(u)}const Ic="pdfjs_internal_id_";function M0(u){return Uint8Array.prototype.toBase64?u.toBase64():btoa(Qf(u))}typeof Promise.try!="function"&&(Promise.try=function(u,...e){return new Promise(t=>{t(u(...e))})});const Es="http://www.w3.org/2000/svg";class ri{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Ja(u,e="text"){if(ar(u,document.baseURI)){const t=await fetch(u);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const r=new XMLHttpRequest;r.open("GET",u,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}i(new Error(r.statusText))}},r.send(null)})}class gr{constructor({viewBox:e,userUnit:t,scale:i,rotation:r,offsetX:a=0,offsetY:c=0,dontFlip:d=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=r,this.offsetX=a,this.offsetY=c,i*=t;const f=(e[2]+e[0])/2,p=(e[3]+e[1])/2;let m,x,b,y;switch(r%=360,r<0&&(r+=360),r){case 180:m=-1,x=0,b=0,y=1;break;case 90:m=0,x=1,b=1,y=0;break;case 270:m=0,x=-1,b=-1,y=0;break;case 0:m=1,x=0,b=0,y=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}d&&(b=-b,y=-y);let A,w,S,N;m===0?(A=Math.abs(p-e[1])*i+a,w=Math.abs(f-e[0])*i+c,S=(e[3]-e[1])*i,N=(e[2]-e[0])*i):(A=Math.abs(f-e[0])*i+a,w=Math.abs(p-e[1])*i+c,S=(e[2]-e[0])*i,N=(e[3]-e[1])*i),this.transform=[m*i,x*i,b*i,y*i,A-m*i*f-b*i*p,w-x*i*f-y*i*p],this.width=S,this.height=N}get rawDims(){const{userUnit:e,viewBox:t}=this,i=t.map(r=>r*e);return Ce(this,"rawDims",{pageWidth:i[2]-i[0],pageHeight:i[3]-i[1],pageX:i[0],pageY:i[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:r=this.offsetY,dontFlip:a=!1}={}){return new gr({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:r,dontFlip:a})}convertToViewportPoint(e,t){return me.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=me.applyTransform([e[0],e[1]],this.transform),i=me.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){return me.applyInverseTransform([e,t],this.transform)}}class Dc extends nn{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Za(u){const e=u.length;let t=0;for(;t<e&&u[t].trim()==="";)t++;return u.substring(t,t+5).toLowerCase()==="data:"}function Fc(u){return typeof u=="string"&&/\.pdf$/i.test(u)}function V0(u){return[u]=u.split(/[#?]/,1),u.substring(u.lastIndexOf("/")+1)}function I0(u,e="document.pdf"){if(typeof u!="string")return e;if(Za(u))return Ee('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=t.exec(u);let a=i.exec(r[1])||i.exec(r[2])||i.exec(r[3]);if(a&&(a=a[0],a.includes("%")))try{a=i.exec(decodeURIComponent(a))[0]}catch{}return a||e}class hf{started=Object.create(null);times=[];time(e){e in this.started&&Ee(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ee(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:r,end:a}of this.times)e.push(`${i.padEnd(t)} ${a-r}ms
`);return e.join("")}}function ar(u,e){try{const{protocol:t}=e?new URL(u,e):new URL(u);return t==="http:"||t==="https:"}catch{return!1}}function ls(u){u.preventDefault()}function Bt(u){u.preventDefault(),u.stopPropagation()}class Jf{static#e;static toDateObject(e){if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const i=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let a=parseInt(t[3],10);a=a>=1&&a<=31?a:1;let c=parseInt(t[4],10);c=c>=0&&c<=23?c:0;let d=parseInt(t[5],10);d=d>=0&&d<=59?d:0;let f=parseInt(t[6],10);f=f>=0&&f<=59?f:0;const p=t[7]||"Z";let m=parseInt(t[8],10);m=m>=0&&m<=23?m:0;let x=parseInt(t[9],10)||0;return x=x>=0&&x<=59?x:0,p==="-"?(c+=m,d+=x):p==="+"&&(c-=m,d-=x),new Date(Date.UTC(i,r,a,c,d,f))}}function D0(u,{scale:e=1,rotation:t=0}){const{width:i,height:r}=u.attributes.style,a=[0,0,parseInt(i),parseInt(r)];return new gr({viewBox:a,userUnit:1,scale:e,rotation:t})}function Oc(u){if(u.startsWith("#")){const e=parseInt(u.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return u.startsWith("rgb(")?u.slice(4,-1).split(",").map(e=>parseInt(e)):u.startsWith("rgba(")?u.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ee(`Not a valid color format: "${u}"`),[0,0,0])}function F0(u){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of u.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;u.set(t,Oc(i))}e.remove()}function He(u){const{a:e,b:t,c:i,d:r,e:a,f:c}=u.getTransform();return[e,t,i,r,a,c]}function ps(u){const{a:e,b:t,c:i,d:r,e:a,f:c}=u.getTransform().invertSelf();return[e,t,i,r,a,c]}function _n(u,e,t=!1,i=!0){if(e instanceof gr){const{pageWidth:r,pageHeight:a}=e.rawDims,{style:c}=u,d=Et.isCSSRoundSupported,f=`var(--scale-factor) * ${r}px`,p=`var(--scale-factor) * ${a}px`,m=d?`round(down, ${f}, var(--scale-round-x, 1px))`:`calc(${f})`,x=d?`round(down, ${p}, var(--scale-round-y, 1px))`:`calc(${p})`;!t||e.rotation%180===0?(c.width=m,c.height=x):(c.width=x,c.height=m)}i&&u.setAttribute("data-main-rotation",e.rotation)}class Ac{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}class cr{#e=null;#t=null;#s;#n=null;#r=null;static#i=null;constructor(e){this.#s=e,cr.#i||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#s._uiManager._signal;e.addEventListener("contextmenu",ls,{signal:t}),e.addEventListener("pointerdown",cr.#l,{signal:t});const i=this.#n=document.createElement("div");i.className="buttons",e.append(i);const r=this.#s.toolbarPosition;if(r){const{style:a}=e,c=this.#s._uiManager.direction==="ltr"?1-r[0]:r[0];a.insetInlineEnd=`${100*c}%`,a.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return this.#h(),e}get div(){return this.#e}static#l(e){e.stopPropagation()}#o(e){this.#s._focusEventsAllowed=!1,Bt(e)}#d(e){this.#s._focusEventsAllowed=!0,Bt(e)}#c(e){const t=this.#s._uiManager._signal;e.addEventListener("focusin",this.#o.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#d.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",ls,{signal:t})}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#r?.shown()}#h(){const{editorType:e,_uiManager:t}=this.#s,i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",cr.#i[e]),this.#c(i),i.addEventListener("click",r=>{t.delete()},{signal:t._signal}),this.#n.append(i)}get#u(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#c(t),this.#n.prepend(t,this.#u),this.#r=e}addColorPicker(e){this.#t=e;const t=e.renderButton();this.#c(t),this.#n.prepend(t,this.#u)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class O0{#e=null;#t=null;#s;constructor(e){this.#s=e}#n(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",ls,{signal:this.#s._signal});const t=this.#e=document.createElement("div");return t.className="buttons",e.append(t),this.#i(),e}#r(e,t){let i=0,r=0;for(const a of e){const c=a.y+a.height;if(c<i)continue;const d=a.x+(t?a.width:0);if(c>i){r=d,i=c;continue}t?d>r&&(r=d):d<r&&(r=d)}return[t?1-r:r,i]}show(e,t,i){const[r,a]=this.#r(t,i),{style:c}=this.#t||=this.#n();e.append(this.#t),c.insetInlineEnd=`${100*r}%`,c.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#i(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=this.#s._signal;e.addEventListener("contextmenu",ls,{signal:i}),e.addEventListener("click",()=>{this.#s.highlightSelection("floating_button")},{signal:i}),this.#e.append(e)}}function Ha(u,e,t){for(const i of t)e.addEventListener(i,u[i].bind(u))}class z0{#e=0;get id(){return`${y0}${this.#e++}`}}class zc{#e=L0();#t=0;#s=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;const a=r.decode().then(()=>(i.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return Ce(this,"_isSVGFittingCanvas",a)}async#n(e,t){this.#s||=new Map;let i=this.#s.get(e);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let r;if(typeof t=="string"?(i.url=t,r=await Ja(t,"blob")):t instanceof File?r=i.file=t:t instanceof Blob&&(r=t),r.type==="image/svg+xml"){const a=zc._isSVGFittingCanvas,c=new FileReader,d=new Image,f=new Promise((p,m)=>{d.onload=()=>{i.bitmap=d,i.isSvg=!0,p()},c.onload=async()=>{const x=i.svgUrl=c.result;d.src=await a?`${x}#svgView(preserveAspectRatio(none))`:x},d.onerror=c.onerror=m});c.readAsDataURL(r),await f}else i.bitmap=await createImageBitmap(r);i.refCounter=1}catch(r){Ee(r),i=null}return this.#s.set(e,i),i&&this.#s.set(i.id,i),i}async getFromFile(e){const{lastModified:t,name:i,size:r,type:a}=e;return this.#n(`${t}_${i}_${r}_${a}`,e)}async getFromUrl(e){return this.#n(e,e)}async getFromBlob(e,t){const i=await t;return this.#n(e,i)}async getFromId(e){this.#s||=new Map;const t=this.#s.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#s||=new Map;let i=this.#s.get(e);if(i?.bitmap)return i.refCounter+=1,i;const r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),i={bitmap:r.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#s.set(e,i),this.#s.set(i.id,i),i}getSvgUrl(e){const t=this.#s.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#s||=new Map;const t=this.#s.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=r.convertToBlob()}i.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class B0{#e=[];#t=!1;#s;#n=-1;constructor(e=128){this.#s=e}add({cmd:e,undo:t,post:i,mustExec:r,type:a=NaN,overwriteIfSameType:c=!1,keepUndo:d=!1}){if(r&&e(),this.#t)return;const f={cmd:e,undo:t,post:i,type:a};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(f);return}if(c&&this.#e[this.#n].type===a){d&&(f.undo=this.#e[this.#n].undo),this.#e[this.#n]=f;return}const p=this.#n+1;p===this.#s?this.#e.splice(0,1):(this.#n=p,p<this.#e.length&&this.#e.splice(p)),this.#e.push(f)}undo(){if(this.#n===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1,this.#n-=1}redo(){if(this.#n<this.#e.length-1){this.#n+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}cleanType(e){if(this.#n!==-1){for(let t=this.#n;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#n-t),this.#n=t;return}this.#e.length=0,this.#n=-1}}destroy(){this.#e=null}}class xr{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Et.platform;for(const[i,r,a={}]of e)for(const c of i){const d=c.startsWith("mac+");t&&d?(this.callbacks.set(c.slice(4),{callback:r,options:a}),this.allKeys.add(c.split("+").at(-1))):!t&&!d&&(this.callbacks.set(c,{callback:r,options:a}),this.allKeys.add(c.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(this.#e(t));if(!i)return;const{callback:r,options:{bubbles:a=!1,args:c=[],checker:d=null}}=i;d&&!d(e,t)||(r.bind(e,...c,t)(),a||Bt(t))}}class Bc{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return F0(e),Ce(this,"_colors",e)}convert(e){const t=Oc(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,r]of this._colors)if(r.every((a,c)=>a===t[c]))return Bc._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?me.makeHexColor(...t):e}}class tn{#e=new AbortController;#t=null;#s=new Map;#n=new Map;#r=null;#i=null;#l=null;#o=new B0;#d=null;#c=null;#h=0;#u=new Set;#f=null;#a=null;#p=new Set;_editorUndoBar=null;#g=!1;#m=!1;#x=!1;#y=null;#v=null;#w=null;#_=null;#N=!1;#k=null;#C=new z0;#A=!1;#j=!1;#E=null;#P=null;#M=null;#I=null;#S=Ne.NONE;#b=new Set;#L=null;#B=null;#U=null;#H={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#D=[0,0];#V=null;#F=null;#$=null;#R=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=tn.prototype,t=c=>c.#F.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),i=(c,{target:d})=>{if(d instanceof HTMLInputElement){const{type:f}=d;return f!=="text"&&f!=="number"}return!0},r=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return Ce(this,"_keyboardManager",new xr([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(c,{target:d})=>!(d instanceof HTMLButtonElement)&&c.#F.contains(d)&&!c.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(c,{target:d})=>!(d instanceof HTMLButtonElement)&&c.#F.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-a,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[a,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-a],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,a],checker:t}]]))}constructor(e,t,i,r,a,c,d,f,p,m,x,b,y){const A=this._signal=this.#e.signal;this.#F=e,this.#$=t,this.#r=i,this._eventBus=r,r._on("editingaction",this.onEditingAction.bind(this),{signal:A}),r._on("pagechanging",this.onPageChanging.bind(this),{signal:A}),r._on("scalechanging",this.onScaleChanging.bind(this),{signal:A}),r._on("rotationchanging",this.onRotationChanging.bind(this),{signal:A}),r._on("setpreference",this.onSetPreference.bind(this),{signal:A}),r._on("switchannotationeditorparams",w=>this.updateParams(w.type,w.value),{signal:A}),this.#te(),this.#re(),this.#X(),this.#i=a.annotationStorage,this.#y=a.filterFactory,this.#B=c,this.#_=d||null,this.#g=f,this.#m=p,this.#x=m,this.#I=x||null,this.viewParameters={realScale:ri.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=b||null,this._supportsPinchToZoom=y!==!1}destroy(){this.#R?.resolve(),this.#R=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#n.values())e.destroy();this.#n.clear(),this.#s.clear(),this.#p.clear(),this.#t=null,this.#b.clear(),this.#o.destroy(),this.#r?.destroy(),this.#k?.hide(),this.#k=null,this.#v&&(clearTimeout(this.#v),this.#v=null),this.#V&&(clearTimeout(this.#V),this.#V=null),this._editorUndoBar?.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#I}get useNewAltTextFlow(){return this.#m}get useNewAltTextWhenAddingImage(){return this.#x}get hcmFilter(){return Ce(this,"hcmFilter",this.#B?this.#y.addHCMFilter(this.#B.foreground,this.#B.background):"none")}get direction(){return Ce(this,"direction",getComputedStyle(this.#F).direction)}get highlightColors(){return Ce(this,"highlightColors",this.#_?new Map(this.#_.split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return Ce(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#c=e}setMainHighlightColorPicker(e){this.#M=e}editAltText(e,t=!1){this.#r?.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){e==="enableNewAltTextWhenAddingImage"&&(this.#x=t)}onPageChanging({pageNumber:e}){this.#h=e-1}focusMainContainer(){this.#F.focus()}findParent(e,t){for(const i of this.#n.values()){const{x:r,y:a,width:c,height:d}=i.div.getBoundingClientRect();if(e>=r&&e<=r+c&&t>=a&&t<=a+d)return i}return null}disableUserSelect(e=!1){this.#$.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*ri.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#c?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#O({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#q(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of this.#n.values())if(i.hasTextLayer(e))return i;return null}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:i,anchorOffset:r,focusNode:a,focusOffset:c}=t,d=t.toString(),p=this.#O(t).closest(".textLayer"),m=this.getSelectionBoxes(p);if(!m)return;t.empty();const x=this.#q(p),b=this.#S===Ne.NONE,y=()=>{x?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:m,anchorNode:i,anchorOffset:r,focusNode:a,focusOffset:c,text:d}),b&&this.showAllEditors("highlight",!0,!0)};if(b){this.switchToMode(Ne.HIGHLIGHT,y);return}y()}#Z(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=this.#O(e).closest(".textLayer"),r=this.getSelectionBoxes(i);r&&(this.#k||=new O0(this),this.#k.show(i,r,this.direction==="ltr"))}addToAnnotationStorage(e){!e.isEmpty()&&this.#i&&!this.#i.has(e.id)&&this.#i.setValue(e.id,e)}#ee(){const e=document.getSelection();if(!e||e.isCollapsed){this.#L&&(this.#k?.hide(),this.#L=null,this.#T({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#L)return;const r=this.#O(e).closest(".textLayer");if(!r){this.#L&&(this.#k?.hide(),this.#L=null,this.#T({hasSelectedText:!1}));return}if(this.#k?.hide(),this.#L=t,this.#T({hasSelectedText:!0}),!(this.#S!==Ne.HIGHLIGHT&&this.#S!==Ne.NONE)&&(this.#S===Ne.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#N=this.isShiftKeyDown,!this.isShiftKeyDown)){const a=this.#S===Ne.HIGHLIGHT?this.#q(r):null;a?.toggleDrawing();const c=new AbortController,d=this.combinedSignal(c),f=p=>{p.type==="pointerup"&&p.button!==0||(c.abort(),a?.toggleDrawing(!0),p.type==="pointerup"&&this.#W("main_toolbar"))};window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("blur",f,{signal:d})}}#W(e=""){this.#S===Ne.HIGHLIGHT?this.highlightSelection(e):this.#g&&this.#Z()}#te(){document.addEventListener("selectionchange",this.#ee.bind(this),{signal:this._signal})}#se(){if(this.#w)return;this.#w=new AbortController;const e=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#ne(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#N&&(this.#N=!1,this.#W("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#b)if(t.div.contains(e)){this.#P=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#P)return;const[e,t]=this.#P;this.#P=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#X(){if(this.#E)return;this.#E=new AbortController;const e=this.combinedSignal(this.#E);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#ie(){this.#E?.abort(),this.#E=null}#Y(){if(this.#d)return;this.#d=new AbortController;const e=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#K(){this.#d?.abort(),this.#d=null}#re(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#X(),this.#Y()}removeEditListeners(){this.#ie(),this.#K()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of this.#a)if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of this.#a)if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of this.#b){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const a of t.items)for(const c of this.#a)if(c.isHandlingMimeForPasting(a.type)){c.paste(a,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(a){Ee(`paste: "${a.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const r=this.currentLayer;try{const a=[];for(const f of i){const p=await r.deserialize(f);if(!p)return;a.push(p)}const c=()=>{for(const f of a)this.#Q(f);this.#J(a)},d=()=>{for(const f of a)f.remove()};this.addCommands({cmd:c,undo:d,mustExec:!0})}catch(a){Ee(`paste: "${a.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#S!==Ne.NONE&&!this.isEditorHandlingKeyboard&&tn._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#N&&(this.#N=!1,this.#W("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#T(e){Object.entries(e).some(([i,r])=>this.#H[i]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#H,e)}),this.#S===Ne.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#z([[Te.HIGHLIGHT_FREE,!0]]))}#z(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#se(),this.#Y(),this.#T({isEditing:this.#S!==Ne.NONE,isEmpty:this.#G(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ne(),this.#K(),this.#T({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#a){this.#a=e;for(const t of this.#a)this.#z(t.defaultPropertiesToUpdate)}}getId(){return this.#C.id}get currentLayer(){return this.#n.get(this.#h)}getLayer(e){return this.#n.get(e)}get currentPageIndex(){return this.#h}addLayer(e){this.#n.set(e.pageIndex,e),this.#A?e.enable():e.disable()}removeLayer(e){this.#n.delete(e.pageIndex)}async updateMode(e,t=null,i=!1){if(this.#S!==e&&!(this.#R&&(await this.#R.promise,!this.#R))){if(this.#R=Promise.withResolvers(),this.#S=e,e===Ne.NONE){this.setEditingState(!1),this.#oe(),this._editorUndoBar?.hide(),this.#R.resolve();return}this.setEditingState(!0),await this.#ae(),this.unselectAll();for(const r of this.#n.values())r.updateMode(e);if(!t){i&&this.addNewEditorFromKeyboard(),this.#R.resolve();return}for(const r of this.#s.values())r.annotationElementId===t?(this.setSelected(r),r.enterInEditMode()):r.unselect();this.#R.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==this.#S&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){if(this.#a){switch(e){case Te.CREATE:this.currentLayer.addNewEditor();return;case Te.HIGHLIGHT_DEFAULT_COLOR:this.#M?.updateColor(t);break;case Te.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#U||=new Map).set(e,t),this.showAllEditors("highlight",t);break}for(const i of this.#b)i.updateParams(e,t);for(const i of this.#a)i.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){for(const a of this.#s.values())a.editorType===e&&a.show(t);(this.#U?.get(Te.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#z([[Te.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#j!==e){this.#j=e;for(const t of this.#n.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#ae(){if(!this.#A){this.#A=!0;const e=[];for(const t of this.#n.values())e.push(t.enable());await Promise.all(e);for(const t of this.#s.values())t.enable()}}#oe(){if(this.unselectAll(),this.#A){this.#A=!1;for(const e of this.#n.values())e.disable();for(const e of this.#s.values())e.disable()}}getEditors(e){const t=[];for(const i of this.#s.values())i.pageIndex===e&&t.push(i);return t}getEditor(e){return this.#s.get(e)}addEditor(e){this.#s.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.focusMainContainer(),this.#v=null},0)),this.#s.delete(e.id),this.unselect(e),(!e.annotationElementId||!this.#u.has(e.annotationElementId))&&this.#i?.remove(e.id)}addDeletedAnnotationElement(e){this.#u.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#u.has(e)}removeDeletedAnnotationElement(e){this.#u.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#Q(e){const t=this.#n.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#z(e.propertiesToUpdate))}get#le(){let e=null;for(e of this.#b);return e}updateUI(e){this.#le===e&&this.#z(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#z(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#b.has(e)){this.#b.delete(e),e.unselect(),this.#T({hasSelectedEditor:this.hasSelection});return}this.#b.add(e),e.select(),this.#z(e.propertiesToUpdate),this.#T({hasSelectedEditor:!0})}setSelected(e){this.#c?.commitOrRemove();for(const t of this.#b)t!==e&&t.unselect();this.#b.clear(),this.#b.add(e),e.select(),this.#z(e.propertiesToUpdate),this.#T({hasSelectedEditor:!0})}isSelected(e){return this.#b.has(e)}get firstSelectedEditor(){return this.#b.values().next().value}unselect(e){e.unselect(),this.#b.delete(e),this.#T({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#b.size!==0}get isEnterHandled(){return this.#b.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#o.undo(),this.#T({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#G()}),this._editorUndoBar?.hide()}redo(){this.#o.redo(),this.#T({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#G()})}addCommands(e){this.#o.add(e),this.#T({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#G()})}cleanUndoStack(e){this.#o.cleanType(e)}#G(){if(this.#s.size===0)return!0;if(this.#s.size===1)for(const e of this.#s.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#b],i=()=>{this._editorUndoBar?.show(r,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},r=()=>{for(const a of t)this.#Q(a)};this.addCommands({cmd:i,undo:r,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#J(e){for(const t of this.#b)t.unselect();this.#b.clear();for(const t of e)t.isEmpty()||(this.#b.add(t),t.select());this.#T({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#b)e.commit();this.#J(this.#s.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#S!==Ne.NONE))&&!this.#c?.commitOrRemove()&&this.hasSelection){for(const e of this.#b)e.unselect();this.#b.clear(),this.#T({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#D[0]+=e,this.#D[1]+=t;const[r,a]=this.#D,c=[...this.#b],d=1e3;this.#V&&clearTimeout(this.#V),this.#V=setTimeout(()=>{this.#V=null,this.#D[0]=this.#D[1]=0,this.addCommands({cmd:()=>{for(const f of c)this.#s.has(f.id)&&f.translateInPage(r,a)},undo:()=>{for(const f of c)this.#s.has(f.id)&&f.translateInPage(-r,-a)},mustExec:!1})},d);for(const f of c)f.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#f=new Map;for(const e of this.#b)this.#f.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#f)return!1;this.disableUserSelect(!1);const e=this.#f;this.#f=null;let t=!1;for(const[{x:r,y:a,pageIndex:c},d]of e)d.newX=r,d.newY=a,d.newPageIndex=c,t||=r!==d.savedX||a!==d.savedY||c!==d.savedPageIndex;if(!t)return!1;const i=(r,a,c,d)=>{if(this.#s.has(r.id)){const f=this.#n.get(d);f?r._setParentAndPosition(f,a,c):(r.pageIndex=d,r.x=a,r.y=c)}};return this.addCommands({cmd:()=>{for(const[r,{newX:a,newY:c,newPageIndex:d}]of e)i(r,a,c,d)},undo:()=>{for(const[r,{savedX:a,savedY:c,savedPageIndex:d}]of e)i(r,a,c,d)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#f)for(const i of this.#f.keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#b.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#S}get imageManager(){return Ce(this,"imageManager",new zc)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let p=0,m=t.rangeCount;p<m;p++)if(!e.contains(t.getRangeAt(p).commonAncestorContainer))return null;const{x:i,y:r,width:a,height:c}=e.getBoundingClientRect();let d;switch(e.getAttribute("data-main-rotation")){case"90":d=(p,m,x,b)=>({x:(m-r)/c,y:1-(p+x-i)/a,width:b/c,height:x/a});break;case"180":d=(p,m,x,b)=>({x:1-(p+x-i)/a,y:1-(m+b-r)/c,width:x/a,height:b/c});break;case"270":d=(p,m,x,b)=>({x:1-(m+b-r)/c,y:(p-i)/a,width:b/c,height:x/a});break;default:d=(p,m,x,b)=>({x:(p-i)/a,y:(m-r)/c,width:x/a,height:b/c});break}const f=[];for(let p=0,m=t.rangeCount;p<m;p++){const x=t.getRangeAt(p);if(!x.collapsed)for(const{x:b,y,width:A,height:w}of x.getClientRects())A===0||w===0||f.push(d(b,y,A,w))}return f.length===0?null:f}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#l||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#l?.delete(e)}renderAnnotationElement(e){const t=this.#l?.get(e.data.id);if(!t)return;const i=this.#i.getRawValue(t);i&&(this.#S===Ne.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}}class gs{#e=null;#t=!1;#s=null;#n=null;#r=null;#i=null;#l=!1;#o=null;#d=null;#c=null;#h=null;#u=!1;static#f=null;static _l10n=null;constructor(e){this.#d=e,this.#u=e._uiManager.useNewAltTextFlow,gs.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){gs._l10n??=e}async render(){const e=this.#s=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#n=document.createElement("span");e.append(t),this.#u?(e.classList.add("new"),e.setAttribute("data-l10n-id",gs.#f.missing),t.setAttribute("data-l10n-id",gs.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#d._uiManager._signal;e.addEventListener("contextmenu",ls,{signal:i}),e.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:i});const r=a=>{a.preventDefault(),this.#d._uiManager.editAltText(this.#d),this.#u&&this.#d._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#a}})};return e.addEventListener("click",r,{capture:!0,signal:i}),e.addEventListener("keydown",a=>{a.target===e&&a.key==="Enter"&&(this.#l=!0,r(a))},{signal:i}),await this.#p(),e}get#a(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#s&&(this.#s.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#u?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#u?this.#e!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(e){this.#e===null&&(this.#c=e,this.#h=await gs._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#p())}toggleAltTextBadge(e=!1){if(!this.#u||this.#e){this.#o?.remove(),this.#o=null;return}if(!this.#o){const t=this.#o=document.createElement("div");t.className="noAltTextBadge",this.#d.div.append(t)}this.#o.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#c===t&&(t=this.#h),{altText:t,decorative:this.#t,guessedText:this.#c,textWithDisclaimer:this.#h}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:r,cancel:a=!1}){i&&(this.#c=i,this.#h=r),!(this.#e===e&&this.#t===t)&&(a||(this.#e=e,this.#t=t),this.#p())}toggle(e=!1){this.#s&&(!e&&this.#i&&(clearTimeout(this.#i),this.#i=null),this.#s.disabled=!e)}shown(){this.#d._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#a}})}destroy(){this.#s?.remove(),this.#s=null,this.#n=null,this.#r=null,this.#o?.remove(),this.#o=null}async#p(){const e=this.#s;if(!e)return;if(this.#u){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",gs.#f[this.#a]),this.#n?.setAttribute("data-l10n-id",gs.#f[`${this.#a}-label`]),!this.#e){this.#r?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#r?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#r;if(!t){this.#r=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#d.id}`;const r=100,a=this.#d._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#i),this.#i=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#i=setTimeout(()=>{this.#i=null,this.#r.classList.add("show"),this.#d._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:a}),e.addEventListener("mouseleave",()=>{this.#i&&(clearTimeout(this.#i),this.#i=null),this.#r?.classList.remove("show")},{signal:a})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#d.getImageForAltText()?.setAttribute("aria-describedby",t.id)}}class eo{#e;#t=!1;#s=null;#n;#r;#i;#l;#o;#d=null;#c;#h=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:r=null,onPinching:a=null,onPinchEnd:c=null,signal:d}){this.#e=e,this.#s=i,this.#n=t,this.#r=r,this.#i=a,this.#l=c,this.#c=new AbortController,this.#o=AbortSignal.any([d,this.#c.signal]),e.addEventListener("touchstart",this.#u.bind(this),{passive:!1,signal:this.#o})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return Ce(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}#u(e){if(this.#n?.()||e.touches.length<2)return;if(!this.#h){this.#h=new AbortController;const r=AbortSignal.any([this.#o,this.#h.signal]),a=this.#e,c={signal:r,passive:!1};a.addEventListener("touchmove",this.#f.bind(this),c),a.addEventListener("touchend",this.#a.bind(this),c),a.addEventListener("touchcancel",this.#a.bind(this),c),this.#r?.()}if(Bt(e),e.touches.length!==2||this.#s?.()){this.#d=null;return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),this.#d={touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#f(e){if(!this.#d||e.touches.length!==2)return;let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);const{screenX:r,screenY:a}=t,{screenX:c,screenY:d}=i,f=this.#d,{touch0X:p,touch0Y:m,touch1X:x,touch1Y:b}=f,y=x-p,A=b-m,w=c-r,S=d-a,N=Math.hypot(w,S)||1,C=Math.hypot(y,A)||1;if(!this.#t&&Math.abs(C-N)<=eo.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(f.touch0X=r,f.touch0Y=a,f.touch1X=c,f.touch1Y=d,e.preventDefault(),!this.#t){this.#t=!0;return}const R=[(r+c)/2,(a+d)/2];this.#i?.(R,C,N)}#a(e){this.#h.abort(),this.#h=null,this.#l?.(),this.#d&&(e.preventDefault(),this.#d=null,this.#t=!1)}destroy(){this.#c?.abort(),this.#c=null}}class we{#e=null;#t=null;#s=null;#n=!1;#r=null;#i="";#l=!1;#o=null;#d=null;#c=null;#h=null;#u="";#f=!1;#a=null;#p=!1;#g=!1;#m=!1;#x=null;#y=0;#v=0;#w=null;#_=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#N=!1;#k=we._zIndex++;static _borderLineWidth=-1;static _colorManager=new Bc;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=we.prototype._resizeWithKeyboard,t=tn.TRANSLATE_SMALL,i=tn.TRANSLATE_BIG;return Ce(this,"_resizerKeyboardManager",new xr([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],we.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:r,pageX:a,pageY:c}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,r],this.pageTranslation=[a,c];const[d,f]=this.parentDimensions;this.x=e.x/d,this.y=e.y/f,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Ce(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new U0({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(we._l10n??=e,we._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),we._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);we._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){De("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#N}set _isDraggable(e){this.#N=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#k}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#O(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#f?this.#f=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,r){const[a,c]=this.parentDimensions;[i,r]=this.screenToPageTranslation(i,r),this.x=(e+i)/a,this.y=(t+r)/c,this.fixAndSetPosition()}#C([e,t],i,r){[i,r]=this.screenToPageTranslation(i,r),this.x+=i/e,this.y+=r/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#C(this.parentDimensions,e,t)}translateInPage(e,t){this.#a||=[this.x,this.y,this.width,this.height],this.#C(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){this.#a||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[r,a]}=this;if(this.x+=e/r,this.y+=t/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x,y:b}=this.div.getBoundingClientRect();this.parent.findNewParent(this,x,b)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:d}=this;const[f,p]=this.getBaseTranslation();c+=f,d+=p;const{style:m}=i;m.left=`${(100*c).toFixed(2)}%`,m.top=`${(100*d).toFixed(2)}%`,this._onTranslating(c,d),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#a&&(this.#a[0]!==this.x||this.#a[1]!==this.y)}get _hasBeenResized(){return!!this.#a&&(this.#a[2]!==this.width||this.#a[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=we,r=i/e,a=i/t;switch(this.rotation){case 90:return[-r,a];case 180:return[r,a];case 270:return[r,-a];default:return[-r,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,r]}=this;let{x:a,y:c,width:d,height:f}=this;if(d*=i,f*=r,a*=i,c*=r,this._mustFixPosition)switch(e){case 0:a=Math.max(0,Math.min(i-d,a)),c=Math.max(0,Math.min(r-f,c));break;case 90:a=Math.max(0,Math.min(i-f,a)),c=Math.min(r,Math.max(d,c));break;case 180:a=Math.min(i,Math.max(d,a)),c=Math.min(r,Math.max(f,c));break;case 270:a=Math.min(i,Math.max(f,a)),c=Math.max(0,Math.min(r-d,c));break}this.x=a/=i,this.y=c/=r;const[p,m]=this.getBaseTranslation();a+=p,c+=m,t.left=`${(100*a).toFixed(2)}%`,t.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#A(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return we.#A(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return we.#A(e,t,360-this.parentRotation)}#j(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(e,t){const[i,r]=this.parentDimensions,{style:a}=this.div;a.width=`${(100*e/i).toFixed(2)}%`,this.#l||(a.height=`${(100*t/r).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:i}=e,r=i.endsWith("%"),a=!this.#l&&t.endsWith("%");if(r&&a)return;const[c,d]=this.parentDimensions;r||(e.width=`${(100*parseFloat(i)/c).toFixed(2)}%`),!this.#l&&!a&&(e.height=`${(100*parseFloat(t)/d).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#E(){if(this.#o)return;this.#o=document.createElement("div"),this.#o.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const r=document.createElement("div");this.#o.append(r),r.classList.add("resizer",i),r.setAttribute("data-resizer-name",i),r.addEventListener("pointerdown",this.#P.bind(this,i),{signal:t}),r.addEventListener("contextmenu",ls,{signal:t}),r.tabIndex=-1}this.div.prepend(this.#o)}#P(e,t){t.preventDefault();const{isMac:i}=Et.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#s?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#d=[t.screenX,t.screenY];const a=new AbortController,c=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#S.bind(this,e),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",Bt,{passive:!1,signal:c}),window.addEventListener("contextmenu",ls,{signal:c}),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const d=this.parent.div.style.cursor,f=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const p=()=>{a.abort(),this.parent.togglePointerEvents(!0),this.#s?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=d,this.div.style.cursor=f,this.#I()};window.addEventListener("pointerup",p,{signal:c}),window.addEventListener("blur",p,{signal:c})}#M(e,t,i,r){this.width=i,this.height=r,this.x=e,this.y=t;const[a,c]=this.parentDimensions;this.setDims(a*i,c*r),this.fixAndSetPosition(),this._onResized()}_onResized(){}#I(){if(!this.#c)return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:r}=this.#c;this.#c=null;const a=this.x,c=this.y,d=this.width,f=this.height;a===e&&c===t&&d===i&&f===r||this.addCommands({cmd:this.#M.bind(this,a,c,d,f),undo:this.#M.bind(this,e,t,i,r),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#S(e,t){const[i,r]=this.parentDimensions,a=this.x,c=this.y,d=this.width,f=this.height,p=we.MIN_SIZE/i,m=we.MIN_SIZE/r,x=this.#j(this.rotation),b=(X,Z)=>[x[0]*X+x[2]*Z,x[1]*X+x[3]*Z],y=this.#j(360-this.rotation),A=(X,Z)=>[y[0]*X+y[2]*Z,y[1]*X+y[3]*Z];let w,S,N=!1,C=!1;switch(e){case"topLeft":N=!0,w=(X,Z)=>[0,0],S=(X,Z)=>[X,Z];break;case"topMiddle":w=(X,Z)=>[X/2,0],S=(X,Z)=>[X/2,Z];break;case"topRight":N=!0,w=(X,Z)=>[X,0],S=(X,Z)=>[0,Z];break;case"middleRight":C=!0,w=(X,Z)=>[X,Z/2],S=(X,Z)=>[0,Z/2];break;case"bottomRight":N=!0,w=(X,Z)=>[X,Z],S=(X,Z)=>[0,0];break;case"bottomMiddle":w=(X,Z)=>[X/2,Z],S=(X,Z)=>[X/2,0];break;case"bottomLeft":N=!0,w=(X,Z)=>[0,Z],S=(X,Z)=>[X,0];break;case"middleLeft":C=!0,w=(X,Z)=>[0,Z/2],S=(X,Z)=>[X,Z/2];break}const R=w(d,f),E=S(d,f);let L=b(...E);const T=we._round(a+L[0]),I=we._round(c+L[1]);let $=1,te=1,ae,de;if(t.fromKeyboard)({deltaX:ae,deltaY:de}=t);else{const{screenX:X,screenY:Z}=t,[q,se]=this.#d;[ae,de]=this.screenToPageTranslation(X-q,Z-se),this.#d[0]=X,this.#d[1]=Z}if([ae,de]=A(ae/i,de/r),N){const X=Math.hypot(d,f);$=te=Math.max(Math.min(Math.hypot(E[0]-R[0]-ae,E[1]-R[1]-de)/X,1/d,1/f),p/d,m/f)}else C?$=Math.max(p,Math.min(1,Math.abs(E[0]-R[0]-ae)))/d:te=Math.max(m,Math.min(1,Math.abs(E[1]-R[1]-de)))/f;const Ae=we._round(d*$),pe=we._round(f*te);L=b(...S(Ae,pe));const be=T-L[0],ke=I-L[1];this.#a||=[this.x,this.y,this.width,this.height],this.width=Ae,this.height=pe,this.x=be,this.y=ke,this.setDims(i*Ae,r*pe),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#s?.finish()}async addEditToolbar(){return this._editToolbar||this.#g?this._editToolbar:(this._editToolbar=new cr(this),this.div.append(this._editToolbar.render()),this.#s&&await this._editToolbar.addAltText(this.#s),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#s?.destroy())}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#s||(gs.initialize(we._l10n),this.#s=new gs(this),this.#e&&(this.#s.data=this.#e,this.#e=null),await this.addEditToolbar())}get altTextData(){return this.#s?.data}set altTextData(e){this.#s&&(this.#s.data=e)}get guessedAltText(){return this.#s?.guessedText}async setGuessedAltText(e){await this.#s?.setGuessedText(e)}serializeAltText(e){return this.#s?.serialize(e)}hasAltText(){return!!this.#s&&!this.#s.isEmpty()}hasAltTextData(){return this.#s?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#n?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#D();const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[i,r]=this.getInitialTranslation();return this.translate(i,r),Ha(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#_||=new eo({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#b.bind(this),onPinching:this.#L.bind(this),onPinchEnd:this.#B.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),this.div}#b(){this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#s?.toggle(!1),this.parent.togglePointerEvents(!1)}#L(e,t,i){let a=.7*(i/t)+1-.7;if(a===1)return;const c=this.#j(this.rotation),d=(T,I)=>[c[0]*T+c[2]*I,c[1]*T+c[3]*I],[f,p]=this.parentDimensions,m=this.x,x=this.y,b=this.width,y=this.height,A=we.MIN_SIZE/f,w=we.MIN_SIZE/p;a=Math.max(Math.min(a,1/b,1/y),A/b,w/y);const S=we._round(b*a),N=we._round(y*a);if(S===b&&N===y)return;this.#a||=[m,x,b,y];const C=d(b/2,y/2),R=we._round(m+C[0]),E=we._round(x+C[1]),L=d(S/2,N/2);this.x=R-L[0],this.y=E-L[1],this.width=S,this.height=N,this.setDims(f*S,p*N),this.fixAndSetPosition(),this._onResizing()}#B(){this.#s?.toggle(!0),this.parent.togglePointerEvents(!0),this.#I()}pointerdown(e){const{isMac:t}=Et.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#f=!0,this._isDraggable){this.#H(e);return}this.#U(e)}get isSelected(){return this._uiManager.isSelected(this)}#U(e){const{isMac:t}=Et.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#H(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1;const r=new AbortController,a=this._uiManager.combinedSignal(r),c={capture:!0,passive:!1,signal:a},d=p=>{r.abort(),this.#r=null,this.#f=!1,this._uiManager.endDragSession()||this.#U(p),i&&this._onStopDragging()};t&&(this.#y=e.clientX,this.#v=e.clientY,this.#r=e.pointerId,this.#i=e.pointerType,window.addEventListener("pointermove",p=>{i||(i=!0,this._onStartDragging());const{clientX:m,clientY:x,pointerId:b}=p;if(b!==this.#r){Bt(p);return}const[y,A]=this.screenToPageTranslation(m-this.#y,x-this.#v);this.#y=m,this.#v=x,this._uiManager.dragSelectedEditors(y,A)},c),window.addEventListener("touchmove",Bt,c),window.addEventListener("pointerdown",p=>{p.pointerType===this.#i&&(this.#_||p.isPrimary)&&d(p),Bt(p)},c));const f=p=>{if(!this.#r||this.#r===p.pointerId){d(p);return}Bt(p)};window.addEventListener("pointerup",f,{signal:a}),window.addEventListener("blur",f,{signal:a})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.#x=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const r=this.parentScale,[a,c]=this.pageDimensions,[d,f]=this.pageTranslation,p=e/r,m=t/r,x=this.x*a,b=this.y*c,y=this.width*a,A=this.height*c;switch(i){case 0:return[x+p+d,c-b-m-A+f,x+p+y+d,c-b-m+f];case 90:return[x+m+d,c-b+p+f,x+m+A+d,c-b+p+y+f];case 180:return[x-p-y+d,c-b+m+f,x-p+d,c-b+m+A+f];case 270:return[x-m-A+d,c-b-p-y+f,x-m+d,c-b-p+f];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,r,a,c]=e,d=a-i,f=c-r;switch(this.rotation){case 0:return[i,t-c,d,f];case 90:return[i,t-r,f,d];case 180:return[a,t-r,d,f];case 270:return[a,t-c,f,d];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){this.#g=!0}disableEditMode(){this.#g=!1}isInEditMode(){return this.#g}shouldGetKeyboardEvents(){return this.#m}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:i,right:r}=this.getClientDimensions(),{innerHeight:a,innerWidth:c}=window;return t<c&&r>0&&e<a&&i>0}#D(){if(this.#h||!this.div)return;this.#h=new AbortController;const e=this._uiManager.combinedSignal(this.#h);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#D()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){De("An editor must be serializable")}static async deserialize(e,t,i){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i});r.rotation=e.rotation,r.#e=e.accessibilityData;const[a,c]=r.pageDimensions,[d,f,p,m]=r.getRectInCurrentCoords(e.rect,c);return r.x=d/a,r.y=f/c,r.width=p/a,r.height=m/c,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#h?.abort(),this.#h=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#x&&(clearTimeout(this.#x),this.#x=null),this.#O(),this.removeEditToolbar(),this.#w){for(const e of this.#w.values())clearTimeout(e);this.#w=null}this.parent=null,this.#_?.destroy(),this.#_=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#E(),this.#o.classList.remove("hidden"),Ha(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#c={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#o.children;if(!this.#t){this.#t=Array.from(t);const c=this.#V.bind(this),d=this.#F.bind(this),f=this._uiManager._signal;for(const p of this.#t){const m=p.getAttribute("data-resizer-name");p.setAttribute("role","spinbutton"),p.addEventListener("keydown",c,{signal:f}),p.addEventListener("blur",d,{signal:f}),p.addEventListener("focus",this.#$.bind(this,m),{signal:f}),p.setAttribute("data-l10n-id",we._l10nResizer[m])}}const i=this.#t[0];let r=0;for(const c of t){if(c===i)break;r++}const a=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(a!==r){if(a<r)for(let d=0;d<r-a;d++)this.#o.append(this.#o.firstChild);else if(a>r)for(let d=0;d<a-r;d++)this.#o.firstChild.before(this.#o.lastChild);let c=0;for(const d of t){const p=this.#t[c++].getAttribute("data-resizer-name");d.setAttribute("data-l10n-id",we._l10nResizer[p])}}this.#R(0),this.#m=!0,this.#o.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#V(e){we._resizerKeyboardManager.exec(this,e)}#F(e){this.#m&&e.relatedTarget?.parentNode!==this.#o&&this.#O()}#$(e){this.#u=this.#m?e:""}#R(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#m&&this.#S(this.#u,{deltaX:e,deltaY:t,fromKeyboard:!0})}#O(){this.#m=!1,this.#R(-1),this.#I()}_stopResizingWithKeyboard(){this.#O(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#s?.toggleAltTextBadge(!1)}unselect(){this.#o?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#s?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#l=!0;const i=e/t,{style:r}=this.div;r.aspectRatio=i,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#w||=new Map;const{action:i}=e;let r=this.#w.get(i);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),this.#w.delete(i),this.#w.size===0&&(this.#w=null)},we._telemetryTimeout),this.#w.set(i,r);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#n=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#n=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class U0 extends we{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const ff=3285377520,Yt=4294901760,ms=65535;class Zf{constructor(e){this.h1=e?e&4294967295:ff,this.h2=e?e&4294967295:ff}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let w=0,S=e.length;w<S;w++){const N=e.charCodeAt(w);N<=255?t[i++]=N:(t[i++]=N>>>8,t[i++]=N&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=i>>2,a=i-r*4,c=new Uint32Array(t.buffer,0,r);let d=0,f=0,p=this.h1,m=this.h2;const x=3432918353,b=461845907,y=x&ms,A=b&ms;for(let w=0;w<r;w++)w&1?(d=c[w],d=d*x&Yt|d*y&ms,d=d<<15|d>>>17,d=d*b&Yt|d*A&ms,p^=d,p=p<<13|p>>>19,p=p*5+3864292196):(f=c[w],f=f*x&Yt|f*y&ms,f=f<<15|f>>>17,f=f*b&Yt|f*A&ms,m^=f,m=m<<13|m>>>19,m=m*5+3864292196);switch(d=0,a){case 3:d^=t[r*4+2]<<16;case 2:d^=t[r*4+1]<<8;case 1:d^=t[r*4],d=d*x&Yt|d*y&ms,d=d<<15|d>>>17,d=d*b&Yt|d*A&ms,r&1?p^=d:m^=d}this.h1=p,this.h2=m}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Yt|e*36045&ms,t=t*4283543511&Yt|((t<<16|e>>>16)*2950163797&Yt)>>>16,e^=t>>>1,e=e*444984403&Yt|e*60499&ms,t=t*3301882366&Yt|((t<<16|e>>>16)*3120437893&Yt)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const _c=Object.freeze({map:null,hash:"",transfer:void 0});class Uc{#e=!1;#t=null;#s=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=this.#s.get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return this.#s.get(e)}remove(e){if(this.#s.delete(e),this.#s.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of this.#s.values())if(t instanceof we)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=this.#s.get(e);let r=!1;if(i!==void 0)for(const[a,c]of Object.entries(t))i[a]!==c&&(r=!0,i[a]=c);else r=!0,this.#s.set(e,t);r&&this.#n(),t instanceof we&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#s.has(e)}getAll(){return this.#s.size>0?Vc(this.#s):null}setAll(e){for(const[t,i]of Object.entries(e))this.setValue(t,i)}get size(){return this.#s.size}#n(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new ep(this)}get serializable(){if(this.#s.size===0)return _c;const e=new Map,t=new Zf,i=[],r=Object.create(null);let a=!1;for(const[c,d]of this.#s){const f=d instanceof we?d.serialize(!1,r):d;f&&(e.set(c,f),t.update(`${c}:${JSON.stringify(f)}`),a||=!!f.bitmap)}if(a)for(const c of e.values())c.bitmap&&i.push(c.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:_c}get editorStats(){let e=null;const t=new Map;for(const i of this.#s.values()){if(!(i instanceof we))continue;const r=i.telemetryFinalData;if(!r)continue;const{type:a}=r;t.has(a)||t.set(a,Object.getPrototypeOf(i).constructor),e||=Object.create(null);const c=e[a]||=new Map;for(const[d,f]of Object.entries(r)){if(d==="type")continue;let p=c.get(d);p||(p=new Map,c.set(d,p));const m=p.get(f)??0;p.set(f,m+1)}}for(const[i,r]of t)e[i]=r.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){this.#t=null}get modifiedIds(){if(this.#t)return this.#t;const e=[];for(const t of this.#s.values())!(t instanceof we)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}}class ep extends Uc{#e;constructor(e){super();const{map:t,hash:i,transfer:r}=e.serializable,a=structuredClone(t,r?{transfer:r}:null);this.#e={map:a,hash:i,transfer:r}}get print(){De("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return Ce(this,"modifiedIds",{ids:new Set,hash:""})}}class H0{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||this.#e.has(e.loadedName))){if(tt(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:r,style:a}=e,c=new FontFace(i,r,a);this.addNativeFontFace(c);try{await c.load(),this.#e.add(i),t?.(e)}catch{Ee(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}De("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(r){throw Ee(`Failed to load font '${i.family}': '${r}'.`),e.disableFontFace=!0,r}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const r=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,r)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return Ce(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(bt||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),Ce(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(tt(!r.done,"completeRequest() cannot be called twice."),r.done=!0;i.length>0&&i[0].done;){const a=i.shift();setTimeout(a.callback,0)}}const{loadingRequests:i}=this,r={done:!1,complete:t,callback:e};return i.push(r),r}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ce(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(E,L){return E.charCodeAt(L)<<24|E.charCodeAt(L+1)<<16|E.charCodeAt(L+2)<<8|E.charCodeAt(L+3)&255}function r(E,L,T,I){const $=E.substring(0,L),te=E.substring(L+T);return $+I+te}let a,c;const d=this._document.createElement("canvas");d.width=1,d.height=1;const f=d.getContext("2d");let p=0;function m(E,L){if(++p>30){Ee("Load test font never loaded."),L();return}if(f.font="30px "+E,f.fillText(".",0,20),f.getImageData(0,0,1,1).data[3]>0){L();return}setTimeout(m.bind(null,E,L))}const x=`lt${Date.now()}${this.loadTestFontId++}`;let b=this._loadTestFont;b=r(b,976,x.length,x);const A=16,w=1482184792;let S=i(b,A);for(a=0,c=x.length-3;a<c;a+=4)S=S-w+i(x,a)|0;a<x.length&&(S=S-w+i(x+"XXX",a)|0),b=r(b,A,4,j0(S));const N=`url(data:font/opentype;base64,${btoa(b)});`,C=`@font-face {font-family:"${x}";src:${N}}`;this.insertRule(C);const R=this._document.createElement("div");R.style.visibility="hidden",R.style.width=R.style.height="10px",R.style.position="absolute",R.style.top=R.style.left="0px";for(const E of[e.loadedName,x]){const L=this._document.createElement("span");L.textContent="Hi",L.style.fontFamily=E,R.append(L)}this._document.body.append(R),m(x,()=>{R.remove(),t.complete()})}}class $0{constructor(e,{disableFontFace:t=!1,fontExtraProperties:i=!1,inspectFont:r=null}){this.compiledGlyphs=Object.create(null);for(const a in e)this[a]=e[a];this.disableFontFace=t===!0,this.fontExtraProperties=i===!0,this._inspectFont=r}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${M0(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let r;try{r=e.get(i)}catch(c){Ee(`getPathGenerator - ignoring character: "${c}".`)}const a=new Path2D(r||"");return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=a}}const Pa={DATA:1,ERROR:2},et={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function pf(){}function Mt(u){if(u instanceof en||u instanceof wc||u instanceof fr||u instanceof df||u instanceof Ua||u instanceof oc)return u;switch(u instanceof Error||typeof u=="object"&&u!==null||De('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),u.name){case"AbortException":return new en(u.message);case"InvalidPDFException":return new wc(u.message);case"MissingPDFException":return new fr(u.message);case"PasswordException":return new df(u.message,u.code);case"UnexpectedResponseException":return new Ua(u.message,u.status);case"UnknownErrorException":return new oc(u.message,u.details)}return new oc(u.message,u.toString())}class or{#e=new AbortController;constructor(e,t,i){this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#n(e);return}if(e.callback){const i=e.callbackId,r=this.callbackCapabilities[i];if(!r)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===Pa.DATA)r.resolve(e.data);else if(e.callback===Pa.ERROR)r.reject(Mt(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,r=e.sourceName,a=this.comObj;Promise.try(t,e.data).then(function(c){a.postMessage({sourceName:i,targetName:r,callback:Pa.DATA,callbackId:e.callbackId,data:c})},function(c){a.postMessage({sourceName:i,targetName:r,callback:Pa.ERROR,callbackId:e.callbackId,reason:Mt(c)})});return}if(e.streamId){this.#s(e);return}t(e.data)}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const r=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[r]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},i)}catch(c){a.reject(c)}return a.promise}sendWithStream(e,t,i,r){const a=this.streamId++,c=this.sourceName,d=this.targetName,f=this.comObj;return new ReadableStream({start:p=>{const m=Promise.withResolvers();return this.streamControllers[a]={controller:p,startCall:m,pullCall:null,cancelCall:null,isClosed:!1},f.postMessage({sourceName:c,targetName:d,action:e,streamId:a,data:t,desiredSize:p.desiredSize},r),m.promise},pull:p=>{const m=Promise.withResolvers();return this.streamControllers[a].pullCall=m,f.postMessage({sourceName:c,targetName:d,stream:et.PULL,streamId:a,desiredSize:p.desiredSize}),m.promise},cancel:p=>{tt(p instanceof Error,"cancel must have a valid reason");const m=Promise.withResolvers();return this.streamControllers[a].cancelCall=m,this.streamControllers[a].isClosed=!0,f.postMessage({sourceName:c,targetName:d,stream:et.CANCEL,streamId:a,reason:Mt(p)}),m.promise}},i)}#s(e){const t=e.streamId,i=this.sourceName,r=e.sourceName,a=this.comObj,c=this,d=this.actionHandler[e.action],f={enqueue(p,m=1,x){if(this.isCancelled)return;const b=this.desiredSize;this.desiredSize-=m,b>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:i,targetName:r,stream:et.ENQUEUE,streamId:t,chunk:p},x)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:i,targetName:r,stream:et.CLOSE,streamId:t}),delete c.streamSinks[t])},error(p){tt(p instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:i,targetName:r,stream:et.ERROR,streamId:t,reason:Mt(p)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};f.sinkCapability.resolve(),f.ready=f.sinkCapability.promise,this.streamSinks[t]=f,Promise.try(d,e.data,f).then(function(){a.postMessage({sourceName:i,targetName:r,stream:et.START_COMPLETE,streamId:t,success:!0})},function(p){a.postMessage({sourceName:i,targetName:r,stream:et.START_COMPLETE,streamId:t,reason:Mt(p)})})}#n(e){const t=e.streamId,i=this.sourceName,r=e.sourceName,a=this.comObj,c=this.streamControllers[t],d=this.streamSinks[t];switch(e.stream){case et.START_COMPLETE:e.success?c.startCall.resolve():c.startCall.reject(Mt(e.reason));break;case et.PULL_COMPLETE:e.success?c.pullCall.resolve():c.pullCall.reject(Mt(e.reason));break;case et.PULL:if(!d){a.postMessage({sourceName:i,targetName:r,stream:et.PULL_COMPLETE,streamId:t,success:!0});break}d.desiredSize<=0&&e.desiredSize>0&&d.sinkCapability.resolve(),d.desiredSize=e.desiredSize,Promise.try(d.onPull||pf).then(function(){a.postMessage({sourceName:i,targetName:r,stream:et.PULL_COMPLETE,streamId:t,success:!0})},function(p){a.postMessage({sourceName:i,targetName:r,stream:et.PULL_COMPLETE,streamId:t,reason:Mt(p)})});break;case et.ENQUEUE:if(tt(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(e.chunk);break;case et.CLOSE:if(tt(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#r(c,t);break;case et.ERROR:tt(c,"error should have stream controller"),c.controller.error(Mt(e.reason)),this.#r(c,t);break;case et.CANCEL_COMPLETE:e.success?c.cancelCall.resolve():c.cancelCall.reject(Mt(e.reason)),this.#r(c,t);break;case et.CANCEL:if(!d)break;const f=Mt(e.reason);Promise.try(d.onCancel||pf,f).then(function(){a.postMessage({sourceName:i,targetName:r,stream:et.CANCEL_COMPLETE,streamId:t,success:!0})},function(p){a.postMessage({sourceName:i,targetName:r,stream:et.CANCEL_COMPLETE,streamId:t,reason:Mt(p)})}),d.sinkCapability.reject(f),d.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#r(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class tp{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){De("Abstract method `_createCanvas` called.")}}class G0 extends tp{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class sp{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){De("Abstract method `_fetch` called.")}}class np extends sp{async _fetch(e){const t=await Ja(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Qa(t)}}class ip{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,r,a){return"none"}destroy(e=!1){}}class W0 extends ip{#e;#t;#s;#n;#r;#i;#l=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#n=e,this.#r=t}get#o(){return this.#t||=new Map}get#d(){return this.#i||=new Map}get#c(){if(!this.#s){const e=this.#r.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const i=this.#r.createElementNS(Es,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#s=this.#r.createElementNS(Es,"defs"),e.append(i),i.append(this.#s),this.#r.body.append(e)}return this.#s}#h(e){if(e.length===1){const f=e[0],p=new Array(256);for(let x=0;x<256;x++)p[x]=f[x]/255;const m=p.join(",");return[m,m,m]}const[t,i,r]=e,a=new Array(256),c=new Array(256),d=new Array(256);for(let f=0;f<256;f++)a[f]=t[f]/255,c[f]=i[f]/255,d[f]=r[f]/255;return[a.join(","),c.join(","),d.join(",")]}#u(e){if(this.#e===void 0){this.#e="";const t=this.#r.URL;t!==this.#r.baseURI&&(Za(t)?Ee('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=t.split("#",1)[0])}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#o.get(e);if(t)return t;const[i,r,a]=this.#h(e),c=e.length===1?i:`${i}${r}${a}`;if(t=this.#o.get(c),t)return this.#o.set(e,t),t;const d=`g_${this.#n}_transfer_map_${this.#l++}`,f=this.#u(d);this.#o.set(e,f),this.#o.set(c,f);const p=this.#p(d);return this.#m(i,r,a,p),f}addHCMFilter(e,t){const i=`${e}-${t}`,r="base";let a=this.#d.get(r);if(a?.key===i||(a?(a.filter?.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},this.#d.set(r,a)),!e||!t))return a.url;const c=this.#y(e);e=me.makeHexColor(...c);const d=this.#y(t);if(t=me.makeHexColor(...d),this.#c.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return a.url;const f=new Array(256);for(let y=0;y<=255;y++){const A=y/255;f[y]=A<=.03928?A/12.92:((A+.055)/1.055)**2.4}const p=f.join(","),m=`g_${this.#n}_hcm_filter`,x=a.filter=this.#p(m);this.#m(p,p,p,x),this.#a(x);const b=(y,A)=>{const w=c[y]/255,S=d[y]/255,N=new Array(A+1);for(let C=0;C<=A;C++)N[C]=w+C/A*(S-w);return N.join(",")};return this.#m(b(0,5),b(1,5),b(2,5),x),a.url=this.#u(m),a.url}addAlphaFilter(e){let t=this.#o.get(e);if(t)return t;const[i]=this.#h([e]),r=`alpha_${i}`;if(t=this.#o.get(r),t)return this.#o.set(e,t),t;const a=`g_${this.#n}_alpha_map_${this.#l++}`,c=this.#u(a);this.#o.set(e,c),this.#o.set(r,c);const d=this.#p(a);return this.#x(i,d),c}addLuminosityFilter(e){let t=this.#o.get(e||"luminosity");if(t)return t;let i,r;if(e?([i]=this.#h([e]),r=`luminosity_${i}`):r="luminosity",t=this.#o.get(r),t)return this.#o.set(e,t),t;const a=`g_${this.#n}_luminosity_map_${this.#l++}`,c=this.#u(a);this.#o.set(e,c),this.#o.set(r,c);const d=this.#p(a);return this.#f(d),e&&this.#x(i,d),c}addHighlightHCMFilter(e,t,i,r,a){const c=`${t}-${i}-${r}-${a}`;let d=this.#d.get(e);if(d?.key===c||(d?(d.filter?.remove(),d.key=c,d.url="none",d.filter=null):(d={key:c,url:"none",filter:null},this.#d.set(e,d)),!t||!i))return d.url;const[f,p]=[t,i].map(this.#y.bind(this));let m=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),x=Math.round(.2126*p[0]+.7152*p[1]+.0722*p[2]),[b,y]=[r,a].map(this.#y.bind(this));x<m&&([m,x,b,y]=[x,m,y,b]),this.#c.style.color="";const A=(N,C,R)=>{const E=new Array(256),L=(x-m)/R,T=N/255,I=(C-N)/(255*R);let $=0;for(let te=0;te<=R;te++){const ae=Math.round(m+te*L),de=T+te*I;for(let Ae=$;Ae<=ae;Ae++)E[Ae]=de;$=ae+1}for(let te=$;te<256;te++)E[te]=E[$-1];return E.join(",")},w=`g_${this.#n}_hcm_${e}_filter`,S=d.filter=this.#p(w);return this.#a(S),this.#m(A(b[0],y[0],5),A(b[1],y[1],5),A(b[2],y[2],5),S),d.url=this.#u(w),d.url}destroy(e=!1){e&&this.#i?.size||(this.#s?.parentNode.parentNode.remove(),this.#s=null,this.#t?.clear(),this.#t=null,this.#i?.clear(),this.#i=null,this.#l=0)}#f(e){const t=this.#r.createElementNS(Es,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#a(e){const t=this.#r.createElementNS(Es,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#p(e){const t=this.#r.createElementNS(Es,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#c.append(t),t}#g(e,t,i){const r=this.#r.createElementNS(Es,t);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),e.append(r)}#m(e,t,i,r){const a=this.#r.createElementNS(Es,"feComponentTransfer");r.append(a),this.#g(a,"feFuncR",e),this.#g(a,"feFuncG",t),this.#g(a,"feFuncB",i)}#x(e,t){const i=this.#r.createElementNS(Es,"feComponentTransfer");t.append(i),this.#g(i,"feFuncA",e)}#y(e){return this.#c.style.color=e,Oc(getComputedStyle(this.#c).getPropertyValue("color"))}}class rp{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){De("Abstract method `_fetch` called.")}}class ap extends rp{async _fetch(e){const t=await Ja(e,"arraybuffer");return new Uint8Array(t)}}bt&&Ee("Please use the `legacy` build in Node.js environments.");async function op(u){const t=await process.getBuiltinModule("fs").promises.readFile(u);return new Uint8Array(t)}class q0 extends ip{}class X0 extends tp{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class Y0 extends sp{async _fetch(e){return op(e)}}class K0 extends rp{async _fetch(e){return op(e)}}const vt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Sc(u,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,i),u.clip(r)}class Hc{getPattern(){De("Abstract method `getPattern` called.")}}class Q0 extends Hc{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(e,t,i,r){let a;if(r===vt.STROKE||r===vt.FILL){const c=t.current.getClippedPathBoundingBox(r,He(e))||[0,0,0,0],d=Math.ceil(c[2]-c[0])||1,f=Math.ceil(c[3]-c[1])||1,p=t.cachedCanvases.getCanvas("pattern",d,f),m=p.context;m.clearRect(0,0,m.canvas.width,m.canvas.height),m.beginPath(),m.rect(0,0,m.canvas.width,m.canvas.height),m.translate(-c[0],-c[1]),i=me.transform(i,[1,0,0,1,c[0],c[1]]),m.transform(...t.baseTransform),this.matrix&&m.transform(...this.matrix),Sc(m,this._bbox),m.fillStyle=this._createGradient(m),m.fill(),a=e.createPattern(p.canvas,"no-repeat");const x=new DOMMatrix(i);a.setTransform(x)}else Sc(e,this._bbox),a=this._createGradient(e);return a}}function dc(u,e,t,i,r,a,c,d){const f=e.coords,p=e.colors,m=u.data,x=u.width*4;let b;f[t+1]>f[i+1]&&(b=t,t=i,i=b,b=a,a=c,c=b),f[i+1]>f[r+1]&&(b=i,i=r,r=b,b=c,c=d,d=b),f[t+1]>f[i+1]&&(b=t,t=i,i=b,b=a,a=c,c=b);const y=(f[t]+e.offsetX)*e.scaleX,A=(f[t+1]+e.offsetY)*e.scaleY,w=(f[i]+e.offsetX)*e.scaleX,S=(f[i+1]+e.offsetY)*e.scaleY,N=(f[r]+e.offsetX)*e.scaleX,C=(f[r+1]+e.offsetY)*e.scaleY;if(A>=C)return;const R=p[a],E=p[a+1],L=p[a+2],T=p[c],I=p[c+1],$=p[c+2],te=p[d],ae=p[d+1],de=p[d+2],Ae=Math.round(A),pe=Math.round(C);let be,ke,X,Z,q,se,Q,V;for(let z=Ae;z<=pe;z++){if(z<S){const ee=z<A?0:(A-z)/(A-S);be=y-(y-w)*ee,ke=R-(R-T)*ee,X=E-(E-I)*ee,Z=L-(L-$)*ee}else{let ee;z>C?ee=1:S===C?ee=0:ee=(S-z)/(S-C),be=w-(w-N)*ee,ke=T-(T-te)*ee,X=I-(I-ae)*ee,Z=$-($-de)*ee}let ie;z<A?ie=0:z>C?ie=1:ie=(A-z)/(A-C),q=y-(y-N)*ie,se=R-(R-te)*ie,Q=E-(E-ae)*ie,V=L-(L-de)*ie;const ge=Math.round(Math.min(be,q)),U=Math.round(Math.max(be,q));let B=x*z+ge*4;for(let ee=ge;ee<=U;ee++)ie=(be-ee)/(be-q),ie<0?ie=0:ie>1&&(ie=1),m[B++]=ke-(ke-se)*ie|0,m[B++]=X-(X-Q)*ie|0,m[B++]=Z-(Z-V)*ie|0,m[B++]=255}}function J0(u,e,t){const i=e.coords,r=e.colors;let a,c;switch(e.type){case"lattice":const d=e.verticesPerRow,f=Math.floor(i.length/d)-1,p=d-1;for(a=0;a<f;a++){let m=a*d;for(let x=0;x<p;x++,m++)dc(u,t,i[m],i[m+1],i[m+d],r[m],r[m+1],r[m+d]),dc(u,t,i[m+d+1],i[m+1],i[m+d],r[m+d+1],r[m+1],r[m+d])}break;case"triangles":for(a=0,c=i.length;a<c;a+=3)dc(u,t,i[a],i[a+1],i[a+2],r[a],r[a+1],r[a+2]);break;default:throw new Error("illegal figure")}}class Z0 extends Hc{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,i){const d=Math.floor(this._bounds[0]),f=Math.floor(this._bounds[1]),p=Math.ceil(this._bounds[2])-d,m=Math.ceil(this._bounds[3])-f,x=Math.min(Math.ceil(Math.abs(p*e[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(m*e[1]*1.1)),3e3),y=p/x,A=m/b,w={coords:this._coords,colors:this._colors,offsetX:-d,offsetY:-f,scaleX:1/y,scaleY:1/A},S=x+4,N=b+4,C=i.getCanvas("mesh",S,N),R=C.context,E=R.createImageData(x,b);if(t){const T=E.data;for(let I=0,$=T.length;I<$;I+=4)T[I]=t[0],T[I+1]=t[1],T[I+2]=t[2],T[I+3]=255}for(const T of this._figures)J0(E,T,w);return R.putImageData(E,2,2),{canvas:C.canvas,offsetX:d-2*y,offsetY:f-2*A,scaleX:y,scaleY:A}}getPattern(e,t,i,r){Sc(e,this._bbox);let a;if(r===vt.SHADING)a=me.singularValueDecompose2dScale(He(e));else if(a=me.singularValueDecompose2dScale(t.baseTransform),this.matrix){const d=me.singularValueDecompose2dScale(this.matrix);a=[a[0]*d[0],a[1]*d[1]]}const c=this._createMeshCanvas(a,r===vt.SHADING?null:this._background,t.cachedCanvases);return r!==vt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(c.offsetX,c.offsetY),e.scale(c.scaleX,c.scaleY),e.createPattern(c.canvas,"no-repeat")}}class ev extends Hc{getPattern(){return"hotpink"}}function tv(u){switch(u[0]){case"RadialAxial":return new Q0(u);case"Mesh":return new Z0(u);case"Dummy":return new ev}throw new Error(`Unknown IR type: ${u[0]}`)}const mf={COLORED:1,UNCOLORED:2};class $c{static MAX_PATTERN_SIZE=3e3;constructor(e,t,i,r,a){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=i,this.canvasGraphicsFactory=r,this.baseTransform=a}createPatternCanvas(e){const{bbox:t,operatorList:i,paintType:r,tilingType:a,color:c,canvasGraphicsFactory:d}=this;let{xstep:f,ystep:p}=this;f=Math.abs(f),p=Math.abs(p),Ka("TilingType: "+a);const m=t[0],x=t[1],b=t[2],y=t[3],A=b-m,w=y-x,S=me.singularValueDecompose2dScale(this.matrix),N=me.singularValueDecompose2dScale(this.baseTransform),C=S[0]*N[0],R=S[1]*N[1];let E=A,L=w,T=!1,I=!1;const $=Math.ceil(f*C),te=Math.ceil(p*R),ae=Math.ceil(A*C),de=Math.ceil(w*R);$>=ae?E=f:T=!0,te>=de?L=p:I=!0;const Ae=this.getSizeAndScale(E,this.ctx.canvas.width,C),pe=this.getSizeAndScale(L,this.ctx.canvas.height,R),be=e.cachedCanvases.getCanvas("pattern",Ae.size,pe.size),ke=be.context,X=d.createCanvasGraphics(ke);if(X.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(X,r,c),ke.translate(-Ae.scale*m,-pe.scale*x),X.transform(Ae.scale,0,0,pe.scale,0,0),ke.save(),this.clipBbox(X,m,x,b,y),X.baseTransform=He(X.ctx),X.executeOperatorList(i),X.endDrawing(),ke.restore(),T||I){const Z=be.canvas;T&&(E=f),I&&(L=p);const q=this.getSizeAndScale(E,this.ctx.canvas.width,C),se=this.getSizeAndScale(L,this.ctx.canvas.height,R),Q=q.size,V=se.size,z=e.cachedCanvases.getCanvas("pattern-workaround",Q,V),ie=z.context,ge=T?Math.floor(A/f):0,U=I?Math.floor(w/p):0;for(let B=0;B<=ge;B++)for(let ee=0;ee<=U;ee++)ie.drawImage(Z,Q*B,V*ee,Q,V,0,0,Q,V);return{canvas:z.canvas,scaleX:q.scale,scaleY:se.scale,offsetX:m,offsetY:x}}return{canvas:be.canvas,scaleX:Ae.scale,scaleY:pe.scale,offsetX:m,offsetY:x}}getSizeAndScale(e,t,i){const r=Math.max($c.MAX_PATTERN_SIZE,t);let a=Math.ceil(e*i);return a>=r?a=r:i=a/e,{scale:i,size:a}}clipBbox(e,t,i,r,a){const c=r-t,d=a-i;e.ctx.rect(t,i,c,d),e.current.updateRectMinMax(He(e.ctx),[t,i,r,a]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const r=e.ctx,a=e.current;switch(t){case mf.COLORED:const c=this.ctx;r.fillStyle=c.fillStyle,r.strokeStyle=c.strokeStyle,a.fillColor=c.fillStyle,a.strokeColor=c.strokeStyle;break;case mf.UNCOLORED:const d=me.makeHexColor(i[0],i[1],i[2]);r.fillStyle=d,r.strokeStyle=d,a.fillColor=d,a.strokeColor=d;break;default:throw new k0(`Unsupported paint type: ${t}`)}}getPattern(e,t,i,r){let a=i;r!==vt.SHADING&&(a=me.transform(a,t.baseTransform),this.matrix&&(a=me.transform(a,this.matrix)));const c=this.createPatternCanvas(t);let d=new DOMMatrix(a);d=d.translate(c.offsetX,c.offsetY),d=d.scale(1/c.scaleX,1/c.scaleY);const f=e.createPattern(c.canvas,"repeat");return f.setTransform(d),f}}function sv({src:u,srcPos:e=0,dest:t,width:i,height:r,nonBlackColor:a=4294967295,inverseDecode:c=!1}){const d=Et.isLittleEndian?4278190080:255,[f,p]=c?[a,d]:[d,a],m=i>>3,x=i&7,b=u.length;t=new Uint32Array(t.buffer);let y=0;for(let A=0;A<r;A++){for(const S=e+m;e<S;e++){const N=e<b?u[e]:255;t[y++]=N&128?p:f,t[y++]=N&64?p:f,t[y++]=N&32?p:f,t[y++]=N&16?p:f,t[y++]=N&8?p:f,t[y++]=N&4?p:f,t[y++]=N&2?p:f,t[y++]=N&1?p:f}if(x===0)continue;const w=e<b?u[e++]:255;for(let S=0;S<x;S++)t[y++]=w&1<<7-S?p:f}return{srcPos:e,destPos:y}}const gf=16,xf=100,nv=15,vf=10,bf=1e3,Vt=16;function iv(u,e){if(u._removeMirroring)throw new Error("Context is already forwarding operations.");u.__originalSave=u.save,u.__originalRestore=u.restore,u.__originalRotate=u.rotate,u.__originalScale=u.scale,u.__originalTranslate=u.translate,u.__originalTransform=u.transform,u.__originalSetTransform=u.setTransform,u.__originalResetTransform=u.resetTransform,u.__originalClip=u.clip,u.__originalMoveTo=u.moveTo,u.__originalLineTo=u.lineTo,u.__originalBezierCurveTo=u.bezierCurveTo,u.__originalRect=u.rect,u.__originalClosePath=u.closePath,u.__originalBeginPath=u.beginPath,u._removeMirroring=()=>{u.save=u.__originalSave,u.restore=u.__originalRestore,u.rotate=u.__originalRotate,u.scale=u.__originalScale,u.translate=u.__originalTranslate,u.transform=u.__originalTransform,u.setTransform=u.__originalSetTransform,u.resetTransform=u.__originalResetTransform,u.clip=u.__originalClip,u.moveTo=u.__originalMoveTo,u.lineTo=u.__originalLineTo,u.bezierCurveTo=u.__originalBezierCurveTo,u.rect=u.__originalRect,u.closePath=u.__originalClosePath,u.beginPath=u.__originalBeginPath,delete u._removeMirroring},u.save=function(){e.save(),this.__originalSave()},u.restore=function(){e.restore(),this.__originalRestore()},u.translate=function(i,r){e.translate(i,r),this.__originalTranslate(i,r)},u.scale=function(i,r){e.scale(i,r),this.__originalScale(i,r)},u.transform=function(i,r,a,c,d,f){e.transform(i,r,a,c,d,f),this.__originalTransform(i,r,a,c,d,f)},u.setTransform=function(i,r,a,c,d,f){e.setTransform(i,r,a,c,d,f),this.__originalSetTransform(i,r,a,c,d,f)},u.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},u.rotate=function(i){e.rotate(i),this.__originalRotate(i)},u.clip=function(i){e.clip(i),this.__originalClip(i)},u.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},u.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},u.bezierCurveTo=function(t,i,r,a,c,d){e.bezierCurveTo(t,i,r,a,c,d),this.__originalBezierCurveTo(t,i,r,a,c,d)},u.rect=function(t,i,r,a){e.rect(t,i,r,a),this.__originalRect(t,i,r,a)},u.closePath=function(){e.closePath(),this.__originalClosePath()},u.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class rv{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,i)):(r=this.canvasFactory.create(t,i),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Ra(u,e,t,i,r,a,c,d,f,p){const[m,x,b,y,A,w]=He(u);if(x===0&&b===0){const C=c*m+A,R=Math.round(C),E=d*y+w,L=Math.round(E),T=(c+f)*m+A,I=Math.abs(Math.round(T)-R)||1,$=(d+p)*y+w,te=Math.abs(Math.round($)-L)||1;return u.setTransform(Math.sign(m),0,0,Math.sign(y),R,L),u.drawImage(e,t,i,r,a,0,0,I,te),u.setTransform(m,x,b,y,A,w),[I,te]}if(m===0&&y===0){const C=d*b+A,R=Math.round(C),E=c*x+w,L=Math.round(E),T=(d+p)*b+A,I=Math.abs(Math.round(T)-R)||1,$=(c+f)*x+w,te=Math.abs(Math.round($)-L)||1;return u.setTransform(0,Math.sign(x),Math.sign(b),0,R,L),u.drawImage(e,t,i,r,a,0,0,te,I),u.setTransform(m,x,b,y,A,w),[te,I]}u.drawImage(e,t,i,r,a,c,d,f,p);const S=Math.hypot(m,x),N=Math.hypot(b,y);return[S*f,N*p]}function av(u){const{width:e,height:t}=u;if(e>bf||t>bf)return null;const i=1e3,r=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),a=e+1;let c=new Uint8Array(a*(t+1)),d,f,p;const m=e+7&-8;let x=new Uint8Array(m*t),b=0;for(const N of u.data){let C=128;for(;C>0;)x[b++]=N&C?0:255,C>>=1}let y=0;for(b=0,x[b]!==0&&(c[0]=1,++y),f=1;f<e;f++)x[b]!==x[b+1]&&(c[f]=x[b]?2:1,++y),b++;for(x[b]!==0&&(c[f]=2,++y),d=1;d<t;d++){b=d*m,p=d*a,x[b-m]!==x[b]&&(c[p]=x[b]?1:8,++y);let N=(x[b]?4:0)+(x[b-m]?8:0);for(f=1;f<e;f++)N=(N>>2)+(x[b+1]?4:0)+(x[b-m+1]?8:0),r[N]&&(c[p+f]=r[N],++y),b++;if(x[b-m]!==x[b]&&(c[p+f]=x[b]?2:4,++y),y>i)return null}for(b=m*(t-1),p=d*a,x[b]!==0&&(c[p]=8,++y),f=1;f<e;f++)x[b]!==x[b+1]&&(c[p+f]=x[b]?4:8,++y),b++;if(x[b]!==0&&(c[p+f]=4,++y),y>i)return null;const A=new Int32Array([0,a,-1,0,-a,0,0,0,1]),w=new Path2D;for(d=0;y&&d<=t;d++){let N=d*a;const C=N+e;for(;N<C&&!c[N];)N++;if(N===C)continue;w.moveTo(N%a,d);const R=N;let E=c[N];do{const L=A[E];do N+=L;while(!c[N]);const T=c[N];T!==5&&T!==10?(E=T,c[N]=0):(E=T&51*E>>4,c[N]&=E>>2|E<<2),w.lineTo(N%a,N/a|0),c[N]||--y}while(R!==N);--d}return x=null,c=null,function(N){N.save(),N.scale(1/e,-1/t),N.translate(0,-t),N.fill(w),N.beginPath(),N.restore()}}class yf{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=Kf,this.textMatrixScale=1,this.fontMatrix=yc,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=xt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,i){[t,i]=me.applyTransform([t,i],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(e,t){const i=me.applyTransform(t,e),r=me.applyTransform(t.slice(2),e),a=me.applyTransform([t[0],t[3]],e),c=me.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,i[0],r[0],a[0],c[0]),this.minY=Math.min(this.minY,i[1],r[1],a[1],c[1]),this.maxX=Math.max(this.maxX,i[0],r[0],a[0],c[0]),this.maxY=Math.max(this.maxY,i[1],r[1],a[1],c[1])}updateScalingPathMinMax(e,t){me.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,i,r,a,c,d,f,p,m){const x=me.bezierBoundingBox(t,i,r,a,c,d,f,p,m);m||this.updateRectMinMax(e,x)}getPathBoundingBox(e=vt.FILL,t=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(e===vt.STROKE){t||De("Stroke bounding box must include transform.");const r=me.singularValueDecompose2dScale(t),a=r[0]*this.lineWidth/2,c=r[1]*this.lineWidth/2;i[0]-=a,i[1]-=c,i[2]+=a,i[3]+=c}return i}updateClipFromPath(){const e=me.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=vt.FILL,t=null){return me.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function wf(u,e){if(e instanceof ImageData){u.putImageData(e,0,0);return}const t=e.height,i=e.width,r=t%Vt,a=(t-r)/Vt,c=r===0?a:a+1,d=u.createImageData(i,Vt);let f=0,p;const m=e.data,x=d.data;let b,y,A,w;if(e.kind===Va.GRAYSCALE_1BPP){const S=m.byteLength,N=new Uint32Array(x.buffer,0,x.byteLength>>2),C=N.length,R=i+7>>3,E=4294967295,L=Et.isLittleEndian?4278190080:255;for(b=0;b<c;b++){for(A=b<a?Vt:r,p=0,y=0;y<A;y++){const T=S-f;let I=0;const $=T>R?i:T*8-7,te=$&-8;let ae=0,de=0;for(;I<te;I+=8)de=m[f++],N[p++]=de&128?E:L,N[p++]=de&64?E:L,N[p++]=de&32?E:L,N[p++]=de&16?E:L,N[p++]=de&8?E:L,N[p++]=de&4?E:L,N[p++]=de&2?E:L,N[p++]=de&1?E:L;for(;I<$;I++)ae===0&&(de=m[f++],ae=128),N[p++]=de&ae?E:L,ae>>=1}for(;p<C;)N[p++]=0;u.putImageData(d,0,b*Vt)}}else if(e.kind===Va.RGBA_32BPP){for(y=0,w=i*Vt*4,b=0;b<a;b++)x.set(m.subarray(f,f+w)),f+=w,u.putImageData(d,0,y),y+=Vt;b<c&&(w=i*r*4,x.set(m.subarray(f,f+w)),u.putImageData(d,0,y))}else if(e.kind===Va.RGB_24BPP)for(A=Vt,w=i*A,b=0;b<c;b++){for(b>=a&&(A=r,w=i*A),p=0,y=w;y--;)x[p++]=m[f++],x[p++]=m[f++],x[p++]=m[f++],x[p++]=255;u.putImageData(d,0,b*Vt)}else throw new Error(`bad image kind: ${e.kind}`)}function Af(u,e){if(e.bitmap){u.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,r=t%Vt,a=(t-r)/Vt,c=r===0?a:a+1,d=u.createImageData(i,Vt);let f=0;const p=e.data,m=d.data;for(let x=0;x<c;x++){const b=x<a?Vt:r;({srcPos:f}=sv({src:p,srcPos:f,dest:m,width:i,height:b,nonBlackColor:0})),u.putImageData(d,0,x*Vt)}}function sr(u,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)u[i]!==void 0&&(e[i]=u[i]);u.setLineDash!==void 0&&(e.setLineDash(u.getLineDash()),e.lineDashOffset=u.lineDashOffset)}function La(u){if(u.strokeStyle=u.fillStyle="#000000",u.fillRule="nonzero",u.globalAlpha=1,u.lineWidth=1,u.lineCap="butt",u.lineJoin="miter",u.miterLimit=10,u.globalCompositeOperation="source-over",u.font="10px sans-serif",u.setLineDash!==void 0&&(u.setLineDash([]),u.lineDashOffset=0),!bt){const{filter:e}=u;e!=="none"&&e!==""&&(u.filter="none")}}function _f(u,e){if(e)return!0;const t=me.singularValueDecompose2dScale(u);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*ri.PDF_TO_CSS_UNITS);return t[0]<=i&&t[1]<=i}const ov=["butt","round","square"],lv=["miter","round","bevel"],cv={},Sf={};class ei{constructor(e,t,i,r,a,{optionalContentConfig:c,markedContentStack:d=null},f,p){this.ctx=e,this.current=new yf(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=r,this.filterFactory=a,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=d||[],this.optionalContentConfig=c,this.cachedCanvases=new rv(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=f,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=p,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:r=null}){const a=this.ctx.canvas.width,c=this.ctx.canvas.height,d=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,a,c),this.ctx.fillStyle=d,i){const f=this.cachedCanvases.getCanvas("transparent",a,c);this.compositeCtx=this.ctx,this.transparentCanvas=f.canvas,this.ctx=f.context,this.ctx.save(),this.ctx.transform(...He(this.compositeCtx))}this.ctx.save(),La(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=He(this.ctx)}executeOperatorList(e,t,i,r){const a=e.argsArray,c=e.fnArray;let d=t||0;const f=a.length;if(f===d)return d;const p=f-d>vf&&typeof i=="function",m=p?Date.now()+nv:0;let x=0;const b=this.commonObjs,y=this.objs;let A;for(;;){if(r!==void 0&&d===r.nextBreakPoint)return r.breakIt(d,i),d;if(A=c[d],A!==as.dependency)this[A].apply(this,a[d]);else for(const w of a[d]){const S=w.startsWith("g_")?b:y;if(!S.has(w))return S.get(w,i),d}if(d++,d===f)return d;if(p&&++x>vf){if(Date.now()>m)return i(),d;x=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const i=e.width??e.displayWidth,r=e.height??e.displayHeight;let a=Math.max(Math.hypot(t[0],t[1]),1),c=Math.max(Math.hypot(t[2],t[3]),1),d=i,f=r,p="prescale1",m,x;for(;a>2&&d>1||c>2&&f>1;){let b=d,y=f;a>2&&d>1&&(b=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d/2),a/=d/b),c>2&&f>1&&(y=f>=16384?Math.floor(f/2)-1||1:Math.ceil(f)/2,c/=f/y),m=this.cachedCanvases.getCanvas(p,b,y),x=m.context,x.clearRect(0,0,b,y),x.drawImage(e,0,0,d,f,0,0,b,y),e=m.canvas,d=b,f=y,p=p==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:d,paintHeight:f}}_createMaskCanvas(e){const t=this.ctx,{width:i,height:r}=e,a=this.current.fillColor,c=this.current.patternFill,d=He(t);let f,p,m,x;if((e.bitmap||e.data)&&e.count>1){const $=e.bitmap||e.data.buffer;p=JSON.stringify(c?d:[d.slice(0,4),a]),f=this._cachedBitmapsMap.get($),f||(f=new Map,this._cachedBitmapsMap.set($,f));const te=f.get(p);if(te&&!c){const ae=Math.round(Math.min(d[0],d[2])+d[4]),de=Math.round(Math.min(d[1],d[3])+d[5]);return{canvas:te,offsetX:ae,offsetY:de}}m=te}m||(x=this.cachedCanvases.getCanvas("maskCanvas",i,r),Af(x.context,e));let b=me.transform(d,[1/i,0,0,-1/r,0,0]);b=me.transform(b,[1,0,0,1,0,-r]);const[y,A,w,S]=me.getAxialAlignedBoundingBox([0,0,i,r],b),N=Math.round(w-y)||1,C=Math.round(S-A)||1,R=this.cachedCanvases.getCanvas("fillCanvas",N,C),E=R.context,L=y,T=A;E.translate(-L,-T),E.transform(...b),m||(m=this._scaleImage(x.canvas,ps(E)),m=m.img,f&&c&&f.set(p,m)),E.imageSmoothingEnabled=_f(He(E),e.interpolate),Ra(E,m,0,0,m.width,m.height,0,0,i,r),E.globalCompositeOperation="source-in";const I=me.transform(ps(E),[1,0,0,1,-L,-T]);return E.fillStyle=c?a.getPattern(t,this,I,vt.FILL):a,E.fillRect(0,0,i,r),f&&!c&&(this.cachedCanvases.delete("fillCanvas"),f.set(p,R.canvas)),{canvas:R.canvas,offsetX:Math.round(L),offsetY:Math.round(T)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=ov[e]}setLineJoin(e){this.ctx.lineJoin=lv[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,i]of e)switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(i,e,t);this.suspendedCtx=this.ctx,this.ctx=r.context;const a=this.ctx;a.setTransform(...He(this.suspendedCtx)),sr(this.suspendedCtx,a),iv(a,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),sr(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,r){const a=r[0],c=r[1],d=r[2]-a,f=r[3]-c;d===0||f===0||(this.genericComposeSMask(t.context,i,d,f,t.subtype,t.backdrop,t.transferMap,a,c,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,r,a,c,d,f,p,m,x){let b=e.canvas,y=f-m,A=p-x;if(c){const S=me.makeHexColor(...c);if(y<0||A<0||y+i>b.width||A+r>b.height){const N=this.cachedCanvases.getCanvas("maskExtension",i,r),C=N.context;C.drawImage(b,-y,-A),C.globalCompositeOperation="destination-atop",C.fillStyle=S,C.fillRect(0,0,i,r),C.globalCompositeOperation="source-over",b=N.canvas,y=A=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const N=new Path2D;N.rect(y,A,i,r),e.clip(N),e.globalCompositeOperation="destination-atop",e.fillStyle=S,e.fillRect(y,A,i,r),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),a==="Alpha"&&d?t.filter=this.filterFactory.addAlphaFilter(d):a==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(d));const w=new Path2D;w.rect(f,p,i,r),t.clip(w),t.globalCompositeOperation="destination-in",t.drawImage(b,y,A,i,r,f,p,i,r),t.restore()}save(){this.inSMaskMode?(sr(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),sr(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,i,r,a,c){this.ctx.transform(e,t,i,r,a,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i){const r=this.ctx,a=this.current;let c=a.x,d=a.y,f,p;const m=He(r),x=m[0]===0&&m[3]===0||m[1]===0&&m[2]===0,b=x?i.slice(0):null;for(let y=0,A=0,w=e.length;y<w;y++)switch(e[y]|0){case as.rectangle:c=t[A++],d=t[A++];const S=t[A++],N=t[A++],C=c+S,R=d+N;r.moveTo(c,d),S===0||N===0?r.lineTo(C,R):(r.lineTo(C,d),r.lineTo(C,R),r.lineTo(c,R)),x||a.updateRectMinMax(m,[c,d,C,R]),r.closePath();break;case as.moveTo:c=t[A++],d=t[A++],r.moveTo(c,d),x||a.updatePathMinMax(m,c,d);break;case as.lineTo:c=t[A++],d=t[A++],r.lineTo(c,d),x||a.updatePathMinMax(m,c,d);break;case as.curveTo:f=c,p=d,c=t[A+4],d=t[A+5],r.bezierCurveTo(t[A],t[A+1],t[A+2],t[A+3],c,d),a.updateCurvePathMinMax(m,f,p,t[A],t[A+1],t[A+2],t[A+3],c,d,b),A+=6;break;case as.curveTo2:f=c,p=d,r.bezierCurveTo(c,d,t[A],t[A+1],t[A+2],t[A+3]),a.updateCurvePathMinMax(m,f,p,c,d,t[A],t[A+1],t[A+2],t[A+3],b),c=t[A+2],d=t[A+3],A+=4;break;case as.curveTo3:f=c,p=d,c=t[A+2],d=t[A+3],r.bezierCurveTo(t[A],t[A+1],c,d,c,d),a.updateCurvePathMinMax(m,f,p,t[A],t[A+1],c,d,c,d,b),A+=4;break;case as.closePath:r.closePath();break}x&&a.updateScalingPathMinMax(m,b),a.setCurrentPoint(c,d)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,i=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&i?.getPattern?(t.save(),t.strokeStyle=i.getPattern(t,this,ps(t),vt.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,i=this.current.fillColor,r=this.current.patternFill;let a=!1;r&&(t.save(),t.fillStyle=i.getPattern(t,this,ps(t),vt.FILL),a=!0);const c=this.current.getClippedPathBoundingBox();this.contentVisible&&c!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),a&&t.restore(),e&&this.consumePath(c)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=cv}eoClip(){this.pendingClip=Sf}beginText(){this.current.textMatrix=Kf,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const i=new Path2D,r=t.getTransform().invertSelf();for(const{transform:a,x:c,y:d,fontSize:f,path:p}of e)i.addPath(p,new DOMMatrix(a).preMultiplySelf(r).translate(c,d).scale(f,-f));t.clip(i),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const i=this.commonObjs.get(e),r=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=i.fontMatrix||yc,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&Ee("Invalid font matrix for font "+e),t<0?(t=-t,r.fontDirection=-1):r.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const a=i.loadedName||"sans-serif",c=i.systemFontInfo?.css||`"${a}", ${i.fallbackName}`;let d="normal";i.black?d="900":i.bold&&(d="bold");const f=i.italic?"italic":"normal";let p=t;t<gf?p=gf:t>xf&&(p=xf),this.current.fontSizeScale=t/p,this.ctx.font=`${f} ${d} ${p}px ${c}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,i,r,a,c){this.current.textMatrix=[e,t,i,r,a,c],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#s(e,t,i){const r=new Path2D;return r.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),r}paintChar(e,t,i,r,a){const c=this.ctx,d=this.current,f=d.font,p=d.textRenderingMode,m=d.fontSize/d.fontSizeScale,x=p&xt.FILL_STROKE_MASK,b=!!(p&xt.ADD_TO_PATH_FLAG),y=d.patternFill&&!f.missingFile,A=d.patternStroke&&!f.missingFile;let w;if((f.disableFontFace||b||y||A)&&(w=f.getPathGenerator(this.commonObjs,e)),f.disableFontFace||y||A){if(c.save(),c.translate(t,i),c.scale(m,-m),x===xt.FILL||x===xt.FILL_STROKE)if(r){const S=c.getTransform();c.setTransform(...r),c.fill(this.#s(w,S,r))}else c.fill(w);if(x===xt.STROKE||x===xt.FILL_STROKE)if(a){const S=c.getTransform();c.setTransform(...a),c.stroke(this.#s(w,S,a))}else c.lineWidth/=m,c.stroke(w);c.restore()}else(x===xt.FILL||x===xt.FILL_STROKE)&&c.fillText(e,t,i),(x===xt.STROKE||x===xt.FILL_STROKE)&&c.strokeText(e,t,i);b&&(this.pendingTextPaths||=[]).push({transform:He(c),x:t,y:i,fontSize:m,path:w})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){i=!0;break}return Ce(this,"isFontSubpixelAAEnabled",i)}showText(e){const t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(e);const r=t.fontSize;if(r===0)return;const a=this.ctx,c=t.fontSizeScale,d=t.charSpacing,f=t.wordSpacing,p=t.fontDirection,m=t.textHScale*p,x=e.length,b=i.vertical,y=b?1:-1,A=i.defaultVMetrics,w=r*t.fontMatrix[0],S=t.textRenderingMode===xt.FILL&&!i.disableFontFace&&!t.patternFill;a.save(),a.transform(...t.textMatrix),a.translate(t.x,t.y+t.textRise),p>0?a.scale(m,-1):a.scale(m,1);let N,C;if(t.patternFill){a.save();const I=t.fillColor.getPattern(a,this,ps(a),vt.FILL);N=He(a),a.restore(),a.fillStyle=I}if(t.patternStroke){a.save();const I=t.strokeColor.getPattern(a,this,ps(a),vt.STROKE);C=He(a),a.restore(),a.strokeStyle=I}let R=t.lineWidth;const E=t.textMatrixScale;if(E===0||R===0){const I=t.textRenderingMode&xt.FILL_STROKE_MASK;(I===xt.STROKE||I===xt.FILL_STROKE)&&(R=this.getSinglePixelWidth())}else R/=E;if(c!==1&&(a.scale(c,c),R/=c),a.lineWidth=R,i.isInvalidPDFjsFont){const I=[];let $=0;for(const te of e)I.push(te.unicode),$+=te.width;a.fillText(I.join(""),0,0),t.x+=$*w*m,a.restore(),this.compose();return}let L=0,T;for(T=0;T<x;++T){const I=e[T];if(typeof I=="number"){L+=y*I*r/1e3;continue}let $=!1;const te=(I.isSpace?f:0)+d,ae=I.fontChar,de=I.accent;let Ae,pe,be=I.width;if(b){const X=I.vmetric||A,Z=-(I.vmetric?X[1]:be*.5)*w,q=X[2]*w;be=X?-X[0]:be,Ae=Z/c,pe=(L+q)/c}else Ae=L/c,pe=0;if(i.remeasure&&be>0){const X=a.measureText(ae).width*1e3/r*c;if(be<X&&this.isFontSubpixelAAEnabled){const Z=be/X;$=!0,a.save(),a.scale(Z,1),Ae/=Z}else be!==X&&(Ae+=(be-X)/2e3*r/c)}if(this.contentVisible&&(I.isInFont||i.missingFile)){if(S&&!de)a.fillText(ae,Ae,pe);else if(this.paintChar(ae,Ae,pe,N,C),de){const X=Ae+r*de.offset.x/c,Z=pe-r*de.offset.y/c;this.paintChar(de.fontChar,X,Z,N,C)}}const ke=b?be*w-te*p:be*w+te*p;L+=ke,$&&a.restore()}b?t.y-=L:t.x+=L*m,a.restore(),this.compose()}showType3Text(e){const t=this.ctx,i=this.current,r=i.font,a=i.fontSize,c=i.fontDirection,d=r.vertical?1:-1,f=i.charSpacing,p=i.wordSpacing,m=i.textHScale*c,x=i.fontMatrix||yc,b=e.length,y=i.textRenderingMode===xt.INVISIBLE;let A,w,S,N;if(!(y||a===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...i.textMatrix),t.translate(i.x,i.y),t.scale(m,c),A=0;A<b;++A){if(w=e[A],typeof w=="number"){N=d*w*a/1e3,this.ctx.translate(N,0),i.x+=N*m;continue}const C=(w.isSpace?p:0)+f,R=r.charProcOperatorList[w.operatorListId];if(!R){Ee(`Type3 character "${w.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=w,this.save(),t.scale(a,a),t.transform(...x),this.executeOperatorList(R),this.restore()),S=me.applyTransform([w.width,0],x)[0]*a+C,t.translate(S,0),i.x+=S*m}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,i,r,a,c){this.ctx.rect(i,r,a-i,c-r),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const i=e[1],r=this.baseTransform||He(this.ctx),a={createCanvasGraphics:c=>new ei(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new $c(e,i,this.ctx,a,r)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,i){this.ctx.strokeStyle=this.current.strokeColor=me.makeHexColor(e,t,i),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,i){this.ctx.fillStyle=this.current.fillColor=me.makeHexColor(e,t,i),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=tv(this.getObject(e)),this.cachedPatterns.set(e,i)),t&&(i.matrix=t),i}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const i=this._getPattern(e);t.fillStyle=i.getPattern(t,this,ps(t),vt.SHADING);const r=ps(t);if(r){const{width:a,height:c}=t.canvas,[d,f,p,m]=me.getAxialAlignedBoundingBox([0,0,a,c],r);this.ctx.fillRect(d,f,p-d,m-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){De("Should not call beginInlineImage")}beginImageData(){De("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=He(this.ctx),t)){const i=t[2]-t[0],r=t[3]-t[1];this.ctx.rect(t[0],t[1],i,r),this.current.updateRectMinMax(He(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Ka("TODO: Support non-isolated groups."),e.knockout&&Ee("Knockout groups not supported.");const i=He(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=me.getAxialAlignedBoundingBox(e.bbox,He(t));const a=[0,0,t.canvas.width,t.canvas.height];r=me.intersect(r,a)||[0,0,0,0];const c=Math.floor(r[0]),d=Math.floor(r[1]),f=Math.max(Math.ceil(r[2])-c,1),p=Math.max(Math.ceil(r[3])-d,1);this.current.startNewPathAndClipBox([0,0,f,p]);let m="groupAt"+this.groupLevel;e.smask&&(m+="_smask_"+this.smaskCounter++%2);const x=this.cachedCanvases.getCanvas(m,f,p),b=x.context;b.translate(-c,-d),b.transform(...i),e.smask?this.smaskStack.push({canvas:x.canvas,context:b,offsetX:c,offsetY:d,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(c,d),t.save()),sr(t,b),this.ctx=b,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const r=He(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...r);const a=me.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],r);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(a)}}beginAnnotation(e,t,i,r,a){if(this.#e(),La(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const c=t[2]-t[0],d=t[3]-t[1];if(a&&this.annotationCanvasMap){i=i.slice(),i[4]-=t[0],i[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=c,t[3]=d;const[f,p]=me.singularValueDecompose2dScale(He(this.ctx)),{viewportScale:m}=this,x=Math.ceil(c*this.outputScaleX*m),b=Math.ceil(d*this.outputScaleY*m);this.annotationCanvas=this.canvasFactory.create(x,b);const{canvas:y,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(e,y),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(f,0,0,-p,0,d*p),La(this.ctx)}else La(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],c,d),this.ctx.clip(),this.ctx.beginPath()}this.current=new yf(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...r)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const i=this.ctx,r=this.processingType3;if(r&&(r.compiled===void 0&&(r.compiled=av(e)),r.compiled)){r.compiled(i);return}const a=this._createMaskCanvas(e),c=a.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(c,a.offsetX,a.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i=0,r=0,a,c){if(!this.contentVisible)return;e=this.getObject(e.data,e);const d=this.ctx;d.save();const f=He(d);d.transform(t,i,r,a,0,0);const p=this._createMaskCanvas(e);d.setTransform(1,0,0,1,p.offsetX-f[4],p.offsetY-f[5]);for(let m=0,x=c.length;m<x;m+=2){const b=me.transform(f,[t,i,r,a,c[m],c[m+1]]),[y,A]=me.applyTransform([0,0],b);d.drawImage(p.canvas,y,A)}d.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,i=this.current.fillColor,r=this.current.patternFill;for(const a of e){const{data:c,width:d,height:f,transform:p}=a,m=this.cachedCanvases.getCanvas("maskCanvas",d,f),x=m.context;x.save();const b=this.getObject(c,a);Af(x,b),x.globalCompositeOperation="source-in",x.fillStyle=r?i.getPattern(x,this,ps(t),vt.FILL):i,x.fillRect(0,0,d,f),x.restore(),t.save(),t.transform(...p),t.scale(1,-1),Ra(t,m.canvas,0,0,d,f,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Ee("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,i,r){if(!this.contentVisible)return;const a=this.getObject(e);if(!a){Ee("Dependent image isn't ready yet");return}const c=a.width,d=a.height,f=[];for(let p=0,m=r.length;p<m;p+=2)f.push({transform:[t,0,0,i,r[p],r[p+1]],x:0,y:0,w:c,h:d});this.paintInlineImageXObjectGroup(a,f)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:r}=e,a=this.cachedCanvases.getCanvas("inlineImage",i,r),c=a.context;return c.filter=this.current.transferMaps,c.drawImage(t,0,0),c.filter="none",a.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,i=e.height,r=this.ctx;if(this.save(),!bt){const{filter:d}=r;d!=="none"&&d!==""&&(r.filter="none")}r.scale(1/t,-1/i);let a;if(e.bitmap)a=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)a=e;else{const f=this.cachedCanvases.getCanvas("inlineImage",t,i).context;wf(f,e),a=this.applyTransferMapsToCanvas(f)}const c=this._scaleImage(a,ps(r));r.imageSmoothingEnabled=_f(He(r),e.interpolate),Ra(r,c.img,0,0,c.paintWidth,c.paintHeight,0,-i,t,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const i=this.ctx;let r;if(e.bitmap)r=e.bitmap;else{const a=e.width,c=e.height,f=this.cachedCanvases.getCanvas("inlineImage",a,c).context;wf(f,e),r=this.applyTransferMapsToCanvas(f)}for(const a of t)i.save(),i.transform(...a.transform),i.scale(1,-1),Ra(i,r,a.x,a.y,a.w,a.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const i=this.ctx;this.pendingClip&&(t||(this.pendingClip===Sf?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=He(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:r,d:a}=this.ctx.getTransform();let c,d;if(i===0&&r===0){const f=Math.abs(t),p=Math.abs(a);if(f===p)if(e===0)c=d=1/f;else{const m=f*e;c=d=m<1?1/m:1}else if(e===0)c=1/f,d=1/p;else{const m=f*e,x=p*e;c=m<1?1/m:1,d=x<1?1/x:1}}else{const f=Math.abs(t*a-i*r),p=Math.hypot(t,i),m=Math.hypot(r,a);if(e===0)c=m/f,d=p/f;else{const x=e*f;c=m>x?m/x:1,d=p>x?p/x:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=d}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:i}=this.current,[r,a]=this.getScaleForStroking();if(t.lineWidth=i||1,r===1&&a===1){t.stroke();return}const c=t.getLineDash();if(e&&t.save(),t.scale(r,a),c.length>0){const d=Math.max(r,a);t.setLineDash(c.map(f=>f/d)),t.lineDashOffset/=d}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const u in as)ei.prototype[u]!==void 0&&(ei.prototype[as[u]]=ei.prototype[u]);class dr{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class dv{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}getAll(){return Vc(this.#e)}has(e){return this.#e.has(e)}}const Jn=Symbol("INTERNAL");class uv{#e=!1;#t=!1;#s=!1;#n=!0;constructor(e,{name:t,intent:i,usage:r,rbGroups:a}){this.#e=!!(e&zt.DISPLAY),this.#t=!!(e&zt.PRINT),this.name=t,this.intent=i,this.usage=r,this.rbGroups=a}get visible(){if(this.#s)return this.#n;if(!this.#n)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,i=!1){e!==Jn&&De("Internal method `_setVisible` called."),this.#s=i,this.#n=t}}class hv{#e=null;#t=new Map;#s=null;#n=null;constructor(e,t=zt.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#n=e.order;for(const i of e.groups)this.#t.set(i.id,new uv(t,i));if(e.baseState==="OFF")for(const i of this.#t.values())i._setVisible(Jn,!1);for(const i of e.on)this.#t.get(i)._setVisible(Jn,!0);for(const i of e.off)this.#t.get(i)._setVisible(Jn,!1);this.#s=this.getHash()}}#r(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let r=1;r<t;r++){const a=e[r];let c;if(Array.isArray(a))c=this.#r(a);else if(this.#t.has(a))c=this.#t.get(a).visible;else return Ee(`Optional content group not found: ${a}`),!0;switch(i){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return i==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return Ka("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(Ee(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#r(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return Ee(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return Ee(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return Ee(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return Ee(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return Ee(`Unknown optional content policy ${e.policy}.`),!0}return Ee(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){const r=this.#t.get(e);if(!r){Ee(`Optional content group not found: ${e}`);return}if(i&&t&&r.rbGroups.length)for(const a of r.rbGroups)for(const c of a)c!==e&&this.#t.get(c)?._setVisible(Jn,!1,!0);r._setVisible(Jn,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let i;for(const r of e){switch(r){case"ON":case"OFF":case"Toggle":i=r;continue}const a=this.#t.get(r);if(a)switch(i){case"ON":this.setVisibility(r,!0,t);break;case"OFF":this.setVisibility(r,!1,t);break;case"Toggle":this.setVisibility(r,!a.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#s===null||this.getHash()===this.#s}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?Vc(this.#t):null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new Zf;for(const[t,i]of this.#t)e.update(`${t}:${i.visible}`);return this.#e=e.hexdigest()}}class fv{constructor(e,{disableRange:t=!1,disableStream:i=!1}){tt(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:a,progressiveDone:c,contentDispositionFilename:d}=e;if(this._queuedChunks=[],this._progressiveDone=c,this._contentDispositionFilename=d,a?.length>0){const f=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(f)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((f,p)=>{this._onReceiveData({begin:f,chunk:p})}),e.addProgressListener((f,p)=>{this._onProgress({loaded:f,total:p})}),e.addProgressiveReadListener(f=>{this._onReceiveData({chunk:f})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const r=this._rangeReaders.some(function(a){return a._begin!==e?!1:(a._enqueue(i),!0)});tt(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){tt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new pv(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new mv(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class pv{constructor(e,t,i=!1,r=null){this._stream=e,this._done=i||!1,this._filename=Fc(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class mv{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function gv(u){let e=!0,t=i("filename\\*","i").exec(u);if(t){t=t[1];let m=d(t);return m=unescape(m),m=f(m),m=p(m),a(m)}if(t=c(u),t){const m=p(t);return a(m)}if(t=i("filename","i").exec(u),t){t=t[1];let m=d(t);return m=p(m),a(m)}function i(m,x){return new RegExp("(?:^|;)\\s*"+m+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',x)}function r(m,x){if(m){if(!/^[\x00-\xFF]+$/.test(x))return x;try{const b=new TextDecoder(m,{fatal:!0}),y=Qa(x);x=b.decode(y),e=!1}catch{}}return x}function a(m){return e&&/[\x80-\xff]/.test(m)&&(m=r("utf-8",m),e&&(m=r("iso-8859-1",m))),m}function c(m){const x=[];let b;const y=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=y.exec(m))!==null;){let[,w,S,N]=b;if(w=parseInt(w,10),w in x){if(w===0)break;continue}x[w]=[S,N]}const A=[];for(let w=0;w<x.length&&w in x;++w){let[S,N]=x[w];N=d(N),S&&(N=unescape(N),w===0&&(N=f(N))),A.push(N)}return A.join("")}function d(m){if(m.startsWith('"')){const x=m.slice(1).split('\\"');for(let b=0;b<x.length;++b){const y=x[b].indexOf('"');y!==-1&&(x[b]=x[b].slice(0,y),x.length=b+1),x[b]=x[b].replaceAll(/\\(.)/g,"$1")}m=x.join('"')}return m}function f(m){const x=m.indexOf("'");if(x===-1)return m;const b=m.slice(0,x),A=m.slice(x+1).replace(/^[^']*'/,"");return r(b,A)}function p(m){return!m.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(m)?m:m.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(x,b,y,A){if(y==="q"||y==="Q")return A=A.replaceAll("_"," "),A=A.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,S){return String.fromCharCode(parseInt(S,16))}),r(b,A);try{A=atob(A)}catch{}return r(b,A)})}return""}function lp(u,e){const t=new Headers;if(!u||!e||typeof e!="object")return t;for(const i in e){const r=e[i];r!==void 0&&t.append(i,r)}return t}function to(u){try{return new URL(u).origin}catch{}return null}function cp({responseHeaders:u,isHttp:e,rangeChunkSize:t,disableRange:i}){const r={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(u.get("Content-Length"),10);return!Number.isInteger(a)||(r.suggestedLength=a,a<=2*t)||i||!e||u.get("Accept-Ranges")!=="bytes"||(u.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function dp(u){const e=u.get("Content-Disposition");if(e){let t=gv(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Fc(t))return t}return null}function so(u,e){return u===404||u===0&&e.startsWith("file:")?new fr('Missing PDF "'+e+'".'):new Ua(`Unexpected server response (${u}) while retrieving PDF "${e}".`,u)}function up(u){return u===200||u===206}function hp(u,e,t){return{method:"GET",headers:u,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function fp(u){return u instanceof Uint8Array?u.buffer:u instanceof ArrayBuffer?u:(Ee(`getArrayBuffer - unexpected data format: ${u}`),new Uint8Array(u).buffer)}class Nf{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=lp(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return tt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new xv(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new vv(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class xv{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const i=new Headers(e.headers),r=t.url;fetch(r,hp(i,this._withCredentials,this._abortController)).then(a=>{if(e._responseOrigin=to(a.url),!up(a.status))throw so(a.status,r);this._reader=a.body.getReader(),this._headersCapability.resolve();const c=a.headers,{allowRangeRequests:d,suggestedLength:f}=cp({responseHeaders:c,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=d,this._contentLength=f||this._contentLength,this._filename=dp(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new en("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:fp(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class vv{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;const r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const a=new Headers(e.headers);a.append("Range",`bytes=${t}-${i-1}`);const c=r.url;fetch(c,hp(a,this._withCredentials,this._abortController)).then(d=>{const f=to(d.url);if(f!==e._responseOrigin)throw new Error(`Expected range response-origin "${f}" to match "${e._responseOrigin}".`);if(!up(d.status))throw so(d.status,c);this._readCapability.resolve(),this._reader=d.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:fp(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const uc=200,hc=206;function bv(u){const e=u.response;return typeof e!="string"?e:Qa(e).buffer}class yv{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:i}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=lp(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,i=this.currXhrId++,r=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[a,c]of this.headers)t.setRequestHeader(a,c);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=hc):r.expectedStatus=uc,t.responseType="arraybuffer",tt(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){const i=this.pendingRequests[e];i&&i.onProgress?.(t)}onStateChange(e,t){const i=this.pendingRequests[e];if(!i)return;const r=i.xhr;if(r.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){i.onError(r.status);return}const a=r.status||uc;if(!(a===uc&&i.expectedStatus===hc)&&a!==i.expectedStatus){i.onError(r.status);return}const d=bv(r);if(a===hc){const f=r.getResponseHeader("Content-Range"),p=/bytes (\d+)-(\d+)\/(\d+)/.exec(f);p?i.onDone({begin:parseInt(p[1],10),chunk:d}):(Ee('Missing or invalid "Content-Range" header.'),i.onError(0))}else d?i.onDone({begin:0,chunk:d}):i.onError(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class wv{constructor(e){this._source=e,this._manager=new yv(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return tt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Av(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const i=new _v(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class Av{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=to(t.responseURL);const i=t.getAllResponseHeaders(),r=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(d=>{const[f,...p]=d.split(": ");return[f,p.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:c}=cp({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=dp(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=so(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class _v{constructor(e,t,i){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=to(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=so(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Sv=/^[a-z][a-z0-9\-+.]+:/i;function Nv(u){if(Sv.test(u))return new URL(u);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(u))}class Ev{constructor(e){this.source=e,this.url=Nv(e.url),tt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return tt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new kv(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new jv(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class kv{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=new fr(`Missing PDF "${this._url}".`)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new en("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class jv{constructor(e,t,i){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=e.source;this._isStreamingSupported=!r.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:t,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Cv=1e5,Lt=30,Tv=.8;class Nt{#e=Promise.withResolvers();#t=null;#s=!1;#n=!!globalThis.FontInspector?.enabled;#r=null;#i=null;#l=0;#o=0;#d=null;#c=null;#h=0;#u=0;#f=Object.create(null);#a=[];#p=null;#g=[];#m=new WeakMap;#x=null;static#y=new Map;static#v=new Map;static#w=new WeakMap;static#_=null;static#N=new Set;constructor({textContentSource:e,container:t,viewport:i}){if(e instanceof ReadableStream)this.#p=e;else if(typeof e=="object")this.#p=new ReadableStream({start(f){f.enqueue(e),f.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#c=t,this.#u=i.scale*(globalThis.devicePixelRatio||1),this.#h=i.rotation,this.#i={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:a,pageX:c,pageY:d}=i.rawDims;this.#x=[1,0,0,-1,-c,d+a],this.#o=r,this.#l=a,Nt.#P(),_n(t,i),this.#e.promise.finally(()=>{Nt.#N.delete(this),this.#i=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Et.platform;return Ce(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#d.read().then(({value:t,done:i})=>{if(i){this.#e.resolve();return}this.#r??=t.lang,Object.assign(this.#f,t.styles),this.#k(t.items),e()},this.#e.reject)};return this.#d=this.#p.getReader(),Nt.#N.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const i=e.scale*(globalThis.devicePixelRatio||1),r=e.rotation;if(r!==this.#h&&(t?.(),this.#h=r,_n(this.#c,{rotation:r})),i!==this.#u){t?.(),this.#u=i;const a={div:null,properties:null,ctx:Nt.#j(this.#r)};for(const c of this.#g)a.properties=this.#m.get(c),a.div=c,this.#A(a)}}cancel(){const e=new en("TextLayer task cancelled.");this.#d?.cancel(e).catch(()=>{}),this.#d=null,this.#e.reject(e)}get textDivs(){return this.#g}get textContentItemsStr(){return this.#a}#k(e){if(this.#s)return;this.#i.ctx??=Nt.#j(this.#r);const t=this.#g,i=this.#a;for(const r of e){if(t.length>Cv){Ee("Ignoring additional textDivs for performance reasons."),this.#s=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const a=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),r.id!==null&&this.#t.setAttribute("id",`${r.id}`),a.append(this.#t)}else r.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}i.push(r.str),this.#C(r)}}#C(e){const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#g.push(t);const r=me.transform(this.#x,e.transform);let a=Math.atan2(r[1],r[0]);const c=this.#f[e.fontName];c.vertical&&(a+=Math.PI/2);let d=this.#n&&c.fontSubstitution||c.fontFamily;d=Nt.fontFamilyMap.get(d)||d;const f=Math.hypot(r[2],r[3]),p=f*Nt.#M(d,this.#r);let m,x;a===0?(m=r[4],x=r[5]-p):(m=r[4]+p*Math.sin(a),x=r[5]-p*Math.cos(a));const b="calc(var(--scale-factor)*",y=t.style;this.#t===this.#c?(y.left=`${(100*m/this.#o).toFixed(2)}%`,y.top=`${(100*x/this.#l).toFixed(2)}%`):(y.left=`${b}${m.toFixed(2)}px)`,y.top=`${b}${x.toFixed(2)}px)`),y.fontSize=`${b}${(Nt.#_*f).toFixed(2)}px)`,y.fontFamily=d,i.fontSize=f,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#n&&(t.dataset.fontName=c.fontSubstitutionLoadedName||e.fontName),a!==0&&(i.angle=a*(180/Math.PI));let A=!1;if(e.str.length>1)A=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const w=Math.abs(e.transform[0]),S=Math.abs(e.transform[3]);w!==S&&Math.max(w,S)/Math.min(w,S)>1.5&&(A=!0)}if(A&&(i.canvasWidth=c.vertical?e.height:e.width),this.#m.set(t,i),this.#i.div=t,this.#i.properties=i,this.#A(this.#i),i.hasText&&this.#t.append(t),i.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),this.#t.append(w)}}#A(e){const{div:t,properties:i,ctx:r}=e,{style:a}=t;let c="";if(Nt.#_>1&&(c=`scale(${1/Nt.#_})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:d}=a,{canvasWidth:f,fontSize:p}=i;Nt.#E(r,p*this.#u,d);const{width:m}=r.measureText(t.textContent);m>0&&(c=`scaleX(${f*this.#u/m}) ${c}`)}i.angle!==0&&(c=`rotate(${i.angle}deg) ${c}`),c.length>0&&(a.transform=c)}static cleanup(){if(!(this.#N.size>0)){this.#y.clear();for(const{canvas:e}of this.#v.values())e.remove();this.#v.clear()}}static#j(e=null){let t=this.#v.get(e||="");if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#v.set(e,t),this.#w.set(t,{size:0,family:""})}return t}static#E(e,t,i){const r=this.#w.get(e);t===r.size&&i===r.family||(e.font=`${t}px ${i}`,r.size=t,r.family=i)}static#P(){if(this.#_!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#_=e.getBoundingClientRect().height,e.remove()}static#M(e,t){const i=this.#y.get(e);if(i)return i;const r=this.#j(t);r.canvas.width=r.canvas.height=Lt,this.#E(r,Lt,e);const a=r.measureText("");let c=a.fontBoundingBoxAscent,d=Math.abs(a.fontBoundingBoxDescent);if(c){const m=c/(c+d);return this.#y.set(e,m),r.canvas.width=r.canvas.height=0,m}r.strokeStyle="red",r.clearRect(0,0,Lt,Lt),r.strokeText("g",0,0);let f=r.getImageData(0,0,Lt,Lt).data;d=0;for(let m=f.length-1-3;m>=0;m-=4)if(f[m]>0){d=Math.ceil(m/4/Lt);break}r.clearRect(0,0,Lt,Lt),r.strokeText("A",0,Lt),f=r.getImageData(0,0,Lt,Lt).data,c=0;for(let m=0,x=f.length;m<x;m+=4)if(f[m]>0){c=Lt-Math.floor(m/4/Lt);break}r.canvas.width=r.canvas.height=0;const p=c?c/(c+d):Tv;return this.#y.set(e,p),p}}class pr{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function r(a){if(!a)return;let c=null;const d=a.name;if(d==="#text")c=a.value;else if(pr.shouldBuildText(d))a?.attributes?.textContent?c=a.attributes.textContent:a.value&&(c=a.value);else return;if(c!==null&&t.push({str:c}),!!a.children)for(const f of a.children)r(f)}return r(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const Pv=65536,Rv=100,Lv=5e3,Mv=bt?X0:G0,Vv=bt?Y0:np,Iv=bt?q0:W0,Dv=bt?K0:ap;function Fv(u={}){typeof u=="string"||u instanceof URL?u={url:u}:(u instanceof ArrayBuffer||ArrayBuffer.isView(u))&&(u={data:u});const e=new Gc,{docId:t}=e,i=u.url?Ov(u.url):null,r=u.data?zv(u.data):null,a=u.httpHeaders||null,c=u.withCredentials===!0,d=u.password??null,f=u.range instanceof pp?u.range:null,p=Number.isInteger(u.rangeChunkSize)&&u.rangeChunkSize>0?u.rangeChunkSize:Pv;let m=u.worker instanceof ti?u.worker:null;const x=u.verbosity,b=typeof u.docBaseUrl=="string"&&!Za(u.docBaseUrl)?u.docBaseUrl:null,y=typeof u.cMapUrl=="string"?u.cMapUrl:null,A=u.cMapPacked!==!1,w=u.CMapReaderFactory||Vv,S=typeof u.standardFontDataUrl=="string"?u.standardFontDataUrl:null,N=u.StandardFontDataFactory||Dv,C=u.stopAtErrors!==!0,R=Number.isInteger(u.maxImageSize)&&u.maxImageSize>-1?u.maxImageSize:-1,E=u.isEvalSupported!==!1,L=typeof u.isOffscreenCanvasSupported=="boolean"?u.isOffscreenCanvasSupported:!bt,T=typeof u.isImageDecoderSupported=="boolean"?u.isImageDecoderSupported:!bt&&(Et.platform.isFirefox||!globalThis.chrome),I=Number.isInteger(u.canvasMaxAreaInBytes)?u.canvasMaxAreaInBytes:-1,$=typeof u.disableFontFace=="boolean"?u.disableFontFace:bt,te=u.fontExtraProperties===!0,ae=u.enableXfa===!0,de=u.ownerDocument||globalThis.document,Ae=u.disableRange===!0,pe=u.disableStream===!0,be=u.disableAutoFetch===!0,ke=u.pdfBug===!0,X=u.CanvasFactory||Mv,Z=u.FilterFactory||Iv,q=u.enableHWA===!0,se=f?f.length:u.length??NaN,Q=typeof u.useSystemFonts=="boolean"?u.useSystemFonts:!bt&&!$,V=typeof u.useWorkerFetch=="boolean"?u.useWorkerFetch:w===np&&N===ap&&y&&S&&ar(y,document.baseURI)&&ar(S,document.baseURI),z=null;_0(x);const ie={canvasFactory:new X({ownerDocument:de,enableHWA:q}),filterFactory:new Z({docId:t,ownerDocument:de}),cMapReaderFactory:V?null:new w({baseUrl:y,isCompressed:A}),standardFontDataFactory:V?null:new N({baseUrl:S})};if(!m){const B={verbosity:x,port:dr.workerPort};m=B.port?ti.fromPort(B):new ti(B),e._worker=m}const ge={docId:t,apiVersion:"4.10.38",data:r,password:d,disableAutoFetch:be,rangeChunkSize:p,length:se,docBaseUrl:b,enableXfa:ae,evaluatorOptions:{maxImageSize:R,disableFontFace:$,ignoreErrors:C,isEvalSupported:E,isOffscreenCanvasSupported:L,isImageDecoderSupported:T,canvasMaxAreaInBytes:I,fontExtraProperties:te,useSystemFonts:Q,cMapUrl:V?y:null,standardFontDataUrl:V?S:null}},U={disableFontFace:$,fontExtraProperties:te,ownerDocument:de,pdfBug:ke,styleElement:z,loadingParams:{disableAutoFetch:be,enableXfa:ae}};return m.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const B=m.messageHandler.sendWithPromise("GetDocRequest",ge,r?[r.buffer]:null);let ee;if(f)ee=new fv(f,{disableRange:Ae,disableStream:pe});else if(!r){if(!i)throw new Error("getDocument - no `url` parameter provided.");let K;if(bt)if(ar(i)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");K=Nf}else K=Ev;else K=ar(i)?Nf:wv;ee=new K({url:i,length:se,httpHeaders:a,withCredentials:c,rangeChunkSize:p,disableRange:Ae,disableStream:pe})}return B.then(K=>{if(e.destroyed)throw new Error("Loading aborted");if(m.destroyed)throw new Error("Worker was destroyed");const ce=new or(t,K,m.port),Me=new $v(ce,e,ee,U,ie);e._transport=Me,ce.send("Ready",null)})}).catch(e._capability.reject),e}function Ov(u){if(u instanceof URL)return u.href;try{return new URL(u,window.location).href}catch{if(bt&&typeof u=="string")return u}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function zv(u){if(bt&&typeof Buffer<"u"&&u instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(u instanceof Uint8Array&&u.byteLength===u.buffer.byteLength)return u;if(typeof u=="string")return Qa(u);if(u instanceof ArrayBuffer||ArrayBuffer.isView(u)||typeof u=="object"&&!isNaN(u?.length))return new Uint8Array(u);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Ef(u){return typeof u=="object"&&Number.isInteger(u?.num)&&u.num>=0&&Number.isInteger(u?.gen)&&u.gen>=0}class Gc{static#e=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Gc.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}}class pp{constructor(e,t,i=!1,r=null){this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const i of this._rangeListeners)i(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){De("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Bv{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ce(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class Uv{#e=null;#t=!1;constructor(e,t,i,r=!1){this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=r?new hf:null,this._pdfBug=r,this.commonObjs=i.commonObjs,this.objs=new mp,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:r=0,dontFlip:a=!1}={}){return new gr({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:r,dontFlip:a})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ce(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:i="display",annotationMode:r=Ks.ENABLE,transform:a=null,background:c=null,optionalContentConfigPromise:d=null,annotationCanvasMap:f=null,pageColors:p=null,printAnnotationStorage:m=null,isEditing:x=!1}){this._stats?.time("Overall");const b=this._transport.getRenderingIntent(i,r,m,x),{renderingIntent:y,cacheKey:A}=b;this.#t=!1,this.#n(),d||=this._transport.getOptionalContentConfig(y);let w=this._intentStates.get(A);w||(w=Object.create(null),this._intentStates.set(A,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const S=!!(y&zt.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(b));const N=E=>{w.renderTasks.delete(C),(this._maybeCleanupAfterRender||S)&&(this.#t=!0),this.#s(!S),E?(C.capability.reject(E),this._abortOperatorList({intentState:w,reason:E instanceof Error?E:new Error(E)})):C.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},C=new Zn({callback:N,params:{canvasContext:e,viewport:t,transform:a,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!S,pdfBug:this._pdfBug,pageColors:p});(w.renderTasks||=new Set).add(C);const R=C.task;return Promise.all([w.displayReadyCapability.promise,d]).then(([E,L])=>{if(this.destroyed){N();return}if(this._stats?.time("Rendering"),!(L.renderingIntent&y))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");C.initializeGraphics({transparency:E,optionalContentConfig:L}),C.operatorListChanged()}).catch(N),R}getOperatorList({intent:e="display",annotationMode:t=Ks.ENABLE,printAnnotationStorage:i=null,isEditing:r=!1}={}){function a(){d.operatorList.lastChunk&&(d.opListReadCapability.resolve(d.operatorList),d.renderTasks.delete(f))}const c=this._transport.getRenderingIntent(e,t,i,r,!0);let d=this._intentStates.get(c.cacheKey);d||(d=Object.create(null),this._intentStates.set(c.cacheKey,d));let f;return d.opListReadCapability||(f=Object.create(null),f.operatorListChanged=a,d.opListReadCapability=Promise.withResolvers(),(d.renderTasks||=new Set).add(f),d.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),d.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>pr.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,r){function a(){c.read().then(function({value:f,done:p}){if(p){i(d);return}d.lang??=f.lang,Object.assign(d.styles,f.styles),d.items.push(...f.items),a()},r)}const c=t.getReader(),d={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,this.#n(),Promise.all(e)}cleanup(e=!1){this.#t=!0;const t=this.#s(!1);return e&&t&&(this._stats&&=new hf),t}#s(e=!1){if(this.#n(),!this.#t||this.destroyed)return!1;if(e)return this.#e=setTimeout(()=>{this.#e=null,this.#s(!1)},Lv),!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#n(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(e,t){const i=this._intentStates.get(t);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let i=0,r=e.length;i<r;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&this.#s(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:r}){const{map:a,transfer:c}=i,f=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:a,modifiedIds:r},c).getReader(),p=this._intentStates.get(t);p.streamReader=f;const m=()=>{f.read().then(({value:x,done:b})=>{if(b){p.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(x,p),m())},x=>{if(p.streamReader=null,!this._transport.destroyed){if(p.operatorList){p.operatorList.lastChunk=!0;for(const b of p.renderTasks)b.operatorListChanged();this.#s(!0)}if(p.displayReadyCapability)p.displayReadyCapability.reject(x);else if(p.opListReadCapability)p.opListReadCapability.reject(x);else throw x}})};m()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof Dc){let r=Rv;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new en(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[r,a]of this._intentStates)if(a===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}class Hv{#e=new Map;#t=Promise.resolve();postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[r]of this.#e)r.call(this,i)})}addEventListener(e,t,i=null){let r=null;if(i?.signal instanceof AbortSignal){const{signal:a}=i;if(a.aborted){Ee("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(e,t);r=()=>a.removeEventListener("abort",c),a.addEventListener("abort",c)}this.#e.set(t,r)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}var $a,wn,An,si,Ia,ni,Da;const Ue=class Ue{constructor({name:e=null,port:t=null,verbosity:i=S0()}={}){Qn(this,si);if(this.name=e,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(rs(Ue,An)?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(rs(Ue,An)||Ji(Ue,An,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new or("main","worker",e),this._messageHandler.on("ready",function(){}),ja(this,si,Ia).call(this)}_initialize(){if(rs(Ue,wn)||rs(Ue,ni,Da)){this._setupFakeWorker();return}let{workerSrc:e}=Ue;try{Ue._isSameOrigin(window.location.href,e)||(e=Ue._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new or("main","worker",t),r=()=>{a.abort(),i.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},a=new AbortController;t.addEventListener("error",()=>{this._webWorker||r()},{signal:a.signal}),i.on("test",d=>{if(a.abort(),this.destroyed||!d){r();return}this._messageHandler=i,this._port=t,this._webWorker=t,ja(this,si,Ia).call(this)}),i.on("ready",d=>{if(a.abort(),this.destroyed){r();return}try{c()}catch{this._setupFakeWorker()}});const c=()=>{const d=new Uint8Array;i.send("test",d,[d.buffer])};c();return}catch{Ka("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){rs(Ue,wn)||(Ee("Setting up fake worker."),Ji(Ue,wn,!0)),Ue._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new Hv;this._port=t;const i=`fake${Fh(Ue,$a)._++}`,r=new or(i+"_worker",i,t);e.setup(r,t),this._messageHandler=new or(i,i+"_worker",t),ja(this,si,Ia).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker?.terminate(),this._webWorker=null,rs(Ue,An)?.delete(this._port),this._port=null,this._messageHandler?.destroy(),this._messageHandler=null}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const t=rs(this,An)?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Ue(e)}static get workerSrc(){if(dr.workerSrc)return dr.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ce(this,"_setupFakeWorkerGlobal",(async()=>rs(this,ni,Da)?rs(this,ni,Da):(await import(this.workerSrc)).WorkerMessageHandler)())}};$a=new WeakMap,wn=new WeakMap,An=new WeakMap,si=new WeakSet,Ia=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},ni=new WeakSet,Da=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Qn(Ue,ni),Qn(Ue,$a,0),Qn(Ue,wn,!1),Qn(Ue,An),bt&&(Ji(Ue,wn,!0),dr.workerSrc||="./pdf.worker.mjs"),Ue._isSameOrigin=(e,t)=>{let i;try{if(i=new URL(e),!i.origin||i.origin==="null")return!1}catch{return!1}const r=new URL(t,i);return i.origin===r.origin},Ue._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let ti=Ue;class $v{#e=new Map;#t=new Map;#s=new Map;#n=new Map;#r=null;constructor(e,t,i,r,a){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new mp,this.fontLoader=new H0({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#i(e,t=null){const i=this.#e.get(e);if(i)return i;const r=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,r),r}get annotationStorage(){return Ce(this,"annotationStorage",new Uc)}getRenderingIntent(e,t=Ks.ENABLE,i=null,r=!1,a=!1){let c=zt.DISPLAY,d=_c;switch(e){case"any":c=zt.ANY;break;case"display":break;case"print":c=zt.PRINT;break;default:Ee(`getRenderingIntent - invalid intent: ${e}`)}const f=c&zt.PRINT&&i instanceof ep?i:this.annotationStorage;switch(t){case Ks.DISABLE:c+=zt.ANNOTATIONS_DISABLE;break;case Ks.ENABLE:break;case Ks.ENABLE_FORMS:c+=zt.ANNOTATIONS_FORMS;break;case Ks.ENABLE_STORAGE:c+=zt.ANNOTATIONS_STORAGE,d=f.serializable;break;default:Ee(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(c+=zt.IS_EDITING),a&&(c+=zt.OPLIST);const{ids:p,hash:m}=f.modifiedIds,x=[c,d.hash,m];return{renderingIntent:c,cacheKey:x.join("_"),annotationStorageSerializable:d,modifiedIds:p}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of this.#t.values())e.push(i._destroy());this.#t.clear(),this.#s.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),Nt.cleanup(),this._networkStream?.cancelAllRequests(new en("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,r)=>{tt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},r.onPull=()=>{this._fullReader.read().then(function({value:a,done:c}){if(c){r.close();return}tt(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{r.error(a)})},r.onCancel=a=>{this._fullReader.cancel(a),r.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("ReaderHeadersReady",async i=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:a,contentLength:c}=this._fullReader;return(!r||!a)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=d=>{t.onProgress?.({loaded:d.loaded,total:d.total})}),{isStreamingSupported:r,isRangeSupported:a,contentLength:c}}),e.on("GetRangeReader",(i,r)=>{tt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(i.begin,i.end);if(!a){r.close();return}r.onPull=()=>{a.read().then(function({value:c,done:d}){if(d){r.close();return}tt(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{r.error(c)})},r.onCancel=c=>{a.cancel(c),r.ready.catch(d=>{if(!this.destroyed)throw d})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new Bv(i,this))}),e.on("DocException",i=>{t._capability.reject(Mt(i))}),e.on("PasswordRequest",i=>{this.#r=Promise.withResolvers();try{if(!t.onPassword)throw Mt(i);const r=a=>{a instanceof Error?this.#r.reject(a):this.#r.resolve({password:a})};t.onPassword(r,i.code)}catch(r){this.#r.reject(r)}return this.#r.promise}),e.on("DataLoaded",i=>{t.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;this.#t.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,r,a])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(r){case"Font":const{disableFontFace:c,fontExtraProperties:d,pdfBug:f}=this._params;if("error"in a){const b=a.error;Ee(`Error during font loading: ${b}`),this.commonObjs.resolve(i,b);break}const p=f&&globalThis.FontInspector?.enabled?(b,y)=>globalThis.FontInspector.fontAdded(b,y):null,m=new $0(a,{disableFontFace:c,fontExtraProperties:d,inspectFont:p});this.fontLoader.bind(m).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!d&&m.data&&(m.data=null),this.commonObjs.resolve(i,m)});break;case"CopyLocalImage":const{imageRef:x}=a;tt(x,"The imageRef must be defined.");for(const b of this.#t.values())for(const[,y]of b.objs)if(y?.ref===x)return y.dataLen?(this.commonObjs.resolve(i,structuredClone(y)),y.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,a);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([i,r,a,c])=>{if(this.destroyed)return;const d=this.#t.get(r);if(!d.objs.has(i)){if(d._intentStates.size===0){c?.bitmap?.close();return}switch(a){case"Image":d.objs.resolve(i,c),c?.dataLen>b0&&(d._maybeCleanupAfterRender=!0);break;case"Pattern":d.objs.resolve(i,c);break;default:throw new Error(`Got unknown object type ${a}`)}}}),e.on("DocProgress",i=>{this.destroyed||t.onProgress?.({loaded:i.loaded,total:i.total})}),e.on("FetchBuiltInCMap",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(i)}),e.on("FetchStandardFontData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Ee("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=this.#s.get(t);if(i)return i;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&this.#n.set(a.refStr,e);const c=new Uv(t,a,this,this._params.pdfBug);return this.#t.set(t,c),c});return this.#s.set(t,r),r}getPageIndex(e){return Ef(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#i("GetFieldObjects")}hasJSActions(){return this.#i("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#i("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#i("GetOptionalContentConfig").then(t=>new hv(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(r=>({info:r[0],metadata:r[1]?new dv(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),Nt.cleanup()}}cachedPageNumber(e){if(!Ef(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#n.get(t)??null}}const nr=Symbol("INITIAL_DATA");class mp{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:nr}}get(e,t=null){if(t){const r=this.#t(e);return r.promise.then(()=>t(r.data)),null}const i=this.#e[e];if(!i||i.data===nr)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=this.#e[e];return!!t&&t.data!==nr}delete(e){const t=this.#e[e];return!t||t.data===nr?!1:(delete this.#e[e],!0)}resolve(e,t=null){const i=this.#t(e);i.data=t,i.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==nr&&(yield[e,t])}}}class Gv{#e=null;constructor(e){this.#e=e,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class Zn{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:i,commonObjs:r,annotationCanvasMap:a,operatorList:c,pageIndex:d,canvasFactory:f,filterFactory:p,useRequestAnimationFrame:m=!1,pdfBug:x=!1,pageColors:b=null}){this.callback=e,this.params=t,this.objs=i,this.commonObjs=r,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=d,this.canvasFactory=f,this.filterFactory=p,this._pdfBug=x,this.pageColors=b,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=m===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Gv(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(Zn.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Zn.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:r,transform:a,background:c}=this.params;this.gfx=new ei(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:a,viewport:r,transparency:e,background:c}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),Zn.#t.delete(this._canvas),this.callback(e||new Dc(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Zn.#t.delete(this._canvas),this.callback())))}}const Wv="4.10.38",qv="f9bea397f";function kf(u){return Math.floor(Math.max(0,Math.min(1,u))*255).toString(16).padStart(2,"0")}function ir(u){return Math.max(0,Math.min(255,255*u))}class jf{static CMYK_G([e,t,i,r]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=ir(e),[e,e,e]}static G_HTML([e]){const t=kf(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(ir)}static RGB_HTML(e){return`#${e.map(kf).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,i+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,i,r]){return[ir(1-Math.min(1,e+r)),ir(1-Math.min(1,i+r)),ir(1-Math.min(1,t+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const r=1-e,a=1-t,c=1-i,d=Math.min(r,a,c);return["CMYK",r,a,c,d]}}class Xv{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),i||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){De("Abstract method `_createSVG` called.")}}class Wc extends Xv{_createSVG(e){return document.createElementNS(Es,e)}}class gp{static setupStorage(e,t,i,r,a){const c=r.getValue(t,{value:null});switch(i.name){case"textarea":if(c.value!==null&&(e.textContent=c.value),a==="print")break;e.addEventListener("input",d=>{r.setValue(t,{value:d.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(c.value===i.attributes.xfaOn?e.setAttribute("checked",!0):c.value===i.attributes.xfaOff&&e.removeAttribute("checked"),a==="print")break;e.addEventListener("change",d=>{r.setValue(t,{value:d.target.checked?d.target.getAttribute("xfaOn"):d.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&e.setAttribute("value",c.value),a==="print")break;e.addEventListener("input",d=>{r.setValue(t,{value:d.target.value})})}break;case"select":if(c.value!==null){e.setAttribute("value",c.value);for(const d of i.children)d.attributes.value===c.value?d.attributes.selected=!0:d.attributes.hasOwnProperty("selected")&&delete d.attributes.selected}e.addEventListener("input",d=>{const f=d.target.options,p=f.selectedIndex===-1?"":f[f.selectedIndex].value;r.setValue(t,{value:p})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:r,linkService:a}){const{attributes:c}=t,d=e instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${r}`);for(const[f,p]of Object.entries(c))if(p!=null)switch(f){case"class":p.length&&e.setAttribute(f,p.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",p);break;case"style":Object.assign(e.style,p);break;case"textContent":e.textContent=p;break;default:(!d||f!=="href"&&f!=="newWindow")&&e.setAttribute(f,p)}d&&a.addLinkAttributes(e,c.href,c.newWindow),i&&c.dataId&&this.setupStorage(e,c.dataId,t,i)}static render(e){const t=e.annotationStorage,i=e.linkService,r=e.xfaHtml,a=e.intent||"display",c=document.createElement(r.name);r.attributes&&this.setAttributes({html:c,element:r,intent:a,linkService:i});const d=a!=="richText",f=e.div;if(f.append(c),e.viewport){const x=`matrix(${e.viewport.transform.join(",")})`;f.style.transform=x}d&&f.setAttribute("class","xfaLayer xfaFont");const p=[];if(r.children.length===0){if(r.value){const x=document.createTextNode(r.value);c.append(x),d&&pr.shouldBuildText(r.name)&&p.push(x)}return{textDivs:p}}const m=[[r,-1,c]];for(;m.length>0;){const[x,b,y]=m.at(-1);if(b+1===x.children.length){m.pop();continue}const A=x.children[++m.at(-1)[1]];if(A===null)continue;const{name:w}=A;if(w==="#text"){const N=document.createTextNode(A.value);p.push(N),y.append(N);continue}const S=A?.attributes?.xmlns?document.createElementNS(A.attributes.xmlns,w):document.createElement(w);if(y.append(S),A.attributes&&this.setAttributes({html:S,element:A,storage:t,intent:a,linkService:i}),A.children?.length>0)m.push([A,-1,S]);else if(A.value){const N=document.createTextNode(A.value);d&&pr.shouldBuildText(w)&&p.push(N),S.append(N)}}for(const x of f.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))x.setAttribute("readOnly",!0);return{textDivs:p}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const vr=1e3,Yv=9,Sn=new WeakSet;function Zs(u){return{width:u[2]-u[0],height:u[3]-u[1]}}class Kv{static create(e){switch(e.data.annotationType){case it.LINK:return new xp(e);case it.TEXT:return new Qv(e);case it.WIDGET:switch(e.data.fieldType){case"Tx":return new Jv(e);case"Btn":return e.data.radioButton?new vp(e):e.data.checkBox?new eb(e):new tb(e);case"Ch":return new sb(e);case"Sig":return new Zv(e)}return new Nn(e);case it.POPUP:return new Nc(e);case it.FREETEXT:return new bp(e);case it.LINE:return new ib(e);case it.SQUARE:return new rb(e);case it.CIRCLE:return new ab(e);case it.POLYLINE:return new yp(e);case it.CARET:return new lb(e);case it.INK:return new qc(e);case it.POLYGON:return new ob(e);case it.HIGHLIGHT:return new wp(e);case it.UNDERLINE:return new cb(e);case it.SQUIGGLY:return new db(e);case it.STRIKEOUT:return new ub(e);case it.STAMP:return new Ap(e);case it.FILEATTACHMENT:return new hb(e);default:return new Je(e)}}}class Je{#e=null;#t=!1;#s=null;constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(i)),r&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:i}){return!!(e?.str||t?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Je._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#e||={rect:this.data.rect.slice(0)};const{rect:t}=e;t&&this.#n(t),this.#s?.popup.updateEdited(e)}resetEdited(){this.#e&&(this.#n(this.#e.rect),this.#s?.popup.resetEdited(),this.#e=null)}#n(e){const{container:{style:t},data:{rect:i,rotation:r},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:c,pageX:d,pageY:f}}}}=this;i?.splice(0,4,...e);const{width:p,height:m}=Zs(e);t.left=`${100*(e[0]-d)/a}%`,t.top=`${100*(c-e[3]+f)/c}%`,r===0?(t.width=`${100*p/a}%`,t.height=`${100*m/c}%`):this.setRotation(r)}_createContainer(e){const{data:t,parent:{page:i,viewport:r}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",t.id),this instanceof Nn||(a.tabIndex=vr);const{style:c}=a;if(c.zIndex=this.parent.zIndex++,t.alternativeText&&(a.title=t.alternativeText),t.noRotate&&a.classList.add("norotate"),!t.rect||this instanceof Nc){const{rotation:w}=t;return!t.hasOwnCanvas&&w!==0&&this.setRotation(w,a),a}const{width:d,height:f}=Zs(t.rect);if(!e&&t.borderStyle.width>0){c.borderWidth=`${t.borderStyle.width}px`;const w=t.borderStyle.horizontalCornerRadius,S=t.borderStyle.verticalCornerRadius;if(w>0||S>0){const C=`calc(${w}px * var(--scale-factor)) / calc(${S}px * var(--scale-factor))`;c.borderRadius=C}else if(this instanceof vp){const C=`calc(${d}px * var(--scale-factor)) / calc(${f}px * var(--scale-factor))`;c.borderRadius=C}switch(t.borderStyle.style){case tr.SOLID:c.borderStyle="solid";break;case tr.DASHED:c.borderStyle="dashed";break;case tr.BEVELED:Ee("Unimplemented border style: beveled");break;case tr.INSET:Ee("Unimplemented border style: inset");break;case tr.UNDERLINE:c.borderBottomStyle="solid";break}const N=t.borderColor||null;N?(this.#t=!0,c.borderColor=me.makeHexColor(N[0]|0,N[1]|0,N[2]|0)):c.borderWidth=0}const p=me.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:m,pageHeight:x,pageX:b,pageY:y}=r.rawDims;c.left=`${100*(p[0]-b)/m}%`,c.top=`${100*(p[1]-y)/x}%`;const{rotation:A}=t;return t.hasOwnCanvas||A===0?(c.width=`${100*d/m}%`,c.height=`${100*f/x}%`):this.setRotation(A,a),a}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:r}=this.parent.viewport.rawDims,{width:a,height:c}=Zs(this.data.rect);let d,f;e%180===0?(d=100*a/i,f=100*c/r):(d=100*c/i,f=100*a/r),t.style.width=`${d}%`,t.style.height=`${f}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,r)=>{const a=r.detail[t],c=a[0],d=a.slice(1);r.target.style[i]=jf[`${c}_HTML`](d),this.annotationStorage.setValue(this.data.id,{[i]:jf[`${c}_rgb`](d)})};return Ce(this,"_commonActions",{display:t=>{const{display:i}=t.detail,r=i%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const r of Object.keys(t.detail))(e[r]||i[r])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[r,a]of Object.entries(t)){const c=i[r];if(c){const d={detail:{[r]:a},target:e};c(d),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,r,a]=this.data.rect.map(w=>Math.fround(w));if(e.length===8){const[w,S,N,C]=e.subarray(2,6);if(r===w&&a===S&&t===N&&i===C)return}const{style:c}=this.container;let d;if(this.#t){const{borderColor:w,borderWidth:S}=c;c.borderWidth=0,d=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${S}">`],this.container.classList.add("hasBorder")}const f=r-t,p=a-i,{svgFactory:m}=this,x=m.createElement("svg");x.classList.add("quadrilateralsContainer"),x.setAttribute("width",0),x.setAttribute("height",0);const b=m.createElement("defs");x.append(b);const y=m.createElement("clipPath"),A=`clippath_${this.data.id}`;y.setAttribute("id",A),y.setAttribute("clipPathUnits","objectBoundingBox"),b.append(y);for(let w=2,S=e.length;w<S;w+=8){const N=e[w],C=e[w+1],R=e[w+2],E=e[w+3],L=m.createElement("rect"),T=(R-t)/f,I=(a-C)/p,$=(N-R)/f,te=(C-E)/p;L.setAttribute("x",T),L.setAttribute("y",I),L.setAttribute("width",$),L.setAttribute("height",te),y.append(L),d?.push(`<rect vector-effect="non-scaling-stroke" x="${T}" y="${I}" width="${$}" height="${te}"/>`)}this.#t&&(d.push("</g></svg>')"),c.backgroundImage=d.join("")),this.container.append(x),this.container.style.clipPath=`url(#${A})`}_createPopup(){const{data:e}=this,t=this.#s=new Nc({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){De("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const r=this._fieldObjects[e];if(r)for(const{page:a,id:c,exportValues:d}of r){if(a===-1||c===t)continue;const f=typeof d=="string"?d:null,p=document.querySelector(`[data-element-id="${c}"]`);if(p&&!Sn.has(p)){Ee(`_getElementsByName - element not allowed: ${c}`);continue}i.push({id:c,exportValue:f,domElement:p})}return i}for(const r of document.getElementsByName(e)){const{exportValue:a}=r,c=r.getAttribute("data-element-id");c!==t&&Sn.has(r)&&i.push({id:c,exportValue:a,domElement:r})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}}class xp extends Je{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,i=document.createElement("a");i.setAttribute("data-element-id",e.id);let r=!1;return e.url?(t.addLinkAttributes(i,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(i,e.action),r=!0):e.attachment?(this.#t(i,e.attachment,e.attachmentDest),r=!0):e.setOCGState?(this.#s(i,e.setOCGState),r=!0):e.dest?(this._bindLink(i,e.dest),r=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,e),r=!0),e.resetForm?(this._bindResetFormAction(i,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#e()}#t(e,t,i=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,i),!1),this.#e()}#s(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(t.actions)){const a=i.get(r);a&&(e[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:r}}),!1))}e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const i=e.onclick;if(i||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){Ee('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(e.onclick=()=>!1);return}e.onclick=()=>{i?.();const{fields:r,refs:a,include:c}=t,d=[];if(r.length!==0||a.length!==0){const m=new Set(a);for(const x of r){const b=this._fieldObjects[x]||[];for(const{id:y}of b)m.add(y)}for(const x of Object.values(this._fieldObjects))for(const b of x)m.has(b.id)===c&&d.push(b)}else for(const m of Object.values(this._fieldObjects))d.push(...m);const f=this.annotationStorage,p=[];for(const m of d){const{id:x}=m;switch(p.push(x),m.type){case"text":{const y=m.defaultValue||"";f.setValue(x,{value:y});break}case"checkbox":case"radiobutton":{const y=m.defaultValue===m.exportValues;f.setValue(x,{value:y});break}case"combobox":case"listbox":{const y=m.defaultValue||"";f.setValue(x,{value:y});break}default:continue}const b=document.querySelector(`[data-element-id="${x}"]`);if(b){if(!Sn.has(b)){Ee(`_bindResetFormAction - element not allowed: ${x}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:p,name:"ResetForm"}}),!1}}}class Qv extends Je{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Nn extends Je{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Et.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,r,a){i.includes("mouse")?e.addEventListener(i,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:a(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):e.addEventListener(i,c=>{if(i==="blur"){if(!t.focused||!c.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}a&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:a(c)}})})}_setEventListeners(e,t,i,r){for(const[a,c]of i)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,a,c,r),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":me.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||Yv,a=e.style;let c;const d=2,f=p=>Math.round(10*p)/10;if(this.data.multiLine){const p=Math.abs(this.data.rect[3]-this.data.rect[1]-d),m=Math.round(p/(ac*r))||1,x=p/m;c=Math.min(r,f(x/ac))}else{const p=Math.abs(this.data.rect[3]-this.data.rect[1]-d);c=Math.min(r,f(p/ac))}a.fontSize=`calc(${c}px * var(--scale-factor))`,a.color=me.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(a.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class Jv extends Nn{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,r){const a=this.annotationStorage;for(const c of this._getElementsByName(e.name,e.id))c.domElement&&(c.domElement[t]=i),a.setValue(c.id,{[r]:i})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const r=e.getValue(t,{value:this.data.fieldValue});let a=r.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&a.length>c&&(a=a.slice(0,c));let d=r.formattedValue||this.data.textContent?.join(`
`)||null;d&&this.data.comb&&(d=d.replaceAll(/\s+/g,""));const f={userValue:a,formattedValue:d,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=d??a,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",d??a),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Sn.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=vr,this._setRequired(i,this.data.required),c&&(i.maxLength=c),i.addEventListener("input",m=>{e.setValue(t,{value:m.target.value}),this.setPropertyOnSiblings(i,"value",m.target.value,"value"),f.formattedValue=null}),i.addEventListener("resetform",m=>{const x=this.data.defaultFieldValue??"";i.value=f.userValue=x,f.formattedValue=null});let p=m=>{const{formattedValue:x}=f;x!=null&&(m.target.value=x),m.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",x=>{if(f.focused)return;const{target:b}=x;f.userValue&&(b.value=f.userValue),f.lastCommittedValue=b.value,f.commitKey=1,this.data.actions?.Focus||(f.focused=!0)}),i.addEventListener("updatefromsandbox",x=>{this.showElementAndHideCanvas(x.target);const b={value(y){f.userValue=y.detail.value??"",e.setValue(t,{value:f.userValue.toString()}),y.target.value=f.userValue},formattedValue(y){const{formattedValue:A}=y.detail;f.formattedValue=A,A!=null&&y.target!==document.activeElement&&(y.target.value=A),e.setValue(t,{formattedValue:A})},selRange(y){y.target.setSelectionRange(...y.detail.selRange)},charLimit:y=>{const{charLimit:A}=y.detail,{target:w}=y;if(A===0){w.removeAttribute("maxLength");return}w.setAttribute("maxLength",A);let S=f.userValue;!S||S.length<=A||(S=S.slice(0,A),w.value=f.userValue=S,e.setValue(t,{value:S}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:S,willCommit:!0,commitKey:1,selStart:w.selectionStart,selEnd:w.selectionEnd}}))}};this._dispatchEventFromSandbox(b,x)}),i.addEventListener("keydown",x=>{f.commitKey=1;let b=-1;if(x.key==="Escape"?b=0:x.key==="Enter"&&!this.data.multiLine?b=2:x.key==="Tab"&&(f.commitKey=3),b===-1)return;const{value:y}=x.target;f.lastCommittedValue!==y&&(f.lastCommittedValue=y,f.userValue=y,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:y,willCommit:!0,commitKey:b,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}}))});const m=p;p=null,i.addEventListener("blur",x=>{if(!f.focused||!x.relatedTarget)return;this.data.actions?.Blur||(f.focused=!1);const{value:b}=x.target;f.userValue=b,f.lastCommittedValue!==b&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:f.commitKey,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}}),m(x)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",x=>{f.lastCommittedValue=null;const{data:b,target:y}=x,{value:A,selectionStart:w,selectionEnd:S}=y;let N=w,C=S;switch(x.inputType){case"deleteWordBackward":{const R=A.substring(0,w).match(/\w*[^\w]*$/);R&&(N-=R[0].length);break}case"deleteWordForward":{const R=A.substring(w).match(/^[^\w]*\w*/);R&&(C+=R[0].length);break}case"deleteContentBackward":w===S&&(N-=1);break;case"deleteContentForward":w===S&&(C+=1);break}x.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,change:b||"",willCommit:!1,selStart:N,selEnd:C}})}),this._setEventListeners(i,f,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],x=>x.target.value)}if(p&&i.addEventListener("blur",p),this.data.comb){const x=(this.data.rect[2]-this.data.rect[0])/c;i.classList.add("comb"),i.style.letterSpacing=`calc(${x}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Zv extends Nn{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class eb extends Nn{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let r=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(i,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return Sn.add(a),a.setAttribute("data-element-id",i),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=t.fieldName,r&&a.setAttribute("checked",!0),a.setAttribute("exportValue",t.exportValue),a.tabIndex=vr,a.addEventListener("change",c=>{const{name:d,checked:f}=c.target;for(const p of this._getElementsByName(d,i)){const m=f&&p.exportValue===t.exportValue;p.domElement&&(p.domElement.checked=m),e.setValue(p.id,{value:m})}e.setValue(i,{value:f})}),a.addEventListener("resetform",c=>{const d=t.defaultFieldValue||"Off";c.target.checked=d===t.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",c=>{const d={value(f){f.target.checked=f.detail.value!=="Off",e.setValue(i,{value:f.target.checked})}};this._dispatchEventFromSandbox(d,c)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class vp extends Nn{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let r=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(i,{value:r})),r)for(const c of this._getElementsByName(t.fieldName,i))e.setValue(c.id,{value:!1});const a=document.createElement("input");if(Sn.add(a),a.setAttribute("data-element-id",i),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=t.fieldName,r&&a.setAttribute("checked",!0),a.tabIndex=vr,a.addEventListener("change",c=>{const{name:d,checked:f}=c.target;for(const p of this._getElementsByName(d,i))e.setValue(p.id,{value:!1});e.setValue(i,{value:f})}),a.addEventListener("resetform",c=>{const d=t.defaultFieldValue;c.target.checked=d!=null&&d===t.buttonValue}),this.enableScripting&&this.hasJSActions){const c=t.buttonValue;a.addEventListener("updatefromsandbox",d=>{const f={value:p=>{const m=c===p.detail.value;for(const x of this._getElementsByName(p.target.name)){const b=m&&x.id===i;x.domElement&&(x.domElement.checked=b),e.setValue(x.id,{value:b})}}};this._dispatchEventFromSandbox(f,d)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],d=>d.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class tb extends xp{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class sb extends Nn{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");Sn.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=vr;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",m=>{const x=this.data.defaultFieldValue;for(const b of r.options)b.selected=b.value===x});for(const m of this.data.options){const x=document.createElement("option");x.textContent=m.displayValue,x.value=m.exportValue,i.value.includes(m.exportValue)&&(x.setAttribute("selected",!0),a=!1),r.append(x)}let c=null;if(a){const m=document.createElement("option");m.value=" ",m.setAttribute("hidden",!0),m.setAttribute("selected",!0),r.prepend(m),c=()=>{m.remove(),r.removeEventListener("input",c),c=null},r.addEventListener("input",c)}const d=m=>{const x=m?"value":"textContent",{options:b,multiple:y}=r;return y?Array.prototype.filter.call(b,A=>A.selected).map(A=>A[x]):b.selectedIndex===-1?null:b[b.selectedIndex][x]};let f=d(!1);const p=m=>{const x=m.target.options;return Array.prototype.map.call(x,b=>({displayValue:b.textContent,exportValue:b.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",m=>{const x={value(b){c?.();const y=b.detail.value,A=new Set(Array.isArray(y)?y:[y]);for(const w of r.options)w.selected=A.has(w.value);e.setValue(t,{value:d(!0)}),f=d(!1)},multipleSelection(b){r.multiple=!0},remove(b){const y=r.options,A=b.detail.remove;y[A].selected=!1,r.remove(A),y.length>0&&Array.prototype.findIndex.call(y,S=>S.selected)===-1&&(y[0].selected=!0),e.setValue(t,{value:d(!0),items:p(b)}),f=d(!1)},clear(b){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),f=d(!1)},insert(b){const{index:y,displayValue:A,exportValue:w}=b.detail.insert,S=r.children[y],N=document.createElement("option");N.textContent=A,N.value=w,S?S.before(N):r.append(N),e.setValue(t,{value:d(!0),items:p(b)}),f=d(!1)},items(b){const{items:y}=b.detail;for(;r.length!==0;)r.remove(0);for(const A of y){const{displayValue:w,exportValue:S}=A,N=document.createElement("option");N.textContent=w,N.value=S,r.append(N)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:d(!0),items:p(b)}),f=d(!1)},indices(b){const y=new Set(b.detail.indices);for(const A of b.target.options)A.selected=y.has(A.index);e.setValue(t,{value:d(!0)}),f=d(!1)},editable(b){b.target.disabled=!b.detail.editable}};this._dispatchEventFromSandbox(x,m)}),r.addEventListener("input",m=>{const x=d(!0),b=d(!1);e.setValue(t,{value:x}),m.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:f,change:b,changeEx:x,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],m=>m.target.value)):r.addEventListener("input",function(m){e.setValue(t,{value:d(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Nc extends Je{constructor(e){const{data:t,elements:i}=e;super(e,{isRenderable:Je._hasPopupData(t)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new nb({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const i of this.elements)i.popup=e,i.container.ariaHasPopup="dialog",t.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(i=>`${Ic}${i}`).join(",")),this.container}}class nb{#e=this.#k.bind(this);#t=this.#E.bind(this);#s=this.#j.bind(this);#n=this.#A.bind(this);#r=null;#i=null;#l=null;#o=null;#d=null;#c=null;#h=null;#u=!1;#f=null;#a=null;#p=null;#g=null;#m=null;#x=null;#y=!1;constructor({container:e,color:t,elements:i,titleObj:r,modificationDate:a,contentsObj:c,richText:d,parent:f,rect:p,parentRect:m,open:x}){this.#i=e,this.#m=r,this.#l=c,this.#g=d,this.#c=f,this.#r=t,this.#p=p,this.#h=m,this.#d=i,this.#o=Jf.toDateObject(a),this.trigger=i.flatMap(b=>b.getElementsToTriggerPopup());for(const b of this.trigger)b.addEventListener("click",this.#n),b.addEventListener("mouseenter",this.#s),b.addEventListener("mouseleave",this.#t),b.classList.add("popupTriggerArea");for(const b of i)b.container?.addEventListener("keydown",this.#e);this.#i.hidden=!0,x&&this.#A()}render(){if(this.#f)return;const e=this.#f=document.createElement("div");if(e.className="popup",this.#r){const a=e.style.outlineColor=me.makeHexColor(...this.#r);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${a} 30%, white)`:e.style.backgroundColor=me.makeHexColor(...this.#r.map(d=>Math.floor(.7*(255-d)+d)))}const t=document.createElement("span");t.className="header";const i=document.createElement("h1");if(t.append(i),{dir:i.dir,str:i.textContent}=this.#m,e.append(t),this.#o){const a=document.createElement("span");a.classList.add("popupDate"),a.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),a.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),t.append(a)}const r=this.#v;if(r)gp.render({xfaHtml:r,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const a=this._formatContents(this.#l);e.append(a)}this.#i.append(e)}get#v(){const e=this.#g,t=this.#l;return e?.str&&(!t?.str||t.str===e.str)&&this.#g.html||null}get#w(){return this.#v?.attributes?.style?.fontSize||0}get#_(){return this.#v?.attributes?.style?.color||null}#N(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:this.#_,fontSize:this.#w?`calc(${this.#w}px * var(--scale-factor))`:""}};for(const a of e.split(`
`))t.push({name:"span",value:a,attributes:r});return i}_formatContents({str:e,dir:t}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=t;const r=e.split(/(?:\r\n?|\n)/);for(let a=0,c=r.length;a<c;++a){const d=r[a];i.append(document.createTextNode(d)),a<c-1&&i.append(document.createElement("br"))}return i}#k(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#u)&&this.#A()}updateEdited({rect:e,popupContent:t}){this.#x||={contentsObj:this.#l,richText:this.#g},e&&(this.#a=null),t&&(this.#g=this.#N(t),this.#l=null),this.#f?.remove(),this.#f=null}resetEdited(){this.#x&&({contentsObj:this.#l,richText:this.#g}=this.#x,this.#x=null,this.#f?.remove(),this.#f=null,this.#a=null)}#C(){if(this.#a!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:r,pageY:a}}}=this.#c;let c=!!this.#h,d=c?this.#h:this.#p;for(const A of this.#d)if(!d||me.intersect(A.data.rect,d)!==null){d=A.data.rect,c=!0;break}const f=me.normalizeRect([d[0],e[3]-d[1]+e[1],d[2],e[3]-d[3]+e[1]]),m=c?d[2]-d[0]+5:0,x=f[0]+m,b=f[1];this.#a=[100*(x-r)/t,100*(b-a)/i];const{style:y}=this.#i;y.left=`${this.#a[0]}%`,y.top=`${this.#a[1]}%`}#A(){this.#u=!this.#u,this.#u?(this.#j(),this.#i.addEventListener("click",this.#n),this.#i.addEventListener("keydown",this.#e)):(this.#E(),this.#i.removeEventListener("click",this.#n),this.#i.removeEventListener("keydown",this.#e))}#j(){this.#f||this.render(),this.isVisible?this.#u&&this.#i.classList.add("focused"):(this.#C(),this.#i.hidden=!1,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)+1e3)}#E(){this.#i.classList.remove("focused"),!(this.#u||!this.isVisible)&&(this.#i.hidden=!0,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)-1e3)}forceHide(){this.#y=this.isVisible,this.#y&&(this.#i.hidden=!0)}maybeShow(){this.#y&&(this.#f||this.#j(),this.#y=!1,this.#i.hidden=!1)}get isVisible(){return this.#i.hidden===!1}}class bp extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Ne.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class ib extends Je{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:t,height:i}=Zs(e.rect),r=this.svgFactory.create(t,i,!0),a=this.#e=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class rb extends Je{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:t,height:i}=Zs(e.rect),r=this.svgFactory.create(t,i,!0),a=e.borderStyle.width,c=this.#e=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",a/2),c.setAttribute("y",a/2),c.setAttribute("width",t-a),c.setAttribute("height",i-a),c.setAttribute("stroke-width",a||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class ab extends Je{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:t,height:i}=Zs(e.rect),r=this.svgFactory.create(t,i,!0),a=e.borderStyle.width,c=this.#e=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",t/2),c.setAttribute("cy",i/2),c.setAttribute("rx",t/2-a/2),c.setAttribute("ry",i/2-a/2),c.setAttribute("stroke-width",a||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class yp extends Je{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:i,popupRef:r}}=this;if(!t)return this.container;const{width:a,height:c}=Zs(e),d=this.svgFactory.create(a,c,!0);let f=[];for(let m=0,x=t.length;m<x;m+=2){const b=t[m]-e[0],y=e[3]-t[m+1];f.push(`${b},${y}`)}f=f.join(" ");const p=this.#e=this.svgFactory.createElement(this.svgElementName);return p.setAttribute("points",f),p.setAttribute("stroke-width",i.width||1),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),d.append(p),this.container.append(d),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class ob extends yp{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class lb extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class qc extends Je{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Ne.HIGHLIGHT:Ne.INK}#s(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:i,borderStyle:r,popupRef:a}}=this,{transform:c,width:d,height:f}=this.#s(t,e),p=this.svgFactory.create(d,f,!0),m=this.#e=this.svgFactory.createElement("svg:g");p.append(m),m.setAttribute("stroke-width",r.width||1),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),m.setAttribute("stroke-miterlimit",10),m.setAttribute("stroke","transparent"),m.setAttribute("fill","transparent"),m.setAttribute("transform",c);for(let x=0,b=i.length;x<b;x++){const y=this.svgFactory.createElement(this.svgElementName);this.#t.push(y),y.setAttribute("points",i[x].join(",")),m.append(y)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(p),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:i,rect:r}=e,a=this.#e;if(t>=0&&a.setAttribute("stroke-width",t||1),i)for(let c=0,d=this.#t.length;c<d;c++)this.#t[c].setAttribute("points",i[c].join(","));if(r){const{transform:c,width:d,height:f}=this.#s(this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${d} ${f}`),a.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class wp extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Ne.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class cb extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class db extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class ub extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Ap extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Ne.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class hb extends Je{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let i;t.hasAppearance||t.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#t.bind(this)),this.#e=i;const{isMac:r}=Et.platform;return e.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),e.append(i),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class fb{#e=null;#t=null;#s=new Map;#n=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:r,page:a,viewport:c,structTreeLayer:d}){this.div=e,this.#e=t,this.#t=i,this.#n=d||null,this.page=a,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return this.#s.size>0}async#r(e,t){const i=e.firstChild||e,r=i.id=`${Ic}${t}`,a=await this.#n?.getAriaAttributes(r);if(a)for(const[c,d]of a)i.setAttribute(c,d);this.div.append(e),this.#e?.moveElementInDOM(this.div,e,i,!1)}async render(e){const{annotations:t}=e,i=this.div;_n(i,this.viewport);const r=new Map,a={data:null,layer:i,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Wc,annotationStorage:e.annotationStorage||new Uc,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const d=c.annotationType===it.POPUP;if(d){const m=r.get(c.id);if(!m)continue;a.elements=m}else{const{width:m,height:x}=Zs(c.rect);if(m<=0||x<=0)continue}a.data=c;const f=Kv.create(a);if(!f.isRenderable)continue;if(!d&&c.popupRef){const m=r.get(c.popupRef);m?m.push(f):r.set(c.popupRef,[f])}const p=f.render();c.hidden&&(p.style.visibility="hidden"),await this.#r(p,c.id),f._isEditable&&(this.#s.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}this.#i()}update({viewport:e}){const t=this.div;this.viewport=e,_n(t,{rotation:e.rotation}),this.#i(),t.hidden=!1}#i(){if(!this.#t)return;const e=this.div;for(const[t,i]of this.#t){const r=e.querySelector(`[data-annotation-id="${t}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:a}=r;a?a.nodeName==="CANVAS"?a.replaceWith(i):a.classList.contains("annotationContent")?a.after(i):a.before(i):r.append(i)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#s.values())}getEditableAnnotation(e){return this.#s.get(e)}}const Ma=/\r\n?|\n/g;class rt extends we{#e;#t="";#s=`${this.id}-editor`;#n=null;#r;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=rt.prototype,t=a=>a.isEmpty(),i=tn.TRANSLATE_SMALL,r=tn.TRANSLATE_BIG;return Ce(this,"_keyboardManager",new xr([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,r],checker:t}]]))}static _type="freetext";static _editorType=Ne.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.#e=e.color||rt._defaultColor||we._defaultLineColor,this.#r=e.fontSize||rt._defaultFontSize}static initialize(e,t){we.initialize(e,t);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case Te.FREETEXT_SIZE:rt._defaultFontSize=t;break;case Te.FREETEXT_COLOR:rt._defaultColor=t;break}}updateParams(e,t){switch(e){case Te.FREETEXT_SIZE:this.#i(t);break;case Te.FREETEXT_COLOR:this.#l(t);break}}static get defaultPropertiesToUpdate(){return[[Te.FREETEXT_SIZE,rt._defaultFontSize],[Te.FREETEXT_COLOR,rt._defaultColor||we._defaultLineColor]]}get propertiesToUpdate(){return[[Te.FREETEXT_SIZE,this.#r],[Te.FREETEXT_COLOR,this.#e]]}#i(e){const t=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-this.#r)*this.parentScale),this.#r=r,this.#d()},i=this.#r;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(e){const t=r=>{this.#e=this.editorDiv.style.color=r},i=this.#e;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-rt._internalPadding*e,-(rt._internalPadding+this.#r)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Ne.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const e=this._uiManager.combinedSignal(this.#n);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#s),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const e=[];this.editorDiv.normalize();let t=null;for(const i of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(e.push(rt.#c(i)),t=i);return e.join(`
`)}#d(){const[e,t]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,c=a.style.display,d=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=c,a.classList.toggle("hidden",d)}this.rotation%180===this.parentRotation%180?(this.width=i.width/e,this.height=i.height/t):(this.width=i.height/e,this.height=i.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#t,t=this.#t=this.#o().trimEnd();if(e===t)return;const i=r=>{if(this.#t=r,!r){this.remove();return}this.#h(),this._uiManager.rebuild(this),this.#d()};this.addCommands({cmd:()=>{i(t)},undo:()=>{i(e)},mustExec:!1}),this.#d()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){rt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#s),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#r}px * var(--scale-factor))`,i.color=this.#e,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Ha(this,this.div,["dblclick","keydown"]),this.width){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[d,f]=this.getInitialTranslation();[d,f]=this.pageTranslationToScreen(d,f);const[p,m]=this.pageDimensions,[x,b]=this.pageTranslation;let y,A;switch(this.rotation){case 0:y=e+(c[0]-x)/p,A=t+this.height-(c[1]-b)/m;break;case 90:y=e+(c[0]-x)/p,A=t-(c[1]-b)/m,[d,f]=[f,-d];break;case 180:y=e-this.width+(c[0]-x)/p,A=t-(c[1]-b)/m,[d,f]=[-d,-f];break;case 270:y=e+(c[0]-x-this.height*m)/p,A=t+(c[1]-b-this.width*p)/m,[d,f]=[-f,d];break}this.setAt(y*r,A*a,d,f)}else this.setAt(e*r,t*a,this.width*r,this.height*a);this.#h(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Ma,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:i}=t;if(i.length===1&&i[0]==="text/plain")return;e.preventDefault();const r=rt.#f(t.getData("text")||"").replaceAll(Ma,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const c=a.getRangeAt(0);if(!r.includes(`
`)){c.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:d,startOffset:f}=c,p=[],m=[];if(d.nodeType===Node.TEXT_NODE){const y=d.parentElement;if(m.push(d.nodeValue.slice(f).replaceAll(Ma,"")),y!==this.editorDiv){let A=p;for(const w of this.editorDiv.childNodes){if(w===y){A=m;continue}A.push(rt.#c(w))}}p.push(d.nodeValue.slice(0,f).replaceAll(Ma,""))}else if(d===this.editorDiv){let y=p,A=0;for(const w of this.editorDiv.childNodes)A++===f&&(y=m),y.push(rt.#c(w))}this.#t=`${p.join(`
`)}${r}${m.join(`
`)}`,this.#h();const x=new Range;let b=p.reduce((y,A)=>y+A.length,0);for(const{firstChild:y}of this.editorDiv.childNodes)if(y.nodeType===Node.TEXT_NODE){const A=y.nodeValue.length;if(b<=A){x.setStart(y,b),x.setEnd(y,b);break}b-=A}a.removeAllRanges(),a.addRange(x)}#h(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const e of this.#t.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#u(){return this.#t.replaceAll(""," ")}static#f(e){return e.replaceAll(" ","")}get contentDiv(){return this.editorDiv}static async deserialize(e,t,i){let r=null;if(e instanceof bp){const{data:{defaultAppearanceData:{fontSize:c,fontColor:d},rect:f,rotation:p,id:m,popupRef:x},textContent:b,textPosition:y,parent:{page:{pageNumber:A}}}=e;if(!b||b.length===0)return null;r=e={annotationType:Ne.FREETEXT,color:Array.from(d),fontSize:c,value:b.join(`
`),position:y,pageIndex:A-1,rect:f.slice(0),rotation:p,id:m,deleted:!1,popupRef:x}}const a=await super.deserialize(e,t,i);return a.#r=e.fontSize,a.#e=me.makeHexColor(...e.color),a.#t=rt.#f(e.value),a.annotationElementId=e.id||null,a._initialData=r,a}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=rt._internalPadding*this.parentScale,i=this.getRect(t,t),r=we._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#e),a={annotationType:Ne.FREETEXT,color:r,fontSize:this.#r,value:this.#u(),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?a:this.annotationElementId&&!this.#a(a)?null:(a.id=this.annotationElementId,a)}#a(e){const{value:t,fontSize:i,color:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==i||e.color.some((c,d)=>c!==r[d])||e.pageIndex!==a}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(this.deleted)return t;const{style:i}=t;i.fontSize=`calc(${this.#r}px * var(--scale-factor))`,i.color=this.#e,t.replaceChildren();for(const a of this.#t.split(`
`)){const c=document.createElement("div");c.append(a?document.createTextNode(a):document.createElement("br")),t.append(c)}const r=rt._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(r,r),popupContent:this.#t}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class oe{static PRECISION=1e-4;toSVGPath(){De("Abstract method `toSVGPath` must be implemented.")}get box(){De("Abstract getter `box` must be implemented.")}serialize(e,t){De("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,r,a,c){c||=new Float32Array(e.length);for(let d=0,f=e.length;d<f;d+=2)c[d]=t+e[d]*r,c[d+1]=i+e[d+1]*a;return c}static _rescaleAndSwap(e,t,i,r,a,c){c||=new Float32Array(e.length);for(let d=0,f=e.length;d<f;d+=2)c[d]=t+e[d+1]*r,c[d+1]=i+e[d]*a;return c}static _translate(e,t,i,r){r||=new Float32Array(e.length);for(let a=0,c=e.length;a<c;a+=2)r[a]=t+e[a],r[a+1]=i+e[a+1];return r}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,r,a){switch(a){case 90:return[1-t/i,e/r];case 180:return[1-e/i,1-t/r];case 270:return[t/i,1-e/r];default:return[e/i,t/r]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,i,r,a,c){return[(e+5*i)/6,(t+5*r)/6,(5*i+a)/6,(5*r+c)/6,(i+a)/2,(r+c)/2]}}class yn{#e;#t=[];#s;#n;#r=[];#i=new Float32Array(18);#l;#o;#d;#c;#h;#u;#f=[];static#a=8;static#p=2;static#g=yn.#a+yn.#p;constructor({x:e,y:t},i,r,a,c,d=0){this.#e=i,this.#u=a*r,this.#n=c,this.#i.set([NaN,NaN,NaN,NaN,e,t],6),this.#s=d,this.#c=yn.#a*r,this.#d=yn.#g*r,this.#h=r,this.#f.push(e,t)}isEmpty(){return isNaN(this.#i[8])}#m(){const e=this.#i.subarray(4,6),t=this.#i.subarray(16,18),[i,r,a,c]=this.#e;return[(this.#l+(e[0]-t[0])/2-i)/a,(this.#o+(e[1]-t[1])/2-r)/c,(this.#l+(t[0]-e[0])/2-i)/a,(this.#o+(t[1]-e[1])/2-r)/c]}add({x:e,y:t}){this.#l=e,this.#o=t;const[i,r,a,c]=this.#e;let[d,f,p,m]=this.#i.subarray(8,12);const x=e-p,b=t-m,y=Math.hypot(x,b);if(y<this.#d)return!1;const A=y-this.#c,w=A/y,S=w*x,N=w*b;let C=d,R=f;d=p,f=m,p+=S,m+=N,this.#f?.push(e,t);const E=-N/A,L=S/A,T=E*this.#u,I=L*this.#u;return this.#i.set(this.#i.subarray(2,8),0),this.#i.set([p+T,m+I],4),this.#i.set(this.#i.subarray(14,18),12),this.#i.set([p-T,m-I],16),isNaN(this.#i[6])?(this.#r.length===0&&(this.#i.set([d+T,f+I],2),this.#r.push(NaN,NaN,NaN,NaN,(d+T-i)/a,(f+I-r)/c),this.#i.set([d-T,f-I],14),this.#t.push(NaN,NaN,NaN,NaN,(d-T-i)/a,(f-I-r)/c)),this.#i.set([C,R,d,f,p,m],6),!this.isEmpty()):(this.#i.set([C,R,d,f,p,m],6),Math.abs(Math.atan2(R-f,C-d)-Math.atan2(N,S))<Math.PI/2?([d,f,p,m]=this.#i.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((d+p)/2-i)/a,((f+m)/2-r)/c),[d,f,C,R]=this.#i.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((C+d)/2-i)/a,((R+f)/2-r)/c),!0):([C,R,d,f,p,m]=this.#i.subarray(0,6),this.#r.push(((C+5*d)/6-i)/a,((R+5*f)/6-r)/c,((5*d+p)/6-i)/a,((5*f+m)/6-r)/c,((d+p)/2-i)/a,((f+m)/2-r)/c),[p,m,d,f,C,R]=this.#i.subarray(12,18),this.#t.push(((C+5*d)/6-i)/a,((R+5*f)/6-r)/c,((5*d+p)/6-i)/a,((5*f+m)/6-r)/c,((d+p)/2-i)/a,((f+m)/2-r)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#r,t=this.#t;if(isNaN(this.#i[6])&&!this.isEmpty())return this.#x();const i=[];i.push(`M${e[4]} ${e[5]}`);for(let r=6;r<e.length;r+=6)isNaN(e[r])?i.push(`L${e[r+4]} ${e[r+5]}`):i.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);this.#v(i);for(let r=t.length-6;r>=6;r-=6)isNaN(t[r])?i.push(`L${t[r+4]} ${t[r+5]}`):i.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);return this.#y(i),i.join(" ")}#x(){const[e,t,i,r]=this.#e,[a,c,d,f]=this.#m();return`M${(this.#i[2]-e)/i} ${(this.#i[3]-t)/r} L${(this.#i[4]-e)/i} ${(this.#i[5]-t)/r} L${a} ${c} L${d} ${f} L${(this.#i[16]-e)/i} ${(this.#i[17]-t)/r} L${(this.#i[14]-e)/i} ${(this.#i[15]-t)/r} Z`}#y(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#v(e){const[t,i,r,a]=this.#e,c=this.#i.subarray(4,6),d=this.#i.subarray(16,18),[f,p,m,x]=this.#m();e.push(`L${(c[0]-t)/r} ${(c[1]-i)/a} L${f} ${p} L${m} ${x} L${(d[0]-t)/r} ${(d[1]-i)/a}`)}newFreeDrawOutline(e,t,i,r,a,c){return new _p(e,t,i,r,a,c)}getOutlines(){const e=this.#r,t=this.#t,i=this.#i,[r,a,c,d]=this.#e,f=new Float32Array((this.#f?.length??0)+2);for(let x=0,b=f.length-2;x<b;x+=2)f[x]=(this.#f[x]-r)/c,f[x+1]=(this.#f[x+1]-a)/d;if(f[f.length-2]=(this.#l-r)/c,f[f.length-1]=(this.#o-a)/d,isNaN(i[6])&&!this.isEmpty())return this.#w(f);const p=new Float32Array(this.#r.length+24+this.#t.length);let m=e.length;for(let x=0;x<m;x+=2){if(isNaN(e[x])){p[x]=p[x+1]=NaN;continue}p[x]=e[x],p[x+1]=e[x+1]}m=this.#N(p,m);for(let x=t.length-6;x>=6;x-=6)for(let b=0;b<6;b+=2){if(isNaN(t[x+b])){p[m]=p[m+1]=NaN,m+=2;continue}p[m]=t[x+b],p[m+1]=t[x+b+1],m+=2}return this.#_(p,m),this.newFreeDrawOutline(p,f,this.#e,this.#h,this.#s,this.#n)}#w(e){const t=this.#i,[i,r,a,c]=this.#e,[d,f,p,m]=this.#m(),x=new Float32Array(36);return x.set([NaN,NaN,NaN,NaN,(t[2]-i)/a,(t[3]-r)/c,NaN,NaN,NaN,NaN,(t[4]-i)/a,(t[5]-r)/c,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,p,m,NaN,NaN,NaN,NaN,(t[16]-i)/a,(t[17]-r)/c,NaN,NaN,NaN,NaN,(t[14]-i)/a,(t[15]-r)/c],0),this.newFreeDrawOutline(x,e,this.#e,this.#h,this.#s,this.#n)}#_(e,t){const i=this.#t;return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6}#N(e,t){const i=this.#i.subarray(4,6),r=this.#i.subarray(16,18),[a,c,d,f]=this.#e,[p,m,x,b]=this.#m();return e.set([NaN,NaN,NaN,NaN,(i[0]-a)/d,(i[1]-c)/f,NaN,NaN,NaN,NaN,p,m,NaN,NaN,NaN,NaN,x,b,NaN,NaN,NaN,NaN,(r[0]-a)/d,(r[1]-c)/f],t),t+=24}}class _p extends oe{#e;#t=new Float32Array(4);#s;#n;#r;#i;#l;constructor(e,t,i,r,a,c){super(),this.#l=e,this.#r=t,this.#e=i,this.#i=r,this.#s=a,this.#n=c,this.lastPoint=[NaN,NaN],this.#o(c);const[d,f,p,m]=this.#t;for(let x=0,b=e.length;x<b;x+=2)e[x]=(e[x]-d)/p,e[x+1]=(e[x+1]-f)/m;for(let x=0,b=t.length;x<b;x+=2)t[x]=(t[x]-d)/p,t[x+1]=(t[x+1]-f)/m}toSVGPath(){const e=[`M${this.#l[4]} ${this.#l[5]}`];for(let t=6,i=this.#l.length;t<i;t+=6){if(isNaN(this.#l[t])){e.push(`L${this.#l[t+4]} ${this.#l[t+5]}`);continue}e.push(`C${this.#l[t]} ${this.#l[t+1]} ${this.#l[t+2]} ${this.#l[t+3]} ${this.#l[t+4]} ${this.#l[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,i,r],a){const c=i-e,d=r-t;let f,p;switch(a){case 0:f=oe._rescale(this.#l,e,r,c,-d),p=oe._rescale(this.#r,e,r,c,-d);break;case 90:f=oe._rescaleAndSwap(this.#l,e,t,c,d),p=oe._rescaleAndSwap(this.#r,e,t,c,d);break;case 180:f=oe._rescale(this.#l,i,t,-c,d),p=oe._rescale(this.#r,i,t,-c,d);break;case 270:f=oe._rescaleAndSwap(this.#l,i,r,-c,-d),p=oe._rescaleAndSwap(this.#r,i,r,-c,-d);break}return{outline:Array.from(f),points:[Array.from(p)]}}#o(e){const t=this.#l;let i=t[4],r=t[5],a=i,c=r,d=i,f=r,p=i,m=r;const x=e?Math.max:Math.min;for(let y=6,A=t.length;y<A;y+=6){if(isNaN(t[y]))a=Math.min(a,t[y+4]),c=Math.min(c,t[y+5]),d=Math.max(d,t[y+4]),f=Math.max(f,t[y+5]),m<t[y+5]?(p=t[y+4],m=t[y+5]):m===t[y+5]&&(p=x(p,t[y+4]));else{const w=me.bezierBoundingBox(i,r,...t.slice(y,y+6));a=Math.min(a,w[0]),c=Math.min(c,w[1]),d=Math.max(d,w[2]),f=Math.max(f,w[3]),m<w[3]?(p=w[2],m=w[3]):m===w[3]&&(p=x(p,w[2]))}i=t[y+4],r=t[y+5]}const b=this.#t;b[0]=a-this.#s,b[1]=c-this.#s,b[2]=d-a+2*this.#s,b[3]=f-c+2*this.#s,this.lastPoint=[p,m]}get box(){return this.#t}newOutliner(e,t,i,r,a,c=0){return new yn(e,t,i,r,a,c)}getNewOutline(e,t){const[i,r,a,c]=this.#t,[d,f,p,m]=this.#e,x=a*p,b=c*m,y=i*p+d,A=r*m+f,w=this.newOutliner({x:this.#r[0]*x+y,y:this.#r[1]*b+A},this.#e,this.#i,e,this.#n,t??this.#s);for(let S=2;S<this.#r.length;S+=2)w.add({x:this.#r[S]*x+y,y:this.#r[S+1]*b+A});return w.getOutlines()}}class Ec{#e;#t;#s=[];#n=[];constructor(e,t=0,i=0,r=!0){let a=1/0,c=-1/0,d=1/0,f=-1/0;const p=10**-4;for(const{x:S,y:N,width:C,height:R}of e){const E=Math.floor((S-t)/p)*p,L=Math.ceil((S+C+t)/p)*p,T=Math.floor((N-t)/p)*p,I=Math.ceil((N+R+t)/p)*p,$=[E,T,I,!0],te=[L,T,I,!1];this.#s.push($,te),a=Math.min(a,E),c=Math.max(c,L),d=Math.min(d,T),f=Math.max(f,I)}const m=c-a+2*i,x=f-d+2*i,b=a-i,y=d-i,A=this.#s.at(r?-1:-2),w=[A[0],A[2]];for(const S of this.#s){const[N,C,R]=S;S[0]=(N-b)/m,S[1]=(C-y)/x,S[2]=(R-y)/x}this.#e=new Float32Array([b,y,m,x]),this.#t=w}getOutlines(){this.#s.sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of this.#s)t[3]?(e.push(...this.#d(t)),this.#l(t)):(this.#o(t),e.push(...this.#d(t)));return this.#r(e)}#r(e){const t=[],i=new Set;for(const c of e){const[d,f,p]=c;t.push([d,f,c],[d,p,c])}t.sort((c,d)=>c[1]-d[1]||c[0]-d[0]);for(let c=0,d=t.length;c<d;c+=2){const f=t[c][2],p=t[c+1][2];f.push(p),p.push(f),i.add(f),i.add(p)}const r=[];let a;for(;i.size>0;){const c=i.values().next().value;let[d,f,p,m,x]=c;i.delete(c);let b=d,y=f;for(a=[d,p],r.push(a);;){let A;if(i.has(m))A=m;else if(i.has(x))A=x;else break;i.delete(A),[d,f,p,m,x]=A,b!==d&&(a.push(b,y,d,y===f?f:p),b=d),y=y===f?p:f}a.push(b,y)}return new pb(r,this.#e,this.#t)}#i(e){const t=this.#n;let i=0,r=t.length-1;for(;i<=r;){const a=i+r>>1,c=t[a][0];if(c===e)return a;c<e?i=a+1:r=a-1}return r+1}#l([,e,t]){const i=this.#i(e);this.#n.splice(i,0,[e,t])}#o([,e,t]){const i=this.#i(e);for(let r=i;r<this.#n.length;r++){const[a,c]=this.#n[r];if(a!==e)break;if(a===e&&c===t){this.#n.splice(r,1);return}}for(let r=i-1;r>=0;r--){const[a,c]=this.#n[r];if(a!==e)break;if(a===e&&c===t){this.#n.splice(r,1);return}}}#d(e){const[t,i,r]=e,a=[[t,i,r]],c=this.#i(r);for(let d=0;d<c;d++){const[f,p]=this.#n[d];for(let m=0,x=a.length;m<x;m++){const[,b,y]=a[m];if(!(p<=b||y<=f)){if(b>=f){if(y>p)a[m][1]=p;else{if(x===1)return[];a.splice(m,1),m--,x--}continue}a[m][2]=f,y>p&&a.push([t,p,y])}}}return a}}class pb extends oe{#e;#t;constructor(e,t,i){super(),this.#t=e,this.#e=t,this.lastPoint=i}toSVGPath(){const e=[];for(const t of this.#t){let[i,r]=t;e.push(`M${i} ${r}`);for(let a=2;a<t.length;a+=2){const c=t[a],d=t[a+1];c===i?(e.push(`V${d}`),r=d):d===r&&(e.push(`H${c}`),i=c)}e.push("Z")}return e.join(" ")}serialize([e,t,i,r],a){const c=[],d=i-e,f=r-t;for(const p of this.#t){const m=new Array(p.length);for(let x=0;x<p.length;x+=2)m[x]=e+p[x]*d,m[x+1]=r-p[x+1]*f;c.push(m)}return c}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class kc extends yn{newFreeDrawOutline(e,t,i,r,a,c){return new mb(e,t,i,r,a,c)}}class mb extends _p{newOutliner(e,t,i,r,a,c=0){return new kc(e,t,i,r,a,c)}}class Kt{#e=null;#t=null;#s;#n=null;#r=!1;#i=!1;#l=null;#o;#d=null;#c=null;#h;static#u=null;static get _keyboardManager(){return Ce(this,"_keyboardManager",new xr([[["Escape","mac+Escape"],Kt.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Kt.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Kt.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Kt.prototype._moveToPrevious],[["Home","mac+Home"],Kt.prototype._moveToBeginning],[["End","mac+End"],Kt.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#i=!1,this.#h=Te.HIGHLIGHT_COLOR,this.#l=e):(this.#i=!0,this.#h=Te.HIGHLIGHT_DEFAULT_COLOR),this.#c=e?._uiManager||t,this.#o=this.#c._eventBus,this.#s=e?.color||this.#c?.highlightColors.values().next().value||"#FFFF98",Kt.#u||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=this.#c._signal;e.addEventListener("click",this.#g.bind(this),{signal:t}),e.addEventListener("keydown",this.#p.bind(this),{signal:t});const i=this.#t=document.createElement("span");return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=this.#s,e.append(i),e}renderMainDropdown(){const e=this.#n=this.#f();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#f(){const e=document.createElement("div"),t=this.#c._signal;e.addEventListener("contextmenu",ls,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,r]of this.#c.highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",r),a.title=i,a.setAttribute("data-l10n-id",Kt.#u[i]);const c=document.createElement("span");a.append(c),c.className="swatch",c.style.backgroundColor=r,a.setAttribute("aria-selected",r===this.#s),a.addEventListener("click",this.#a.bind(this,r),{signal:t}),e.append(a)}return e.addEventListener("keydown",this.#p.bind(this),{signal:t}),e}#a(e,t){t.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:this.#h,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#g(e);return}const t=e.target.getAttribute("data-color");t&&this.#a(t,e)}_moveToNext(e){if(!this.#x){this.#g(e);return}if(e.target===this.#e){this.#n.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#n?.firstChild||e.target===this.#e){this.#x&&this._hideDropdownFromKeyboard();return}this.#x||this.#g(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#x){this.#g(e);return}this.#n.firstChild?.focus()}_moveToEnd(e){if(!this.#x){this.#g(e);return}this.#n.lastChild?.focus()}#p(e){Kt._keyboardManager.exec(this,e)}#g(e){if(this.#x){this.hideDropdown();return}if(this.#r=e.detail===0,this.#d||(this.#d=new AbortController,window.addEventListener("pointerdown",this.#m.bind(this),{signal:this.#c.combinedSignal(this.#d)})),this.#n){this.#n.classList.remove("hidden");return}const t=this.#n=this.#f();this.#e.append(t)}#m(e){this.#n?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#d?.abort(),this.#d=null}get#x(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#i){if(!this.#x){this.#l?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#n)return;const t=this.#c.highlightColors.values();for(const i of this.#n.children)i.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#n?.remove(),this.#n=null}}class Qe extends we{#e=null;#t=0;#s;#n=null;#r=null;#i=null;#l=null;#o=0;#d=null;#c=null;#h=null;#u=!1;#f=null;#a;#p=null;#g="";#m;#x="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Ne.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=Qe.prototype;return Ce(this,"_keyboardManager",new xr([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||Qe._defaultColor,this.#m=e.thickness||Qe._defaultThickness,this.#a=e.opacity||Qe._defaultOpacity,this.#s=e.boxes||null,this.#x=e.methodOfCreation||"",this.#g=e.text||"",this._isDraggable=!1,e.highlightId>-1?(this.#u=!0,this.#v(e),this.#C()):this.#s&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#l=e.focusNode,this.#o=e.focusOffset,this.#y(),this.#C(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#m,methodOfCreation:this.#x}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#y(){const e=new Ec(this.#s,.001);this.#c=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const t=new Ec(this.#s,.0025,.001,this._uiManager.direction==="ltr");this.#i=t.getOutlines();const{lastPoint:i}=this.#i;this.#f=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]}#v({highlightOutlines:e,highlightId:t,clipPathId:i}){this.#c=e;const r=1.5;if(this.#i=e.getNewOutline(this.#m/2+r,.0025),t>=0)this.#h=t,this.#n=i,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},!0);else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:Qe.#A(this.#c.box,(m-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:Qe.#A(this.#i.box,m),path:{d:this.#i.toSVGPath()}})}const[a,c,d,f]=e.box;switch(this.rotation){case 0:this.x=a,this.y=c,this.width=d,this.height=f;break;case 90:{const[m,x]=this.parentDimensions;this.x=c,this.y=1-a,this.width=d*x/m,this.height=f*m/x;break}case 180:this.x=1-a,this.y=1-c,this.width=d,this.height=f;break;case 270:{const[m,x]=this.parentDimensions;this.x=1-c,this.y=a,this.width=d*x/m,this.height=f*m/x;break}}const{lastPoint:p}=this.#i;this.#f=[(p[0]-a)/d,(p[1]-c)/f]}static initialize(e,t){we.initialize(e,t),Qe._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case Te.HIGHLIGHT_DEFAULT_COLOR:Qe._defaultColor=t;break;case Te.HIGHLIGHT_THICKNESS:Qe._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#f}updateParams(e,t){switch(e){case Te.HIGHLIGHT_COLOR:this.#w(t);break;case Te.HIGHLIGHT_THICKNESS:this.#_(t);break}}static get defaultPropertiesToUpdate(){return[[Te.HIGHLIGHT_DEFAULT_COLOR,Qe._defaultColor],[Te.HIGHLIGHT_THICKNESS,Qe._defaultThickness]]}get propertiesToUpdate(){return[[Te.HIGHLIGHT_COLOR,this.color||Qe._defaultColor],[Te.HIGHLIGHT_THICKNESS,this.#m||Qe._defaultThickness],[Te.HIGHLIGHT_FREE,this.#u]]}#w(e){const t=(a,c)=>{this.color=a,this.#a=c,this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:a,"fill-opacity":c}}),this.#r?.updateColor(a)},i=this.color,r=this.#a;this.addCommands({cmd:t.bind(this,e,Qe._defaultOpacity),undo:t.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#_(e){const t=this.#m,i=r=>{this.#m=r,this.#N(r)};this.addCommands({cmd:i.bind(this,e),undo:i.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Te.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(this.#r=new Kt({editor:this}),e.addColorPicker(this.#r)),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#P())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#P())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#k(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#C(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#k():e&&(this.#C(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#N(e){if(!this.#u)return;this.#v({highlightOutlines:this.#c.getNewOutline(e/2)}),this.fixAndSetPosition();const[t,i]=this.parentDimensions;this.setDims(this.width*t,this.height*i)}#k(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#C(e=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#n}=e.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#a},rootClass:{highlight:!0,free:this.#u},path:{d:this.#c.toSVGPath()}},!1,!0),this.#p=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#i.box,path:{d:this.#i.toSVGPath()}},this.#u),this.#d&&(this.#d.style.clipPath=this.#n))}static#A([e,t,i,r],a){switch(a){case 90:return[1-t-r,e,r,i];case 180:return[1-e-i,1-t-r,i,r];case 270:return[t,1-e-i,r,i]}return[e,t,i,r]}rotate(e){const{drawLayer:t}=this.parent;let i;this.#u?(e=(e-this.rotation+360)%360,i=Qe.#A(this.#c.box,e)):i=Qe.#A([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#h,{bbox:i,root:{"data-main-rotation":e}}),t.updateProperties(this.#p,{bbox:Qe.#A(this.#i.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#g&&(e.setAttribute("aria-label",this.#g),e.setAttribute("role","mark")),this.#u?e.classList.add("free"):this.div.addEventListener("keydown",this.#j.bind(this),{signal:this._uiManager._signal});const t=this.#d=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#n;const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),Ha(this,this.#d,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#j(e){Qe._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#E(!0);break;case 1:case 3:this.#E(!1);break}}#E(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#l,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#E(!1))}get _mustFixPosition(){return!this.#u}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!e}}))}#P(){return this.#u?this.rotation:0}#M(){if(this.#u)return null;const[e,t]=this.pageDimensions,[i,r]=this.pageTranslation,a=this.#s,c=new Float32Array(a.length*8);let d=0;for(const{x:f,y:p,width:m,height:x}of a){const b=f*e+i,y=(1-p)*t+r;c[d]=c[d+4]=b,c[d+1]=c[d+3]=y,c[d+2]=c[d+6]=b+m*e,c[d+5]=c[d+7]=y-x*t,d+=8}return c}#I(e){return this.#c.serialize(e,this.#P())}static startHighlighting(e,t,{target:i,x:r,y:a}){const{x:c,y:d,width:f,height:p}=i.getBoundingClientRect(),m=new AbortController,x=e.combinedSignal(m),b=y=>{m.abort(),this.#b(e,y)};window.addEventListener("blur",b,{signal:x}),window.addEventListener("pointerup",b,{signal:x}),window.addEventListener("pointerdown",Bt,{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",ls,{signal:x}),i.addEventListener("pointermove",this.#S.bind(this,e),{signal:x}),this._freeHighlight=new kc({x:r,y:a},[c,d,f,p],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#S(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#b(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,i){let r=null;if(e instanceof wp){const{data:{quadPoints:A,rect:w,rotation:S,id:N,color:C,opacity:R,popupRef:E},parent:{page:{pageNumber:L}}}=e;r=e={annotationType:Ne.HIGHLIGHT,color:Array.from(C),opacity:R,quadPoints:A,boxes:null,pageIndex:L-1,rect:w.slice(0),rotation:S,id:N,deleted:!1,popupRef:E}}else if(e instanceof qc){const{data:{inkLists:A,rect:w,rotation:S,id:N,color:C,borderStyle:{rawWidth:R},popupRef:E},parent:{page:{pageNumber:L}}}=e;r=e={annotationType:Ne.HIGHLIGHT,color:Array.from(C),thickness:R,inkLists:A,boxes:null,pageIndex:L-1,rect:w.slice(0),rotation:S,id:N,deleted:!1,popupRef:E}}const{color:a,quadPoints:c,inkLists:d,opacity:f}=e,p=await super.deserialize(e,t,i);p.color=me.makeHexColor(...a),p.#a=f||1,d&&(p.#m=e.thickness),p.annotationElementId=e.id||null,p._initialData=r;const[m,x]=p.pageDimensions,[b,y]=p.pageTranslation;if(c){const A=p.#s=[];for(let w=0;w<c.length;w+=8)A.push({x:(c[w]-b)/m,y:1-(c[w+1]-y)/x,width:(c[w+2]-c[w])/m,height:(c[w+1]-c[w+5])/x});p.#y(),p.#C(),p.rotate(p.rotation)}else if(d){p.#u=!0;const A=d[0],w={x:A[0]-b,y:x-(A[1]-y)},S=new kc(w,[0,0,m,x],1,p.#m/2,!0,.001);for(let R=0,E=A.length;R<E;R+=2)w.x=A[R]-b,w.y=x-(A[R+1]-y),S.add(w);const{id:N,clipPathId:C}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:p.color,"fill-opacity":p._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:S.toSVGPath()}},!0,!0);p.#v({highlightOutlines:S.getOutlines(),highlightId:N,clipPathId:C}),p.#C()}return p}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=this.getRect(0,0),i=we._colorManager.convert(this.color),r={annotationType:Ne.HIGHLIGHT,color:i,opacity:this.#a,thickness:this.#m,quadPoints:this.#M(),outlines:this.#I(t),pageIndex:this.pageIndex,rect:t,rotation:this.#P(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#L(r)?null:(r.id=this.annotationElementId,r)}#L(e){const{color:t}=this._initialData;return e.color.some((i,r)=>i!==t[r])}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class gb{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))this.updateProperty(t,i)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){De("Not implemented")}}class ye extends we{#e=null;#t;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#s=null;static#n=null;static#r=null;static#i=NaN;static#l=null;static#o=null;static#d=NaN;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,e.drawOutlines&&(this.#c(e),this.#f())}#c({drawOutlines:e,drawId:t,drawingOptions:i}){this.#e=e,this._drawingOptions||=i,t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#h(e,this.parent),this.#g(e.box)}#h(e,t){const{id:i}=t.drawLayer.draw(ye._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(e,t){const i=new Set(Object.keys(e));for(const[r,a]of Object.entries(t))i.has(r)?Object.assign(e[r],a):e[r]=a;return e}static getDefaultDrawingOptions(e){De("Not implemented")}static get typesMap(){De("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const i=this.typesMap.get(e);i&&this._defaultDrawingOptions.updateProperty(i,t),this._currentParent&&(ye.#s.updateProperty(i,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const i=this.constructor.typesMap.get(e);i&&this._updateProperty(e,i,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)e.push([i,t[r]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[i,r]of this.constructor.typesMap)e.push([i,t[r]]);return e}_updateProperty(e,t,i){const r=this._drawingOptions,a=r[t],c=d=>{r.updateProperty(t,d);const f=this.#e.updateProperty(t,d);f&&this.#g(f),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:c.bind(this,i),undo:c.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,ye._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#p()),{bbox:this.#m()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,ye._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#p()),{bbox:this.#m()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#m(e,t)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,ye._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#m()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#g(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#u()):e&&(this._uiManager.addShouldRescale(this),this.#f(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#h(this.#e,e)}}#a([e,t,i,r]){const{parentDimensions:[a,c],rotation:d}=this;switch(d){case 90:return[t,1-e,i*(c/a),r*(a/c)];case 180:return[1-e,1-t,i,r];case 270:return[1-t,e,i*(c/a),r*(a/c)];default:return[e,t,i,r]}}#p(){const{x:e,y:t,width:i,height:r,parentDimensions:[a,c],rotation:d}=this;switch(d){case 90:return[1-t,e,i*(a/c),r*(c/a)];case 180:return[1-e,1-t,i,r];case 270:return[t,1-e,i*(a/c),r*(c/a)];default:return[e,t,i,r]}}#g(e){if([this.x,this.y,this.width,this.height]=this.#a(e),this.div){this.fixAndSetPosition();const[t,i]=this.parentDimensions;this.setDims(this.width*t,this.height*i)}this._onResized()}#m(){const{x:e,y:t,width:i,height:r,rotation:a,parentRotation:c,parentDimensions:[d,f]}=this;switch((a*4+c)/90){case 1:return[1-t-r,e,r,i];case 2:return[1-e-i,1-t-r,i,r];case 3:return[t,1-e-i,r,i];case 4:return[e,t-i*(d/f),r*(f/d),i*(d/f)];case 5:return[1-t,e,i*(d/f),r*(f/d)];case 6:return[1-e-r*(f/d),1-t,r*(f/d),i*(d/f)];case 7:return[t-i*(d/f),1-e-r*(f/d),i*(d/f),r*(f/d)];case 8:return[e-i,t-r,i,r];case 9:return[1-t,e-i,r,i];case 10:return[1-e,1-t,i,r];case 11:return[t-r,1-e,r,i];case 12:return[e-r*(f/d),t,r*(f/d),i*(d/f)];case 13:return[1-t-i*(d/f),e-r*(f/d),i*(d/f),r*(f/d)];case 14:return[1-e,1-t-i*(d/f),r*(f/d),i*(d/f)];case 15:return[t,1-e,i*(d/f),r*(f/d)];default:return[e,t,i,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,ye._mergeSVGProperties({bbox:this.#m()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#g(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const e=super.render();e.classList.add("draw");const t=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal";const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),e}static createDrawerInstance(e,t,i,r,a){De("Not implemented")}static startDrawing(e,t,i,r){const{target:a,offsetX:c,offsetY:d,pointerId:f,pointerType:p}=r;if(ye.#l&&ye.#l!==p)return;const{viewport:{rotation:m}}=e,{width:x,height:b}=a.getBoundingClientRect(),y=ye.#n=new AbortController,A=e.combinedSignal(y);if(ye.#i||=f,ye.#l??=p,window.addEventListener("pointerup",w=>{ye.#i===w.pointerId?this._endDraw(w):ye.#o?.delete(w.pointerId)},{signal:A}),window.addEventListener("pointercancel",w=>{ye.#i===w.pointerId?this._currentParent.endDrawingSession():ye.#o?.delete(w.pointerId)},{signal:A}),window.addEventListener("pointerdown",w=>{ye.#l===w.pointerType&&((ye.#o||=new Set).add(w.pointerId),ye.#s.isCancellable()&&(ye.#s.removeLastElement(),ye.#s.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:A}),window.addEventListener("contextmenu",ls,{signal:A}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:A}),a.addEventListener("touchmove",w=>{w.timeStamp===ye.#d&&Bt(w)},{signal:A}),e.toggleDrawing(),t._editorUndoBar?.hide(),ye.#s){e.drawLayer.updateProperties(this._currentDrawId,ye.#s.startNew(c,d,x,b,m));return}t.updateUIForDefaultProperties(this),ye.#s=this.createDrawerInstance(c,d,x,b,m),ye.#r=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(ye.#r.toSVGProperties(),ye.#s.defaultSVGProperties),!0,!1)}static _drawMove(e){if(ye.#d=-1,!ye.#s)return;const{offsetX:t,offsetY:i,pointerId:r}=e;if(ye.#i===r){if(ye.#o?.size>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,ye.#s.add(t,i)),ye.#d=e.timeStamp,Bt(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,ye.#s=null,ye.#r=null,ye.#l=null,ye.#d=NaN),ye.#n&&(ye.#n.abort(),ye.#n=null,ye.#i=NaN,ye.#o=null)}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e&&t.drawLayer.updateProperties(this._currentDrawId,ye.#s.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const i=ye.#s,r=this._currentDrawId,a=i.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(r,i.setLastElement(a))},undo:()=>{t.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:Te.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(Te.DRAW_STEP),!ye.#s.isEmpty()){const{pageDimensions:[i,r],scale:a}=t,c=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:ye.#s.getOutlines(i*a,r*a,a,this._INNER_MARGIN),drawingOptions:ye.#r,mustBeCommitted:!e});return this._cleanup(!0),c}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,i,r,a,c){De("Not implemented")}static async deserialize(e,t,i){const{rawDims:{pageWidth:r,pageHeight:a,pageX:c,pageY:d}}=t.viewport,f=this.deserializeDraw(c,d,r,a,this._INNER_MARGIN,e),p=await super.deserialize(e,t,i);return p.createDrawingOptions(e),p.#c({drawOutlines:f}),p.#f(),p.onScaleChanging(),p.rotate(),p}serializeDraw(e){const[t,i]=this.pageTranslation,[r,a]=this.pageDimensions;return this.#e.serialize([t,i,r,a],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class xb{#e=new Float64Array(6);#t;#s;#n;#r;#i;#l="";#o=0;#d=new no;#c;#h;constructor(e,t,i,r,a,c){this.#c=i,this.#h=r,this.#n=a,this.#r=c,[e,t]=this.#u(e,t);const d=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#i=[e,t],this.#s=[{line:d,points:this.#i}],this.#e.set(d,0)}updateProperty(e,t){e==="stroke-width"&&(this.#r=t)}#u(e,t){return oe._normalizePoint(e,t,this.#c,this.#h,this.#n)}isEmpty(){return!this.#s||this.#s.length===0}isCancellable(){return this.#i.length<=10}add(e,t){[e,t]=this.#u(e,t);const[i,r,a,c]=this.#e.subarray(2,6),d=e-a,f=t-c;return Math.hypot(this.#c*d,this.#h*f)<=2?null:(this.#i.push(e,t),isNaN(i)?(this.#e.set([a,c,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([i,r,a,c,e,t],0),this.#t.push(...oe.createBezierPoints(i,r,a,c,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(this.#i.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,r,a){this.#c=i,this.#h=r,this.#n=a,[e,t]=this.#u(e,t);const c=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#i=[e,t];const d=this.#s.at(-1);return d&&(d.line=new Float32Array(d.line),d.points=new Float32Array(d.points)),this.#s.push({line:c,points:this.#i}),this.#e.set(c,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#s.at(-1)}setLastElement(e){return this.#s?(this.#s.push(e),this.#t=e.line,this.#i=e.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#d.setLastElement(e)}removeLastElement(){if(!this.#s)return this.#d.removeLastElement();this.#s.pop(),this.#l="";for(let e=0,t=this.#s.length;e<t;e++){const{line:i,points:r}=this.#s[e];this.#t=i,this.#i=r,this.#o=0,this.toSVGPath()}return{path:{d:this.#l}}}toSVGPath(){const e=oe.svgRound(this.#t[4]),t=oe.svgRound(this.#t[5]);if(this.#i.length===2)return this.#l=`${this.#l} M ${e} ${t} Z`,this.#l;if(this.#i.length<=6){const r=this.#l.lastIndexOf("M");this.#l=`${this.#l.slice(0,r)} M ${e} ${t}`,this.#o=6}if(this.#i.length===4){const r=oe.svgRound(this.#t[10]),a=oe.svgRound(this.#t[11]);return this.#l=`${this.#l} L ${r} ${a}`,this.#o=12,this.#l}const i=[];this.#o===0&&(i.push(`M ${e} ${t}`),this.#o=6);for(let r=this.#o,a=this.#t.length;r<a;r+=6){const[c,d,f,p,m,x]=this.#t.slice(r,r+6).map(oe.svgRound);i.push(`C${c} ${d} ${f} ${p} ${m} ${x}`)}return this.#l+=i.join(" "),this.#o=this.#t.length,this.#l}getOutlines(e,t,i,r){const a=this.#s.at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),this.#d.build(this.#s,e,t,i,this.#n,this.#r,r),this.#e=null,this.#t=null,this.#s=null,this.#l=null,this.#d}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class no extends oe{#e;#t=0;#s;#n;#r;#i;#l;#o;#d;build(e,t,i,r,a,c,d){this.#r=t,this.#i=i,this.#l=r,this.#o=a,this.#d=c,this.#s=d??0,this.#n=e,this.#u()}setLastElement(e){return this.#n.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#n){if(e.push(`M${oe.svgRound(t[4])} ${oe.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12){e.push(`L${oe.svgRound(t[10])} ${oe.svgRound(t[11])}`);continue}for(let i=6,r=t.length;i<r;i+=6){const[a,c,d,f,p,m]=t.subarray(i,i+6).map(oe.svgRound);e.push(`C${a} ${c} ${d} ${f} ${p} ${m}`)}}return e.join("")}serialize([e,t,i,r],a){const c=[],d=[],[f,p,m,x]=this.#h();let b,y,A,w,S,N,C,R,E;switch(this.#o){case 0:E=oe._rescale,b=e,y=t+r,A=i,w=-r,S=e+f*i,N=t+(1-p-x)*r,C=e+(f+m)*i,R=t+(1-p)*r;break;case 90:E=oe._rescaleAndSwap,b=e,y=t,A=i,w=r,S=e+p*i,N=t+f*r,C=e+(p+x)*i,R=t+(f+m)*r;break;case 180:E=oe._rescale,b=e+i,y=t,A=-i,w=r,S=e+(1-f-m)*i,N=t+p*r,C=e+(1-f)*i,R=t+(p+x)*r;break;case 270:E=oe._rescaleAndSwap,b=e+i,y=t+r,A=-i,w=-r,S=e+(1-p-x)*i,N=t+(1-f-m)*r,C=e+(1-p)*i,R=t+(1-f)*r;break}for(const{line:L,points:T}of this.#n)c.push(E(L,b,y,A,w,a?new Array(L.length):null)),d.push(E(T,b,y,A,w,a?new Array(T.length):null));return{lines:c,points:d,rect:[S,N,C,R]}}static deserialize(e,t,i,r,a,{paths:{lines:c,points:d},rotation:f,thickness:p}){const m=[];let x,b,y,A,w;switch(f){case 0:w=oe._rescale,x=-e/i,b=t/r+1,y=1/i,A=-1/r;break;case 90:w=oe._rescaleAndSwap,x=-t/r,b=-e/i,y=1/r,A=1/i;break;case 180:w=oe._rescale,x=e/i+1,b=-t/r,y=-1/i,A=1/r;break;case 270:w=oe._rescaleAndSwap,x=t/r+1,b=e/i+1,y=-1/r,A=-1/i;break}if(!c){c=[];for(const N of d){const C=N.length;if(C===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,N[0],N[1]]));continue}if(C===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,N[0],N[1],NaN,NaN,NaN,NaN,N[2],N[3]]));continue}const R=new Float32Array(3*(C-2));c.push(R);let[E,L,T,I]=N.subarray(0,4);R.set([NaN,NaN,NaN,NaN,E,L],0);for(let $=4;$<C;$+=2){const te=N[$],ae=N[$+1];R.set(oe.createBezierPoints(E,L,T,I,te,ae),($-2)*3),[E,L,T,I]=[T,I,te,ae]}}}for(let N=0,C=c.length;N<C;N++)m.push({line:w(c[N].map(R=>R??NaN),x,b,y,A),points:w(d[N].map(R=>R??NaN),x,b,y,A)});const S=new no;return S.build(m,i,r,1,f,p,a),S}#c(e=this.#d){const t=this.#s+e/2*this.#l;return this.#o%180===0?[t/this.#r,t/this.#i]:[t/this.#i,t/this.#r]}#h(){const[e,t,i,r]=this.#e,[a,c]=this.#c(0);return[e+a,t+c,i-2*a,r-2*c]}#u(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#n){if(r.length<=12){for(let d=4,f=r.length;d<f;d+=6){const[p,m]=r.subarray(d,d+2);e[0]=Math.min(e[0],p),e[1]=Math.min(e[1],m),e[2]=Math.max(e[2],p),e[3]=Math.max(e[3],m)}continue}let a=r[4],c=r[5];for(let d=6,f=r.length;d<f;d+=6){const[p,m,x,b,y,A]=r.subarray(d,d+6);me.bezierBoundingBox(a,c,p,m,x,b,y,A,e),a=y,c=A}}const[t,i]=this.#c();e[0]=Math.min(1,Math.max(0,e[0]-t)),e[1]=Math.min(1,Math.max(0,e[1]-i)),e[2]=Math.min(1,Math.max(0,e[2]+t)),e[3]=Math.min(1,Math.max(0,e[3]+i)),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,i]=this.#c();this.#d=e;const[r,a]=this.#c(),[c,d]=[r-t,a-i],f=this.#e;return f[0]-=c,f[1]-=d,f[2]+=2*c,f[3]+=2*d,f}updateParentDimensions([e,t],i){const[r,a]=this.#c();this.#r=e,this.#i=t,this.#l=i;const[c,d]=this.#c(),f=c-r,p=d-a,m=this.#e;return m[0]-=f,m[1]-=p,m[2]+=2*f,m[3]+=2*p,m}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(oe.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${oe.svgRound(e)} ${oe.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let i=0,r=0,a=0,c=0,d=0,f=0;switch(this.#t){case 90:r=t/e,a=-e/t,d=e;break;case 180:i=-1,c=-1,d=e,f=t;break;case 270:r=-t/e,a=e/t,f=t;break;default:return""}return`matrix(${i} ${r} ${a} ${c} ${oe.svgRound(d)} ${oe.svgRound(f)})`}getPathResizingSVGProperties([e,t,i,r]){const[a,c]=this.#c(),[d,f,p,m]=this.#e;if(Math.abs(p-a)<=oe.PRECISION||Math.abs(m-c)<=oe.PRECISION){const w=e+i/2-(d+p/2),S=t+r/2-(f+m/2);return{path:{"transform-origin":`${oe.svgRound(e)} ${oe.svgRound(t)}`,transform:`${this.rotationTransform} translate(${w} ${S})`}}}const x=(i-2*a)/(p-2*a),b=(r-2*c)/(m-2*c),y=p/i,A=m/r;return{path:{"transform-origin":`${oe.svgRound(d)} ${oe.svgRound(f)}`,transform:`${this.rotationTransform} scale(${y} ${A}) translate(${oe.svgRound(a)} ${oe.svgRound(c)}) scale(${x} ${b}) translate(${oe.svgRound(-a)} ${oe.svgRound(-c)})`}}}getPathResizedSVGProperties([e,t,i,r]){const[a,c]=this.#c(),d=this.#e,[f,p,m,x]=d;if(d[0]=e,d[1]=t,d[2]=i,d[3]=r,Math.abs(m-a)<=oe.PRECISION||Math.abs(x-c)<=oe.PRECISION){const S=e+i/2-(f+m/2),N=t+r/2-(p+x/2);for(const{line:C,points:R}of this.#n)oe._translate(C,S,N,C),oe._translate(R,S,N,R);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${oe.svgRound(e)} ${oe.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const b=(i-2*a)/(m-2*a),y=(r-2*c)/(x-2*c),A=-b*(f+a)+e+a,w=-y*(p+c)+t+c;if(b!==1||y!==1||A!==0||w!==0)for(const{line:S,points:N}of this.#n)oe._rescale(S,A,w,b,y,S),oe._rescale(N,A,w,b,y,N);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${oe.svgRound(e)} ${oe.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],i){const[r,a]=i,c=this.#e,d=e-c[0],f=t-c[1];if(this.#r===r&&this.#i===a)for(const{line:p,points:m}of this.#n)oe._translate(p,d,f,p),oe._translate(m,d,f,m);else{const p=this.#r/r,m=this.#i/a;this.#r=r,this.#i=a;for(const{line:x,points:b}of this.#n)oe._rescale(x,d,f,p,m,x),oe._rescale(b,d,f,p,m,b);c[2]*=p,c[3]*=m}return c[0]=e,c[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${oe.svgRound(e)} ${oe.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${oe.svgRound(e[0])} ${oe.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class Xc extends gb{#e;constructor(e){super(),this.#e=e,super.updateProperties({fill:"none",stroke:we._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this.#e.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Xc(this.#e);return e.updateAll(this),e}}class Yc extends ye{static _type="ink";static _editorType=Ne.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0}static initialize(e,t){we.initialize(e,t),this._defaultDrawingOptions=new Xc(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ce(this,"typesMap",new Map([[Te.INK_THICKNESS,"stroke-width"],[Te.INK_COLOR,"stroke"],[Te.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,i,r,a){return new xb(e,t,i,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,i,r,a,c){return no.deserialize(e,t,i,r,a,c)}static async deserialize(e,t,i){let r=null;if(e instanceof qc){const{data:{inkLists:c,rect:d,rotation:f,id:p,color:m,opacity:x,borderStyle:{rawWidth:b},popupRef:y},parent:{page:{pageNumber:A}}}=e;r=e={annotationType:Ne.INK,color:Array.from(m),thickness:b,opacity:x,paths:{points:c},boxes:null,pageIndex:A-1,rect:d.slice(0),rotation:f,id:p,deleted:!1,popupRef:y}}const a=await super.deserialize(e,t,i);return a.annotationElementId=e.id||null,a._initialData=r,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:i}=this;t.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:i}){this._drawingOptions=Yc.getDefaultDrawingOptions({stroke:me.makeHexColor(...e),"stroke-width":t,"stroke-opacity":i})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:i,rect:r}=this.serializeDraw(e),{_drawingOptions:{stroke:a,"stroke-opacity":c,"stroke-width":d}}=this,f={annotationType:Ne.INK,color:we._colorManager.convert(a),opacity:c,thickness:d,paths:{lines:t,points:i},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?f:this.annotationElementId&&!this.#e(f)?null:(f.id=this.annotationElementId,f)}#e(e){const{color:t,thickness:i,opacity:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((c,d)=>c!==t[d])||e.thickness!==i||e.opacity!==r||e.pageIndex!==a}renderAnnotationElement(e){const{points:t,rect:i}=this.serializeDraw(!1);return e.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:t}),null}}class Kc extends we{#e=null;#t=null;#s=null;#n=null;#r=null;#i="";#l=null;#o=null;#d=!1;#c=!1;static _type="stamp";static _editorType=Ne.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#n=e.bitmapUrl,this.#r=e.bitmapFile}static initialize(e,t){we.initialize(e,t)}static get supportedTypes(){return Ce(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return Ce(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(Ne.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#h(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#d=e.isSvg),e.file&&(this.#i=e.file.name),this.#a()}#u(){if(this.#s=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:c}=e||this.copyCanvas(null,null,!0).imageData,d=await i.guess({name:"altText",request:{data:r,width:a,height:c,channels:r.length/(a*c)}});if(!d)throw new Error("No response from the AI service.");if(d.error)throw new Error("Error from the AI service.");if(d.cancel)return null;if(!d.output)throw new Error("No valid response from the AI service.");const f=d.output;return await this.setGuessedAltText(f),t&&!this.hasAltTextData()&&(this.altTextData={alt:f,decorative:!1}),f}#f(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(i=>this.#h(i,!0)).finally(()=>this.#u());return}if(this.#n){const i=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromUrl(i).then(r=>this.#h(r)).finally(()=>this.#u());return}if(this.#r){const i=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#s=this._uiManager.imageManager.getFromFile(i).then(r=>this.#h(r)).finally(()=>this.#u());return}const e=document.createElement("input");e.type="file",e.accept=Kc.supportedTypesStr;const t=this._uiManager._signal;this.#s=new Promise(i=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(r)}i()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),i()},{signal:t})}).finally(()=>this.#u()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#l?.remove(),this.#l=null,this.#o&&(clearTimeout(this.#o),this.#o=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#f();return}super.rebuild(),this.div!==null&&(this.#t&&this.#l===null&&this.#f(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#s||this.#e||this.#n||this.#r||this.#t)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#e?this.#a():this.#f(),this.width&&!this.annotationElementId){const[i,r]=this.parentDimensions;this.setAt(e*i,t*r,this.width*i,this.height*r)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#o!==null&&clearTimeout(this.#o);const e=200;this.#o=setTimeout(()=>{this.#o=null,this.#g()},e)}#a(){const{div:e}=this;let{width:t,height:i}=this.#e;const[r,a]=this.pageDimensions,c=.75;if(this.width)t=this.width*r,i=this.height*a;else if(t>c*r||i>c*a){const m=Math.min(c*r/t,c*a/i);t*=m,i*=m}const[d,f]=this.parentDimensions;this.setDims(t*d/r,i*f/a),this._uiManager.enableWaiting(!1);const p=this.#l=document.createElement("canvas");p.setAttribute("role","img"),this.addContainer(p),this.width=t/r,this.height=i/a,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#g(),this.#c||(this.parent.addUndoableEditor(this),this.#c=!0),this._reportTelemetry({action:"inserted_image"}),this.#i&&p.setAttribute("aria-label",this.#i)}copyCanvas(e,t,i=!1){e||(e=224);const{width:r,height:a}=this.#e,c=new Ac;let d=this.#e,f=r,p=a,m=null;if(t){if(r>t||a>t){const T=Math.min(t/r,t/a);f=Math.floor(r*T),p=Math.floor(a*T)}m=document.createElement("canvas");const b=m.width=Math.ceil(f*c.sx),y=m.height=Math.ceil(p*c.sy);this.#d||(d=this.#p(b,y));const A=m.getContext("2d");A.filter=this._uiManager.hcmFilter;let w="white",S="#cfcfd8";this._uiManager.hcmFilter!=="none"?S="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(w="#8f8f9d",S="#42414d");const N=15,C=N*c.sx,R=N*c.sy,E=new OffscreenCanvas(C*2,R*2),L=E.getContext("2d");L.fillStyle=w,L.fillRect(0,0,C*2,R*2),L.fillStyle=S,L.fillRect(0,0,C,R),L.fillRect(C,R,C,R),A.fillStyle=A.createPattern(E,"repeat"),A.fillRect(0,0,b,y),A.drawImage(d,0,0,d.width,d.height,0,0,b,y)}let x=null;if(i){let b,y;if(c.symmetric&&d.width<e&&d.height<e)b=d.width,y=d.height;else if(d=this.#e,r>e||a>e){const S=Math.min(e/r,e/a);b=Math.floor(r*S),y=Math.floor(a*S),this.#d||(d=this.#p(b,y))}const w=new OffscreenCanvas(b,y).getContext("2d",{willReadFrequently:!0});w.drawImage(d,0,0,d.width,d.height,0,0,b,y),x={width:b,height:y,data:w.getImageData(0,0,b,y).data}}return{canvas:m,width:f,height:p,imageData:x}}#p(e,t){const{width:i,height:r}=this.#e;let a=i,c=r,d=this.#e;for(;a>2*e||c>2*t;){const f=a,p=c;a>2*e&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),c>2*t&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const m=new OffscreenCanvas(a,c);m.getContext("2d").drawImage(d,0,0,f,p,0,0,a,c),d=m.transferToImageBitmap()}return d}#g(){const[e,t]=this.parentDimensions,{width:i,height:r}=this,a=new Ac,c=Math.ceil(i*e*a.sx),d=Math.ceil(r*t*a.sy),f=this.#l;if(!f||f.width===c&&f.height===d)return;f.width=c,f.height=d;const p=this.#d?this.#e:this.#p(c,d),m=f.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(p,0,0,p.width,p.height,0,0,c,d)}getImageForAltText(){return this.#l}#m(e){if(e){if(this.#d){const r=this._uiManager.imageManager.getSvgUrl(this.#t);if(r)return r}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#d){const[t,i]=this.pageDimensions,r=Math.round(this.width*t*ri.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*ri.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(r,a);return c.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,r,a),c.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,i){let r=null;if(e instanceof Ap){const{data:{rect:A,rotation:w,id:S,structParent:N,popupRef:C},container:R,parent:{page:{pageNumber:E}}}=e,L=R.querySelector("canvas"),T=i.imageManager.getFromCanvas(R.id,L);L.remove();const I=(await t._structTree.getAriaAttributes(`${Ic}${S}`))?.get("aria-label")||"";r=e={annotationType:Ne.STAMP,bitmapId:T.id,bitmap:T.bitmap,pageIndex:E-1,rect:A.slice(0),rotation:w,id:S,deleted:!1,accessibilityData:{decorative:!1,altText:I},isSvg:!1,structParent:N,popupRef:C}}const a=await super.deserialize(e,t,i),{rect:c,bitmap:d,bitmapUrl:f,bitmapId:p,isSvg:m,accessibilityData:x}=e;p&&i.imageManager.isValidId(p)?(a.#t=p,d&&(a.#e=d)):a.#n=f,a.#d=m;const[b,y]=a.pageDimensions;return a.width=(c[2]-c[0])/b,a.height=(c[3]-c[1])/y,a.annotationElementId=e.id||null,x&&(a.altTextData=x),a._initialData=r,a.#c=!!r,a}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:Ne.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#d,structTreeParentId:this._structTreeParentId};if(e)return i.bitmapUrl=this.#m(!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const d=this.#x(i);if(d.isSame)return null;d.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,t===null)return i;t.stamps||=new Map;const c=this.#d?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:c,serialized:i}),i.bitmap=this.#m(!1);else if(this.#d){const d=t.stamps.get(this.#t);c>d.area&&(d.area=c,d.serialized.bitmap.close(),d.serialized.bitmap=this.#m(!1))}return i}#x(e){const{pageIndex:t,accessibilityData:{altText:i}}=this._initialData,r=e.pageIndex===t,a=(e.accessibilityData?.alt||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}class ks{#e;#t=!1;#s=null;#n=null;#r=null;#i=new Map;#l=!1;#o=!1;#d=!1;#c=null;#h=null;#u=null;#f=null;#a;static _initialized=!1;static#p=new Map([rt,Yc,Kc,Qe].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:r,accessibilityManager:a,annotationLayer:c,drawLayer:d,textLayer:f,viewport:p,l10n:m}){const x=[...ks.#p.values()];if(!ks._initialized){ks._initialized=!0;for(const b of x)b.initialize(m,e)}e.registerEditorTypes(x),this.#a=e,this.pageIndex=t,this.div=i,this.#e=a,this.#s=c,this.viewport=p,this.#u=f,this.drawLayer=d,this._structTree=r,this.#a.addLayer(this)}get isEmpty(){return this.#i.size===0}get isInvisible(){return this.isEmpty&&this.#a.getMode()===Ne.NONE}updateToolbar(e){this.#a.updateToolbar(e)}updateMode(e=this.#a.getMode()){switch(this.#v(),e){case Ne.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ne.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Ne.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const i of ks.#p.values())t.toggle(`${i._type}Editing`,e===i._editorType);this.div.hidden=!1}hasTextLayer(e){return e===this.#u?.div}setEditingState(e){this.#a.setEditingState(e)}addCommands(e){this.#a.addCommands(e)}cleanUndoStack(e){this.#a.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#s?.div.classList.toggle("disabled",!e)}async enable(){this.#d=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const i of this.#i.values())i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#a.removeChangedExistingAnnotation(i),e.add(i.annotationElementId));if(!this.#s){this.#d=!1;return}const t=this.#s.getEditableAnnotations();for(const i of t){if(i.hide(),this.#a.isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const r=await this.deserialize(i);r&&(this.addOrRebuild(r),r.enableEditing())}this.#d=!1}disable(){this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of this.#i.values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);this.getEditableAnnotation(r.annotationElementId)?.show(),r.remove()}if(this.#s){const r=this.#s.getEditableAnnotations();for(const a of r){const{id:c}=a.data;if(this.#a.isDeletedAnnotationElement(c))continue;let d=t.get(c);if(d){d.resetAnnotationElement(a),d.show(!1),a.show();continue}d=e.get(c),d&&(this.#a.addChangedExistingAnnotation(d),d.renderAnnotationElement(a)&&d.show(!1)),a.show()}}this.#v(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of ks.#p.values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(e){return this.#s?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#a.getActive()!==e&&this.#a.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#f){this.#f=new AbortController;const e=this.#a.combinedSignal(this.#f);this.#u.div.addEventListener("pointerdown",this.#g.bind(this),{signal:e}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#u.div.classList.remove("highlighting"))}#g(e){this.#a.unselectAll();const{target:t}=e;if(t===this.#u.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#u.div.contains(t)){const{isMac:i}=Et.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#a.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),Qe.startHighlighting(this,this.#a.direction==="ltr",{target:this.#u.div,x:e.x,y:e.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#a._signal}),e.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const e=this.#a.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#n?.abort(),this.#n=null}attach(e){this.#i.set(e.id,e);const{annotationElementId:t}=e;t&&this.#a.isDeletedAnnotationElement(t)&&this.#a.removeDeletedAnnotationElement(e)}detach(e){this.#i.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#o&&e.annotationElementId&&this.#a.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#a.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#a.addDeletedAnnotationElement(e.annotationElementId),we.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#a.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#d),this.#a.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#r&&(e._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#a._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getNextId(){return this.#a.getId()}get#m(){return ks.#p.get(this.#a.getMode())}combinedSignal(e){return this.#a.combinedSignal(e)}#x(e){const t=this.#m;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#m?.canCreateNewEmptyEditor()}pasteEditor(e,t){this.#a.updateToolbar(e),this.#a.updateMode(e);const{offsetX:i,offsetY:r}=this.#y(),a=this.getNextId(),c=this.#x({parent:this,id:a,x:i,y:r,uiManager:this.#a,isCentered:!0,...t});c&&this.add(c)}async deserialize(e){return await ks.#p.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#a)||null}createAndAddNewEditor(e,t,i={}){const r=this.getNextId(),a=this.#x({parent:this,id:r,x:e.offsetX,y:e.offsetY,uiManager:this.#a,isCentered:t,...i});return a&&this.add(a),a}#y(){const{x:e,y:t,width:i,height:r}=this.div.getBoundingClientRect(),a=Math.max(0,e),c=Math.max(0,t),d=Math.min(window.innerWidth,e+i),f=Math.min(window.innerHeight,t+r),p=(a+d)/2-e,m=(c+f)/2-t,[x,b]=this.viewport.rotation%180===0?[p,m]:[m,p];return{offsetX:x,offsetY:b}}addNewEditor(){this.createAndAddNewEditor(this.#y(),!0)}setSelected(e){this.#a.setSelected(e)}toggleSelected(e){this.#a.toggleSelected(e)}unselect(e){this.#a.unselect(e)}pointerup(e){const{isMac:t}=Et.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&this.#l&&(this.#l=!1,!(this.#m?.isDrawer&&this.#m.supportMultipleDrawings))){if(!this.#t){this.#t=!0;return}if(this.#a.getMode()===Ne.STAMP){this.#a.unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){if(this.#a.getMode()===Ne.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}const{isMac:t}=Et.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#l=!0,this.#m?.isDrawer){this.startDrawingSession(e);return}const i=this.#a.getActive();this.#t=!i||i.isEmpty()}startDrawingSession(e){if(this.div.focus(),this.#c){this.#m.startDrawing(this,this.#a,!1,e);return}this.#a.setCurrentDrawingSession(this),this.#c=new AbortController;const t=this.#a.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#h=null,this.commitOrRemove())},{signal:t}),this.#m.startDrawing(this,this.#a,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#h=t);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(e=!1){return this.#c?(this.#a.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#h=null,this.#m.endDrawing(e)):null}findNewParent(e,t,i){const r=this.#a.findParent(t,i);return r===null||r===this?!1:(r.changeParent(e),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#m.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const e of this.#i.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#i.clear(),this.#a.removeLayer(this)}#v(){for(const e of this.#i.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,_n(this.div,e);for(const t of this.#a.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#a.commitOrRemove(),this.#v();const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,_n(this.div,{rotation:i}),t!==i)for(const r of this.#i.values())r.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#a.viewParameters.realScale}}class St{#e=null;#t=0;#s=new Map;#n=new Map;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#s.size>0)for(const t of this.#s.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return Ce(this,"_svgFactory",new Wc)}static#r(e,[t,i,r,a]){const{style:c}=e;c.top=`${100*i}%`,c.left=`${100*t}%`,c.width=`${100*r}%`,c.height=`${100*a}%`}#i(){const e=St._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#l(e,t){const i=St._svgFactory.createElement("clipPath");e.append(i);const r=`clip_${t}`;i.setAttribute("id",r),i.setAttribute("clipPathUnits","objectBoundingBox");const a=St._svgFactory.createElement("use");return i.append(a),a.setAttribute("href",`#${t}`),a.classList.add("clip"),r}#o(e,t){for(const[i,r]of Object.entries(t))r===null?e.removeAttribute(i):e.setAttribute(i,r)}draw(e,t=!1,i=!1){const r=this.#t++,a=this.#i(),c=St._svgFactory.createElement("defs");a.append(c);const d=St._svgFactory.createElement("path");c.append(d);const f=`path_p${this.pageIndex}_${r}`;d.setAttribute("id",f),d.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#n.set(r,d);const p=i?this.#l(c,f):null,m=St._svgFactory.createElement("use");return a.append(m),m.setAttribute("href",`#${f}`),this.updateProperties(a,e),this.#s.set(r,a),{id:r,clipPathId:`url(#${p})`}}drawOutline(e,t){const i=this.#t++,r=this.#i(),a=St._svgFactory.createElement("defs");r.append(a);const c=St._svgFactory.createElement("path");a.append(c);const d=`path_p${this.pageIndex}_${i}`;c.setAttribute("id",d),c.setAttribute("vector-effect","non-scaling-stroke");let f;if(t){const x=St._svgFactory.createElement("mask");a.append(x),f=`mask_p${this.pageIndex}_${i}`,x.setAttribute("id",f),x.setAttribute("maskUnits","objectBoundingBox");const b=St._svgFactory.createElement("rect");x.append(b),b.setAttribute("width","1"),b.setAttribute("height","1"),b.setAttribute("fill","white");const y=St._svgFactory.createElement("use");x.append(y),y.setAttribute("href",`#${d}`),y.setAttribute("stroke","none"),y.setAttribute("fill","black"),y.setAttribute("fill-rule","nonzero"),y.classList.add("mask")}const p=St._svgFactory.createElement("use");r.append(p),p.setAttribute("href",`#${d}`),f&&p.setAttribute("mask",`url(#${f})`);const m=p.cloneNode();return r.append(m),p.classList.add("mainOutline"),m.classList.add("secondaryOutline"),this.updateProperties(r,e),this.#s.set(i,r),i}finalizeDraw(e,t){this.#n.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:i,bbox:r,rootClass:a,path:c}=t,d=typeof e=="number"?this.#s.get(e):e;if(d){if(i&&this.#o(d,i),r&&St.#r(d,r),a){const{classList:f}=d;for(const[p,m]of Object.entries(a))f.toggle(p,m)}if(c){const p=d.firstChild.firstChild;this.#o(p,c)}}}updateParent(e,t){if(t===this)return;const i=this.#s.get(e);i&&(t.#e.append(i),this.#s.delete(e),t.#s.set(e,i))}remove(e){this.#n.delete(e),this.#e!==null&&(this.#s.get(e).remove(),this.#s.delete(e))}destroy(){this.#e=null;for(const e of this.#s.values())e.remove();this.#s.clear(),this.#n.clear()}}globalThis.pdfjsTestingUtils={HighlightOutliner:Ec};Se.AbortException;Se.AnnotationEditorLayer;Se.AnnotationEditorParamsType;Se.AnnotationEditorType;Se.AnnotationEditorUIManager;Se.AnnotationLayer;Se.AnnotationMode;Se.ColorPicker;Se.DOMSVGFactory;Se.DrawLayer;Se.FeatureTest;var vb=Se.GlobalWorkerOptions;Se.ImageKind;Se.InvalidPDFException;Se.MissingPDFException;Se.OPS;Se.OutputScale;Se.PDFDataRangeTransport;Se.PDFDateString;Se.PDFWorker;Se.PasswordResponses;Se.PermissionFlag;Se.PixelsPerInch;Se.RenderingCancelledException;Se.TextLayer;Se.TouchManager;Se.UnexpectedResponseException;Se.Util;Se.VerbosityLevel;Se.XfaLayer;Se.build;Se.createValidAbsoluteUrl;Se.fetchData;var bb=Se.getDocument;Se.getFilenameFromUrl;Se.getPdfFilenameFromUrl;Se.getXfaPageViewport;Se.isDataScheme;Se.isPdfFile;Se.noContextMenu;Se.normalizeUnicode;Se.setLayerDimensions;Se.shadow;Se.stopEvent;Se.version;const yb="/assets/pdf.worker.min-yatZIOMy.mjs";typeof window<"u"&&(vb.workerSrc=yb);const wb="data:audio/mp3;base64,//uQxAAAAAANIAAAAAExBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/7kMQAD8AAADSAAAAANIAAADSAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVQ==";let rr=null;function Cf(){try{rr||(rr=new Audio(wb),rr.volume=.25),rr.currentTime=0,rr.play().catch(()=>{})}catch{}}function Ab({pdfUrl:u,currentPage:e,onRequestPrev:t,onRequestNext:i,onTotalPagesChange:r,onPageChange:a,zoom:c=100,title:d,className:f="",flipPhase:p,flipDirection:m,onFlipAnimationEnd:x,isFlipping:b}){const y=j.useRef(null),[A,w]=j.useState(null),[S,N]=j.useState(0),[C,R]=j.useState(!0),[E,L]=j.useState(null),[T,I]=j.useState(!1),$=j.useRef(!1),[te,ae]=j.useState(!1),[de,Ae]=j.useState(""),[pe,be]=j.useState([]),[ke,X]=j.useState(0),[Z,q]=j.useState(!1),se=j.useRef(null);j.useEffect(()=>{if(!u)return;let B=!0;return R(!0),L(null),bb(u).promise.then(K=>{B&&(w(K),N(K.numPages),r(K.numPages),R(!1))}).catch(K=>{B&&(K.name==="AbortException"||K.name==="RenderingCancelledException"||(console.error("PdfJsFlipbook: Error loading PDF:",K),L(K.message||"Erreur inconnue lors du chargement"),R(!1)))}),()=>{B=!1}},[u,r]),j.useEffect(()=>{if(!A||!y.current||$.current||b&&p!=="in")return;const ee=setTimeout(async()=>{$.current=!0,I(!0),console.log(`[PdfJs] Rendering page ${e}`);try{const K=await A.getPage(e),ce=y.current,Me=ce.getContext("2d"),dt=K.getViewport({scale:2*(c/100)});ce.width=dt.width,ce.height=dt.height,Me.clearRect(0,0,ce.width,ce.height),Me.fillStyle="#ffffff",Me.fillRect(0,0,ce.width,ce.height),await K.render({canvasContext:Me,viewport:dt}).promise,Q(Me,ce.width,ce.height),console.log(`[PdfJs] Page ${e} rendered`)}catch(K){console.error("[PdfJs] Page render error:",K)}finally{I(!1),$.current=!1}},b?50:0);return()=>clearTimeout(ee)},[A,e,c,b,p]);const Q=(B,ee,K)=>{const ce="Tarikh.ma";B.save(),B.font="24px serif",B.fillStyle="rgba(100, 100, 100, 0.08)";const Me=B.measureText(ce).width,yt=Math.max(400,Me+200),dt=300;B.rotate(-25*Math.PI/180);for(let wt=-K;wt<K*2;wt+=dt)for(let Ut=-ee;Ut<ee*2;Ut+=yt){const rn=wt/dt%2===0?0:yt/2;B.fillText(ce,Ut+rn,wt)}B.restore()};j.useEffect(()=>{const B=ee=>{(ee.ctrlKey||ee.metaKey)&&ee.key==="f"&&(ee.preventDefault(),ae(!0),setTimeout(()=>se.current?.focus(),100)),ee.key==="Escape"&&te&&(ae(!1),Ae(""),be([]))};return window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[te]);const V=j.useCallback(async()=>{if(!A||!de.trim()){be([]);return}q(!0);const B=[],ee=de.toLowerCase();console.log(`[PdfJs Search] Searching for: "${ee}" in ${A.numPages} pages`);try{for(let K=1;K<=A.numPages;K++){const yt=(await(await A.getPage(K)).getTextContent()).items.map(Ut=>Ut.str).join(" ").toLowerCase();K<=3&&console.log(`[PdfJs Search] Page ${K} text (first 200 chars):`,yt.slice(0,200)||"(empty - no text layer)");let dt=0,wt=0;for(;(dt=yt.indexOf(ee,dt))!==-1;)B.push({pageNum:K,matchIndex:wt}),wt++,dt+=ee.length}console.log(`[PdfJs Search] Found ${B.length} results`),be(B),X(0),B.length>0&&a&&a(B[0].pageNum)}catch(K){console.error("[PdfJs] Search error:",K)}finally{q(!1)}},[A,de,a]);j.useEffect(()=>{if(!de.trim()||de.length<2){be([]);return}const B=setTimeout(()=>{V()},300);return()=>clearTimeout(B)},[de,V]);const z=j.useCallback(()=>{if(pe.length===0)return;const B=(ke+1)%pe.length;X(B),a&&a(pe[B].pageNum)},[pe,ke,a]),ie=j.useCallback(()=>{if(pe.length===0)return;const B=(ke-1+pe.length)%pe.length;X(B),a&&a(pe[B].pageNum)},[pe,ke,a]);if(E)return l.jsxs("div",{className:`flex flex-col items-center justify-center bg-slate-100 rounded p-6 text-center ${f}`,style:{minHeight:280},children:[l.jsx("span",{className:"material-symbols-outlined text-4xl text-red-400 mb-2",children:"error"}),l.jsx("span",{className:"text-slate-600 text-sm font-medium mb-1",children:"Impossible de charger le PDF."}),l.jsx("span",{className:"text-slate-400 text-xs",children:E})]});const ge=()=>{Cf(),t()},U=()=>{Cf(),i()};return l.jsxs("div",{className:`cahier-viewer cahier-viewer-brochure relative w-full flex-1 flex items-center justify-center min-h-0 overflow-hidden ${b?"is-flipping":""} ${f}`,children:[te&&l.jsxs("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-30 flex items-center gap-2 bg-white/95 backdrop-blur-sm rounded-lg shadow-lg border border-slate-200 px-3 py-2",children:[l.jsx("span",{className:"material-symbols-outlined text-slate-400 text-xl",children:"search"}),l.jsx("input",{ref:se,type:"text",value:de,onChange:B=>Ae(B.target.value),onKeyDown:B=>{B.key==="Enter"&&(B.shiftKey?ie():pe.length>0?z():V())},placeholder:"Rechercher dans le document...",className:"w-48 sm:w-64 bg-transparent text-sm text-slate-700 placeholder:text-slate-400 focus:outline-none",autoFocus:!0}),Z?l.jsx("span",{className:"text-xs text-slate-400 animate-pulse",children:"..."}):pe.length>0?l.jsxs("span",{className:"text-xs text-slate-500 whitespace-nowrap",children:[ke+1," / ",pe.length]}):de&&!Z?l.jsx("span",{className:"text-xs text-slate-400",children:"0 rsultat"}):null,l.jsx("button",{type:"button",onClick:ie,disabled:pe.length===0,className:"p-1 hover:bg-slate-100 rounded disabled:opacity-40 disabled:cursor-not-allowed",title:"Rsultat prcdent (Shift+Entre)",children:l.jsx("span",{className:"material-symbols-outlined text-lg text-slate-500",children:"expand_less"})}),l.jsx("button",{type:"button",onClick:z,disabled:pe.length===0,className:"p-1 hover:bg-slate-100 rounded disabled:opacity-40 disabled:cursor-not-allowed",title:"Rsultat suivant (Entre)",children:l.jsx("span",{className:"material-symbols-outlined text-lg text-slate-500",children:"expand_more"})}),l.jsx("button",{type:"button",onClick:()=>{ae(!1),Ae(""),be([])},className:"p-1 hover:bg-slate-100 rounded",title:"Fermer (chap)",children:l.jsx("span",{className:"material-symbols-outlined text-lg text-slate-500",children:"close"})})]}),!te&&l.jsx("button",{type:"button",onClick:()=>{ae(!0),setTimeout(()=>se.current?.focus(),100)},className:"absolute top-4 right-4 z-20 w-10 h-10 flex items-center justify-center rounded-full bg-white/90 shadow-md border border-slate-200/80 text-slate-600 hover:bg-white hover:text-slate-900 transition-all hover:scale-105",title:"Rechercher (Ctrl+F)",children:l.jsx("span",{className:"material-symbols-outlined text-xl",children:"search"})}),l.jsx("button",{type:"button",onClick:ge,disabled:e<=1||b||C,className:"absolute left-2 sm:left-4 top-1/2 -translate-y-1/2 z-20 w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center rounded-full bg-white/90 shadow-md border border-slate-200/80 text-slate-600 hover:bg-white hover:text-slate-900 disabled:opacity-40 disabled:pointer-events-none transition-all hover:scale-105","aria-label":"Page prcdente",children:l.jsx("span",{className:"material-symbols-outlined text-2xl sm:text-3xl font-light",children:"chevron_left"})}),l.jsx("button",{type:"button",onClick:U,disabled:e>=S||b||C,className:"absolute right-2 sm:right-4 top-1/2 -translate-y-1/2 z-20 w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center rounded-full bg-white/90 shadow-md border border-slate-200/80 text-slate-600 hover:bg-white hover:text-slate-900 disabled:opacity-40 disabled:pointer-events-none transition-all hover:scale-105","aria-label":"Page suivante",children:l.jsx("span",{className:"material-symbols-outlined text-2xl sm:text-3xl font-light",children:"chevron_right"})}),l.jsx("div",{role:"button",tabIndex:0,onClick:ge,onKeyDown:B=>B.key==="Enter"&&ge(),className:"cahier-zone-prev","aria-label":"Page prcdente (zone)","aria-disabled":b}),l.jsx("div",{role:"button",tabIndex:0,onClick:U,onKeyDown:B=>B.key==="Enter"&&U(),className:"cahier-zone-next","aria-label":"Page suivante (zone)","aria-disabled":b}),l.jsx("div",{className:`cahier-page relative w-full h-full flex items-center justify-center min-h-[50vh] sm:min-h-[60vh] max-h-[75vh] sm:max-h-[80vh] ${p&&m?`turn-${m}-${p}`:""}`,onAnimationEnd:x,children:l.jsxs("div",{className:"cahier-page-inner absolute inset-0 flex items-center justify-center rounded overflow-hidden bg-white shadow-[0_2px_16px_rgba(0,0,0,0.08),inset_0_0_0_1px_rgba(0,0,0,0.06)]",children:[C&&l.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-50 z-10",children:l.jsx("span",{className:"text-slate-500 text-sm animate-pulse",children:"Chargement"})}),T&&!C&&l.jsx("div",{className:"absolute inset-x-0 bottom-4 flex items-center justify-center z-0 pointer-events-none",children:l.jsx("span",{className:"text-slate-400 text-[10px] uppercase tracking-widest bg-white/80 px-2 py-1 rounded",children:"Rendu..."})}),l.jsx("canvas",{ref:y,className:"max-w-full max-h-full object-contain select-none pointer-events-none",style:{userSelect:"none",WebkitUserSelect:"none"},onContextMenu:B=>B.preventDefault(),"aria-label":d}),l.jsx("div",{className:"paper-texture-overlay absolute inset-0 pointer-events-none mix-blend-multiply opacity-[0.03]"})]})})]})}function _b(u){return u==null?"":typeof u=="string"?u:String(u)}function Sb(){const{id:u}=Lc(),[e,t]=j.useState(null),[i,r]=j.useState([]),[a,c]=j.useState(!0),[d,f]=j.useState(100),[p,m]=j.useState(1),[x,b]=j.useState(null),[y,A]=j.useState(null),[w,S]=j.useState(null),N=j.useRef(null),C=e?.type==="pdf",R=x!==null,E=C&&e?.pages_status==="completed"&&(e?.pages_count??0)>0,L=C&&!E,T=E?e?.pages_count??1:0,[I,$]=j.useState(0);j.useEffect(()=>(e&&(window.document.title=`${e.title}  Tarikh.ma`),()=>{window.document.title="Tarikh.ma"}),[e?.title]),j.useEffect(()=>{u&&(m(1),S(null),b(null),A(null),Ba.get(u).then(U=>{t(U.document),r(U.similar??[])}).catch(()=>t(null)).finally(()=>c(!1)))},[u]),j.useEffect(()=>{if(!e||e.type!=="pdf"){S(null);return}const U=rc(String(e.id));S(null);let B=null,ee=!1;return fetch(U).then(K=>{if(!K.ok)throw new Error(K.statusText);return K.blob()}).then(K=>{if(ee)return;const ce=URL.createObjectURL(K);B=ce,S(ce)}).catch(()=>{}),()=>{ee=!0,B&&URL.revokeObjectURL(B),S(null)}},[e?.id,e?.type]);const te=500,ae=j.useRef(null),de=U=>{if(U.target===U.currentTarget)if(console.log(`[Flip] Animation end Phase:${x} Page:${p}`),x==="out"){const B=y==="next"?p+1:p-1;console.log(`[Flip] Moving to page ${B}, phase -> IN`),m(B),b("in")}else x==="in"&&(console.log("[Flip] Phase IN finished -> NULL"),b(null),A(null))};j.useEffect(()=>{if(x===null){ae.current&&(clearTimeout(ae.current),ae.current=null);return}const U=x,B=y,ee=p;return ae.current=setTimeout(()=>{if(ae.current)if(console.warn(`[Flip] Fallback triggered for phase ${U}`),ae.current=null,U==="out"){const K=B==="next"?ee+1:ee-1;m(K),b("in")}else b(null),A(null)},te+200),()=>{ae.current&&(clearTimeout(ae.current),ae.current=null)}},[x,y,p]);const Ae=()=>{const U=p>1&&!R;console.log(`[Nav] Prev clicked. Page:${p} isFlipping:${R} CanGo:${U}`),U&&(A("prev"),b("out"))},pe=()=>{const U=E?T:I,B=p<U&&!R;console.log(`[Nav] Next clicked. Page:${p}/${U} isFlipping:${R} CanGo:${B}`),B&&(A("next"),b("out"))};j.useEffect(()=>{if(!C)return;const U=B=>{B.key==="ArrowLeft"?(B.preventDefault(),Ae()):B.key==="ArrowRight"&&(B.preventDefault(),pe())};return window.addEventListener("keydown",U),()=>window.removeEventListener("keydown",U)},[C,p,I,T,R]),j.useEffect(()=>{if(!e)return;const U=N.current;if(!U)return;const B=K=>{try{const ce=window.document.getSelection();(U.contains(window.document.activeElement)||ce?.anchorNode&&U.contains(ce.anchorNode))&&(K.preventDefault(),K.stopPropagation())}catch{K.preventDefault()}},ee=K=>{if(!U.contains(window.document.activeElement))return;(K.ctrlKey||K.metaKey)&&(K.key==="c"||K.key==="x"||K.key==="v"||K.key==="a")&&(K.preventDefault(),K.stopPropagation())};return window.document.addEventListener("copy",B,!0),window.document.addEventListener("cut",B,!0),window.document.addEventListener("paste",B,!0),window.document.addEventListener("keydown",ee,!0),()=>{window.document.removeEventListener("copy",B,!0),window.document.removeEventListener("cut",B,!0),window.document.removeEventListener("paste",B,!0),window.document.removeEventListener("keydown",ee,!0)}},[e]);const be=e?.region?.name??"";if(a)return l.jsxs("div",{className:"flex flex-col flex-1 min-h-0 w-full",children:[l.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3 border-b border-slate-200 bg-white/95 backdrop-blur-md px-4 sm:px-6 py-3 z-50 shrink-0",children:[l.jsxs(he,{to:"/",className:"flex items-center gap-2 sm:gap-3",children:[l.jsx("span",{className:"text-accent-gold material-symbols-outlined text-xl sm:text-2xl",children:"auto_stories"}),l.jsx("h2",{className:"text-lg sm:text-xl font-bold tracking-tight text-slate-900",children:"Tarikh.ma"})]}),l.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[l.jsxs("div",{className:"relative hidden sm:block",children:[l.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-lg",children:"search"}),l.jsx("input",{className:"bg-slate-100 border-none rounded-lg pl-9 pr-3 py-2 text-sm w-44 lg:w-64",placeholder:"Rechercher...",type:"text",readOnly:!0})]}),l.jsx(he,{to:"/login",className:"bg-accent-gold text-white text-sm font-bold px-4 py-2 sm:px-5 rounded-lg hover:brightness-110 transition-all shadow-lg shadow-accent-gold/20 whitespace-nowrap",children:"Mon Compte"})]})]}),l.jsxs("main",{className:"flex flex-1 flex-col lg:flex-row overflow-hidden min-h-0",children:[l.jsx("div",{className:"flex-1 flex items-center justify-center bg-slate-100 min-h-[40vh]",children:l.jsx("span",{className:"text-slate-500",children:"Chargement"})}),l.jsx("aside",{className:"w-full lg:w-96 bg-white border-t lg:border-t-0 lg:border-l border-slate-200 hidden lg:block animate-pulse shrink-0"})]})]});if(!e)return l.jsxs("div",{className:"flex flex-col flex-1 min-h-0 w-full",children:[l.jsxs("header",{className:"flex items-center justify-between border-b border-slate-200 bg-white px-6 py-3 z-50 shrink-0",children:[l.jsxs(he,{to:"/",className:"flex items-center gap-3",children:[l.jsx("span",{className:"text-primary material-symbols-outlined text-2xl",children:"auto_stories"}),l.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Tarikh.ma"})]}),l.jsx(he,{to:"/archives",className:"text-primary font-semibold",children:"Retour aux archives"})]}),l.jsx("main",{className:"flex flex-1 items-center justify-center p-12 min-h-0",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-slate-600",children:"Document introuvable."}),l.jsx(he,{to:"/archives",className:"text-accent-gold font-semibold mt-4 inline-block hover:underline",children:"Retour aux archives"})]})})]});const ke=rc(String(e.id)),X=e.type==="image",Z=e.type==="video",q=e.type==="audio",se=C||X||Z||q,Q=U=>U.preventDefault(),V=U=>{U.preventDefault(),U.stopPropagation()},z=U=>{U.preventDefault(),U.stopPropagation()},ie=U=>{U.preventDefault(),U.stopPropagation()},ge=U=>{(U.ctrlKey||U.metaKey)&&(U.key==="c"||U.key==="x"||U.key==="v"||U.key==="a")&&(U.preventDefault(),U.stopPropagation())};return l.jsxs("div",{className:"flex flex-col flex-1 min-h-0 w-full",children:[l.jsxs("header",{className:"flex flex-wrap items-center justify-between gap-3 border-b border-slate-200 bg-white/95 backdrop-blur-md px-4 sm:px-6 py-3 z-50 shrink-0",children:[l.jsxs("div",{className:"flex items-center gap-3 sm:gap-6 min-w-0 flex-1",children:[l.jsxs(he,{to:"/",className:"flex items-center gap-2 sm:gap-3 shrink-0",children:[l.jsx("span",{className:"text-accent-gold",children:l.jsx("span",{className:"material-symbols-outlined text-xl sm:text-2xl",children:"auto_stories"})}),l.jsx("h2",{className:"text-lg sm:text-xl font-bold tracking-tight text-slate-900 truncate",children:"Tarikh.ma"})]}),l.jsxs("nav",{className:"hidden md:flex items-center gap-1 text-sm font-medium text-slate-500 min-w-0",children:[l.jsx(he,{to:"/archives",className:"hover:text-accent-gold px-2 transition-colors shrink-0",children:"Archives"}),be&&l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"material-symbols-outlined text-xs shrink-0",children:"chevron_right"}),l.jsx(he,{to:"/archives",className:"hover:text-accent-gold px-2 transition-colors truncate max-w-[120px]",children:be})]}),l.jsx("span",{className:"material-symbols-outlined text-xs shrink-0",children:"chevron_right"}),l.jsx("span",{className:"text-slate-900 truncate max-w-[140px] lg:max-w-[200px]",title:e.title,children:e.title})]})]}),l.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 shrink-0",children:[l.jsxs("div",{className:"relative hidden sm:block",children:[l.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-lg",children:"search"}),l.jsx("input",{className:"bg-slate-100 border-none rounded-lg pl-9 pr-3 py-2 text-sm w-44 lg:w-64 focus:ring-2 focus:ring-accent-gold/40 transition-all",placeholder:"Rechercher...",type:"text",readOnly:!0})]}),l.jsx(he,{to:"/login",className:"bg-accent-gold text-white text-sm font-bold px-4 py-2 sm:px-5 rounded-lg hover:brightness-110 transition-all shadow-lg shadow-accent-gold/20 whitespace-nowrap",children:"Mon Compte"})]})]}),l.jsxs("main",{className:"flex flex-1 flex-col lg:flex-row overflow-auto lg:overflow-hidden relative min-h-0",children:[l.jsxs("div",{className:"flex-1 flex flex-col bg-[#fcfaf7] relative group min-w-0 min-h-[40vh] sm:min-h-[50vh] border-b border-slate-200 lg:border-b-0 lg:border-r border-slate-200",children:[l.jsxs("div",{className:"absolute top-3 left-4 z-20 flex items-center gap-2 px-3 py-1.5 rounded-md bg-white/95 shadow-sm border border-accent-gold/20",children:[l.jsx("span",{className:"material-symbols-outlined text-accent-gold text-lg",children:"visibility"}),l.jsx("span",{className:"text-slate-700 text-xs font-semibold uppercase tracking-wider",children:"Lecture en ligne uniquement"}),l.jsx("span",{className:"text-slate-400 text-[10px] hidden sm:inline",children:" Copier/coller dsactiv"})]}),l.jsxs("div",{className:"absolute top-3 left-1/2 -translate-x-1/2 flex items-center gap-0.5 bg-white/90 shadow-sm border border-slate-200/80 p-1 rounded-lg z-20 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity duration-300",children:[l.jsx("button",{type:"button",onClick:()=>f(U=>Math.min(200,U+10)),className:"p-2 hover:bg-slate-100 rounded text-slate-600 transition-colors","aria-label":"Zoom avant",children:l.jsx("span",{className:"material-symbols-outlined text-lg",children:"zoom_in"})}),l.jsx("button",{type:"button",onClick:()=>f(U=>Math.max(50,U-10)),className:"p-2 hover:bg-slate-100 rounded text-slate-600 transition-colors","aria-label":"Zoom arrire",children:l.jsx("span",{className:"material-symbols-outlined text-lg",children:"zoom_out"})}),l.jsx("div",{className:"w-px h-5 bg-slate-200 mx-0.5"}),l.jsx("button",{type:"button",onClick:()=>N.current?.requestFullscreen?.(),className:"p-2 hover:bg-slate-100 rounded text-slate-600 transition-colors","aria-label":"Plein cran",children:l.jsx("span",{className:"material-symbols-outlined text-lg",children:"fullscreen"})})]}),l.jsxs("div",{className:"flex-1 flex items-center justify-center p-4 sm:p-6 lg:p-8 overflow-auto custom-scrollbar relative min-h-0 select-none no-download no-copy bg-[#fcfaf7]",ref:N,onContextMenu:Q,onCopy:V,onCut:z,onPaste:ie,onKeyDown:ge,children:[l.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-30 bg-gradient-to-b from-transparent via-transparent to-slate-100/50 z-10","aria-hidden":!0}),l.jsxs("div",{className:"relative z-0 flex flex-col items-center justify-center w-full h-full",style:{userSelect:"none",pointerEvents:se?"auto":"none"},children:[E&&l.jsxs(l.Fragment,{children:[l.jsx(v0,{documentId:String(e.id),totalPages:T,currentPage:p,onRequestPrev:Ae,onRequestNext:pe,zoom:d,title:e.title,flipPhase:x,flipDirection:y,onFlipAnimationEnd:de,isFlipping:R}),l.jsx("div",{className:"flex items-center justify-center py-3 px-4 border-t border-slate-200/80 bg-white/50 shrink-0",children:l.jsxs("span",{className:"text-slate-500 text-xs font-medium uppercase tracking-[0.2em]",children:[e.title.length>28?`${e.title.slice(0,26)}`:e.title,l.jsx("span",{className:"mx-2 text-slate-300",children:"|"}),l.jsx("span",{className:"text-slate-700 font-semibold tracking-normal",children:p}),T>0&&l.jsxs("span",{className:"text-slate-400 font-normal",children:[" / ",T]})]})})]}),L&&l.jsxs(l.Fragment,{children:[w?l.jsx(Ab,{pdfUrl:w,currentPage:p,onRequestPrev:Ae,onRequestNext:pe,onTotalPagesChange:$,onPageChange:m,zoom:d,title:e.title,flipPhase:x,flipDirection:y,onFlipAnimationEnd:de,isFlipping:R}):l.jsx("div",{className:"flex-1 flex items-center justify-center bg-white shadow-sm rounded min-h-[50vh] w-full max-w-2xl",children:l.jsxs("div",{className:"flex flex-col items-center gap-3",children:[l.jsx("div",{className:"w-8 h-8 border-4 border-accent-gold/20 border-t-accent-gold rounded-full animate-spin"}),l.jsx("span",{className:"text-slate-500 text-sm animate-pulse",children:"Prparation du document scuris..."})]})}),l.jsx("div",{className:"flex items-center justify-center py-3 px-4 border-t border-slate-200/80 bg-white/50 shrink-0",children:l.jsxs("span",{className:"text-slate-500 text-xs font-medium uppercase tracking-[0.2em]",children:[e.title.length>28?`${e.title.slice(0,26)}`:e.title,l.jsx("span",{className:"mx-2 text-slate-300",children:"|"}),l.jsx("span",{className:"text-slate-700 font-semibold tracking-normal",children:p}),I>0&&l.jsxs("span",{className:"text-slate-400 font-normal",children:[" / ",I]})]})})]}),X&&l.jsxs("div",{className:"relative shadow-[0_0_100px_rgba(17,82,212,0.15)] rounded-sm border border-white/5 transition-transform duration-500",onContextMenu:Q,children:[l.jsx("img",{src:ke,alt:e.title,className:"max-h-[70vh] sm:max-h-[80vh] w-auto select-none pointer-events-none rounded-sm",style:{transform:`scale(${d/100})`},draggable:!1,loading:"lazy",onContextMenu:Q}),l.jsx("div",{className:"absolute -top-4 -left-4 w-8 h-8 border-t-2 border-l-2 border-accent-gold/40 rounded-tl"}),l.jsx("div",{className:"absolute -top-4 -right-4 w-8 h-8 border-t-2 border-r-2 border-accent-gold/40 rounded-tr"}),l.jsx("div",{className:"absolute -bottom-4 -left-4 w-8 h-8 border-b-2 border-l-2 border-accent-gold/40 rounded-bl"}),l.jsx("div",{className:"absolute -bottom-4 -right-4 w-8 h-8 border-b-2 border-r-2 border-accent-gold/40 rounded-br"})]}),Z&&l.jsx("video",{src:ke,controls:!0,className:"max-w-full max-h-[70vh] sm:max-h-[80vh] rounded",controlsList:"nodownload noremoteplayback",disablePictureInPicture:!0}),q&&l.jsx("div",{className:"w-full max-w-md px-4",children:l.jsx("audio",{src:ke,controls:!0,className:"w-full",controlsList:"nodownload noremoteplayback"})}),!se&&l.jsxs("div",{className:"text-center text-slate-500 px-4",children:[l.jsx("span",{className:"material-symbols-outlined text-5xl sm:text-6xl block mb-4 text-slate-400",children:"description"}),l.jsx("p",{className:"text-sm sm:text-base",children:"Aperu non disponible pour ce type. Consultation en lecture seule uniquement."})]})]})]}),i.length>0&&l.jsxs("div",{className:"bg-slate-100 border-t border-slate-200 p-3 sm:p-4 h-40 sm:h-48 overflow-hidden shrink-0",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3 px-1 sm:px-2",children:[l.jsx("h3",{className:"text-slate-600 text-[10px] sm:text-xs font-bold uppercase tracking-widest",children:"Documents similaires"}),l.jsxs("div",{className:"flex gap-1 sm:gap-2",children:[l.jsx("button",{type:"button",className:"text-slate-500 hover:text-primary transition-colors p-1","aria-label":"Prcdent",children:l.jsx("span",{className:"material-symbols-outlined text-base sm:text-lg",children:"arrow_back_ios"})}),l.jsx("button",{type:"button",className:"text-slate-500 hover:text-primary transition-colors p-1","aria-label":"Suivant",children:l.jsx("span",{className:"material-symbols-outlined text-base sm:text-lg",children:"arrow_forward_ios"})})]})]}),l.jsx("div",{className:"flex gap-3 sm:gap-4 overflow-x-auto custom-scrollbar pb-2 scrollbar-hide touch-scroll",children:i.map(U=>l.jsxs(he,{to:`/documents/${U.id}`,className:"flex-shrink-0 w-24 sm:w-32 group/card cursor-pointer",children:[l.jsx("div",{className:"aspect-[3/4] rounded-md overflow-hidden bg-slate-200 border border-slate-200 group-hover/card:border-accent-gold/50 transition-all",children:U.type==="image"?l.jsx("img",{src:rc(String(U.id)),alt:"",className:"w-full h-full object-cover grayscale opacity-80 group-hover/card:grayscale-0 group-hover/card:opacity-100 transition-all duration-500"}):l.jsx("div",{className:"w-full h-full flex items-center justify-center",children:l.jsx("span",{className:"material-symbols-outlined text-slate-400 text-4xl",children:"description"})})}),l.jsx("p",{className:"text-[9px] sm:text-[10px] text-slate-600 mt-1 sm:mt-2 truncate group-hover/card:text-accent-gold transition-colors",children:U.title})]},U.id))})]})]}),l.jsx("aside",{className:"w-full lg:w-96 bg-white border-t lg:border-t-0 lg:border-l border-slate-200 flex flex-col z-30 custom-scrollbar overflow-y-auto shrink-0 lg:min-h-0",children:l.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[l.jsxs("div",{className:"flex items-center gap-2 text-accent-gold mb-2",children:[l.jsx("span",{className:"material-symbols-outlined text-sm",children:"verified"}),l.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:"Document Certifi"})]}),l.jsx("h1",{className:"font-serif text-xl sm:text-2xl lg:text-3xl font-bold mb-3 sm:mb-4 leading-tight text-slate-900",children:e.title}),l.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 mb-6 sm:mb-8",children:[l.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1 rounded-full bg-accent-gold/10 text-accent-gold text-xs font-semibold",children:[l.jsx("span",{className:"material-symbols-outlined text-sm",children:"visibility"}),l.jsxs("span",{children:[e.views_count||"1,284"," vues"]})]}),l.jsx("button",{type:"button",onClick:()=>navigator.clipboard.writeText(window.location.href),className:"text-slate-400 hover:text-accent-gold transition-colors","aria-label":"Partager",children:l.jsx("span",{className:"material-symbols-outlined",children:"share"})}),l.jsx("button",{type:"button",className:"text-slate-400 hover:text-red-500 transition-colors","aria-label":"Favoris",children:l.jsx("span",{className:"material-symbols-outlined",children:"favorite"})})]}),l.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-2 sm:mb-3",children:"Description"}),l.jsx("p",{className:"text-xs sm:text-sm text-slate-600 leading-relaxed italic line-clamp-4 sm:line-clamp-none",children:e.description??"Aucune description disponible."})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[l.jsxs("div",{className:"p-3 sm:p-4 rounded-xl bg-slate-50 border border-slate-100",children:[l.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase mb-1",children:"Thme"}),l.jsx("p",{className:"text-sm font-medium text-slate-900",children:e.theme?.name??""})]}),l.jsxs("div",{className:"p-3 sm:p-4 rounded-xl bg-slate-50 border border-slate-100",children:[l.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase mb-1",children:"Rgion"}),l.jsx("p",{className:"text-sm font-medium text-slate-900",children:e.region?.name??""})]}),l.jsxs("div",{className:"p-3 sm:p-4 rounded-xl bg-slate-50 border border-slate-100",children:[l.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase mb-1",children:"Date"}),l.jsx("p",{className:"text-sm font-medium text-slate-900",children:_b(e.year)})]}),l.jsxs("div",{className:"p-3 sm:p-4 rounded-xl bg-slate-50 border border-slate-100",children:[l.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase mb-1",children:"Auteur"}),l.jsx("p",{className:"text-sm font-medium text-slate-900",children:e.author??""})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-4",children:"Actions de recherche"}),l.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 rounded-lg border border-slate-200 hover:bg-slate-50 transition-colors group",children:[l.jsx("span",{className:"text-sm font-medium text-slate-800",children:"Provenance & Histoire"}),l.jsx("span",{className:"material-symbols-outlined text-slate-400 group-hover:text-accent-gold transition-colors",children:"history"})]}),l.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 rounded-lg border border-slate-200 hover:bg-slate-50 transition-colors group",children:[l.jsx("span",{className:"text-sm font-medium text-slate-800",children:"Citer le document"}),l.jsx("span",{className:"material-symbols-outlined text-slate-400 group-hover:text-accent-gold transition-colors",children:"format_quote"})]}),l.jsxs("button",{type:"button",className:"w-full flex items-center justify-between px-4 py-3 rounded-lg border border-slate-200 hover:bg-slate-50 transition-colors group",children:[l.jsx("span",{className:"text-sm font-medium text-slate-800",children:"Signaler une erreur"}),l.jsx("span",{className:"material-symbols-outlined text-slate-400 group-hover:text-accent-gold transition-colors",children:"flag"})]})]})]}),l.jsxs("div",{className:"mt-8 sm:mt-12 p-4 sm:p-6 rounded-2xl bg-accent-gold/5 border border-accent-gold/10",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[l.jsx("span",{className:"material-symbols-outlined text-accent-gold",children:"lock"}),l.jsx("h5",{className:"text-sm font-bold text-slate-900",children:"Lecture Scurise"})]}),l.jsx("p",{className:"text-xs text-slate-500 leading-relaxed",children:"Ce document est protg par le droit d'auteur patrimonial. Le tlchargement est dsactiv pour garantir la prservation numrique."})]})]})})]})]})}const Nb="https://lh3.googleusercontent.com/aida-public/AB6AXuBn_NnEt4bFo_o0yfA9_SPDod599m_ZmfIICE430YfnJ7WmtU_XSKuJeUnmt7swSSF2z3Cshb4pXbT4Rbzr7IAHG0iUv3gXR44z3b661tiigmn68RyFLb_N4agFqwnJldQsRsK4dc2n9NsBuehsC4y-0ifwM761okYN0-Wd8L3Um_zKEk58uOysiQsQwwQdwnuOdF100esyYjhNnwsYn7Vy64ib7-5Ifhd7TD2-tMG7yjxOMNmC4fkf1artiNIhF0q4Qk7PZ61Z4n2X",Eb={pdf:"#13ec5b",image:"#3b82f6",photo:"#3b82f6",carte:"#64748b",video:"#f59e0b",audio:"#a855f7"};function Tf(u){return Eb[(u||"").toLowerCase()]??"#94a3b8"}function kb(u){const e=(u||"").toLowerCase();return e==="pdf"?"picture_as_pdf":e==="image"||e==="photo"?"image":e==="video"?"video_file":e==="audio"?"audio_file":"description"}function jb(u){const e=(u||"").toLowerCase();return e==="pdf"?"text-admin-primary":e==="image"||e==="photo"?"text-blue-500":e==="video"?"text-amber-500":e==="audio"?"text-purple-500":"text-slate-500"}function Cb(u){const e=(u||"").toLowerCase();return e==="pdf"?"border-admin-primary":e==="image"||e==="photo"?"border-blue-500":e==="video"?"border-amber-500":e==="audio"?"border-purple-500":"border-slate-400"}function Tb(){const[u,e]=j.useState(null),[t,i]=j.useState(!0),[r,a]=j.useState("30j");if(j.useEffect(()=>{i(!0),ct.stats({period:r}).then(e).catch(()=>e(null)).finally(()=>i(!1))},[r]),t||!u)return l.jsx("div",{className:"p-8 flex items-center justify-center min-h-[60vh]",children:l.jsx("div",{className:"text-slate-500",children:"Chargement des statistiques"})});const{stats:c,traffic_by_month:d,type_distribution:f,most_viewed:p}=u,m=c.views_total??0,x=c.documents_count??0,b=c.users_count??0,y=c.new_documents_in_period??x,A=c.new_documents_change_percent,w=d?.data??[],S=Math.max(1,...w),N=w.length,C=N>0&&`M ${w.map((I,$)=>{const te=N>1?$/(N-1)*100:50,ae=35-I/S*35;return`${te},${ae}`}).join(" L ")}`,R=C?`${C} V 40 H 0 Z`:"";return l.jsxs(l.Fragment,{children:[l.jsxs("header",{className:"sticky top-0 z-10 bg-white/80 backdrop-blur-md border-b border-slate-200 px-8 py-4 flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold tracking-tight",children:"Analytiques des Consultations V1"}),l.jsx("p",{className:"text-sm text-slate-500",children:"Vue d'ensemble statistique du trafic documentaire."})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:[l.jsx("button",{type:"button",onClick:()=>a("30j"),className:`px-3 py-1.5 text-xs font-bold rounded shadow-sm transition-colors ${r==="30j"?"bg-white text-slate-900":"text-slate-500 hover:text-slate-700"}`,children:"30 derniers jours"}),l.jsx("button",{type:"button",onClick:()=>a("trimestre"),className:`px-3 py-1.5 text-xs font-medium rounded transition-colors ${r==="trimestre"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Trimestre"}),l.jsx("button",{type:"button",onClick:()=>a("annee"),className:`px-3 py-1.5 text-xs font-medium rounded transition-colors ${r==="annee"?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Anne"})]}),l.jsxs("button",{type:"button",className:"flex items-center gap-2 bg-admin-primary text-white px-4 py-2 rounded-lg text-sm font-bold shadow-sm shadow-admin-primary/20 hover:opacity-90 transition-opacity",children:[l.jsx("span",{className:"material-symbols-outlined text-sm",children:"download"}),"Exporter Rapport"]})]})]}),l.jsxs("div",{className:"p-8 max-w-7xl mx-auto space-y-8",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[l.jsx("div",{className:"flex justify-between items-start mb-4",children:l.jsx("div",{className:"p-2 bg-admin-primary/10 rounded-lg text-admin-primary",children:l.jsx("span",{className:"material-symbols-outlined",children:"visibility"})})}),l.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Total Consultations"}),l.jsx("p",{className:"text-2xl font-bold mt-1",children:m.toLocaleString("fr-FR")})]}),l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[l.jsx("div",{className:"flex justify-between items-start mb-4",children:l.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg text-blue-500",children:l.jsx("span",{className:"material-symbols-outlined",children:"groups"})})}),l.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Utilisateurs"}),l.jsx("p",{className:"text-2xl font-bold mt-1",children:b.toLocaleString("fr-FR")})]}),l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[l.jsx("div",{className:"flex justify-between items-start mb-4",children:l.jsx("div",{className:"p-2 bg-amber-500/10 rounded-lg text-amber-500",children:l.jsx("span",{className:"material-symbols-outlined",children:"description"})})}),l.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Total Documents"}),l.jsx("p",{className:"text-2xl font-bold mt-1",children:x.toLocaleString("fr-FR")})]}),l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[l.jsxs("div",{className:"flex justify-between items-start mb-4",children:[l.jsx("div",{className:"p-2 bg-purple-500/10 rounded-lg text-purple-500",children:l.jsx("span",{className:"material-symbols-outlined",children:"file_present"})}),A!=null&&l.jsxs("span",{className:`text-xs font-bold px-2 py-1 rounded ${A>=0?"text-green-500 bg-green-50":"text-red-500 bg-red-50"}`,children:[A>=0?"+":"",A,"%"]})]}),l.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Nouveaux (priode)"}),l.jsx("p",{className:"text-2xl font-bold mt-1",children:y.toLocaleString("fr-FR")})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[l.jsxs("div",{className:"lg:col-span-2 bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-8",children:[l.jsx("h3",{className:"text-lg font-bold",children:"Nouveaux documents par mois"}),l.jsxs("span",{className:"flex items-center gap-1 text-xs text-slate-500",children:[l.jsx("span",{className:"w-2 h-2 rounded-full bg-admin-primary"})," 12 derniers mois"]})]}),l.jsxs("div",{className:"relative h-64 w-full",children:[l.jsxs("svg",{className:"w-full h-full",preserveAspectRatio:"none",viewBox:"0 0 100 40",children:[R&&l.jsx("path",{d:R,fill:"url(#adminGrad1)",opacity:"0.2"}),C&&l.jsx("path",{d:C,fill:"none",stroke:"#13ec5b",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1"}),l.jsx("defs",{children:l.jsxs("linearGradient",{id:"adminGrad1",x1:"0%",x2:"0%",y1:"0%",y2:"100%",children:[l.jsx("stop",{offset:"0%",stopColor:"#13ec5b",stopOpacity:1}),l.jsx("stop",{offset:"100%",stopColor:"#13ec5b",stopOpacity:0})]})})]}),l.jsx("div",{className:"flex justify-between mt-4 px-2",children:(d?.labels??[]).map(E=>l.jsx("span",{className:"text-[10px] text-slate-400 font-bold uppercase truncate max-w-[12%]",children:E},E))})]})]}),l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm flex flex-col",children:[l.jsx("h3",{className:"text-lg font-bold mb-6",children:"Type de Document"}),l.jsxs("div",{className:"relative flex-1 flex items-center justify-center min-h-[180px]",children:[l.jsxs("svg",{className:"w-48 h-48 transform -rotate-90",viewBox:"0 0 192 192",children:[l.jsx("circle",{cx:"96",cy:"96",fill:"none",r:"70",stroke:"#f1f5f9",strokeWidth:"20"}),(f??[]).length>0?(()=>{const E=2*Math.PI*70;let L=0;return f.map(T=>{const I=T.percentage/100*E,$=l.jsx("circle",{cx:"96",cy:"96",fill:"none",r:"70",stroke:Tf(T.type),strokeDasharray:`${I} ${E}`,strokeDashoffset:-L,strokeWidth:"20"},T.type);return L+=I,$})})():l.jsx("circle",{cx:"96",cy:"96",fill:"none",r:"70",stroke:"#e2e8f0",strokeWidth:"20"})]}),l.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none",children:[l.jsx("p",{className:"text-2xl font-black",children:x}),l.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold",children:"Total"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[(f??[]).map(E=>l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"w-3 h-3 rounded-full shrink-0",style:{backgroundColor:Tf(E.type)}}),l.jsxs("span",{className:"text-xs font-semibold truncate",children:[E.type," (",E.percentage,"%)"]})]},E.type)),(!f||f.length===0)&&l.jsx("p",{className:"text-xs text-slate-400 col-span-2",children:"Aucun document"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h3",{className:"text-lg font-bold",children:"Popularit par Rgion (Maroc)"}),l.jsxs("div",{className:"text-[10px] font-bold text-slate-400 flex items-center gap-1",children:[l.jsx("span",{className:"material-symbols-outlined text-sm",children:"location_on"})," TEMPS REL"]})]}),l.jsxs("div",{className:"rounded-lg overflow-hidden bg-slate-100 border border-slate-200",children:[l.jsxs("div",{className:"relative h-56 sm:h-64 flex items-center justify-center",children:[l.jsx("div",{className:"absolute inset-0 morocco-map-overlay opacity-30 pointer-events-none"}),l.jsx("div",{className:"relative z-[1] w-full h-full bg-center bg-no-repeat bg-contain",style:{backgroundImage:`url(${Nb})`},title:"Carte Maroc"}),l.jsx("div",{className:"absolute top-1/4 left-1/3 w-6 h-6 bg-admin-primary/30 rounded-full animate-ping pointer-events-none"}),l.jsx("div",{className:"absolute top-1/4 left-1/3 w-3 h-3 bg-admin-primary rounded-full shadow border-2 border-white pointer-events-none"}),l.jsx("div",{className:"absolute top-[45%] left-1/4 w-4 h-4 bg-admin-primary/30 rounded-full pointer-events-none"}),l.jsx("div",{className:"absolute top-[45%] left-1/4 w-2.5 h-2.5 bg-admin-primary rounded-full shadow border-2 border-white pointer-events-none"})]}),l.jsxs("div",{className:"px-4 py-3 bg-white border-t border-slate-200",children:[l.jsx("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider mb-2",children:"Top 3 Rgions"}),l.jsxs("ul",{className:"flex flex-wrap gap-x-6 gap-y-1 text-sm",children:[l.jsxs("li",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-slate-700",children:"Casablanca-Settat"}),l.jsx("span",{className:"text-admin-primary font-bold",children:"42%"})]}),l.jsxs("li",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-slate-700",children:"Rabat-Sal-Knitra"}),l.jsx("span",{className:"text-admin-primary font-bold",children:"28%"})]}),l.jsxs("li",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-slate-700",children:"Marrakech-Safi"}),l.jsx("span",{className:"text-admin-primary font-bold",children:"15%"})]})]})]})]})]}),l.jsxs("div",{className:"bg-white p-6 rounded-xl border border-slate-200 shadow-sm flex flex-col",children:[l.jsx("h3",{className:"text-lg font-bold mb-6",children:"Consultations Rcentes"}),l.jsxs("div",{className:"space-y-4 overflow-y-auto pr-2 flex-1 min-h-0",children:[p.slice(0,4).map((E,L)=>{const T=["Casablanca","Marrakech","Fs","Rabat"],I=[2,14,25,60];return l.jsxs(he,{to:`/documents/${E.id}`,className:`flex items-center gap-4 p-3 hover:bg-slate-50 rounded-lg transition-colors border-l-4 ${Cb(E.type)}`,children:[l.jsx("div",{className:`w-10 h-10 rounded flex items-center justify-center ${E.type==="pdf"?"bg-admin-primary/10 text-admin-primary":E.type==="image"?"bg-blue-500/10 text-blue-500":"bg-slate-100 text-slate-500"}`,children:l.jsx("span",{className:"material-symbols-outlined",children:kb(E.type)})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"text-sm font-bold truncate",children:E.title}),l.jsxs("p",{className:"text-[10px] text-slate-500",children:["Consult depuis ",T[L%T.length],"  Il y a ",I[L]," min"]})]}),l.jsxs("span",{className:"text-xs font-bold text-slate-400",children:["#",E.id]})]},E.id)}),p.length===0&&l.jsx("p",{className:"text-sm text-slate-500 py-4",children:"Aucune consultation rcente."})]}),l.jsx(he,{to:"/admin/documents",className:"mt-6 pt-4 text-sm font-bold text-admin-primary hover:underline text-center block",children:"Voir tout l'historique"})]})]}),l.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden",children:[l.jsxs("div",{className:"p-6 border-b border-slate-100 flex items-center justify-between",children:[l.jsx("h3",{className:"text-lg font-bold",children:"Documents les plus consults"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"text",placeholder:"Rechercher un document...",className:"pl-10 pr-4 py-2 text-sm bg-slate-100 border-none rounded-lg focus:ring-2 focus:ring-admin-primary/50 w-64 outline-none"}),l.jsx("span",{className:"material-symbols-outlined absolute left-3 top-2.5 text-slate-400 text-sm",children:"search"})]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-left",children:[l.jsx("thead",{className:"bg-slate-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Document"}),l.jsx("th",{className:"px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Type"}),l.jsx("th",{className:"px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Vues"}),l.jsx("th",{className:"px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Temps Moyen"}),l.jsx("th",{className:"px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Taux de Rebond"}),l.jsx("th",{className:"px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Actions"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:p.slice(0,4).map((E,L)=>{const T=[12,45,18,62][L%4],I=["06:45","03:12","08:20","05:40"][L%4];return l.jsxs("tr",{className:"hover:bg-slate-50/50 transition-colors",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:`material-symbols-outlined text-xl ${jb(E.type)}`,children:"description"}),l.jsx(he,{to:`/documents/${E.id}`,className:"text-sm font-semibold hover:text-admin-primary",children:E.title})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("span",{className:"px-2 py-1 bg-slate-100 rounded text-[10px] font-bold uppercase",children:E.type})}),l.jsx("td",{className:"px-6 py-4 text-sm font-bold",children:E.views_count.toLocaleString("fr-FR")}),l.jsx("td",{className:"px-6 py-4 text-sm",children:I}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"flex-1 h-1.5 bg-slate-100 rounded-full overflow-hidden max-w-[80px]",children:l.jsx("div",{className:"h-full bg-green-500",style:{width:`${Math.min(T,100)}%`}})}),l.jsxs("span",{className:"text-[10px] font-bold",children:[T,"%"]})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsx(he,{to:`/admin/documents/${E.id}/edit`,className:"text-slate-400 hover:text-admin-primary inline-flex",children:l.jsx("span",{className:"material-symbols-outlined text-xl",children:"more_vert"})})})]},E.id)})})]})}),l.jsxs("div",{className:"p-4 bg-slate-50 border-t border-slate-100 flex items-center justify-between",children:[l.jsxs("p",{className:"text-xs text-slate-500",children:["Affichage de 1-",Math.min(4,p.length)," sur ",x," documents"]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded border border-slate-200 bg-white text-slate-400 disabled:opacity-50",disabled:!0,children:l.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_left"})}),l.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded border border-admin-primary bg-admin-primary text-white text-xs font-bold",children:"1"}),l.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded border border-slate-200 bg-white text-xs font-bold hover:bg-slate-50",children:"2"}),l.jsx("button",{type:"button",className:"w-8 h-8 flex items-center justify-center rounded border border-slate-200 bg-white text-slate-400 hover:bg-slate-50",children:l.jsx("span",{className:"material-symbols-outlined text-sm",children:"chevron_right"})})]})]})]})]})]})}function Pb(){const u=os(f=>f.user),[e,t]=j.useState(null),[i,r]=j.useState(!0),[a,c]=j.useState(1);j.useEffect(()=>{u?.role!=="admin"&&u?.role!=="editor"||(r(!0),ct.documents.list({page:a,per_page:20}).then(t).catch(()=>t(null)).finally(()=>r(!1)))},[u?.role,a]);const d=(f,p)=>{window.confirm(`Supprimer  ${p}  ?`)&&ct.documents.delete(f).then(()=>t(m=>m?{...m,data:m.data.filter(x=>x.id!==f)}:null)).catch(m=>alert(m.message))};return u&&u.role!=="admin"&&u.role!=="editor"?l.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-16 text-center",children:[l.jsx("p",{className:"text-slate-500",children:"Accs rserv aux administrateurs et diteurs."}),l.jsx(he,{to:"/",className:"text-primary font-semibold mt-4 inline-block",children:"Retour  l'accueil"})]}):u?l.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-10",children:[l.jsxs("div",{className:"flex items-center justify-between mb-8",children:[l.jsx("h1",{className:"text-3xl font-black text-slate-900 dark:text-white",children:"Documents"}),l.jsx(he,{to:"/admin/documents/new",className:"px-4 py-2 rounded-lg bg-primary text-white font-bold hover:opacity-90 transition-opacity",children:"Ajouter un document"})]}),l.jsx("div",{className:"bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 overflow-hidden",children:i?l.jsx("div",{className:"p-8 text-center text-slate-500",children:"Chargement"}):e&&e.data.length>0?l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-left",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-slate-200 dark:border-slate-800",children:[l.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Titre"}),l.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Type"}),l.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Anne"}),l.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Rgion"}),l.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Thme"}),l.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Vues"}),l.jsx("th",{className:"p-4 font-bold text-slate-700 dark:text-slate-300",children:"Actions"})]})}),l.jsx("tbody",{children:e.data.map(f=>l.jsxs("tr",{className:"border-b border-slate-100 dark:border-slate-800",children:[l.jsx("td",{className:"p-4",children:l.jsx(he,{to:`/documents/${f.id}`,className:"font-medium text-primary hover:underline",children:f.title})}),l.jsx("td",{className:"p-4 text-sm",children:f.type}),l.jsx("td",{className:"p-4 text-sm",children:f.year??""}),l.jsx("td",{className:"p-4 text-sm",children:f.region?.name??""}),l.jsx("td",{className:"p-4 text-sm",children:f.theme?.name??""}),l.jsx("td",{className:"p-4 text-sm",children:f.views_count}),l.jsxs("td",{className:"p-4 flex gap-2",children:[l.jsx(he,{to:`/admin/documents/${f.id}/edit`,className:"text-sm text-primary font-medium hover:underline",children:"Modifier"}),l.jsx("button",{type:"button",onClick:()=>d(f.id,f.title),className:"text-sm text-red-600 dark:text-red-400 font-medium hover:underline",children:"Supprimer"})]})]},f.id))})]})}):l.jsx("p",{className:"p-8 text-slate-500",children:"Aucun document."})}),e&&e.last_page>1&&l.jsxs("div",{className:"flex justify-center gap-2 mt-6",children:[l.jsx("button",{type:"button",onClick:()=>c(f=>Math.max(1,f-1)),disabled:a<=1,className:"px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 disabled:opacity-50",children:"Prcdent"}),l.jsxs("span",{className:"px-4 py-2 text-slate-600 dark:text-slate-400",children:["Page ",e.current_page," / ",e.last_page]}),l.jsx("button",{type:"button",onClick:()=>c(f=>Math.min(e.last_page,f+1)),disabled:a>=e.last_page,className:"px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 disabled:opacity-50",children:"Suivant"})]})]}):l.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-16 text-center",children:[l.jsx("p",{className:"text-slate-500",children:"Veuillez vous connecter."}),l.jsx(he,{to:"/login",className:"text-primary font-semibold mt-4 inline-block",children:"Connexion"})]})}const Rb=["pdf","image","carte","video","audio"],Lb=".pdf,.jpg,.jpeg,.png",fc=50;function Pf(){const u=os(J=>J.user),e=sn(),{id:t}=Lc(),i=t&&t!=="new",r=j.useRef(null),[a,c]=j.useState([]),[d,f]=j.useState([]),[p,m]=j.useState(!!i),[x,b]=j.useState(!1),[y,A]=j.useState(""),[w,S]=j.useState(1),[N,C]=j.useState(!0),[R,E]=j.useState("public"),[L,T]=j.useState(!1),[I,$]=j.useState(""),[te,ae]=j.useState(""),[de,Ae]=j.useState(""),[pe,be]=j.useState("pdf"),[ke,X]=j.useState(""),[Z,q]=j.useState(""),[se,Q]=j.useState(""),[V,z]=j.useState(""),[ie,ge]=j.useState(""),[U,B]=j.useState(null),[ee,K]=j.useState(null),[ce,Me]=j.useState(null),[yt,dt]=j.useState(null),[wt,Ut]=j.useState(!1),[rn,ci]=j.useState(!1);j.useEffect(()=>{Yf.list().then(J=>c(J)).catch(()=>[]),Kx.list().then(J=>f(J)).catch(()=>[])},[]),j.useEffect(()=>{!i||!t||(A(""),ct.documents.get(Number(t)).then(J=>{$(J.title),ae(J.author??""),Ae(J.description??""),be(J.type),X(J.year??""),q(J.region_id??""),Q(J.theme_id??""),z(J.language??""),ge(J.keywords??""),ci(J.is_rare??!1),Me({pages_status:J.pages_status??void 0,pages_count:J.pages_count??null,thumbnail_url:J.thumbnail_url??null}),J.pages_status==="processing"&&ct.documents.conversionProgress(Number(t)).then(Re=>dt(Re.progress??null)).catch(()=>{})}).catch(J=>{const Re=J?.message?.toLowerCase?.();Re==="failed to fetch"||Re?.includes("network")||Re?.includes("load")?A("Impossible de joindre le serveur. Vrifiez que l'API Laravel est dmarre (php artisan serve) et que le proxy pointe vers http://localhost:8000."):A(J?.message??"Document introuvable")}).finally(()=>m(!1)))},[t,i]),j.useEffect(()=>{if(!i||!t||pe!=="pdf"||ce?.pages_status!=="processing")return;const J=setInterval(()=>{ct.documents.conversionProgress(Number(t)).then(Re=>{dt(Re.progress??null),Re.pages_status!=="processing"&&Me(En=>En?{...En,pages_status:Re.pages_status,pages_count:Re.pages_count}:null)}).catch(()=>{})},2e3);return()=>clearInterval(J)},[t,i,pe,ce?.pages_status]);const di=()=>{!t||pe!=="pdf"||(Ut(!0),ct.documents.regeneratePages(Number(t)).then(J=>{Me({pages_status:J.document.pages_status??"pending",pages_count:J.document.pages_count??null}),dt(null)}).finally(()=>Ut(!1)))},ui=J=>{if(!J)return B(null);if(J.size>fc*1024*1024){A(`Fichier trop volumineux (max ${fc} MB).`);return}A(""),B(J)},hi=J=>{J.preventDefault(),T(!1);const Re=J.dataTransfer.files?.[0];Re&&ui(Re)},an=J=>{J.preventDefault(),T(!0)},Cs=()=>T(!1),fi=J=>{if(J.preventDefault(),A(""),!i&&!U){A("Le fichier est obligatoire pour un nouveau document.");return}b(!0);const Re=new FormData;Re.append("title",I),Re.append("author",te),Re.append("description",de),Re.append("type",pe),Re.append("year",ke),Re.append("region_id",Z===""?"":String(Z)),Re.append("theme_id",se===""?"":String(se)),Re.append("language",V),Re.append("keywords",ie),Re.append("is_rare",rn?"1":"0"),U&&Re.append("file",U),ee&&Re.append("thumbnail",ee),i&&Re.append("_method","PUT"),(i?ct.documents.update(Number(t),Re):ct.documents.create(Re)).then(()=>e("/admin/documents")).catch(br=>{A(br.message),b(!1)})};return u&&u.role!=="admin"&&u.role!=="editor"?l.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-16 text-center",children:[l.jsx("p",{className:"text-slate-500",children:"Accs rserv."}),l.jsx(he,{to:"/",className:"text-admin-primary font-semibold mt-4 inline-block",children:"Accueil"})]}):u?p&&i?l.jsx("div",{className:"max-w-4xl mx-auto px-8 py-20",children:l.jsx("div",{className:"h-64 bg-slate-100 rounded-xl animate-pulse"})}):l.jsxs("div",{className:"px-8 py-10 max-w-4xl mx-auto",children:[l.jsxs("header",{className:"mb-10",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 mb-2",children:[l.jsx(he,{to:"/admin/documents",className:"hover:underline",children:"Documents"}),l.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"chevron_right"}),l.jsx("span",{className:"text-slate-900 font-medium",children:i?"Modifier":"Nouveau Document"})]}),l.jsx("h2",{className:"text-3xl font-black text-slate-900 tracking-tight",children:i?"Modifier le document":"Ajouter un Document Historique"}),l.jsx("p",{className:"text-slate-500 mt-2",children:i?"Mettez  jour les mtadonnes du document.":"Intgrez une nouvelle pice  la base de donnes de Tarikh.ma."})]}),l.jsxs("form",{onSubmit:fi,className:"flex flex-col",children:[y&&l.jsx("div",{className:"mb-6 p-4 rounded-lg bg-red-50 text-red-700 text-sm border border-red-100",children:y}),l.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:[l.jsxs("div",{className:"flex border-b border-slate-200",children:[l.jsxs("button",{type:"button",onClick:()=>S(1),className:`flex-1 py-4 px-6 flex items-center gap-3 ${w===1?"step-active":"text-slate-500 border-b-2 border-transparent"}`,children:[l.jsx("span",{className:`w-7 h-7 rounded-full flex items-center justify-center font-bold text-xs ${w===1?"bg-admin-primary text-white":"bg-slate-100 text-slate-500"}`,children:"1"}),l.jsx("span",{className:"text-sm font-bold",children:"Fichier"})]}),l.jsxs("button",{type:"button",onClick:()=>S(2),className:`flex-1 py-4 px-6 flex items-center gap-3 ${w===2?"step-active":"text-slate-500 border-b-2 border-transparent"}`,children:[l.jsx("span",{className:`w-7 h-7 rounded-full flex items-center justify-center font-bold text-xs ${w===2?"bg-admin-primary text-white":"bg-slate-100 text-slate-500"}`,children:"2"}),l.jsx("span",{className:"text-sm font-semibold",children:"Dtails (Mtadonnes)"})]}),l.jsxs("button",{type:"button",onClick:()=>S(3),className:`flex-1 py-4 px-6 flex items-center gap-3 ${w===3?"step-active":"text-slate-500 border-b-2 border-transparent"}`,children:[l.jsx("span",{className:`w-7 h-7 rounded-full flex items-center justify-center font-bold text-xs ${w===3?"bg-admin-primary text-white":"bg-slate-100 text-slate-500"}`,children:"3"}),l.jsx("span",{className:"text-sm font-semibold",children:"Scurit"})]})]}),l.jsxs("div",{className:"p-8",children:[w===1&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"tape 1 : Tlchargement du fichier"}),l.jsxs("div",{onDrop:hi,onDragOver:an,onDragLeave:Cs,onClick:()=>r.current?.click(),className:`flex flex-col items-center justify-center gap-6 rounded-xl border-2 border-dashed px-10 py-16 cursor-pointer transition-colors ${L?"border-admin-primary bg-admin-primary/5":"border-slate-200 bg-slate-50/50 hover:border-admin-primary/50"}`,children:[l.jsx("input",{ref:r,type:"file",accept:Lb,className:"hidden",onChange:J=>ui(J.target.files?.[0]??null)}),l.jsx("div",{className:"w-16 h-16 rounded-full bg-admin-primary/10 flex items-center justify-center text-admin-primary",children:l.jsx("span",{className:"material-symbols-outlined text-[40px]",children:"upload_file"})}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-slate-900 text-lg font-bold",children:"Glissez-dposez le document ici"}),l.jsxs("p",{className:"text-slate-500 text-sm mt-1",children:["PDF, JPG, PNG supports (Max ",fc," MB)"]}),U&&l.jsx("p",{className:"text-admin-primary text-sm font-semibold mt-2",children:U.name})]}),l.jsx("button",{type:"button",onClick:J=>{J.stopPropagation(),r.current?.click()},className:"px-6 py-2.5 bg-white border border-slate-200 rounded-lg text-sm font-bold text-slate-900 shadow-sm hover:bg-slate-50",children:"Parcourir les fichiers"})]}),l.jsxs("div",{className:"space-y-4 pt-6 border-t border-slate-200",children:[l.jsx("h3",{className:"text-sm font-bold text-slate-900",children:"Image miniature (Preview)"}),l.jsxs("div",{className:"flex items-center gap-6",children:[l.jsx("div",{className:"w-32 h-32 rounded-lg bg-slate-100 border border-slate-200 flex items-center justify-center overflow-hidden",children:ee?l.jsx("img",{src:URL.createObjectURL(ee),alt:"Aperu",className:"w-full h-full object-cover"}):ce?.thumbnail_url?l.jsx("img",{src:ce.thumbnail_url,alt:"Aperu actuel",className:"w-full h-full object-cover"}):l.jsx("span",{className:"material-symbols-outlined text-slate-300 text-3xl",children:"image"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-xs text-slate-500 mb-3",children:"Tlchargez une image (JPG/PNG) pour l'aperu dans la liste des archives."}),l.jsx("input",{type:"file",accept:"image/*",onChange:J=>K(J.target.files?.[0]??null),className:"text-xs text-slate-600 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-admin-primary/10 file:text-admin-primary hover:file:bg-admin-primary/20"})]})]})]}),l.jsxs("div",{className:"flex gap-4 p-4 rounded-lg bg-blue-50 border border-blue-100",children:[l.jsx("span",{className:"material-symbols-outlined text-blue-600 shrink-0",children:"verified_user"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-bold text-blue-900",children:"Avis de scurit"}),l.jsx("p",{className:"text-sm text-blue-800 mt-1",children:"Tous les fichiers tlchargs sont automatiquement chiffrs. Notre systme analyse le document pour s'assurer qu'il respecte les normes de conservation numrique."})]})]})]}),w===2&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-6",children:"Dtails du document"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"sm:col-span-2 flex flex-col gap-2",children:[l.jsxs("label",{className:"text-sm font-bold text-slate-900",children:["Titre du document ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",value:I,onChange:J=>$(J.target.value),required:!0,placeholder:"Ex: Dahir royal de 1912",className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary focus:border-admin-primary outline-none"})]}),l.jsxs("div",{className:"sm:col-span-2 flex flex-col gap-2",children:[l.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Auteur / Source"}),l.jsx("input",{type:"text",value:te,onChange:J=>ae(J.target.value),placeholder:"Ex: Ibn Khaldoun, Ministre de la Culture",className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary focus:border-admin-primary outline-none"})]}),l.jsxs("div",{className:"sm:col-span-2 flex flex-col gap-2",children:[l.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Description historique"}),l.jsx("textarea",{value:de,onChange:J=>Ae(J.target.value),placeholder:"Dcrivez le contexte et l'importance de ce document...",rows:4,className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary focus:border-admin-primary outline-none"})]}),l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsxs("label",{className:"text-sm font-bold text-slate-900",children:["Type de document ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("select",{value:pe,onChange:J=>be(J.target.value),required:!0,className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary focus:border-admin-primary outline-none",children:Rb.map(J=>l.jsx("option",{value:J,children:J},J))})]}),l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Anne / Priode"}),l.jsx("input",{type:"text",value:ke,onChange:J=>X(J.target.value),placeholder:"Ex: 1912",className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary focus:border-admin-primary outline-none"})]}),l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Priode / Thmatique"}),l.jsxs("select",{value:se,onChange:J=>Q(J.target.value?Number(J.target.value):""),className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary focus:border-admin-primary outline-none",children:[l.jsx("option",{value:"",children:""}),a.map(J=>l.jsx("option",{value:J.id,children:J.name},J.id))]})]}),l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Rgion du Maroc"}),l.jsxs("select",{value:Z,onChange:J=>q(J.target.value?Number(J.target.value):""),className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary focus:border-admin-primary outline-none",children:[l.jsx("option",{value:"",children:""}),d.map(J=>l.jsx("option",{value:J.id,children:J.name},J.id))]})]}),l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Langue"}),l.jsx("input",{type:"text",value:V,onChange:J=>z(J.target.value),className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary outline-none"})]}),l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsx("label",{className:"text-sm font-bold text-slate-900",children:"Mots-cls"}),l.jsx("input",{type:"text",value:ie,onChange:J=>ge(J.target.value),placeholder:"spars par des virgules",className:"w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-admin-primary outline-none"})]})]})]}),w===3&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-6",children:"Scurit et accs"}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"material-symbols-outlined text-admin-primary",children:"branding_watermark"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-bold",children:"Activer le filigrane Tarikh.ma"}),l.jsx("p",{className:"text-xs text-slate-500",children:"Ajoute un logo semi-transparent sur les images"})]})]}),l.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:N,onChange:J=>C(J.target.checked),className:"sr-only peer"}),l.jsx("div",{className:"w-11 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-admin-primary"})]})]}),l.jsxs("div",{className:"flex items-center justify-between p-4 bg-amber-50/50 border border-amber-200 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:"material-symbols-outlined text-amber-600",children:"star"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-bold",children:'Marquer comme "Document Rare"'}),l.jsx("p",{className:"text-xs text-slate-500",children:"S'affichera dans la section spciale de la page d'accueil"})]})]}),l.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:rn,onChange:J=>ci(J.target.checked),className:"sr-only peer"}),l.jsx("div",{className:"w-11 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-amber-500"})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Niveau d'accs au document"}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[l.jsxs("label",{className:`relative flex flex-col p-4 border-2 rounded-xl cursor-pointer transition-colors ${R==="public"?"border-admin-primary bg-admin-primary/5":"border-slate-200 hover:bg-slate-50"}`,children:[l.jsx("input",{type:"radio",name:"access",value:"public",checked:R==="public",onChange:()=>E("public"),className:"sr-only"}),l.jsx("span",{className:`material-symbols-outlined mb-1 ${R==="public"?"text-admin-primary":"text-slate-500"}`,children:"public"}),l.jsx("span",{className:"text-xs font-bold uppercase tracking-wide",children:"Public"}),l.jsx("span",{className:"text-[10px] text-slate-500 mt-1",children:"Visible par tous"}),R==="public"&&l.jsx("div",{className:"absolute top-2 right-2",children:l.jsx("span",{className:"material-symbols-outlined text-admin-primary text-[18px]",children:"check_circle"})})]}),l.jsxs("label",{className:`relative flex flex-col p-4 border-2 rounded-xl cursor-pointer transition-colors ${R==="restricted"?"border-admin-primary bg-admin-primary/5":"border-slate-200 hover:bg-slate-50"}`,children:[l.jsx("input",{type:"radio",name:"access",value:"restricted",checked:R==="restricted",onChange:()=>E("restricted"),className:"sr-only"}),l.jsx("span",{className:`material-symbols-outlined mb-1 ${R==="restricted"?"text-admin-primary":"text-slate-500"}`,children:"lock_open"}),l.jsx("span",{className:"text-xs font-bold uppercase tracking-wide",children:"Inscrit"}),l.jsx("span",{className:"text-[10px] text-slate-500 mt-1",children:"Utilisateurs connects"}),R==="restricted"&&l.jsx("div",{className:"absolute top-2 right-2",children:l.jsx("span",{className:"material-symbols-outlined text-admin-primary text-[18px]",children:"check_circle"})})]}),l.jsxs("label",{className:`relative flex flex-col p-4 border-2 rounded-xl cursor-pointer transition-colors ${R==="private"?"border-admin-primary bg-admin-primary/5":"border-slate-200 hover:bg-slate-50"}`,children:[l.jsx("input",{type:"radio",name:"access",value:"private",checked:R==="private",onChange:()=>E("private"),className:"sr-only"}),l.jsx("span",{className:`material-symbols-outlined mb-1 ${R==="private"?"text-admin-primary":"text-slate-500"}`,children:"lock"}),l.jsx("span",{className:"text-xs font-bold uppercase tracking-wide",children:"Priv"}),l.jsx("span",{className:"text-[10px] text-slate-500 mt-1",children:"Admin uniquement"}),R==="private"&&l.jsx("div",{className:"absolute top-2 right-2",children:l.jsx("span",{className:"material-symbols-outlined text-admin-primary text-[18px]",children:"check_circle"})})]})]})]}),i&&pe==="pdf"&&l.jsxs("div",{className:"space-y-3 pt-4 border-t border-slate-200",children:[l.jsx("p",{className:"text-sm font-bold text-slate-900",children:"Conversion PDF  pages (flipbook)"}),l.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 rounded-xl bg-slate-50 border border-slate-200",children:[l.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase",children:"Statut"}),l.jsxs("span",{className:`text-sm font-semibold ${ce?.pages_status==="completed"?"text-green-600":ce?.pages_status==="failed"?"text-red-600":"text-amber-600"}`,children:[ce?.pages_status==="completed"&&`${ce?.pages_count??0} page(s)`,ce?.pages_status==="processing"&&"Conversion en cours",ce?.pages_status==="pending"&&"En attente",ce?.pages_status==="failed"&&"chec",!ce?.pages_status&&""]}),ce?.pages_status==="processing"&&yt&&l.jsxs("span",{className:"text-xs text-slate-500",children:[yt.current," / ",yt.total]}),l.jsxs("button",{type:"button",onClick:di,disabled:wt||ce?.pages_status==="processing",className:"ml-auto px-4 py-2 rounded-lg text-sm font-bold bg-white border border-slate-200 hover:bg-slate-50 disabled:opacity-50 flex items-center gap-2",children:[l.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"refresh"}),wt?"Regnration":"Regnrer les pages"]})]})]})]})]})]}),l.jsxs("div",{className:"px-8 py-5 bg-slate-50/80 border-t border-slate-200 flex flex-wrap items-center justify-between gap-4",children:[l.jsxs(he,{to:"/admin/documents",className:"flex items-center gap-2 px-5 py-2.5 rounded-lg text-sm font-bold text-slate-500 hover:bg-slate-200 transition-colors",children:[l.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"arrow_back"}),"Annuler"]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{type:"submit",disabled:x,className:"px-6 py-2.5 rounded-lg text-sm font-bold text-slate-900 bg-white border border-slate-200 shadow-sm hover:bg-slate-50 disabled:opacity-50",children:x?"Enregistrement":"Enregistrer en brouillon"}),l.jsxs("button",{type:"submit",disabled:x,className:"px-10 py-2.5 bg-admin-primary hover:bg-admin-primary/90 text-white rounded-lg text-sm font-black transition-all shadow-md flex items-center gap-2 disabled:opacity-50",children:[x?"Enregistrement":i?"Enregistrer":"Publier le Document",l.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"send"})]})]})]})]})]}),l.jsxs("footer",{className:"mt-8 flex flex-wrap items-center justify-between gap-4 text-slate-500 text-xs",children:[l.jsxs("p",{children:[" ",new Date().getFullYear()," Tarikh.ma - Systme de Management de Contenu Historique"]}),l.jsxs("div",{className:"flex gap-4",children:[l.jsx("a",{href:"#support",className:"hover:underline",children:"Support technique"}),l.jsx("a",{href:"#logs",className:"hover:underline",children:"Logs d'activit"})]})]})]}):l.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-16 text-center",children:[l.jsx("p",{className:"text-slate-500",children:"Veuillez vous connecter."}),l.jsx(he,{to:"/login",className:"text-admin-primary font-semibold mt-4 inline-block",children:"Connexion"})]})}const pc={admin:"Administrateur",editor:"diteur",reader:"Lecteur"},Rf={admin:"bg-admin-primary/10 text-admin-primary border-admin-primary/20",editor:"bg-blue-500/10 text-blue-600 border-blue-500/20",reader:"bg-slate-500/10 text-slate-500 border-slate-500/20"},mc=[{key:"edit_content",label:"dition de contenu",desc:"Modifier les articles et documents existants.",default:!0},{key:"publish_direct",label:"Publication directe",desc:"Publier sans validation d'un admin.",default:!1},{key:"access_stats",label:"Accs aux statistiques",desc:"Consulter les chiffres d'audience.",default:!0},{key:"delete_right",label:"Droit de suppression",desc:"Supprimer dfinitivement du contenu.",default:!1},{key:"technical_mgmt",label:"Gestion technique",desc:"Accs aux paramtres du serveur API.",default:!1}],Mb={admin:"Le rle d'administrateur dispose de tous les droits : gestion des utilisateurs, du contenu et des paramtres techniques.",editor:"Le rle d'diteur permet de crer, modifier et publier du contenu historique. Il ne possde pas de droits de suppression globale.",reader:"Le rle de lecteur permet uniquement de consulter le contenu et les statistiques, sans droit de modification."};function Lf(u){return u.split(/\s+/).map(e=>e[0]).join("").toUpperCase().slice(0,2)}function Vb(u){return Rf[u]??Rf.reader}function Ib(){const u=os(T=>T.user),[e,t]=j.useState(null),[i,r]=j.useState(!0),[a,c]=j.useState(1),[d,f]=j.useState(""),[p,m]=j.useState(!0),[x,b]=j.useState("editor"),[y,A]=j.useState(Object.fromEntries(mc.map(T=>[T.key,T.default]))),[w,S]=j.useState(null);j.useEffect(()=>{u?.role==="admin"&&(r(!0),ct.users.list({page:a,per_page:10}).then(T=>t({...T,total:T.total??T.data.length})).catch(()=>t(null)).finally(()=>r(!1)))},[u?.role,a]);const N=(T,I)=>{window.confirm(`Supprimer l'utilisateur  ${I}  ?`)&&ct.users.delete(T).then(()=>t($=>$?{...$,data:$.data.filter(te=>te.id!==T)}:null)).catch($=>alert($.message))},C=e?.data.filter(T=>!d||T.name.toLowerCase().includes(d.toLowerCase())||T.email.toLowerCase().includes(d.toLowerCase())||(pc[T.role]??T.role).toLowerCase().includes(d.toLowerCase()))??[],R=T=>{A(I=>({...I,[T]:!I[T]}))},E=()=>{A(Object.fromEntries(mc.map(T=>[T.key,T.default])))},L=e?.data.filter(T=>T.role===x).length??0;return u&&u.role!=="admin"?l.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-16 text-center bg-white",children:[l.jsx("p",{className:"text-slate-500",children:"Accs rserv aux administrateurs."}),l.jsx(he,{to:"/",className:"text-admin-primary font-semibold mt-4 inline-block",children:"Retour  l'accueil"})]}):u?l.jsxs("div",{className:"flex flex-1 overflow-hidden bg-white",children:[l.jsx("main",{className:"flex-1 flex flex-col overflow-hidden min-w-0",children:l.jsxs("div",{className:"flex-1 overflow-y-auto p-6 sm:p-8",children:[l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 mb-2",children:[l.jsx(he,{to:"/admin",className:"hover:text-slate-700",children:"Accueil"}),l.jsx("span",{className:"material-symbols-outlined text-xs",children:"chevron_right"}),l.jsx("span",{children:"Administration"}),l.jsx("span",{className:"material-symbols-outlined text-xs",children:"chevron_right"}),l.jsx("span",{className:"text-admin-primary font-semibold",children:"Utilisateurs"})]}),l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900 tracking-tight",children:"Gestion des Utilisateurs"}),l.jsx("p",{className:"text-slate-500 mt-1 text-sm",children:"Contrlez les accs et dfinissez les permissions de votre quipe ditoriale."})]}),l.jsxs(he,{to:"/admin/users/new",className:"flex items-center justify-center gap-2 px-5 py-2.5 bg-admin-primary text-white font-bold rounded-lg hover:shadow-lg hover:brightness-110 transition-all shrink-0",children:[l.jsx("span",{className:"material-symbols-outlined text-lg",children:"person_add"}),"Ajouter un utilisateur"]})]})]}),l.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[l.jsxs("div",{className:"relative w-full max-w-md",children:[l.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-xl",children:"search"}),l.jsx("input",{type:"text",value:d,onChange:T=>f(T.target.value),placeholder:"Rechercher par nom, email ou rle...",className:"w-full bg-slate-50 border border-slate-200 rounded-lg pl-10 pr-4 py-2.5 text-slate-900 placeholder:text-slate-400 focus:ring-2 focus:ring-admin-primary/50 focus:border-admin-primary"})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("button",{type:"button",onClick:()=>m(!0),className:"lg:hidden flex items-center gap-2 px-4 py-2.5 bg-admin-primary/10 border border-admin-primary/20 text-admin-primary rounded-lg hover:bg-admin-primary/20 transition-all text-sm font-medium",children:[l.jsx("span",{className:"material-symbols-outlined text-lg",children:"admin_panel_settings"}),"Rles"]}),l.jsxs("button",{type:"button",className:"flex items-center gap-2 px-4 py-2.5 bg-white border border-slate-200 text-slate-600 rounded-lg hover:bg-slate-50 transition-all text-sm font-medium",children:[l.jsx("span",{className:"material-symbols-outlined text-lg",children:"filter_list"}),"Filtrer"]}),l.jsxs("button",{type:"button",className:"flex items-center gap-2 px-4 py-2.5 bg-white border border-slate-200 text-slate-600 rounded-lg hover:bg-slate-50 transition-all text-sm font-medium",children:[l.jsx("span",{className:"material-symbols-outlined text-lg",children:"download"}),"Exporter"]})]})]}),l.jsx("div",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:i?l.jsx("div",{className:"p-12 text-center text-slate-500",children:"Chargement"}):C.length>0?l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-left border-collapse",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-slate-50 text-slate-500 text-xs font-bold uppercase tracking-wider",children:[l.jsx("th",{className:"px-6 py-4 border-b border-slate-200",children:"Utilisateur"}),l.jsx("th",{className:"px-6 py-4 border-b border-slate-200",children:"Rle"}),l.jsx("th",{className:"px-6 py-4 border-b border-slate-200",children:"Statut du compte"}),l.jsx("th",{className:"px-6 py-4 border-b border-slate-200",children:"Dernire connexion"}),l.jsx("th",{className:"px-6 py-4 border-b border-slate-200 text-right",children:"Actions"})]})}),l.jsx("tbody",{className:"divide-y divide-slate-100",children:C.map((T,I)=>l.jsxs("tr",{className:"group hover:bg-slate-50/80 transition-colors",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"size-10 rounded-full bg-admin-primary/10 flex items-center justify-center border border-admin-primary/20 text-admin-primary font-bold text-sm shrink-0",children:Lf(T.name)}),l.jsxs("div",{children:[l.jsx("p",{className:"text-slate-900 font-bold text-sm",children:T.name}),l.jsx("p",{className:"text-slate-500 text-xs",children:T.email})]})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("span",{className:`px-3 py-1 text-[11px] font-bold rounded-full border uppercase tracking-tighter ${Vb(T.role)}`,children:pc[T.role]??T.role})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"size-2 rounded-full bg-emerald-500"}),l.jsx("span",{className:"text-sm text-slate-700",children:"Actif"})]})}),l.jsx("td",{className:"px-6 py-4 text-sm text-slate-500",children:I===0?"Il y a 2 heures":I===1?"Hier  14:30":I===2?"Il y a 5 jours":"En ligne"}),l.jsx("td",{className:"px-6 py-4 text-right",children:l.jsxs("div",{className:"flex items-center justify-end gap-1 relative",children:[l.jsx(he,{to:`/admin/users/${T.id}/edit`,className:"p-2 text-slate-400 hover:text-admin-primary transition-colors rounded-lg","aria-label":"Modifier",children:l.jsx("span",{className:"material-symbols-outlined",children:"edit_square"})}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{type:"button",onClick:()=>S(w===T.id?null:T.id),className:"p-2 text-slate-400 hover:text-slate-600 transition-colors rounded-lg","aria-label":"Menu actions",children:l.jsx("span",{className:"material-symbols-outlined",children:"more_vert"})}),w===T.id&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 z-10","aria-hidden":!0,onClick:()=>S(null)}),l.jsxs("div",{className:"absolute right-0 top-full mt-1 py-1 bg-white border border-slate-200 rounded-lg shadow-lg z-20 min-w-[140px]",children:[l.jsxs(he,{to:`/admin/users/${T.id}/edit`,className:"flex items-center gap-2 px-4 py-2 text-sm text-slate-700 hover:bg-slate-50",onClick:()=>S(null),children:[l.jsx("span",{className:"material-symbols-outlined text-lg",children:"edit"}),"Modifier"]}),l.jsxs("button",{type:"button",onClick:()=>{S(null),N(T.id,T.name)},className:"flex items-center gap-2 w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:[l.jsx("span",{className:"material-symbols-outlined text-lg",children:"delete"}),"Supprimer"]})]})]})]})]})})]},T.id))})]})}):l.jsx("p",{className:"p-8 text-slate-500 text-center",children:"Aucun utilisateur trouv."})}),e&&e.data.length>0&&l.jsxs("div",{className:"mt-6 flex flex-wrap items-center justify-between gap-4",children:[l.jsxs("p",{className:"text-slate-500 text-sm",children:["Affichage de ",l.jsxs("span",{className:"text-slate-900 font-bold",children:["1  ",C.length]})," sur"," ",e.total??e.data.length," utilisateurs"]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{type:"button",onClick:()=>c(T=>Math.max(1,T-1)),disabled:a<=1,className:"px-3 py-1.5 rounded-lg bg-white border border-slate-200 text-slate-600 disabled:opacity-50 text-sm font-medium",children:"Prcdent"}),l.jsx("button",{type:"button",className:"px-3 py-1.5 rounded-lg bg-admin-primary/20 text-admin-primary border border-admin-primary/30 text-sm font-bold",children:a}),e.last_page>1&&l.jsx("button",{type:"button",onClick:()=>c(T=>Math.min(e.last_page,T+1)),disabled:a>=e.last_page,className:"px-3 py-1.5 rounded-lg bg-white border border-slate-200 text-slate-600 hover:bg-slate-50 disabled:opacity-50 text-sm font-medium",children:"Suivant"})]})]})]})}),l.jsxs("aside",{className:`w-full lg:w-96 flex-shrink-0 bg-white border-l border-slate-200 flex flex-col shadow-xl z-20 transition-transform duration-300
          ${p?"flex fixed lg:relative inset-y-0 right-0 lg:inset-auto":"hidden lg:flex"}`,children:[l.jsxs("div",{className:"p-6 border-b border-slate-200 flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-slate-900 tracking-tight",children:"Gestion des Rles"}),l.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Configuration :"," ",l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-bold bg-blue-500/10 text-blue-600 border border-blue-500/20",children:x==="admin"?"Administrateur":x==="editor"?"diteur":"Lecteur"})]})]}),l.jsx("button",{type:"button",onClick:()=>m(!1),className:"size-8 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 hover:bg-slate-200 hover:text-slate-700 transition-colors lg:hidden","aria-label":"Fermer",children:l.jsx("span",{className:"material-symbols-outlined text-lg",children:"close"})})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-2 block",children:"Rle  configurer"}),l.jsx("div",{className:"flex gap-2 flex-wrap",children:["admin","editor","reader"].map(T=>l.jsx("button",{type:"button",onClick:()=>b(T),className:`px-3 py-1.5 rounded-full text-xs font-bold border ${x===T?"bg-admin-primary/20 text-admin-primary border-admin-primary/30":"bg-slate-50 text-slate-600 border-slate-200 hover:bg-slate-100"}`,children:pc[T]},T))})]}),l.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[l.jsx("span",{className:"material-symbols-outlined text-blue-500 text-xl",children:"shield_with_heart"}),l.jsx("h3",{className:"font-bold text-slate-900",children:"Niveau de privilges"})]}),l.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:Mb[x]})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4",children:"Permissions du rle"}),l.jsx("div",{className:"space-y-4",children:mc.map(T=>l.jsxs("div",{className:"flex items-start justify-between gap-4",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"text-sm font-bold text-slate-900",children:T.label}),l.jsx("p",{className:"text-xs text-slate-500",children:T.desc})]}),l.jsx("button",{type:"button",role:"switch","aria-checked":y[T.key],onClick:()=>R(T.key),className:`relative inline-flex h-5 w-10 shrink-0 rounded-full border-2 transition-colors focus:outline-none focus:ring-2 focus:ring-admin-primary/50 ${y[T.key]?"bg-admin-primary border-admin-primary":"bg-slate-200 border-slate-200"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 rounded-full bg-white shadow transition-transform ${y[T.key]?"translate-x-5":"translate-x-0.5"}`,style:{marginTop:2}})})]},T.key))})]}),l.jsxs("div",{className:"space-y-3 pt-2",children:[l.jsx("button",{type:"button",className:"w-full py-3 bg-admin-primary/10 border border-admin-primary/30 text-admin-primary font-bold rounded-lg hover:bg-admin-primary/20 transition-all text-sm",children:"Sauvegarder les permissions"}),l.jsx("button",{type:"button",onClick:E,className:"w-full py-2 text-slate-500 text-sm hover:text-slate-700 transition-colors",children:"Rinitialiser par dfaut"})]})]}),l.jsxs("div",{className:"p-6 bg-slate-50 border-t border-slate-200",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsx("span",{className:"text-xs text-slate-500",children:"Utilisateurs avec ce rle"}),l.jsxs("span",{className:"text-xs font-bold text-slate-900",children:[L," membre",L!==1?"s":""]})]}),l.jsxs("div",{className:"flex -space-x-2",children:[C.filter(T=>T.role===x).slice(0,5).map(T=>l.jsx("div",{className:"size-8 rounded-full border-2 border-white bg-admin-primary/20 flex items-center justify-center text-xs font-bold text-slate-700",title:T.name,children:Lf(T.name).slice(0,1)},T.id)),L>5&&l.jsxs("div",{className:"size-8 rounded-full border-2 border-white bg-slate-300 flex items-center justify-center text-[10px] font-bold text-slate-600",children:["+",L-5]})]})]})]})]}):l.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-16 text-center bg-white",children:[l.jsx("p",{className:"text-slate-500",children:"Veuillez vous connecter."}),l.jsx(he,{to:"/login",className:"text-admin-primary font-semibold mt-4 inline-block",children:"Connexion"})]})}const Db=[{value:"admin",label:"Administrateur"},{value:"editor",label:"diteur"},{value:"reader",label:"Lecteur"}];function Mf(){const u=os(L=>L.user),e=sn(),{id:t}=Lc(),i=t&&t!=="new",[r,a]=j.useState(!!i),[c,d]=j.useState(!1),[f,p]=j.useState(""),[m,x]=j.useState(""),[b,y]=j.useState(""),[A,w]=j.useState("reader"),[S,N]=j.useState(""),[C,R]=j.useState("");j.useEffect(()=>{i&&ct.users.get(Number(t)).then(L=>{x(L.name),y(L.email),w(L.role)}).catch(()=>p("Utilisateur introuvable")).finally(()=>a(!1))},[t,i]);const E=L=>{if(L.preventDefault(),p(""),d(!0),!i&&S!==C){p("Les mots de passe ne correspondent pas."),d(!1);return}if(!i&&S.length<8){p("Le mot de passe doit contenir au moins 8 caractres."),d(!1);return}(i?ct.users.update(Number(t),{name:m,email:b,role:A,...S?{password:S,password_confirmation:C}:{}}):ct.users.create({name:m,email:b,password:S,password_confirmation:C,role:A})).then(()=>e("/admin/users")).catch(I=>{p(I.message),d(!1)})};return u&&u.role!=="admin"?l.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-16 text-center",children:[l.jsx("p",{className:"text-slate-500",children:"Accs rserv aux administrateurs."}),l.jsx(he,{to:"/",className:"text-primary font-semibold mt-4 inline-block",children:"Accueil"})]}):u?r&&i?l.jsx("div",{className:"max-w-2xl mx-auto px-6 py-20",children:l.jsx("div",{className:"h-64 bg-slate-100 dark:bg-slate-800 rounded-xl animate-pulse"})}):l.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-10",children:[l.jsx(he,{to:"/admin/users",className:"text-primary font-medium hover:underline mb-6 inline-block",children:" Retour aux utilisateurs"}),l.jsx("h1",{className:"text-2xl font-black text-slate-900 dark:text-white mb-6",children:i?"Modifier l'utilisateur":"Ajouter un utilisateur"}),l.jsxs("form",{onSubmit:E,className:"space-y-6",children:[f&&l.jsx("div",{className:"p-4 rounded-lg bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 text-sm",children:f}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-slate-600 dark:text-slate-400 mb-1",children:"Nom *"}),l.jsx("input",{type:"text",value:m,onChange:L=>x(L.target.value),required:!0,className:"w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-4 py-2.5 focus:ring-2 focus:ring-primary outline-none"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-slate-600 dark:text-slate-400 mb-1",children:"Email *"}),l.jsx("input",{type:"email",value:b,onChange:L=>y(L.target.value),required:!0,className:"w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-4 py-2.5 focus:ring-2 focus:ring-primary outline-none"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-slate-600 dark:text-slate-400 mb-1",children:"Rle *"}),l.jsx("select",{value:A,onChange:L=>w(L.target.value),className:"w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-4 py-2.5 focus:ring-2 focus:ring-primary outline-none",children:Db.map(L=>l.jsx("option",{value:L.value,children:L.label},L.value))})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-bold text-slate-600 dark:text-slate-400 mb-1",children:["Mot de passe ",i?"(laisser vide pour ne pas changer)":"*"]}),l.jsx("input",{type:"password",value:S,onChange:L=>N(L.target.value),minLength:i?0:8,className:"w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-4 py-2.5 focus:ring-2 focus:ring-primary outline-none"})]}),!i&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-slate-600 dark:text-slate-400 mb-1",children:"Confirmer le mot de passe *"}),l.jsx("input",{type:"password",value:C,onChange:L=>R(L.target.value),className:"w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-4 py-2.5 focus:ring-2 focus:ring-primary outline-none"})]}),l.jsxs("div",{className:"flex gap-4 pt-4",children:[l.jsx("button",{type:"submit",disabled:c,className:"px-6 py-2.5 rounded-lg bg-primary text-white font-bold hover:opacity-90 disabled:opacity-50",children:c?"Enregistrement":i?"Enregistrer":"Crer"}),l.jsx(he,{to:"/admin/users",className:"px-6 py-2.5 rounded-lg border border-slate-200 dark:border-slate-700 font-bold hover:bg-slate-50 dark:hover:bg-slate-800",children:"Annuler"})]})]})]}):l.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-16 text-center",children:[l.jsx("p",{className:"text-slate-500",children:"Veuillez vous connecter."}),l.jsx(he,{to:"/login",className:"text-primary font-semibold mt-4 inline-block",children:"Connexion"})]})}function Fb(){return os(e=>e.user)?l.jsx("div",{className:"flex flex-col flex-1 bg-white",children:l.jsxs("div",{className:"flex-1 overflow-y-auto p-6 sm:p-8",children:[l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500 mb-2",children:[l.jsx(he,{to:"/admin",className:"hover:text-slate-700",children:"Accueil"}),l.jsx("span",{className:"material-symbols-outlined text-xs",children:"chevron_right"}),l.jsx("span",{children:"Administration"}),l.jsx("span",{className:"material-symbols-outlined text-xs",children:"chevron_right"}),l.jsx("span",{className:"text-admin-primary font-semibold",children:"Paramtres"})]}),l.jsx("h1",{className:"text-2xl sm:text-3xl font-extrabold text-slate-900 tracking-tight",children:"Paramtres"}),l.jsx("p",{className:"text-slate-500 mt-1 text-sm",children:"Configuration gnrale de la plateforme et options d'administration."})]}),l.jsxs("div",{className:"max-w-3xl space-y-8",children:[l.jsxs("section",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:[l.jsx("div",{className:"px-6 py-4 border-b border-slate-100 bg-slate-50/80",children:l.jsxs("h2",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[l.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"tune"}),"Gnral"]})}),l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Nom de la plateforme"}),l.jsx("input",{type:"text",defaultValue:"Tarikh.ma",className:"w-full bg-slate-50 border border-slate-200 rounded-lg px-4 py-2.5 text-slate-900 focus:ring-2 focus:ring-admin-primary/50 focus:border-admin-primary",readOnly:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Email de contact"}),l.jsx("input",{type:"email",placeholder:"contact@tarikh.ma",className:"w-full bg-slate-50 border border-slate-200 rounded-lg px-4 py-2.5 text-slate-900 placeholder:text-slate-400 focus:ring-2 focus:ring-admin-primary/50 focus:border-admin-primary"})]}),l.jsx("button",{type:"button",className:"px-4 py-2.5 bg-admin-primary text-white font-bold rounded-lg hover:brightness-110 transition-all text-sm",children:"Enregistrer"})]})]}),l.jsxs("section",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:[l.jsx("div",{className:"px-6 py-4 border-b border-slate-100 bg-slate-50/80",children:l.jsxs("h2",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[l.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"lock"}),"Scurit"]})}),l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-slate-900",children:"Authentification  deux facteurs"}),l.jsx("p",{className:"text-xs text-slate-500",children:"Recommand pour les comptes administrateur."})]}),l.jsx("button",{type:"button",role:"switch","aria-checked":!1,className:"relative inline-flex h-5 w-10 shrink-0 rounded-full border-2 border-slate-200 bg-slate-200 transition-colors",children:l.jsx("span",{className:"inline-block h-4 w-4 rounded-full bg-white shadow translate-x-0.5",style:{marginTop:2}})})]}),l.jsxs("div",{className:"flex items-center justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-slate-900",children:"Expiration des sessions"}),l.jsx("p",{className:"text-xs text-slate-500",children:"Dconnexion automatique aprs inactivit."})]}),l.jsxs("select",{className:"bg-slate-50 border border-slate-200 rounded-lg px-3 py-2 text-sm text-slate-900 focus:ring-2 focus:ring-admin-primary/50",children:[l.jsx("option",{value:"60",children:"1 heure"}),l.jsx("option",{value:"480",children:"8 heures"}),l.jsx("option",{value:"1440",children:"24 heures"})]})]})]})]}),l.jsxs("section",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:[l.jsx("div",{className:"px-6 py-4 border-b border-slate-100 bg-slate-50/80",children:l.jsxs("h2",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[l.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"notifications"}),"Notifications"]})}),l.jsx("div",{className:"p-6 space-y-4",children:l.jsxs("div",{className:"flex items-center justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-slate-900",children:"Alertes par email"}),l.jsx("p",{className:"text-xs text-slate-500",children:"Nouveaux documents, signalements, etc."})]}),l.jsx("button",{type:"button",role:"switch","aria-checked":!0,className:"relative inline-flex h-5 w-10 shrink-0 rounded-full border-2 bg-admin-primary border-admin-primary transition-colors",children:l.jsx("span",{className:"inline-block h-4 w-4 rounded-full bg-white shadow translate-x-5",style:{marginTop:2}})})]})})]}),l.jsxs("section",{className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:[l.jsx("div",{className:"px-6 py-4 border-b border-slate-100 bg-slate-50/80",children:l.jsxs("h2",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[l.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"help"}),"Support & Admin"]})}),l.jsxs("div",{className:"p-6 space-y-4",children:[l.jsx("p",{className:"text-sm text-slate-600",children:"Pour toute question technique ou demande d'accs, contactez l'quipe Tarikh.ma."}),l.jsxs("div",{className:"flex flex-wrap gap-3",children:[l.jsxs("a",{href:"mailto:admin@tarikh.ma",className:"inline-flex items-center gap-2 px-4 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 transition-colors text-sm font-medium",children:[l.jsx("span",{className:"material-symbols-outlined text-lg",children:"mail"}),"Contacter l'admin"]}),l.jsxs(he,{to:"/admin",className:"inline-flex items-center gap-2 px-4 py-2 bg-admin-primary/10 text-admin-primary rounded-lg hover:bg-admin-primary/20 transition-colors text-sm font-medium",children:[l.jsx("span",{className:"material-symbols-outlined text-lg",children:"dashboard"}),"Retour au tableau de bord"]})]})]})]})]})]})}):null}function Ob(){const[u,e]=j.useState([]),[t,i]=j.useState(!0),[r,a]=j.useState(!1),[c,d]=j.useState(!1),[f,p]=j.useState(""),[m,x]=j.useState(""),[b,y]=j.useState(null),[A,w]=j.useState(!0),[S,N]=j.useState(0),C=async()=>{i(!0);try{const I=await ct.banners.list();e(I)}catch(I){console.error("Erreur bannires:",I)}finally{i(!1)}};j.useEffect(()=>{C()},[]);const R=async I=>{I.preventDefault(),d(!0);const $=new FormData;$.append("title",f),b&&$.append("image",b),m&&$.append("link_url",m),$.append("is_active",A?"1":"0"),$.append("order",String(S));try{await ct.banners.create($),a(!1),T(),C()}catch(te){alert(te.message||"Erreur lors de la cration")}finally{d(!1)}},E=async I=>{const $=new FormData;$.append("is_active",I.is_active?"0":"1");try{await ct.banners.update(I.id,$),C()}catch{alert("Erreur lors de la mise  jour")}},L=async I=>{if(confirm("Voulez-vous vraiment supprimer cette bannire ?"))try{await ct.banners.delete(I),C()}catch{alert("Erreur lors de la suppression")}},T=()=>{p(""),x(""),y(null),w(!0),N(0)};return l.jsxs("div",{className:"p-8",children:[l.jsxs("div",{className:"flex justify-between items-center mb-8",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Gestion des Bannires"}),l.jsx("p",{className:"text-slate-500",children:"Grez les publicits affiches sur la page d'accueil"})]}),l.jsxs("button",{onClick:()=>a(!0),className:"bg-primary text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-primary/90 transition-colors",children:[l.jsx("span",{className:"material-symbols-outlined",children:"add"}),"Nouvelle Bannire"]})]}),t?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(I=>l.jsx("div",{className:"h-48 bg-slate-100 animate-pulse rounded-xl"},I))}):l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[u.map(I=>l.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"h-32 bg-slate-100 relative",children:[l.jsx("img",{src:I.image_url,alt:I.title,className:"w-full h-full object-cover"}),l.jsxs("div",{className:"absolute top-2 right-2 flex gap-2",children:[l.jsx("button",{onClick:()=>E(I),className:`p-1.5 rounded-full backdrop-blur-md ${I.is_active?"bg-green-500/80 text-white":"bg-slate-500/80 text-white"}`,title:I.is_active?"Dsactiver":"Activer",children:l.jsx("span",{className:"material-symbols-outlined text-sm",children:I.is_active?"visibility":"visibility_off"})}),l.jsx("button",{onClick:()=>L(I.id),className:"p-1.5 bg-red-500/80 text-white rounded-full backdrop-blur-md",title:"Supprimer",children:l.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]}),l.jsxs("div",{className:"p-4",children:[l.jsx("h3",{className:"font-bold text-slate-800 truncate",children:I.title}),l.jsx("p",{className:"text-xs text-slate-500 truncate mb-3",children:I.link_url||"Aucun lien"}),l.jsxs("div",{className:"flex justify-between items-center text-xs",children:[l.jsxs("span",{className:"bg-slate-100 px-2 py-1 rounded text-slate-600",children:["Ordre: ",I.order]}),l.jsx("span",{className:I.is_active?"text-green-600 font-bold":"text-slate-400",children:I.is_active?"Active":"Inactive"})]})]})]},I.id)),u.length===0&&l.jsxs("div",{className:"col-span-full py-12 text-center bg-slate-50 rounded-xl border-2 border-dashed border-slate-200",children:[l.jsx("span",{className:"material-symbols-outlined text-4xl text-slate-300 mb-2",children:"ads_click"}),l.jsx("p",{className:"text-slate-500",children:"Aucune bannire configure"})]})]}),r&&l.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md overflow-hidden shadow-2xl",children:[l.jsxs("div",{className:"p-6 border-b border-slate-100 flex justify-between items-center",children:[l.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Ajouter une bannire"}),l.jsx("button",{onClick:()=>a(!1),className:"text-slate-400 hover:text-slate-600",children:l.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),l.jsxs("form",{onSubmit:R,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Titre"}),l.jsx("input",{type:"text",required:!0,value:f,onChange:I=>p(I.target.value),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary/20 outline-none",placeholder:"Ex: Exposition 2024"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Image (Recommand: 1200x300)"}),l.jsx("input",{type:"file",required:!0,accept:"image/*",onChange:I=>y(I.target.files?.[0]||null),className:"w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-primary/10 file:text-primary hover:file:bg-primary/20"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Lien de redirection (URL)"}),l.jsx("input",{type:"url",value:m,onChange:I=>x(I.target.value),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary/20 outline-none",placeholder:"https://..."})]}),l.jsxs("div",{className:"flex gap-4",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Ordre"}),l.jsx("input",{type:"number",value:S,onChange:I=>N(Number(I.target.value)),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-primary/20 outline-none"})]}),l.jsx("div",{className:"flex flex-col justify-end",children:l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer py-2",children:[l.jsx("input",{type:"checkbox",checked:A,onChange:I=>w(I.target.checked),className:"w-4 h-4 text-primary rounded border-slate-300 focus:ring-primary"}),l.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Activer"})]})})]}),l.jsxs("div",{className:"pt-4 flex gap-3",children:[l.jsx("button",{type:"button",onClick:()=>a(!1),className:"flex-1 px-4 py-2 border border-slate-200 text-slate-600 rounded-lg hover:bg-slate-50 transition-colors",children:"Annuler"}),l.jsx("button",{type:"submit",disabled:c,className:"flex-1 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50",children:c?"Envoi...":"Enregistrer"})]})]})]})})]})}function zb(){const u=os(e=>e.loadUser);return j.useEffect(()=>{u()},[u]),l.jsxs(_x,{children:[l.jsx(Ke,{path:"/documents/:id",element:l.jsx(s0,{}),children:l.jsx(Ke,{index:!0,element:l.jsx(Sb,{})})}),l.jsxs(Ke,{path:"/admin",element:l.jsx(n0,{}),children:[l.jsx(Ke,{index:!0,element:l.jsx(Tb,{})}),l.jsx(Ke,{path:"documents",element:l.jsx(Pb,{})}),l.jsx(Ke,{path:"documents/new",element:l.jsx(Pf,{})}),l.jsx(Ke,{path:"documents/:id/edit",element:l.jsx(Pf,{})}),l.jsx(Ke,{path:"users",element:l.jsx(Ib,{})}),l.jsx(Ke,{path:"users/new",element:l.jsx(Mf,{})}),l.jsx(Ke,{path:"users/:id/edit",element:l.jsx(Mf,{})}),l.jsx(Ke,{path:"banners",element:l.jsx(Ob,{})}),l.jsx(Ke,{path:"parametres",element:l.jsx(Fb,{})})]}),l.jsxs(Ke,{path:"/",element:l.jsx(t0,{}),children:[l.jsx(Ke,{index:!0,element:l.jsx(a0,{})}),l.jsx(Ke,{path:"a-propos",element:l.jsx(o0,{})}),l.jsx(Ke,{path:"epoques",element:l.jsx(c0,{})}),l.jsx(Ke,{path:"archives",element:l.jsx(h0,{})}),l.jsx(Ke,{path:"login",element:l.jsx(d0,{})}),l.jsx(Ke,{path:"register",element:l.jsx(u0,{})})]}),l.jsx(Ke,{path:"*",element:l.jsx(wx,{to:"/",replace:!0})})]})}Tg.createRoot(document.getElementById("root")).render(l.jsx(Cc.StrictMode,{children:l.jsx(Px,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:l.jsx(zb,{})})}));
